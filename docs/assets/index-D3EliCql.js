(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const g of h.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&s(g)}).observe(document,{childList:!0,subtree:!0});function a(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerPolicy&&(h.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?h.credentials="include":o.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(o){if(o.ep)return;o.ep=!0;const h=a(o);fetch(o.href,h)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"||typeof window<"u"?window:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace$1(e){if(e.__esModule)return e;var i=e.default;if(typeof i=="function"){var a=function s(){return this instanceof s?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};a.prototype=i.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var o=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return e[s]}})}),a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,i,a){this.props=e,this.context=i,this.refs=D$1,this.updater=a||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,i,a){this.props=e,this.context=i,this.refs=D$1,this.updater=a||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,i,a){var s,o={},h=null,g=null;if(i!=null)for(s in i.ref!==void 0&&(g=i.ref),i.key!==void 0&&(h=""+i.key),i)J.call(i,s)&&!L$3.hasOwnProperty(s)&&(o[s]=i[s]);var _=arguments.length-2;if(_===1)o.children=a;else if(1<_){for(var $=Array(_),b=0;b<_;b++)$[b]=arguments[b+2];o.children=$}if(e&&e.defaultProps)for(s in _=e.defaultProps,_)o[s]===void 0&&(o[s]=_[s]);return{$$typeof:l$1,type:e,key:h,ref:g,props:o,_owner:K$1.current}}function N$1(e,i){return{$$typeof:l$1,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return i[a]})}var P$1=/\/+/g;function Q$1(e,i){return typeof e=="object"&&e!==null&&e.key!=null?escape(""+e.key):i.toString(36)}function R$2(e,i,a,s,o){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var g=!1;if(e===null)g=!0;else switch(h){case"string":case"number":g=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:g=!0}}if(g)return g=e,o=o(g),e=s===""?"."+Q$1(g,0):s,I$1(o)?(a="",e!=null&&(a=e.replace(P$1,"$&/")+"/"),R$2(o,i,a,"",function(b){return b})):o!=null&&(O$1(o)&&(o=N$1(o,a+(!o.key||g&&g.key===o.key?"":(""+o.key).replace(P$1,"$&/")+"/")+e)),i.push(o)),1;if(g=0,s=s===""?".":s+":",I$1(e))for(var _=0;_<e.length;_++){h=e[_];var $=s+Q$1(h,_);g+=R$2(h,i,a,$,o)}else if($=A$1(e),typeof $=="function")for(e=$.call(e),_=0;!(h=e.next()).done;)h=h.value,$=s+Q$1(h,_++),g+=R$2(h,i,a,$,o);else if(h==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return g}function S$1(e,i,a){if(e==null)return e;var s=[],o=0;return R$2(e,s,"","",function(h){return i.call(a,h,o++)}),s}function T$1(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,i,a){S$1(e,function(){i.apply(this,arguments)},a)},count:function(e){var i=0;return S$1(e,function(){i++}),i},toArray:function(e){return S$1(e,function(i){return i})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$3;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(e,i,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=C$1({},e.props),o=e.key,h=e.ref,g=e._owner;if(i!=null){if(i.ref!==void 0&&(h=i.ref,g=K$1.current),i.key!==void 0&&(o=""+i.key),e.type&&e.type.defaultProps)var _=e.type.defaultProps;for($ in i)J.call(i,$)&&!L$3.hasOwnProperty($)&&(s[$]=i[$]===void 0&&_!==void 0?_[$]:i[$])}var $=arguments.length-2;if($===1)s.children=a;else if(1<$){_=Array($);for(var b=0;b<$;b++)_[b]=arguments[b+2];s.children=_}return{$$typeof:l$1,type:e.type,key:o,ref:h,props:s,_owner:g}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var i=M$1.bind(null,e);return i.type=e,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y$1,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,i){return{$$typeof:x$1,type:e,compare:i===void 0?null:i}};react_production_min.startTransition=function(e){var i=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=i}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(e,i){return U$1.current.useCallback(e,i)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,i){return U$1.current.useEffect(e,i)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,i,a){return U$1.current.useImperativeHandle(e,i,a)};react_production_min.useInsertionEffect=function(e,i){return U$1.current.useInsertionEffect(e,i)};react_production_min.useLayoutEffect=function(e,i){return U$1.current.useLayoutEffect(e,i)};react_production_min.useMemo=function(e,i){return U$1.current.useMemo(e,i)};react_production_min.useReducer=function(e,i,a){return U$1.current.useReducer(e,i,a)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,i,a){return U$1.current.useSyncExternalStore(e,i,a)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs$1(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q(e,i,a){var s,o={},h=null,g=null;a!==void 0&&(h=""+a),i.key!==void 0&&(h=""+i.key),i.ref!==void 0&&(g=i.ref);for(s in i)m$2.call(i,s)&&!p$2.hasOwnProperty(s)&&(o[s]=i[s]);if(e&&e.defaultProps)for(s in i=e.defaultProps,i)o[s]===void 0&&(o[s]=i[s]);return{$$typeof:k,type:e,key:h,ref:g,props:o,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(Xt,ln){var nn=Xt.length;Xt.push(ln);t:for(;0<nn;){var gn=nn-1>>>1,dn=Xt[gn];if(0<o(dn,ln))Xt[gn]=ln,Xt[nn]=dn,nn=gn;else break t}}function a(Xt){return Xt.length===0?null:Xt[0]}function s(Xt){if(Xt.length===0)return null;var ln=Xt[0],nn=Xt.pop();if(nn!==ln){Xt[0]=nn;t:for(var gn=0,dn=Xt.length,$n=dn>>>1;gn<$n;){var En=2*(gn+1)-1,qt=Xt[En],en=En+1,Tn=Xt[en];if(0>o(qt,nn))en<dn&&0>o(Tn,qt)?(Xt[gn]=Tn,Xt[en]=nn,gn=en):(Xt[gn]=qt,Xt[En]=nn,gn=En);else if(en<dn&&0>o(Tn,nn))Xt[gn]=Tn,Xt[en]=nn,gn=en;else break t}}return ln}function o(Xt,ln){var nn=Xt.sortIndex-ln.sortIndex;return nn!==0?nn:Xt.id-ln.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var g=Date,_=g.now();e.unstable_now=function(){return g.now()-_}}var $=[],b=[],tt=1,st=null,at=3,nt=!1,lt=!1,ft=!1,pt=typeof setTimeout=="function"?setTimeout:null,dt=typeof clearTimeout=="function"?clearTimeout:null,_t=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ut(Xt){for(var ln=a(b);ln!==null;){if(ln.callback===null)s(b);else if(ln.startTime<=Xt)s(b),ln.sortIndex=ln.expirationTime,i($,ln);else break;ln=a(b)}}function mt(Xt){if(ft=!1,ut(Xt),!lt)if(a($)!==null)lt=!0,sn(kt);else{var ln=a(b);ln!==null&&on(mt,ln.startTime-Xt)}}function kt(Xt,ln){lt=!1,ft&&(ft=!1,dt(Et),Et=-1),nt=!0;var nn=at;try{for(ut(ln),st=a($);st!==null&&(!(st.expirationTime>ln)||Xt&&!zt());){var gn=st.callback;if(typeof gn=="function"){st.callback=null,at=st.priorityLevel;var dn=gn(st.expirationTime<=ln);ln=e.unstable_now(),typeof dn=="function"?st.callback=dn:st===a($)&&s($),ut(ln)}else s($);st=a($)}if(st!==null)var $n=!0;else{var En=a(b);En!==null&&on(mt,En.startTime-ln),$n=!1}return $n}finally{st=null,at=nn,nt=!1}}var bt=!1,vt=null,Et=-1,Mt=5,At=-1;function zt(){return!(e.unstable_now()-At<Mt)}function Vt(){if(vt!==null){var Xt=e.unstable_now();At=Xt;var ln=!0;try{ln=vt(!0,Xt)}finally{ln?Gt():(bt=!1,vt=null)}}else bt=!1}var Gt;if(typeof _t=="function")Gt=function(){_t(Vt)};else if(typeof MessageChannel<"u"){var Kt=new MessageChannel,Wt=Kt.port2;Kt.port1.onmessage=Vt,Gt=function(){Wt.postMessage(null)}}else Gt=function(){pt(Vt,0)};function sn(Xt){vt=Xt,bt||(bt=!0,Gt())}function on(Xt,ln){Et=pt(function(){Xt(e.unstable_now())},ln)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Xt){Xt.callback=null},e.unstable_continueExecution=function(){lt||nt||(lt=!0,sn(kt))},e.unstable_forceFrameRate=function(Xt){0>Xt||125<Xt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Mt=0<Xt?Math.floor(1e3/Xt):5},e.unstable_getCurrentPriorityLevel=function(){return at},e.unstable_getFirstCallbackNode=function(){return a($)},e.unstable_next=function(Xt){switch(at){case 1:case 2:case 3:var ln=3;break;default:ln=at}var nn=at;at=ln;try{return Xt()}finally{at=nn}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Xt,ln){switch(Xt){case 1:case 2:case 3:case 4:case 5:break;default:Xt=3}var nn=at;at=Xt;try{return ln()}finally{at=nn}},e.unstable_scheduleCallback=function(Xt,ln,nn){var gn=e.unstable_now();switch(typeof nn=="object"&&nn!==null?(nn=nn.delay,nn=typeof nn=="number"&&0<nn?gn+nn:gn):nn=gn,Xt){case 1:var dn=-1;break;case 2:dn=250;break;case 5:dn=1073741823;break;case 4:dn=1e4;break;default:dn=5e3}return dn=nn+dn,Xt={id:tt++,callback:ln,priorityLevel:Xt,startTime:nn,expirationTime:dn,sortIndex:-1},nn>gn?(Xt.sortIndex=nn,i(b,Xt),a($)===null&&Xt===a(b)&&(ft?(dt(Et),Et=-1):ft=!0,on(mt,nn-gn))):(Xt.sortIndex=dn,i($,Xt),lt||nt||(lt=!0,sn(kt))),Xt},e.unstable_shouldYield=zt,e.unstable_wrapCallback=function(Xt){var ln=at;return function(){var nn=at;at=ln;try{return Xt.apply(this,arguments)}finally{at=nn}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,i){ha(e,i),ha(e+"Capture",i)}function ha(e,i){for(ea[e]=i,e=0;e<i.length;e++)da.add(i[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,i,a,s){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return s?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,i,a,s){if(i===null||typeof i>"u"||pa(e,i,a,s))return!0;if(s)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v(e,i,a,s,o,h,g){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=a,this.propertyName=e,this.type=i,this.sanitizeURL=h,this.removeEmptyString=g}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];z[i]=new v(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,i,a,s){var o=z.hasOwnProperty(i)?z[i]:null;(o!==null?o.type!==0:s||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,a,o,s)&&(a=null),s||o===null?oa(i)&&(a===null?e.removeAttribute(i):e.setAttribute(i,""+a)):o.mustUseProperty?e[o.propertyName]=a===null?o.type===3?!1:"":a:(i=o.attributeName,s=o.attributeNamespace,a===null?e.removeAttribute(i):(o=o.type,a=o===3||o===4&&a===!0?"":""+a,s?e.setAttributeNS(s,i,a):e.setAttribute(i,a))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+e}var Na=!1;function Oa(e,i){if(!e||Na)return"";Na=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(b){var s=b}Reflect.construct(e,[],i)}else{try{i.call()}catch(b){s=b}e.call(i.prototype)}else{try{throw Error()}catch(b){s=b}e()}}catch(b){if(b&&s&&typeof b.stack=="string"){for(var o=b.stack.split(`
`),h=s.stack.split(`
`),g=o.length-1,_=h.length-1;1<=g&&0<=_&&o[g]!==h[_];)_--;for(;1<=g&&0<=_;g--,_--)if(o[g]!==h[_]){if(g!==1||_!==1)do if(g--,_--,0>_||o[g]!==h[_]){var $=`
`+o[g].replace(" at new "," at ");return e.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",e.displayName)),$}while(1<=g&&0<=_);break}}}finally{Na=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return i=e.displayName||null,i!==null?i:Qa(e.type)||"Memo";case Ha:i=e._payload,e=e._init;try{return Qa(e(i))}catch{}}return null}function Ra(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(e){var i=Ta(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),s=""+e[i];if(!e.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var o=a.get,h=a.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return o.call(this)},set:function(g){s=""+g,h.call(this,g)}}),Object.defineProperty(e,i,{enumerable:a.enumerable}),{getValue:function(){return s},setValue:function(g){s=""+g},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var a=i.getValue(),s="";return e&&(s=Ta(e)?e.checked?"true":"false":e.value),e=s,e!==a?(i.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,i){var a=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function Za(e,i){var a=i.defaultValue==null?"":i.defaultValue,s=i.checked!=null?i.checked:i.defaultChecked;a=Sa(i.value!=null?i.value:a),e._wrapperState={initialChecked:s,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(e,i){i=i.checked,i!=null&&ta(e,"checked",i,!1)}function bb(e,i){ab(e,i);var a=Sa(i.value),s=i.type;if(a!=null)s==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?cb(e,i.type,a):i.hasOwnProperty("defaultValue")&&cb(e,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function db(e,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var s=i.type;if(!(s!=="submit"&&s!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,a||i===e.value||(e.value=i),e.defaultValue=i}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function cb(e,i,a){(i!=="number"||Xa(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var eb=Array.isArray;function fb(e,i,a,s){if(e=e.options,i){i={};for(var o=0;o<a.length;o++)i["$"+a[o]]=!0;for(a=0;a<e.length;a++)o=i.hasOwnProperty("$"+e[a].value),e[a].selected!==o&&(e[a].selected=o),o&&s&&(e[a].defaultSelected=!0)}else{for(a=""+Sa(a),i=null,o=0;o<e.length;o++){if(e[o].value===a){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}i!==null||e[o].disabled||(i=e[o])}i!==null&&(i.selected=!0)}}function gb(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(p$1(92));if(eb(a)){if(1<a.length)throw Error(p$1(93));a=a[0]}i=a}i==null&&(i=""),a=i}e._wrapperState={initialValue:Sa(a)}}function ib(e,i){var a=Sa(i.value),s=Sa(i.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),i.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),s!=null&&(e.defaultValue=""+s)}function jb(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,s,o){MSApp.execUnsafeLocalFunction(function(){return e(i,a,s,o)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function ob(e,i){if(i){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=i;return}}e.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),pb[i]=pb[e]})});function rb(e,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||pb.hasOwnProperty(e)&&pb[e]?(""+i).trim():i+"px"}function sb(e,i){e=e.style;for(var a in i)if(i.hasOwnProperty(a)){var s=a.indexOf("--")===0,o=rb(a,i[a],s);a==="float"&&(a="cssFloat"),s?e.setProperty(a,o):e[a]=o}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,i){if(i){if(tb[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p$1(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p$1(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p$1(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p$1(62))}}function vb(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p$1(280));var i=e.stateNode;i&&(i=Db(i),yb(e.stateNode,e.type,i))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,i=Ab;if(Ab=zb=null,Bb(e),i)for(e=0;e<i.length;e++)Bb(i[e])}}function Gb(e,i){return e(i)}function Hb(){}var Ib=!1;function Jb(e,i,a){if(Ib)return e(i,a);Ib=!0;try{return Gb(e,i,a)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,i){var a=e.stateNode;if(a===null)return null;var s=Db(a);if(s===null)return null;a=s[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(p$1(231,i,typeof a));return a}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,i,a,s,o,h,g,_,$){var b=Array.prototype.slice.call(arguments,3);try{i.apply(a,b)}catch(tt){this.onError(tt)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,i,a,s,o,h,g,_,$){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,i,a,s,o,h,g,_,$){if(Tb.apply(this,arguments),Ob){if(Ob){var b=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=b)}}function Vb(e){var i=e,a=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(a=i.return),e=i.return;while(e)}return i.tag===3?a:null}function Wb(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p$1(188))}function Yb(e){var i=e.alternate;if(!i){if(i=Vb(e),i===null)throw Error(p$1(188));return i!==e?null:e}for(var a=e,s=i;;){var o=a.return;if(o===null)break;var h=o.alternate;if(h===null){if(s=o.return,s!==null){a=s;continue}break}if(o.child===h.child){for(h=o.child;h;){if(h===a)return Xb(o),e;if(h===s)return Xb(o),i;h=h.sibling}throw Error(p$1(188))}if(a.return!==s.return)a=o,s=h;else{for(var g=!1,_=o.child;_;){if(_===a){g=!0,a=o,s=h;break}if(_===s){g=!0,s=o,a=h;break}_=_.sibling}if(!g){for(_=h.child;_;){if(_===a){g=!0,a=h,s=o;break}if(_===s){g=!0,s=h,a=o;break}_=_.sibling}if(!g)throw Error(p$1(189))}}if(a.alternate!==s)throw Error(p$1(190))}if(a.tag!==3)throw Error(p$1(188));return a.stateNode.current===a?e:i}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=$b(e);if(i!==null)return i;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,i){var a=e.pendingLanes;if(a===0)return 0;var s=0,o=e.suspendedLanes,h=e.pingedLanes,g=a&268435455;if(g!==0){var _=g&~o;_!==0?s=tc(_):(h&=g,h!==0&&(s=tc(h)))}else g=a&~o,g!==0?s=tc(g):h!==0&&(s=tc(h));if(s===0)return 0;if(i!==0&&i!==s&&!(i&o)&&(o=s&-s,h=i&-i,o>=h||o===16&&(h&4194240)!==0))return i;if(s&4&&(s|=a&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=s;0<i;)a=31-oc(i),o=1<<a,s|=e[a],i&=~o;return s}function vc(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,i){for(var a=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,h=e.pendingLanes;0<h;){var g=31-oc(h),_=1<<g,$=o[g];$===-1?(!(_&a)||_&s)&&(o[g]=vc(_,i)):$<=i&&(e.expiredLanes|=_),h&=~_}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var i=[],a=0;31>a;a++)i.push(e);return i}function Ac(e,i,a){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-oc(i),e[i]=a}function Bc(e,i){var a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<a;){var o=31-oc(a),h=1<<o;i[o]=0,s[o]=-1,e[o]=-1,a&=~h}}function Cc(e,i){var a=e.entangledLanes|=i;for(e=e.entanglements;a;){var s=31-oc(a),o=1<<s;o&i|e[s]&i&&(e[s]|=i),a&=~o}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,i){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(e,i,a,s,o,h){return e===null||e.nativeEvent!==h?(e={blockedOn:i,domEventName:a,eventSystemFlags:s,nativeEvent:h,targetContainers:[o]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),e):(e.eventSystemFlags|=s,i=e.targetContainers,o!==null&&i.indexOf(o)===-1&&i.push(o),e)}function Uc(e,i,a,s,o){switch(i){case"focusin":return Lc=Tc(Lc,e,i,a,s,o),!0;case"dragenter":return Mc=Tc(Mc,e,i,a,s,o),!0;case"mouseover":return Nc=Tc(Nc,e,i,a,s,o),!0;case"pointerover":var h=o.pointerId;return Oc.set(h,Tc(Oc.get(h)||null,e,i,a,s,o)),!0;case"gotpointercapture":return h=o.pointerId,Pc.set(h,Tc(Pc.get(h)||null,e,i,a,s,o)),!0}return!1}function Vc(e){var i=Wc(e.target);if(i!==null){var a=Vb(i);if(a!==null){if(i=a.tag,i===13){if(i=Wb(a),i!==null){e.blockedOn=i,Ic(e.priority,function(){Gc(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var a=Yc(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var s=new a.constructor(a.type,a);wb=s,a.target.dispatchEvent(s),wb=null}else return i=Cb(a),i!==null&&Fc(i),e.blockedOn=a,!1;i.shift()}return!0}function Zc(e,i,a){Xc(e)&&a.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,i){e.blockedOn===i&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function i(o){return ad(o,e)}if(0<Kc.length){ad(Kc[0],e);for(var a=1;a<Kc.length;a++){var s=Kc[a];s.blockedOn===e&&(s.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(i),Pc.forEach(i),a=0;a<Qc.length;a++)s=Qc[a],s.blockedOn===e&&(s.blockedOn=null);for(;0<Qc.length&&(a=Qc[0],a.blockedOn===null);)Vc(a),a.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,i,a,s){var o=C,h=cd.transition;cd.transition=null;try{C=1,fd(e,i,a,s)}finally{C=o,cd.transition=h}}function gd(e,i,a,s){var o=C,h=cd.transition;cd.transition=null;try{C=4,fd(e,i,a,s)}finally{C=o,cd.transition=h}}function fd(e,i,a,s){if(dd){var o=Yc(e,i,a,s);if(o===null)hd(e,i,s,id,a),Sc(e,s);else if(Uc(o,e,i,a,s))s.stopPropagation();else if(Sc(e,s),i&4&&-1<Rc.indexOf(e)){for(;o!==null;){var h=Cb(o);if(h!==null&&Ec(h),h=Yc(e,i,a,s),h===null&&hd(e,i,s,id,a),h===o)break;o=h}o!==null&&s.stopPropagation()}else hd(e,i,s,null,a)}}var id=null;function Yc(e,i,a,s){if(id=null,e=xb(s),e=Wc(e),e!==null)if(i=Vb(e),i===null)e=null;else if(a=i.tag,a===13){if(e=Wb(i),e!==null)return e;e=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,i=ld,a=i.length,s,o="value"in kd?kd.value:kd.textContent,h=o.length;for(e=0;e<a&&i[e]===o[e];e++);var g=a-e;for(s=1;s<=g&&i[a-s]===o[h-s];s++);return md=o.slice(e,1<s?1-s:void 0)}function od(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function i(a,s,o,h,g){this._reactName=a,this._targetInst=o,this.type=s,this.nativeEvent=h,this.target=g,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(a=e[_],this[_]=a?a(h):h[_]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od[e])?!!i[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var i=Md[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(e,i){switch(e){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,i){switch(e){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe=!0,ee);case"textInput":return e=i.data,e===ee&&fe?null:e;default:return null}}function ke(e,i){if(ie)return e==="compositionend"||!ae&&ge(e,i)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de&&i.locale!=="ko"?null:i.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!le[e.type]:i==="textarea"}function ne(e,i,a,s){Eb(s),i=oe(i,"onChange"),0<i.length&&(a=new td("onChange","change",null,a,s),e.push({event:a,listeners:i}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){var i=ue(e);if(Wa(i))return e}function ve(e,i){if(e==="change")return i}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var i=[];ne(i,qe,e,xb(e)),Jb(re,i)}}function Ce(e,i,a){e==="focusin"?(Ae(),pe=i,qe=a,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,i){if(e==="click")return te(i)}function Fe(e,i){if(e==="input"||e==="change")return te(i)}function Ge(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,i){if(He(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var a=Object.keys(e),s=Object.keys(i);if(a.length!==s.length)return!1;for(s=0;s<a.length;s++){var o=a[s];if(!ja.call(i,o)||!He(e[o],i[o]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,i){var a=Je(e);e=0;for(var s;a;){if(a.nodeType===3){if(s=e+a.textContent.length,e<=i&&s>=i)return{node:a,offset:i-e};e=s}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=Je(a)}}function Le(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Le(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var e=window,i=Xa();i instanceof e.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)e=i.contentWindow;else break;i=Xa(e.document)}return i}function Ne(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Oe(e){var i=Me(),a=e.focusedElem,s=e.selectionRange;if(i!==a&&a&&a.ownerDocument&&Le(a.ownerDocument.documentElement,a)){if(s!==null&&Ne(a)){if(i=s.start,e=s.end,e===void 0&&(e=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(e,a.value.length);else if(e=(i=a.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var o=a.textContent.length,h=Math.min(s.start,o);s=s.end===void 0?h:Math.min(s.end,o),!e.extend&&h>s&&(o=s,s=h,h=o),o=Ke(a,h);var g=Ke(a,s);o&&g&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==g.node||e.focusOffset!==g.offset)&&(i=i.createRange(),i.setStart(o.node,o.offset),e.removeAllRanges(),h>s?(e.addRange(i),e.extend(g.node,g.offset)):(i.setEnd(g.node,g.offset),e.addRange(i)))}}for(i=[],e=a;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)e=i[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,i,a){var s=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Te||Qe==null||Qe!==Xa(s)||(s=Qe,"selectionStart"in s&&Ne(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Se&&Ie(Se,s)||(Se=s,s=oe(Re,"onSelect"),0<s.length&&(i=new td("onSelect","select",null,i,a),e.push({event:i,listeners:s}),i.target=Qe)))}function Ve(e,i){var a={};return a[e.toLowerCase()]=i.toLowerCase(),a["Webkit"+e]="webkit"+i,a["Moz"+e]="moz"+i,a}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var i=We[e],a;for(a in i)if(i.hasOwnProperty(a)&&a in Ye)return Xe[e]=i[a];return e}var $e$1=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,i){df.set(e,i),fa(i,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e$1,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,i,a){var s=e.type||"unknown-event";e.currentTarget=a,Ub(s,i,void 0,e),e.currentTarget=null}function se(e,i){i=(i&4)!==0;for(var a=0;a<e.length;a++){var s=e[a],o=s.event;s=s.listeners;t:{var h=void 0;if(i)for(var g=s.length-1;0<=g;g--){var _=s[g],$=_.instance,b=_.currentTarget;if(_=_.listener,$!==h&&o.isPropagationStopped())break t;nf(o,_,b),h=$}else for(g=0;g<s.length;g++){if(_=s[g],$=_.instance,b=_.currentTarget,_=_.listener,$!==h&&o.isPropagationStopped())break t;nf(o,_,b),h=$}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,i){var a=i[of];a===void 0&&(a=i[of]=new Set);var s=e+"__bubble";a.has(s)||(pf(i,e,2,!1),a.add(s))}function qf(e,i,a){var s=0;i&&(s|=4),pf(a,e,s,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(a){a!=="selectionchange"&&(mf.has(a)||qf(a,!1,e),qf(a,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(e,i,a,s){switch(jd(i)){case 1:var o=ed;break;case 4:o=gd;break;default:o=fd}a=o.bind(null,i,a,e),o=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(i,a,{capture:!0,passive:o}):e.addEventListener(i,a,!0):o!==void 0?e.addEventListener(i,a,{passive:o}):e.addEventListener(i,a,!1)}function hd(e,i,a,s,o){var h=s;if(!(i&1)&&!(i&2)&&s!==null)t:for(;;){if(s===null)return;var g=s.tag;if(g===3||g===4){var _=s.stateNode.containerInfo;if(_===o||_.nodeType===8&&_.parentNode===o)break;if(g===4)for(g=s.return;g!==null;){var $=g.tag;if(($===3||$===4)&&($=g.stateNode.containerInfo,$===o||$.nodeType===8&&$.parentNode===o))return;g=g.return}for(;_!==null;){if(g=Wc(_),g===null)return;if($=g.tag,$===5||$===6){s=h=g;continue t}_=_.parentNode}}s=s.return}Jb(function(){var b=h,tt=xb(a),st=[];t:{var at=df.get(e);if(at!==void 0){var nt=td,lt=e;switch(e){case"keypress":if(od(a)===0)break t;case"keydown":case"keyup":nt=Rd;break;case"focusin":lt="focus",nt=Fd;break;case"focusout":lt="blur",nt=Fd;break;case"beforeblur":case"afterblur":nt=Fd;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=Vd;break;case $e$1:case af:case bf:nt=Hd;break;case cf:nt=Xd;break;case"scroll":nt=vd;break;case"wheel":nt=Zd;break;case"copy":case"cut":case"paste":nt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=Td}var ft=(i&4)!==0,pt=!ft&&e==="scroll",dt=ft?at!==null?at+"Capture":null:at;ft=[];for(var _t=b,ut;_t!==null;){ut=_t;var mt=ut.stateNode;if(ut.tag===5&&mt!==null&&(ut=mt,dt!==null&&(mt=Kb(_t,dt),mt!=null&&ft.push(tf(_t,mt,ut)))),pt)break;_t=_t.return}0<ft.length&&(at=new nt(at,lt,null,a,tt),st.push({event:at,listeners:ft}))}}if(!(i&7)){t:{if(at=e==="mouseover"||e==="pointerover",nt=e==="mouseout"||e==="pointerout",at&&a!==wb&&(lt=a.relatedTarget||a.fromElement)&&(Wc(lt)||lt[uf]))break t;if((nt||at)&&(at=tt.window===tt?tt:(at=tt.ownerDocument)?at.defaultView||at.parentWindow:window,nt?(lt=a.relatedTarget||a.toElement,nt=b,lt=lt?Wc(lt):null,lt!==null&&(pt=Vb(lt),lt!==pt||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(nt=null,lt=b),nt!==lt)){if(ft=Bd,mt="onMouseLeave",dt="onMouseEnter",_t="mouse",(e==="pointerout"||e==="pointerover")&&(ft=Td,mt="onPointerLeave",dt="onPointerEnter",_t="pointer"),pt=nt==null?at:ue(nt),ut=lt==null?at:ue(lt),at=new ft(mt,_t+"leave",nt,a,tt),at.target=pt,at.relatedTarget=ut,mt=null,Wc(tt)===b&&(ft=new ft(dt,_t+"enter",lt,a,tt),ft.target=ut,ft.relatedTarget=pt,mt=ft),pt=mt,nt&&lt)e:{for(ft=nt,dt=lt,_t=0,ut=ft;ut;ut=vf(ut))_t++;for(ut=0,mt=dt;mt;mt=vf(mt))ut++;for(;0<_t-ut;)ft=vf(ft),_t--;for(;0<ut-_t;)dt=vf(dt),ut--;for(;_t--;){if(ft===dt||dt!==null&&ft===dt.alternate)break e;ft=vf(ft),dt=vf(dt)}ft=null}else ft=null;nt!==null&&wf(st,at,nt,ft,!1),lt!==null&&pt!==null&&wf(st,pt,lt,ft,!0)}}t:{if(at=b?ue(b):window,nt=at.nodeName&&at.nodeName.toLowerCase(),nt==="select"||nt==="input"&&at.type==="file")var kt=ve;else if(me(at))if(we)kt=Fe;else{kt=De;var bt=Ce}else(nt=at.nodeName)&&nt.toLowerCase()==="input"&&(at.type==="checkbox"||at.type==="radio")&&(kt=Ee);if(kt&&(kt=kt(e,b))){ne(st,kt,a,tt);break t}bt&&bt(e,at,b),e==="focusout"&&(bt=at._wrapperState)&&bt.controlled&&at.type==="number"&&cb(at,"number",at.value)}switch(bt=b?ue(b):window,e){case"focusin":(me(bt)||bt.contentEditable==="true")&&(Qe=bt,Re=b,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(st,a,tt);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(st,a,tt)}var vt;if(ae)t:{switch(e){case"compositionstart":var Et="onCompositionStart";break t;case"compositionend":Et="onCompositionEnd";break t;case"compositionupdate":Et="onCompositionUpdate";break t}Et=void 0}else ie?ge(e,a)&&(Et="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Et="onCompositionStart");Et&&(de&&a.locale!=="ko"&&(ie||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&ie&&(vt=nd()):(kd=tt,ld="value"in kd?kd.value:kd.textContent,ie=!0)),bt=oe(b,Et),0<bt.length&&(Et=new Ld(Et,e,null,a,tt),st.push({event:Et,listeners:bt}),vt?Et.data=vt:(vt=he(a),vt!==null&&(Et.data=vt)))),(vt=ce?je(e,a):ke(e,a))&&(b=oe(b,"onBeforeInput"),0<b.length&&(tt=new Ld("onBeforeInput","beforeinput",null,a,tt),st.push({event:tt,listeners:b}),tt.data=vt))}se(st,i)})}function tf(e,i,a){return{instance:e,listener:i,currentTarget:a}}function oe(e,i){for(var a=i+"Capture",s=[];e!==null;){var o=e,h=o.stateNode;o.tag===5&&h!==null&&(o=h,h=Kb(e,a),h!=null&&s.unshift(tf(e,h,o)),h=Kb(e,i),h!=null&&s.push(tf(e,h,o))),e=e.return}return s}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,i,a,s,o){for(var h=i._reactName,g=[];a!==null&&a!==s;){var _=a,$=_.alternate,b=_.stateNode;if($!==null&&$===s)break;_.tag===5&&b!==null&&(_=b,o?($=Kb(a,h),$!=null&&g.unshift(tf(a,$,_))):o||($=Kb(a,h),$!=null&&g.push(tf(a,$,_)))),a=a.return}g.length!==0&&e.push({event:i,listeners:g})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,i,a){if(i=zf(i),zf(e)!==i&&a)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,i){var a=i,s=0;do{var o=a.nextSibling;if(e.removeChild(a),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(s===0){e.removeChild(o),bd(i);return}s--}else a!=="$"&&a!=="$?"&&a!=="$!"||s++;a=o}while(a);bd(i)}function Lf(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return e;i--}else a==="/$"&&i++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var i=e[Of];if(i)return i;for(var a=e.parentNode;a;){if(i=a[uf]||a[Of]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(e=Mf(e);e!==null;){if(a=e[Of])return a;e=Mf(e)}return i}e=a,a=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p$1(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,i){Tf++,Sf[Tf]=e.current,e.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,i){var a=e.type.contextTypes;if(!a)return Vf;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===i)return s.__reactInternalMemoizedMaskedChildContext;var o={},h;for(h in a)o[h]=i[h];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),o}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H)}function ag(e,i,a){if(H.current!==Vf)throw Error(p$1(168));G(H,i),G(Wf,a)}function bg(e,i,a){var s=e.stateNode;if(i=i.childContextTypes,typeof s.getChildContext!="function")return a;s=s.getChildContext();for(var o in s)if(!(o in i))throw Error(p$1(108,Ra(e)||"Unknown",o));return A({},a,s)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,i,a){var s=e.stateNode;if(!s)throw Error(p$1(169));a?(e=bg(e,i,Xf),s.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H),G(H,e)):E(Wf),G(Wf,a)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,i=C;try{var a=eg;for(C=1;e<a.length;e++){var s=a[e];do s=s(!0);while(s!==null)}eg=null,fg=!1}catch(o){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),o}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,i){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=i}function ug(e,i,a){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var s=rg;e=sg;var o=32-oc(s)-1;s&=~(1<<o),a+=1;var h=32-oc(i)+o;if(30<h){var g=o-o%5;h=(s&(1<<g)-1).toString(32),s>>=g,o-=g,rg=1<<32-oc(i)+o|a<<o|s,sg=h+e}else rg=1<<h|a<<o|s,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,i){var a=Bg(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=e,i=e.deletions,i===null?(e.deletions=[a],e.flags|=16):i.push(a)}function Cg(e,i){switch(e.tag){case 5:var a=e.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,xg=e,yg=Lf(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,xg=e,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=Bg(18,null,null,0),a.stateNode=i,a.return=e,e.child=a,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var i=yg;if(i){var a=i;if(!Cg(e,i)){if(Dg(e))throw Error(p$1(418));i=Lf(a.nextSibling);var s=xg;i&&Cg(e,i)?Ag(s,a):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p$1(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!Ef(e.type,e.memoizedProps)),i&&(i=yg)){if(Dg(e))throw Hg(),Error(p$1(418));for(;i;)Ag(e,i),i=Lf(i.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p$1(317));t:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(i===0){yg=Lf(e.nextSibling);break t}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,i,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(p$1(309));var s=a.stateNode}if(!s)throw Error(p$1(147,e));var o=s,h=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===h?i.ref:(i=function(g){var _=o.refs;g===null?delete _[h]:_[h]=g},i._stringRef=h,i)}if(typeof e!="string")throw Error(p$1(284));if(!a._owner)throw Error(p$1(290,e))}return e}function Mg(e,i){throw e=Object.prototype.toString.call(i),Error(p$1(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function Ng(e){var i=e._init;return i(e._payload)}function Og(e){function i(dt,_t){if(e){var ut=dt.deletions;ut===null?(dt.deletions=[_t],dt.flags|=16):ut.push(_t)}}function a(dt,_t){if(!e)return null;for(;_t!==null;)i(dt,_t),_t=_t.sibling;return null}function s(dt,_t){for(dt=new Map;_t!==null;)_t.key!==null?dt.set(_t.key,_t):dt.set(_t.index,_t),_t=_t.sibling;return dt}function o(dt,_t){return dt=Pg(dt,_t),dt.index=0,dt.sibling=null,dt}function h(dt,_t,ut){return dt.index=ut,e?(ut=dt.alternate,ut!==null?(ut=ut.index,ut<_t?(dt.flags|=2,_t):ut):(dt.flags|=2,_t)):(dt.flags|=1048576,_t)}function g(dt){return e&&dt.alternate===null&&(dt.flags|=2),dt}function _(dt,_t,ut,mt){return _t===null||_t.tag!==6?(_t=Qg(ut,dt.mode,mt),_t.return=dt,_t):(_t=o(_t,ut),_t.return=dt,_t)}function $(dt,_t,ut,mt){var kt=ut.type;return kt===ya?tt(dt,_t,ut.props.children,mt,ut.key):_t!==null&&(_t.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===Ha&&Ng(kt)===_t.type)?(mt=o(_t,ut.props),mt.ref=Lg(dt,_t,ut),mt.return=dt,mt):(mt=Rg(ut.type,ut.key,ut.props,null,dt.mode,mt),mt.ref=Lg(dt,_t,ut),mt.return=dt,mt)}function b(dt,_t,ut,mt){return _t===null||_t.tag!==4||_t.stateNode.containerInfo!==ut.containerInfo||_t.stateNode.implementation!==ut.implementation?(_t=Sg(ut,dt.mode,mt),_t.return=dt,_t):(_t=o(_t,ut.children||[]),_t.return=dt,_t)}function tt(dt,_t,ut,mt,kt){return _t===null||_t.tag!==7?(_t=Tg(ut,dt.mode,mt,kt),_t.return=dt,_t):(_t=o(_t,ut),_t.return=dt,_t)}function st(dt,_t,ut){if(typeof _t=="string"&&_t!==""||typeof _t=="number")return _t=Qg(""+_t,dt.mode,ut),_t.return=dt,_t;if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case va:return ut=Rg(_t.type,_t.key,_t.props,null,dt.mode,ut),ut.ref=Lg(dt,null,_t),ut.return=dt,ut;case wa:return _t=Sg(_t,dt.mode,ut),_t.return=dt,_t;case Ha:var mt=_t._init;return st(dt,mt(_t._payload),ut)}if(eb(_t)||Ka(_t))return _t=Tg(_t,dt.mode,ut,null),_t.return=dt,_t;Mg(dt,_t)}return null}function at(dt,_t,ut,mt){var kt=_t!==null?_t.key:null;if(typeof ut=="string"&&ut!==""||typeof ut=="number")return kt!==null?null:_(dt,_t,""+ut,mt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case va:return ut.key===kt?$(dt,_t,ut,mt):null;case wa:return ut.key===kt?b(dt,_t,ut,mt):null;case Ha:return kt=ut._init,at(dt,_t,kt(ut._payload),mt)}if(eb(ut)||Ka(ut))return kt!==null?null:tt(dt,_t,ut,mt,null);Mg(dt,ut)}return null}function nt(dt,_t,ut,mt,kt){if(typeof mt=="string"&&mt!==""||typeof mt=="number")return dt=dt.get(ut)||null,_(_t,dt,""+mt,kt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return dt=dt.get(mt.key===null?ut:mt.key)||null,$(_t,dt,mt,kt);case wa:return dt=dt.get(mt.key===null?ut:mt.key)||null,b(_t,dt,mt,kt);case Ha:var bt=mt._init;return nt(dt,_t,ut,bt(mt._payload),kt)}if(eb(mt)||Ka(mt))return dt=dt.get(ut)||null,tt(_t,dt,mt,kt,null);Mg(_t,mt)}return null}function lt(dt,_t,ut,mt){for(var kt=null,bt=null,vt=_t,Et=_t=0,Mt=null;vt!==null&&Et<ut.length;Et++){vt.index>Et?(Mt=vt,vt=null):Mt=vt.sibling;var At=at(dt,vt,ut[Et],mt);if(At===null){vt===null&&(vt=Mt);break}e&&vt&&At.alternate===null&&i(dt,vt),_t=h(At,_t,Et),bt===null?kt=At:bt.sibling=At,bt=At,vt=Mt}if(Et===ut.length)return a(dt,vt),I&&tg(dt,Et),kt;if(vt===null){for(;Et<ut.length;Et++)vt=st(dt,ut[Et],mt),vt!==null&&(_t=h(vt,_t,Et),bt===null?kt=vt:bt.sibling=vt,bt=vt);return I&&tg(dt,Et),kt}for(vt=s(dt,vt);Et<ut.length;Et++)Mt=nt(vt,dt,Et,ut[Et],mt),Mt!==null&&(e&&Mt.alternate!==null&&vt.delete(Mt.key===null?Et:Mt.key),_t=h(Mt,_t,Et),bt===null?kt=Mt:bt.sibling=Mt,bt=Mt);return e&&vt.forEach(function(zt){return i(dt,zt)}),I&&tg(dt,Et),kt}function ft(dt,_t,ut,mt){var kt=Ka(ut);if(typeof kt!="function")throw Error(p$1(150));if(ut=kt.call(ut),ut==null)throw Error(p$1(151));for(var bt=kt=null,vt=_t,Et=_t=0,Mt=null,At=ut.next();vt!==null&&!At.done;Et++,At=ut.next()){vt.index>Et?(Mt=vt,vt=null):Mt=vt.sibling;var zt=at(dt,vt,At.value,mt);if(zt===null){vt===null&&(vt=Mt);break}e&&vt&&zt.alternate===null&&i(dt,vt),_t=h(zt,_t,Et),bt===null?kt=zt:bt.sibling=zt,bt=zt,vt=Mt}if(At.done)return a(dt,vt),I&&tg(dt,Et),kt;if(vt===null){for(;!At.done;Et++,At=ut.next())At=st(dt,At.value,mt),At!==null&&(_t=h(At,_t,Et),bt===null?kt=At:bt.sibling=At,bt=At);return I&&tg(dt,Et),kt}for(vt=s(dt,vt);!At.done;Et++,At=ut.next())At=nt(vt,dt,Et,At.value,mt),At!==null&&(e&&At.alternate!==null&&vt.delete(At.key===null?Et:At.key),_t=h(At,_t,Et),bt===null?kt=At:bt.sibling=At,bt=At);return e&&vt.forEach(function(Vt){return i(dt,Vt)}),I&&tg(dt,Et),kt}function pt(dt,_t,ut,mt){if(typeof ut=="object"&&ut!==null&&ut.type===ya&&ut.key===null&&(ut=ut.props.children),typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case va:t:{for(var kt=ut.key,bt=_t;bt!==null;){if(bt.key===kt){if(kt=ut.type,kt===ya){if(bt.tag===7){a(dt,bt.sibling),_t=o(bt,ut.props.children),_t.return=dt,dt=_t;break t}}else if(bt.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===Ha&&Ng(kt)===bt.type){a(dt,bt.sibling),_t=o(bt,ut.props),_t.ref=Lg(dt,bt,ut),_t.return=dt,dt=_t;break t}a(dt,bt);break}else i(dt,bt);bt=bt.sibling}ut.type===ya?(_t=Tg(ut.props.children,dt.mode,mt,ut.key),_t.return=dt,dt=_t):(mt=Rg(ut.type,ut.key,ut.props,null,dt.mode,mt),mt.ref=Lg(dt,_t,ut),mt.return=dt,dt=mt)}return g(dt);case wa:t:{for(bt=ut.key;_t!==null;){if(_t.key===bt)if(_t.tag===4&&_t.stateNode.containerInfo===ut.containerInfo&&_t.stateNode.implementation===ut.implementation){a(dt,_t.sibling),_t=o(_t,ut.children||[]),_t.return=dt,dt=_t;break t}else{a(dt,_t);break}else i(dt,_t);_t=_t.sibling}_t=Sg(ut,dt.mode,mt),_t.return=dt,dt=_t}return g(dt);case Ha:return bt=ut._init,pt(dt,_t,bt(ut._payload),mt)}if(eb(ut))return lt(dt,_t,ut,mt);if(Ka(ut))return ft(dt,_t,ut,mt);Mg(dt,ut)}return typeof ut=="string"&&ut!==""||typeof ut=="number"?(ut=""+ut,_t!==null&&_t.tag===6?(a(dt,_t.sibling),_t=o(_t,ut),_t.return=dt,dt=_t):(a(dt,_t),_t=Qg(ut,dt.mode,mt),_t.return=dt,dt=_t),g(dt)):a(dt,_t)}return pt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var i=Wg.current;E(Wg),e._currentValue=i}function bh(e,i,a){for(;e!==null;){var s=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,s!==null&&(s.childLanes|=i)):s!==null&&(s.childLanes&i)!==i&&(s.childLanes|=i),e===a)break;e=e.return}}function ch(e,i){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(dh=!0),e.firstContext=null)}function eh(e){var i=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:i,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return i}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,i,a,s){var o=i.interleaved;return o===null?(a.next=a,gh(i)):(a.next=o.next,o.next=a),i.interleaved=a,ih(e,s)}function ih(e,i){e.lanes|=i;var a=e.alternate;for(a!==null&&(a.lanes|=i),a=e,e=e.return;e!==null;)e.childLanes|=i,a=e.alternate,a!==null&&(a.childLanes|=i),a=e,e=e.return;return a.tag===3?a.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function nh(e,i,a){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,K&2){var o=s.pending;return o===null?i.next=i:(i.next=o.next,o.next=i),s.pending=i,ih(e,a)}return o=s.interleaved,o===null?(i.next=i,gh(s)):(i.next=o.next,o.next=i),s.interleaved=i,ih(e,a)}function oh(e,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var s=i.lanes;s&=e.pendingLanes,a|=s,i.lanes=a,Cc(e,a)}}function ph(e,i){var a=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,a===s)){var o=null,h=null;if(a=a.firstBaseUpdate,a!==null){do{var g={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};h===null?o=h=g:h=h.next=g,a=a.next}while(a!==null);h===null?o=h=i:h=h.next=i}else o=h=i;a={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:h,shared:s.shared,effects:s.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=i:e.next=i,a.lastBaseUpdate=i}function qh(e,i,a,s){var o=e.updateQueue;jh=!1;var h=o.firstBaseUpdate,g=o.lastBaseUpdate,_=o.shared.pending;if(_!==null){o.shared.pending=null;var $=_,b=$.next;$.next=null,g===null?h=b:g.next=b,g=$;var tt=e.alternate;tt!==null&&(tt=tt.updateQueue,_=tt.lastBaseUpdate,_!==g&&(_===null?tt.firstBaseUpdate=b:_.next=b,tt.lastBaseUpdate=$))}if(h!==null){var st=o.baseState;g=0,tt=b=$=null,_=h;do{var at=_.lane,nt=_.eventTime;if((s&at)===at){tt!==null&&(tt=tt.next={eventTime:nt,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});t:{var lt=e,ft=_;switch(at=i,nt=a,ft.tag){case 1:if(lt=ft.payload,typeof lt=="function"){st=lt.call(nt,st,at);break t}st=lt;break t;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=ft.payload,at=typeof lt=="function"?lt.call(nt,st,at):lt,at==null)break t;st=A({},st,at);break t;case 2:jh=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,at=o.effects,at===null?o.effects=[_]:at.push(_))}else nt={eventTime:nt,lane:at,tag:_.tag,payload:_.payload,callback:_.callback,next:null},tt===null?(b=tt=nt,$=st):tt=tt.next=nt,g|=at;if(_=_.next,_===null){if(_=o.shared.pending,_===null)break;at=_,_=at.next,at.next=null,o.lastBaseUpdate=at,o.shared.pending=null}}while(!0);if(tt===null&&($=st),o.baseState=$,o.firstBaseUpdate=b,o.lastBaseUpdate=tt,i=o.shared.interleaved,i!==null){o=i;do g|=o.lane,o=o.next;while(o!==i)}else h===null&&(o.shared.lanes=0);rh|=g,e.lanes=g,e.memoizedState=st}}function sh(e,i,a){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var s=e[i],o=s.callback;if(o!==null){if(s.callback=null,s=a,typeof o!="function")throw Error(p$1(191,o));o.call(s)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p$1(174));return e}function yh(e,i){switch(G(wh,i),G(vh,e),G(uh,th),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=lb(i,e)}E(uh),G(uh,i)}function zh(){E(uh),E(vh),E(wh)}function Ah(e){xh(wh.current);var i=xh(uh.current),a=lb(i,e.type);i!==a&&(G(vh,e),G(uh,a))}function Bh(e){vh.current===e&&(E(uh),E(vh))}var L$2=Uf(0);function Ch(e){for(var i=e;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p$1(321))}function Mh(e,i){if(i===null)return!1;for(var a=0;a<i.length&&a<e.length;a++)if(!He(e[a],i[a]))return!1;return!0}function Nh(e,i,a,s,o,h){if(Hh=h,M=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=a(s,o),Jh){h=0;do{if(Jh=!1,Kh=0,25<=h)throw Error(p$1(301));h+=1,O=N=null,i.updateQueue=null,Fh.current=Qh,e=a(s,o)}while(Jh)}if(Fh.current=Rh,i=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,i)throw Error(p$1(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=e:O=O.next=e,O}function Uh(){if(N===null){var e=M.alternate;e=e!==null?e.memoizedState:null}else e=N.next;var i=O===null?M.memoizedState:O.next;if(i!==null)O=i,N=e;else{if(e===null)throw Error(p$1(310));N=e,e={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=e:O=O.next=e}return O}function Vh(e,i){return typeof i=="function"?i(e):i}function Wh(e){var i=Uh(),a=i.queue;if(a===null)throw Error(p$1(311));a.lastRenderedReducer=e;var s=N,o=s.baseQueue,h=a.pending;if(h!==null){if(o!==null){var g=o.next;o.next=h.next,h.next=g}s.baseQueue=o=h,a.pending=null}if(o!==null){h=o.next,s=s.baseState;var _=g=null,$=null,b=h;do{var tt=b.lane;if((Hh&tt)===tt)$!==null&&($=$.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),s=b.hasEagerState?b.eagerState:e(s,b.action);else{var st={lane:tt,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};$===null?(_=$=st,g=s):$=$.next=st,M.lanes|=tt,rh|=tt}b=b.next}while(b!==null&&b!==h);$===null?g=s:$.next=_,He(s,i.memoizedState)||(dh=!0),i.memoizedState=s,i.baseState=g,i.baseQueue=$,a.lastRenderedState=s}if(e=a.interleaved,e!==null){o=e;do h=o.lane,M.lanes|=h,rh|=h,o=o.next;while(o!==e)}else o===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Xh(e){var i=Uh(),a=i.queue;if(a===null)throw Error(p$1(311));a.lastRenderedReducer=e;var s=a.dispatch,o=a.pending,h=i.memoizedState;if(o!==null){a.pending=null;var g=o=o.next;do h=e(h,g.action),g=g.next;while(g!==o);He(h,i.memoizedState)||(dh=!0),i.memoizedState=h,i.baseQueue===null&&(i.baseState=h),a.lastRenderedState=h}return[h,s]}function Yh(){}function Zh(e,i){var a=M,s=Uh(),o=i(),h=!He(s.memoizedState,o);if(h&&(s.memoizedState=o,dh=!0),s=s.queue,$h(ai.bind(null,a,s,e),[e]),s.getSnapshot!==i||h||O!==null&&O.memoizedState.tag&1){if(a.flags|=2048,bi(9,ci.bind(null,a,s,o,i),void 0,null),Q===null)throw Error(p$1(349));Hh&30||di(a,i,o)}return o}function di(e,i,a){e.flags|=16384,e={getSnapshot:i,value:a},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.stores=[e]):(a=i.stores,a===null?i.stores=[e]:a.push(e))}function ci(e,i,a,s){i.value=a,i.getSnapshot=s,ei(i)&&fi(e)}function ai(e,i,a){return a(function(){ei(i)&&fi(e)})}function ei(e){var i=e.getSnapshot;e=e.value;try{var a=i();return!He(e,a)}catch{return!0}}function fi(e){var i=ih(e,1);i!==null&&gi(i,e,1,-1)}function hi(e){var i=Th();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},i.queue=e,e=e.dispatch=ii.bind(null,M,e),[i.memoizedState,e]}function bi(e,i,a,s){return e={tag:e,create:i,destroy:a,deps:s,next:null},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.lastEffect=e.next=e):(a=i.lastEffect,a===null?i.lastEffect=e.next=e:(s=a.next,a.next=e,e.next=s,i.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,i,a,s){var o=Th();M.flags|=e,o.memoizedState=bi(1|i,a,void 0,s===void 0?null:s)}function li$1(e,i,a,s){var o=Uh();s=s===void 0?null:s;var h=void 0;if(N!==null){var g=N.memoizedState;if(h=g.destroy,s!==null&&Mh(s,g.deps)){o.memoizedState=bi(i,a,h,s);return}}M.flags|=e,o.memoizedState=bi(1|i,a,h,s)}function mi(e,i){return ki(8390656,8,e,i)}function $h(e,i){return li$1(2048,8,e,i)}function ni(e,i){return li$1(4,2,e,i)}function oi(e,i){return li$1(4,4,e,i)}function pi(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function qi(e,i,a){return a=a!=null?a.concat([e]):null,li$1(4,4,pi.bind(null,i,e),a)}function ri(){}function si(e,i){var a=Uh();i=i===void 0?null:i;var s=a.memoizedState;return s!==null&&i!==null&&Mh(i,s[1])?s[0]:(a.memoizedState=[e,i],e)}function ti(e,i){var a=Uh();i=i===void 0?null:i;var s=a.memoizedState;return s!==null&&i!==null&&Mh(i,s[1])?s[0]:(e=e(),a.memoizedState=[e,i],e)}function ui(e,i,a){return Hh&21?(He(a,i)||(a=yc(),M.lanes|=a,rh|=a,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=a)}function vi(e,i){var a=C;C=a!==0&&4>a?a:4,e(!0);var s=Gh.transition;Gh.transition={};try{e(!1),i()}finally{C=a,Gh.transition=s}}function wi(){return Uh().memoizedState}function xi(e,i,a){var s=yi(e);if(a={lane:s,action:a,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(i,a);else if(a=hh(e,i,a,s),a!==null){var o=R$1();gi(a,e,s,o),Bi(a,i,s)}}function ii(e,i,a){var s=yi(e),o={lane:s,action:a,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(i,o);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=i.lastRenderedReducer,h!==null))try{var g=i.lastRenderedState,_=h(g,a);if(o.hasEagerState=!0,o.eagerState=_,He(_,g)){var $=i.interleaved;$===null?(o.next=o,gh(i)):(o.next=$.next,$.next=o),i.interleaved=o;return}}catch{}finally{}a=hh(e,i,o,s),a!==null&&(o=R$1(),gi(a,e,s,o),Bi(a,i,s))}}function zi(e){var i=e.alternate;return e===M||i!==null&&i===M}function Ai(e,i){Jh=Ih=!0;var a=e.pending;a===null?i.next=i:(i.next=a.next,a.next=i),e.pending=i}function Bi(e,i,a){if(a&4194240){var s=i.lanes;s&=e.pendingLanes,a|=s,i.lanes=a,Cc(e,a)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,i){return Th().memoizedState=[e,i===void 0?null:i],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,i,a){return a=a!=null?a.concat([e]):null,ki(4194308,4,pi.bind(null,i,e),a)},useLayoutEffect:function(e,i){return ki(4194308,4,e,i)},useInsertionEffect:function(e,i){return ki(4,2,e,i)},useMemo:function(e,i){var a=Th();return i=i===void 0?null:i,e=e(),a.memoizedState=[e,i],e},useReducer:function(e,i,a){var s=Th();return i=a!==void 0?a(i):i,s.memoizedState=s.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},s.queue=e,e=e.dispatch=xi.bind(null,M,e),[s.memoizedState,e]},useRef:function(e){var i=Th();return e={current:e},i.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),i=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,a){var s=M,o=Th();if(I){if(a===void 0)throw Error(p$1(407));a=a()}else{if(a=i(),Q===null)throw Error(p$1(349));Hh&30||di(s,i,a)}o.memoizedState=a;var h={value:a,getSnapshot:i};return o.queue=h,mi(ai.bind(null,s,h,e),[e]),s.flags|=2048,bi(9,ci.bind(null,s,h,a,i),void 0,null),a},useId:function(){var e=Th(),i=Q.identifierPrefix;if(I){var a=sg,s=rg;a=(s&~(1<<32-oc(s)-1)).toString(32)+a,i=":"+i+"R"+a,a=Kh++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=Lh++,i=":"+i+"r"+a.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return ui(i,N.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return N===null?i.memoizedState=e:ui(i,N.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,i){if(e&&e.defaultProps){i=A({},i),e=e.defaultProps;for(var a in e)i[a]===void 0&&(i[a]=e[a]);return i}return i}function Di(e,i,a,s){i=e.memoizedState,a=a(s,i),a=a==null?i:A({},i,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,i,a){e=e._reactInternals;var s=R$1(),o=yi(e),h=mh(s,o);h.payload=i,a!=null&&(h.callback=a),i=nh(e,h,o),i!==null&&(gi(i,e,o,s),oh(i,e,o))},enqueueReplaceState:function(e,i,a){e=e._reactInternals;var s=R$1(),o=yi(e),h=mh(s,o);h.tag=1,h.payload=i,a!=null&&(h.callback=a),i=nh(e,h,o),i!==null&&(gi(i,e,o,s),oh(i,e,o))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var a=R$1(),s=yi(e),o=mh(a,s);o.tag=2,i!=null&&(o.callback=i),i=nh(e,o,s),i!==null&&(gi(i,e,s,a),oh(i,e,s))}};function Fi(e,i,a,s,o,h,g){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,h,g):i.prototype&&i.prototype.isPureReactComponent?!Ie(a,s)||!Ie(o,h):!0}function Gi(e,i,a){var s=!1,o=Vf,h=i.contextType;return typeof h=="object"&&h!==null?h=eh(h):(o=Zf(i)?Xf:H.current,s=i.contextTypes,h=(s=s!=null)?Yf(e,o):Vf),i=new i(a,h),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ei,e.stateNode=i,i._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=h),i}function Hi(e,i,a,s){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,s),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,s),i.state!==e&&Ei.enqueueReplaceState(i,i.state,null)}function Ii(e,i,a,s){var o=e.stateNode;o.props=a,o.state=e.memoizedState,o.refs={},kh(e);var h=i.contextType;typeof h=="object"&&h!==null?o.context=eh(h):(h=Zf(i)?Xf:H.current,o.context=Yf(e,h)),o.state=e.memoizedState,h=i.getDerivedStateFromProps,typeof h=="function"&&(Di(e,i,h,a),o.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(i=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),i!==o.state&&Ei.enqueueReplaceState(o,o.state,null),qh(e,a,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,i){try{var a="",s=i;do a+=Pa(s),s=s.return;while(s);var o=a}catch(h){o=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:i,stack:o,digest:null}}function Ki(e,i,a){return{value:e,source:null,stack:a??null,digest:i??null}}function Li(e,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,i,a){a=mh(-1,a),a.tag=3,a.payload={element:null};var s=i.value;return a.callback=function(){Oi||(Oi=!0,Pi=s),Li(e,i)},a}function Qi(e,i,a){a=mh(-1,a),a.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=i.value;a.payload=function(){return s(o)},a.callback=function(){Li(e,i)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(a.callback=function(){Li(e,i),typeof s!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var g=i.stack;this.componentDidCatch(i.value,{componentStack:g!==null?g:""})}),a}function Si(e,i,a){var s=e.pingCache;if(s===null){s=e.pingCache=new Mi;var o=new Set;s.set(i,o)}else o=s.get(i),o===void 0&&(o=new Set,s.set(i,o));o.has(a)||(o.add(a),e=Ti.bind(null,e,i,a),i.then(e,e))}function Ui(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Vi(e,i,a,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===i?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=mh(-1,1),i.tag=2,nh(a,i,1))),a.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,i,a,s){i.child=e===null?Vg(i,null,a,s):Ug(i,e.child,a,s)}function Yi(e,i,a,s,o){a=a.render;var h=i.ref;return ch(i,o),s=Nh(e,i,a,s,h,o),a=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~o,Zi(e,i,o)):(I&&a&&vg(i),i.flags|=1,Xi(e,i,s,o),i.child)}function $i(e,i,a,s,o){if(e===null){var h=a.type;return typeof h=="function"&&!aj(h)&&h.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=h,bj(e,i,h,s,o)):(e=Rg(a.type,null,s,i,i.mode,o),e.ref=i.ref,e.return=i,i.child=e)}if(h=e.child,!(e.lanes&o)){var g=h.memoizedProps;if(a=a.compare,a=a!==null?a:Ie,a(g,s)&&e.ref===i.ref)return Zi(e,i,o)}return i.flags|=1,e=Pg(h,s),e.ref=i.ref,e.return=i,i.child=e}function bj(e,i,a,s,o){if(e!==null){var h=e.memoizedProps;if(Ie(h,s)&&e.ref===i.ref)if(dh=!1,i.pendingProps=s=h,(e.lanes&o)!==0)e.flags&131072&&(dh=!0);else return i.lanes=e.lanes,Zi(e,i,o)}return cj(e,i,a,s,o)}function dj(e,i,a){var s=i.pendingProps,o=s.children,h=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=a;else{if(!(a&1073741824))return e=h!==null?h.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,G(ej,fj),fj|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=h!==null?h.baseLanes:a,G(ej,fj),fj|=s}else h!==null?(s=h.baseLanes|a,i.memoizedState=null):s=a,G(ej,fj),fj|=s;return Xi(e,i,o,a),i.child}function gj(e,i){var a=i.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function cj(e,i,a,s,o){var h=Zf(a)?Xf:H.current;return h=Yf(i,h),ch(i,o),a=Nh(e,i,a,s,h,o),s=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~o,Zi(e,i,o)):(I&&s&&vg(i),i.flags|=1,Xi(e,i,a,o),i.child)}function hj(e,i,a,s,o){if(Zf(a)){var h=!0;cg(i)}else h=!1;if(ch(i,o),i.stateNode===null)ij(e,i),Gi(i,a,s),Ii(i,a,s,o),s=!0;else if(e===null){var g=i.stateNode,_=i.memoizedProps;g.props=_;var $=g.context,b=a.contextType;typeof b=="object"&&b!==null?b=eh(b):(b=Zf(a)?Xf:H.current,b=Yf(i,b));var tt=a.getDerivedStateFromProps,st=typeof tt=="function"||typeof g.getSnapshotBeforeUpdate=="function";st||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(_!==s||$!==b)&&Hi(i,g,s,b),jh=!1;var at=i.memoizedState;g.state=at,qh(i,s,g,o),$=i.memoizedState,_!==s||at!==$||Wf.current||jh?(typeof tt=="function"&&(Di(i,a,tt,s),$=i.memoizedState),(_=jh||Fi(i,a,_,s,at,$,b))?(st||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=s,i.memoizedState=$),g.props=s,g.state=$,g.context=b,s=_):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),s=!1)}else{g=i.stateNode,lh(e,i),_=i.memoizedProps,b=i.type===i.elementType?_:Ci(i.type,_),g.props=b,st=i.pendingProps,at=g.context,$=a.contextType,typeof $=="object"&&$!==null?$=eh($):($=Zf(a)?Xf:H.current,$=Yf(i,$));var nt=a.getDerivedStateFromProps;(tt=typeof nt=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(_!==st||at!==$)&&Hi(i,g,s,$),jh=!1,at=i.memoizedState,g.state=at,qh(i,s,g,o);var lt=i.memoizedState;_!==st||at!==lt||Wf.current||jh?(typeof nt=="function"&&(Di(i,a,nt,s),lt=i.memoizedState),(b=jh||Fi(i,a,b,s,at,lt,$)||!1)?(tt||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(s,lt,$),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(s,lt,$)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||_===e.memoizedProps&&at===e.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&at===e.memoizedState||(i.flags|=1024),i.memoizedProps=s,i.memoizedState=lt),g.props=s,g.state=lt,g.context=$,s=b):(typeof g.componentDidUpdate!="function"||_===e.memoizedProps&&at===e.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&at===e.memoizedState||(i.flags|=1024),s=!1)}return jj(e,i,a,s,h,o)}function jj(e,i,a,s,o,h){gj(e,i);var g=(i.flags&128)!==0;if(!s&&!g)return o&&dg(i,a,!1),Zi(e,i,h);s=i.stateNode,Wi.current=i;var _=g&&typeof a.getDerivedStateFromError!="function"?null:s.render();return i.flags|=1,e!==null&&g?(i.child=Ug(i,e.child,null,h),i.child=Ug(i,null,_,h)):Xi(e,i,_,h),i.memoizedState=s.state,o&&dg(i,a,!0),i.child}function kj(e){var i=e.stateNode;i.pendingContext?ag(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(e,i.context,!1),yh(e,i.containerInfo)}function lj(e,i,a,s,o){return Ig(),Jg(o),i.flags|=256,Xi(e,i,a,s),i.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,i,a){var s=i.pendingProps,o=L$2.current,h=!1,g=(i.flags&128)!==0,_;if((_=g)||(_=e!==null&&e.memoizedState===null?!1:(o&2)!==0),_?(h=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),G(L$2,o&1),e===null)return Eg(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(g=s.children,e=s.fallback,h?(s=i.mode,h=i.child,g={mode:"hidden",children:g},!(s&1)&&h!==null?(h.childLanes=0,h.pendingProps=g):h=pj(g,s,0,null),e=Tg(e,s,a,null),h.return=i,e.return=i,h.sibling=e,i.child=h,i.child.memoizedState=nj(a),i.memoizedState=mj,e):qj(i,g));if(o=e.memoizedState,o!==null&&(_=o.dehydrated,_!==null))return rj(e,i,g,s,_,o,a);if(h){h=s.fallback,g=i.mode,o=e.child,_=o.sibling;var $={mode:"hidden",children:s.children};return!(g&1)&&i.child!==o?(s=i.child,s.childLanes=0,s.pendingProps=$,i.deletions=null):(s=Pg(o,$),s.subtreeFlags=o.subtreeFlags&14680064),_!==null?h=Pg(_,h):(h=Tg(h,g,a,null),h.flags|=2),h.return=i,s.return=i,s.sibling=h,i.child=s,s=h,h=i.child,g=e.child.memoizedState,g=g===null?nj(a):{baseLanes:g.baseLanes|a,cachePool:null,transitions:g.transitions},h.memoizedState=g,h.childLanes=e.childLanes&~a,i.memoizedState=mj,s}return h=e.child,e=h.sibling,s=Pg(h,{mode:"visible",children:s.children}),!(i.mode&1)&&(s.lanes=a),s.return=i,s.sibling=null,e!==null&&(a=i.deletions,a===null?(i.deletions=[e],i.flags|=16):a.push(e)),i.child=s,i.memoizedState=null,s}function qj(e,i){return i=pj({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function sj(e,i,a,s){return s!==null&&Jg(s),Ug(i,e.child,null,a),e=qj(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function rj(e,i,a,s,o,h,g){if(a)return i.flags&256?(i.flags&=-257,s=Ki(Error(p$1(422))),sj(e,i,g,s)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(h=s.fallback,o=i.mode,s=pj({mode:"visible",children:s.children},o,0,null),h=Tg(h,o,g,null),h.flags|=2,s.return=i,h.return=i,s.sibling=h,i.child=s,i.mode&1&&Ug(i,e.child,null,g),i.child.memoizedState=nj(g),i.memoizedState=mj,h);if(!(i.mode&1))return sj(e,i,g,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var _=s.dgst;return s=_,h=Error(p$1(419)),s=Ki(h,s,void 0),sj(e,i,g,s)}if(_=(g&e.childLanes)!==0,dh||_){if(s=Q,s!==null){switch(g&-g){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|g)?0:o,o!==0&&o!==h.retryLane&&(h.retryLane=o,ih(e,o),gi(s,e,o,-1))}return tj(),s=Ki(Error(p$1(421))),sj(e,i,g,s)}return o.data==="$?"?(i.flags|=128,i.child=e.child,i=uj.bind(null,e),o._reactRetry=i,null):(e=h.treeContext,yg=Lf(o.nextSibling),xg=i,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=i),i=qj(i,s.children),i.flags|=4096,i)}function vj(e,i,a){e.lanes|=i;var s=e.alternate;s!==null&&(s.lanes|=i),bh(e.return,i,a)}function wj(e,i,a,s,o){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:s,tail:a,tailMode:o}:(h.isBackwards=i,h.rendering=null,h.renderingStartTime=0,h.last=s,h.tail=a,h.tailMode=o)}function xj(e,i,a){var s=i.pendingProps,o=s.revealOrder,h=s.tail;if(Xi(e,i,s.children,a),s=L$2.current,s&2)s=s&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,a,i);else if(e.tag===19)vj(e,a,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(G(L$2,s),!(i.mode&1))i.memoizedState=null;else switch(o){case"forwards":for(a=i.child,o=null;a!==null;)e=a.alternate,e!==null&&Ch(e)===null&&(o=a),a=a.sibling;a=o,a===null?(o=i.child,i.child=null):(o=a.sibling,a.sibling=null),wj(i,!1,o,a,h);break;case"backwards":for(a=null,o=i.child,i.child=null;o!==null;){if(e=o.alternate,e!==null&&Ch(e)===null){i.child=o;break}e=o.sibling,o.sibling=a,a=o,o=e}wj(i,!0,a,null,h);break;case"together":wj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ij(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function Zi(e,i,a){if(e!==null&&(i.dependencies=e.dependencies),rh|=i.lanes,!(a&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(p$1(153));if(i.child!==null){for(e=i.child,a=Pg(e,e.pendingProps),i.child=a,a.return=i;e.sibling!==null;)e=e.sibling,a=a.sibling=Pg(e,e.pendingProps),a.return=i;a.sibling=null}return i.child}function yj(e,i,a){switch(i.tag){case 3:kj(i),Ig();break;case 5:Ah(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:yh(i,i.stateNode.containerInfo);break;case 10:var s=i.type._context,o=i.memoizedProps.value;G(Wg,s._currentValue),s._currentValue=o;break;case 13:if(s=i.memoizedState,s!==null)return s.dehydrated!==null?(G(L$2,L$2.current&1),i.flags|=128,null):a&i.child.childLanes?oj(e,i,a):(G(L$2,L$2.current&1),e=Zi(e,i,a),e!==null?e.sibling:null);G(L$2,L$2.current&1);break;case 19:if(s=(a&i.childLanes)!==0,e.flags&128){if(s)return xj(e,i,a);i.flags|=128}if(o=i.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),G(L$2,L$2.current),s)break;return null;case 22:case 23:return i.lanes=0,dj(e,i,a)}return Zi(e,i,a)}var zj,Aj,Bj,Cj;zj=function(e,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Aj=function(){};Bj=function(e,i,a,s){var o=e.memoizedProps;if(o!==s){e=i.stateNode,xh(uh.current);var h=null;switch(a){case"input":o=Ya(e,o),s=Ya(e,s),h=[];break;case"select":o=A({},o,{value:void 0}),s=A({},s,{value:void 0}),h=[];break;case"textarea":o=gb(e,o),s=gb(e,s),h=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Bf)}ub(a,s);var g;a=null;for(b in o)if(!s.hasOwnProperty(b)&&o.hasOwnProperty(b)&&o[b]!=null)if(b==="style"){var _=o[b];for(g in _)_.hasOwnProperty(g)&&(a||(a={}),a[g]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(ea.hasOwnProperty(b)?h||(h=[]):(h=h||[]).push(b,null));for(b in s){var $=s[b];if(_=o!=null?o[b]:void 0,s.hasOwnProperty(b)&&$!==_&&($!=null||_!=null))if(b==="style")if(_){for(g in _)!_.hasOwnProperty(g)||$&&$.hasOwnProperty(g)||(a||(a={}),a[g]="");for(g in $)$.hasOwnProperty(g)&&_[g]!==$[g]&&(a||(a={}),a[g]=$[g])}else a||(h||(h=[]),h.push(b,a)),a=$;else b==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,_=_?_.__html:void 0,$!=null&&_!==$&&(h=h||[]).push(b,$)):b==="children"?typeof $!="string"&&typeof $!="number"||(h=h||[]).push(b,""+$):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(ea.hasOwnProperty(b)?($!=null&&b==="onScroll"&&D("scroll",e),h||_===$||(h=[])):(h=h||[]).push(b,$))}a&&(h=h||[]).push("style",a);var b=h;(i.updateQueue=b)&&(i.flags|=4)}};Cj=function(e,i,a,s){a!==s&&(i.flags|=4)};function Dj(e,i){if(!I)switch(e.tailMode){case"hidden":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function S(e){var i=e.alternate!==null&&e.alternate.child===e.child,a=0,s=0;if(i)for(var o=e.child;o!==null;)a|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)a|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=a,i}function Ej(e,i,a){var s=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return s=i.stateNode,zh(),E(Wf),E(H),Eh(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Gg(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,i),S(i),null;case 5:Bh(i);var o=xh(wh.current);if(a=i.type,e!==null&&i.stateNode!=null)Bj(e,i,a,s,o),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!s){if(i.stateNode===null)throw Error(p$1(166));return S(i),null}if(e=xh(uh.current),Gg(i)){s=i.stateNode,a=i.type;var h=i.memoizedProps;switch(s[Of]=i,s[Pf]=h,e=(i.mode&1)!==0,a){case"dialog":D("cancel",s),D("close",s);break;case"iframe":case"object":case"embed":D("load",s);break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],s);break;case"source":D("error",s);break;case"img":case"image":case"link":D("error",s),D("load",s);break;case"details":D("toggle",s);break;case"input":Za(s,h),D("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!h.multiple},D("invalid",s);break;case"textarea":hb(s,h),D("invalid",s)}ub(a,h),o=null;for(var g in h)if(h.hasOwnProperty(g)){var _=h[g];g==="children"?typeof _=="string"?s.textContent!==_&&(h.suppressHydrationWarning!==!0&&Af(s.textContent,_,e),o=["children",_]):typeof _=="number"&&s.textContent!==""+_&&(h.suppressHydrationWarning!==!0&&Af(s.textContent,_,e),o=["children",""+_]):ea.hasOwnProperty(g)&&_!=null&&g==="onScroll"&&D("scroll",s)}switch(a){case"input":Va(s),db(s,h,!0);break;case"textarea":Va(s),jb(s);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(s.onclick=Bf)}s=o,i.updateQueue=s,s!==null&&(i.flags|=4)}else{g=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=g.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=g.createElement(a,{is:s.is}):(e=g.createElement(a),a==="select"&&(g=e,s.multiple?g.multiple=!0:s.size&&(g.size=s.size))):e=g.createElementNS(e,a),e[Of]=i,e[Pf]=s,zj(e,i,!1,!1),i.stateNode=e;t:{switch(g=vb(a,s),a){case"dialog":D("cancel",e),D("close",e),o=s;break;case"iframe":case"object":case"embed":D("load",e),o=s;break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],e);o=s;break;case"source":D("error",e),o=s;break;case"img":case"image":case"link":D("error",e),D("load",e),o=s;break;case"details":D("toggle",e),o=s;break;case"input":Za(e,s),o=Ya(e,s),D("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=A({},s,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,s),o=gb(e,s),D("invalid",e);break;default:o=s}ub(a,o),_=o;for(h in _)if(_.hasOwnProperty(h)){var $=_[h];h==="style"?sb(e,$):h==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&nb(e,$)):h==="children"?typeof $=="string"?(a!=="textarea"||$!=="")&&ob(e,$):typeof $=="number"&&ob(e,""+$):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ea.hasOwnProperty(h)?$!=null&&h==="onScroll"&&D("scroll",e):$!=null&&ta(e,h,$,g))}switch(a){case"input":Va(e),db(e,s,!1);break;case"textarea":Va(e),jb(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Sa(s.value));break;case"select":e.multiple=!!s.multiple,h=s.value,h!=null?fb(e,!!s.multiple,h,!1):s.defaultValue!=null&&fb(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Bf)}switch(a){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break t;case"img":s=!0;break t;default:s=!1}}s&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(e&&i.stateNode!=null)Cj(e,i,e.memoizedProps,s);else{if(typeof s!="string"&&i.stateNode===null)throw Error(p$1(166));if(a=xh(wh.current),xh(uh.current),Gg(i)){if(s=i.stateNode,a=i.memoizedProps,s[Of]=i,(h=s.nodeValue!==a)&&(e=xg,e!==null))switch(e.tag){case 3:Af(s.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(s.nodeValue,a,(e.mode&1)!==0)}h&&(i.flags|=4)}else s=(a.nodeType===9?a:a.ownerDocument).createTextNode(s),s[Of]=i,i.stateNode=s}return S(i),null;case 13:if(E(L$2),s=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,h=!1;else if(h=Gg(i),s!==null&&s.dehydrated!==null){if(e===null){if(!h)throw Error(p$1(318));if(h=i.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(p$1(317));h[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),h=!1}else zg!==null&&(Fj(zg),zg=null),h=!0;if(!h)return i.flags&65536?i:null}return i.flags&128?(i.lanes=a,i):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(i.child.flags|=8192,i.mode&1&&(e===null||L$2.current&1?T===0&&(T=3):tj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return zh(),Aj(e,i),e===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return ah(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E(L$2),h=i.memoizedState,h===null)return S(i),null;if(s=(i.flags&128)!==0,g=h.rendering,g===null)if(s)Dj(h,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(g=Ch(e),g!==null){for(i.flags|=128,Dj(h,!1),s=g.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),i.subtreeFlags=0,s=a,a=i.child;a!==null;)h=a,e=s,h.flags&=14680066,g=h.alternate,g===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=g.childLanes,h.lanes=g.lanes,h.child=g.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=g.memoizedProps,h.memoizedState=g.memoizedState,h.updateQueue=g.updateQueue,h.type=g.type,e=g.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return G(L$2,L$2.current&1|2),i.child}e=e.sibling}h.tail!==null&&B()>Gj&&(i.flags|=128,s=!0,Dj(h,!1),i.lanes=4194304)}else{if(!s)if(e=Ch(g),e!==null){if(i.flags|=128,s=!0,a=e.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),Dj(h,!0),h.tail===null&&h.tailMode==="hidden"&&!g.alternate&&!I)return S(i),null}else 2*B()-h.renderingStartTime>Gj&&a!==1073741824&&(i.flags|=128,s=!0,Dj(h,!1),i.lanes=4194304);h.isBackwards?(g.sibling=i.child,i.child=g):(a=h.last,a!==null?a.sibling=g:i.child=g,h.last=g)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=B(),i.sibling=null,a=L$2.current,G(L$2,s?a&1|2:a&1),i):(S(i),null);case 22:case 23:return Hj(),s=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(i.flags|=8192),s&&i.mode&1?fj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p$1(156,i.tag))}function Ij(e,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return zh(),E(Wf),E(H),Eh(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Bh(i),null;case 13:if(E(L$2),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(p$1(340));Ig()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return E(L$2),null;case 4:return zh(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,i){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(s){W(e,i,s)}else a.current=null}function Mj(e,i,a){try{a()}catch(s){W(e,i,s)}}var Nj=!1;function Oj(e,i){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var s=a.getSelection&&a.getSelection();if(s&&s.rangeCount!==0){a=s.anchorNode;var o=s.anchorOffset,h=s.focusNode;s=s.focusOffset;try{a.nodeType,h.nodeType}catch{a=null;break t}var g=0,_=-1,$=-1,b=0,tt=0,st=e,at=null;e:for(;;){for(var nt;st!==a||o!==0&&st.nodeType!==3||(_=g+o),st!==h||s!==0&&st.nodeType!==3||($=g+s),st.nodeType===3&&(g+=st.nodeValue.length),(nt=st.firstChild)!==null;)at=st,st=nt;for(;;){if(st===e)break e;if(at===a&&++b===o&&(_=g),at===h&&++tt===s&&($=g),(nt=st.nextSibling)!==null)break;st=at,at=st.parentNode}st=nt}a=_===-1||$===-1?null:{start:_,end:$}}else a=null}a=a||{start:0,end:0}}else a=null;for(Df={focusedElem:e,selectionRange:a},dd=!1,V=i;V!==null;)if(i=V,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,V=e;else for(;V!==null;){i=V;try{var lt=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var ft=lt.memoizedProps,pt=lt.memoizedState,dt=i.stateNode,_t=dt.getSnapshotBeforeUpdate(i.elementType===i.type?ft:Ci(i.type,ft),pt);dt.__reactInternalSnapshotBeforeUpdate=_t}break;case 3:var ut=i.stateNode.containerInfo;ut.nodeType===1?ut.textContent="":ut.nodeType===9&&ut.documentElement&&ut.removeChild(ut.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(mt){W(i,i.return,mt)}if(e=i.sibling,e!==null){e.return=i.return,V=e;break}V=i.return}return lt=Nj,Nj=!1,lt}function Pj(e,i,a){var s=i.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var h=o.destroy;o.destroy=void 0,h!==void 0&&Mj(i,a,h)}o=o.next}while(o!==s)}}function Qj(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var s=a.create;a.destroy=s()}a=a.next}while(a!==i)}}function Rj(e){var i=e.ref;if(i!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof i=="function"?i(e):i.current=e}}function Sj(e){var i=e.alternate;i!==null&&(e.alternate=null,Sj(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,i,a){var s=e.tag;if(s===5||s===6)e=e.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(e,i):a.insertBefore(e,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(e,a)):(i=a,i.appendChild(e)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=Bf));else if(s!==4&&(e=e.child,e!==null))for(Vj(e,i,a),e=e.sibling;e!==null;)Vj(e,i,a),e=e.sibling}function Wj(e,i,a){var s=e.tag;if(s===5||s===6)e=e.stateNode,i?a.insertBefore(e,i):a.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Wj(e,i,a),e=e.sibling;e!==null;)Wj(e,i,a),e=e.sibling}var X=null,Xj=!1;function Yj(e,i,a){for(a=a.child;a!==null;)Zj(e,i,a),a=a.sibling}function Zj(e,i,a){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,a)}catch{}switch(a.tag){case 5:U||Lj(a,i);case 6:var s=X,o=Xj;X=null,Yj(e,i,a),X=s,Xj=o,X!==null&&(Xj?(e=X,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):X.removeChild(a.stateNode));break;case 18:X!==null&&(Xj?(e=X,a=a.stateNode,e.nodeType===8?Kf(e.parentNode,a):e.nodeType===1&&Kf(e,a),bd(e)):Kf(X,a.stateNode));break;case 4:s=X,o=Xj,X=a.stateNode.containerInfo,Xj=!0,Yj(e,i,a),X=s,Xj=o;break;case 0:case 11:case 14:case 15:if(!U&&(s=a.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var h=o,g=h.destroy;h=h.tag,g!==void 0&&(h&2||h&4)&&Mj(a,i,g),o=o.next}while(o!==s)}Yj(e,i,a);break;case 1:if(!U&&(Lj(a,i),s=a.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=a.memoizedProps,s.state=a.memoizedState,s.componentWillUnmount()}catch(_){W(a,i,_)}Yj(e,i,a);break;case 21:Yj(e,i,a);break;case 22:a.mode&1?(U=(s=U)||a.memoizedState!==null,Yj(e,i,a),U=s):Yj(e,i,a);break;default:Yj(e,i,a)}}function ak(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new Kj),i.forEach(function(s){var o=bk.bind(null,e,s);a.has(s)||(a.add(s),s.then(o,o))})}}function ck(e,i){var a=i.deletions;if(a!==null)for(var s=0;s<a.length;s++){var o=a[s];try{var h=e,g=i,_=g;t:for(;_!==null;){switch(_.tag){case 5:X=_.stateNode,Xj=!1;break t;case 3:X=_.stateNode.containerInfo,Xj=!0;break t;case 4:X=_.stateNode.containerInfo,Xj=!0;break t}_=_.return}if(X===null)throw Error(p$1(160));Zj(h,g,o),X=null,Xj=!1;var $=o.alternate;$!==null&&($.return=null),o.return=null}catch(b){W(o,i,b)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)dk(i,e),i=i.sibling}function dk(e,i){var a=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(i,e),ek(e),s&4){try{Pj(3,e,e.return),Qj(3,e)}catch(ft){W(e,e.return,ft)}try{Pj(5,e,e.return)}catch(ft){W(e,e.return,ft)}}break;case 1:ck(i,e),ek(e),s&512&&a!==null&&Lj(a,a.return);break;case 5:if(ck(i,e),ek(e),s&512&&a!==null&&Lj(a,a.return),e.flags&32){var o=e.stateNode;try{ob(o,"")}catch(ft){W(e,e.return,ft)}}if(s&4&&(o=e.stateNode,o!=null)){var h=e.memoizedProps,g=a!==null?a.memoizedProps:h,_=e.type,$=e.updateQueue;if(e.updateQueue=null,$!==null)try{_==="input"&&h.type==="radio"&&h.name!=null&&ab(o,h),vb(_,g);var b=vb(_,h);for(g=0;g<$.length;g+=2){var tt=$[g],st=$[g+1];tt==="style"?sb(o,st):tt==="dangerouslySetInnerHTML"?nb(o,st):tt==="children"?ob(o,st):ta(o,tt,st,b)}switch(_){case"input":bb(o,h);break;case"textarea":ib(o,h);break;case"select":var at=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!h.multiple;var nt=h.value;nt!=null?fb(o,!!h.multiple,nt,!1):at!==!!h.multiple&&(h.defaultValue!=null?fb(o,!!h.multiple,h.defaultValue,!0):fb(o,!!h.multiple,h.multiple?[]:"",!1))}o[Pf]=h}catch(ft){W(e,e.return,ft)}}break;case 6:if(ck(i,e),ek(e),s&4){if(e.stateNode===null)throw Error(p$1(162));o=e.stateNode,h=e.memoizedProps;try{o.nodeValue=h}catch(ft){W(e,e.return,ft)}}break;case 3:if(ck(i,e),ek(e),s&4&&a!==null&&a.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(ft){W(e,e.return,ft)}break;case 4:ck(i,e),ek(e);break;case 13:ck(i,e),ek(e),o=e.child,o.flags&8192&&(h=o.memoizedState!==null,o.stateNode.isHidden=h,!h||o.alternate!==null&&o.alternate.memoizedState!==null||(fk=B())),s&4&&ak(e);break;case 22:if(tt=a!==null&&a.memoizedState!==null,e.mode&1?(U=(b=U)||tt,ck(i,e),U=b):ck(i,e),ek(e),s&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!tt&&e.mode&1)for(V=e,tt=e.child;tt!==null;){for(st=V=tt;V!==null;){switch(at=V,nt=at.child,at.tag){case 0:case 11:case 14:case 15:Pj(4,at,at.return);break;case 1:Lj(at,at.return);var lt=at.stateNode;if(typeof lt.componentWillUnmount=="function"){s=at,a=at.return;try{i=s,lt.props=i.memoizedProps,lt.state=i.memoizedState,lt.componentWillUnmount()}catch(ft){W(s,a,ft)}}break;case 5:Lj(at,at.return);break;case 22:if(at.memoizedState!==null){gk(st);continue}}nt!==null?(nt.return=at,V=nt):gk(st)}tt=tt.sibling}t:for(tt=null,st=e;;){if(st.tag===5){if(tt===null){tt=st;try{o=st.stateNode,b?(h=o.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(_=st.stateNode,$=st.memoizedProps.style,g=$!=null&&$.hasOwnProperty("display")?$.display:null,_.style.display=rb("display",g))}catch(ft){W(e,e.return,ft)}}}else if(st.tag===6){if(tt===null)try{st.stateNode.nodeValue=b?"":st.memoizedProps}catch(ft){W(e,e.return,ft)}}else if((st.tag!==22&&st.tag!==23||st.memoizedState===null||st===e)&&st.child!==null){st.child.return=st,st=st.child;continue}if(st===e)break t;for(;st.sibling===null;){if(st.return===null||st.return===e)break t;tt===st&&(tt=null),st=st.return}tt===st&&(tt=null),st.sibling.return=st.return,st=st.sibling}}break;case 19:ck(i,e),ek(e),s&4&&ak(e);break;case 21:break;default:ck(i,e),ek(e)}}function ek(e){var i=e.flags;if(i&2){try{t:{for(var a=e.return;a!==null;){if(Tj(a)){var s=a;break t}a=a.return}throw Error(p$1(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(ob(o,""),s.flags&=-33);var h=Uj(e);Wj(e,h,o);break;case 3:case 4:var g=s.stateNode.containerInfo,_=Uj(e);Vj(e,_,g);break;default:throw Error(p$1(161))}}catch($){W(e,e.return,$)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function hk(e,i,a){V=e,ik(e)}function ik(e,i,a){for(var s=(e.mode&1)!==0;V!==null;){var o=V,h=o.child;if(o.tag===22&&s){var g=o.memoizedState!==null||Jj;if(!g){var _=o.alternate,$=_!==null&&_.memoizedState!==null||U;_=Jj;var b=U;if(Jj=g,(U=$)&&!b)for(V=o;V!==null;)g=V,$=g.child,g.tag===22&&g.memoizedState!==null?jk(o):$!==null?($.return=g,V=$):jk(o);for(;h!==null;)V=h,ik(h),h=h.sibling;V=o,Jj=_,U=b}kk(e)}else o.subtreeFlags&8772&&h!==null?(h.return=o,V=h):kk(e)}}function kk(e){for(;V!==null;){var i=V;if(i.flags&8772){var a=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U||Qj(5,i);break;case 1:var s=i.stateNode;if(i.flags&4&&!U)if(a===null)s.componentDidMount();else{var o=i.elementType===i.type?a.memoizedProps:Ci(i.type,a.memoizedProps);s.componentDidUpdate(o,a.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var h=i.updateQueue;h!==null&&sh(i,h,s);break;case 3:var g=i.updateQueue;if(g!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}sh(i,g,a)}break;case 5:var _=i.stateNode;if(a===null&&i.flags&4){a=_;var $=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&a.focus();break;case"img":$.src&&(a.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var b=i.alternate;if(b!==null){var tt=b.memoizedState;if(tt!==null){var st=tt.dehydrated;st!==null&&bd(st)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||i.flags&512&&Rj(i)}catch(at){W(i,i.return,at)}}if(i===e){V=null;break}if(a=i.sibling,a!==null){a.return=i.return,V=a;break}V=i.return}}function gk(e){for(;V!==null;){var i=V;if(i===e){V=null;break}var a=i.sibling;if(a!==null){a.return=i.return,V=a;break}V=i.return}}function jk(e){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Qj(4,i)}catch($){W(i,a,$)}break;case 1:var s=i.stateNode;if(typeof s.componentDidMount=="function"){var o=i.return;try{s.componentDidMount()}catch($){W(i,o,$)}}var h=i.return;try{Rj(i)}catch($){W(i,h,$)}break;case 5:var g=i.return;try{Rj(i)}catch($){W(i,g,$)}}}catch($){W(i,i.return,$)}if(i===e){V=null;break}var _=i.sibling;if(_!==null){_.return=i.return,V=_;break}V=i.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y$1=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,i,a,s){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(e,a,s),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=a),T===4&&Ck(e,Z)),Dk(e,s),a===1&&K===0&&!(i.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(e,i){var a=e.callbackNode;wc(e,i);var s=uc(e,e===Q?Z:0);if(s===0)a!==null&&bc(a),e.callbackNode=null,e.callbackPriority=0;else if(i=s&-s,e.callbackPriority!==i){if(a!=null&&bc(a),i===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),a=null;else{switch(Dc(s)){case 1:a=fc;break;case 4:a=gc;break;case 16:a=hc;break;case 536870912:a=jc;break;default:a=hc}a=Fk(a,Gk.bind(null,e))}e.callbackPriority=i,e.callbackNode=a}}function Gk(e,i){if(Ak=-1,Bk=0,K&6)throw Error(p$1(327));var a=e.callbackNode;if(Hk()&&e.callbackNode!==a)return null;var s=uc(e,e===Q?Z:0);if(s===0)return null;if(s&30||s&e.expiredLanes||i)i=Ik(e,s);else{i=s;var o=K;K|=2;var h=Jk();(Q!==e||Z!==i)&&(uk=null,Gj=B()+500,Kk(e,i));do try{Lk();break}catch(_){Mk(e,_)}while(!0);$g(),mk.current=h,K=o,Y$1!==null?i=0:(Q=null,Z=0,i=T)}if(i!==0){if(i===2&&(o=xc(e),o!==0&&(s=o,i=Nk(e,o))),i===1)throw a=pk,Kk(e,0),Ck(e,s),Dk(e,B()),a;if(i===6)Ck(e,s);else{if(o=e.current.alternate,!(s&30)&&!Ok(o)&&(i=Ik(e,s),i===2&&(h=xc(e),h!==0&&(s=h,i=Nk(e,h))),i===1))throw a=pk,Kk(e,0),Ck(e,s),Dk(e,B()),a;switch(e.finishedWork=o,e.finishedLanes=s,i){case 0:case 1:throw Error(p$1(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,s),(s&130023424)===s&&(i=fk+500-B(),10<i)){if(uc(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){R$1(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),i);break}Pk(e,tk,uk);break;case 4:if(Ck(e,s),(s&4194240)===s)break;for(i=e.eventTimes,o=-1;0<s;){var g=31-oc(s);h=1<<g,g=i[g],g>o&&(o=g),s&=~h}if(s=o,s=B()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*lk(s/1960))-s,10<s){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),s);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(e,B()),e.callbackNode===a?Gk.bind(null,e):null}function Nk(e,i){var a=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,i).flags|=256),e=Ik(e,i),e!==2&&(i=tk,tk=a,i!==null&&Fj(i)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var i=e;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var s=0;s<a.length;s++){var o=a[s],h=o.getSnapshot;o=o.value;try{if(!He(h(),o))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ck(e,i){for(i&=~rk,i&=~qk,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var a=31-oc(i),s=1<<a;e[a]=-1,i&=~s}}function Ek(e){if(K&6)throw Error(p$1(327));Hk();var i=uc(e,0);if(!(i&1))return Dk(e,B()),null;var a=Ik(e,i);if(e.tag!==0&&a===2){var s=xc(e);s!==0&&(i=s,a=Nk(e,s))}if(a===1)throw a=pk,Kk(e,0),Ck(e,i),Dk(e,B()),a;if(a===6)throw Error(p$1(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,i){var a=K;K|=1;try{return e(i)}finally{K=a,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var i=K;K|=1;var a=ok.transition,s=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=s,ok.transition=a,K=i,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(e,i){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,Gf(a)),Y$1!==null)for(a=Y$1.return;a!==null;){var s=a;switch(wg(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(s);break;case 4:zh();break;case 13:E(L$2);break;case 19:E(L$2);break;case 10:ah(s.type._context);break;case 22:case 23:Hj()}a=a.return}if(Q=e,Y$1=e=Pg(e.current,null),Z=fj=i,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(i=0;i<fh.length;i++)if(a=fh[i],s=a.interleaved,s!==null){a.interleaved=null;var o=s.next,h=a.pending;if(h!==null){var g=h.next;h.next=o,s.next=g}a.pending=s}fh=null}return e}function Mk(e,i){do{var a=Y$1;try{if($g(),Fh.current=Rh,Ih){for(var s=M.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,a===null||a.return===null){T=1,pk=i,Y$1=null;break}t:{var h=e,g=a.return,_=a,$=i;if(i=Z,_.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var b=$,tt=_,st=tt.tag;if(!(tt.mode&1)&&(st===0||st===11||st===15)){var at=tt.alternate;at?(tt.updateQueue=at.updateQueue,tt.memoizedState=at.memoizedState,tt.lanes=at.lanes):(tt.updateQueue=null,tt.memoizedState=null)}var nt=Ui(g);if(nt!==null){nt.flags&=-257,Vi(nt,g,_,h,i),nt.mode&1&&Si(h,b,i),i=nt,$=b;var lt=i.updateQueue;if(lt===null){var ft=new Set;ft.add($),i.updateQueue=ft}else lt.add($);break t}else{if(!(i&1)){Si(h,b,i),tj();break t}$=Error(p$1(426))}}else if(I&&_.mode&1){var pt=Ui(g);if(pt!==null){!(pt.flags&65536)&&(pt.flags|=256),Vi(pt,g,_,h,i),Jg(Ji($,_));break t}}h=$=Ji($,_),T!==4&&(T=2),sk===null?sk=[h]:sk.push(h),h=g;do{switch(h.tag){case 3:h.flags|=65536,i&=-i,h.lanes|=i;var dt=Ni(h,$,i);ph(h,dt);break t;case 1:_=$;var _t=h.type,ut=h.stateNode;if(!(h.flags&128)&&(typeof _t.getDerivedStateFromError=="function"||ut!==null&&typeof ut.componentDidCatch=="function"&&(Ri===null||!Ri.has(ut)))){h.flags|=65536,i&=-i,h.lanes|=i;var mt=Qi(h,_,i);ph(h,mt);break t}}h=h.return}while(h!==null)}Sk(a)}catch(kt){i=kt,Y$1===a&&a!==null&&(Y$1=a=a.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,i){var a=K;K|=2;var s=Jk();(Q!==e||Z!==i)&&(uk=null,Kk(e,i));do try{Tk();break}catch(o){Mk(e,o)}while(!0);if($g(),K=a,mk.current=s,Y$1!==null)throw Error(p$1(261));return Q=null,Z=0,T}function Tk(){for(;Y$1!==null;)Uk(Y$1)}function Lk(){for(;Y$1!==null&&!cc();)Uk(Y$1)}function Uk(e){var i=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,i===null?Sk(e):Y$1=i,nk.current=null}function Sk(e){var i=e;do{var a=i.alternate;if(e=i.return,i.flags&32768){if(a=Ij(a,i),a!==null){a.flags&=32767,Y$1=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y$1=null;return}}else if(a=Ej(a,i,fj),a!==null){Y$1=a;return}if(i=i.sibling,i!==null){Y$1=i;return}Y$1=i=e}while(i!==null);T===0&&(T=5)}function Pk(e,i,a){var s=C,o=ok.transition;try{ok.transition=null,C=1,Wk(e,i,a,s)}finally{ok.transition=o,C=s}return null}function Wk(e,i,a,s){do Hk();while(wk!==null);if(K&6)throw Error(p$1(327));a=e.finishedWork;var o=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(p$1(177));e.callbackNode=null,e.callbackPriority=0;var h=a.lanes|a.childLanes;if(Bc(e,h),e===Q&&(Y$1=Q=null,Z=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),h=(a.flags&15990)!==0,a.subtreeFlags&15990||h){h=ok.transition,ok.transition=null;var g=C;C=1;var _=K;K|=4,nk.current=null,Oj(e,a),dk(a,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=a,hk(a),dc(),K=_,C=g,ok.transition=h}else e.current=a;if(vk&&(vk=!1,wk=e,xk=o),h=e.pendingLanes,h===0&&(Ri=null),mc(a.stateNode),Dk(e,B()),i!==null)for(s=e.onRecoverableError,a=0;a<i.length;a++)o=i[a],s(o.value,{componentStack:o.stack,digest:o.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),h=e.pendingLanes,h&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),i=ok.transition,a=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var s=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p$1(331));var o=K;for(K|=4,V=e.current;V!==null;){var h=V,g=h.child;if(V.flags&16){var _=h.deletions;if(_!==null){for(var $=0;$<_.length;$++){var b=_[$];for(V=b;V!==null;){var tt=V;switch(tt.tag){case 0:case 11:case 15:Pj(8,tt,h)}var st=tt.child;if(st!==null)st.return=tt,V=st;else for(;V!==null;){tt=V;var at=tt.sibling,nt=tt.return;if(Sj(tt),tt===b){V=null;break}if(at!==null){at.return=nt,V=at;break}V=nt}}}var lt=h.alternate;if(lt!==null){var ft=lt.child;if(ft!==null){lt.child=null;do{var pt=ft.sibling;ft.sibling=null,ft=pt}while(ft!==null)}}V=h}}if(h.subtreeFlags&2064&&g!==null)g.return=h,V=g;else t:for(;V!==null;){if(h=V,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Pj(9,h,h.return)}var dt=h.sibling;if(dt!==null){dt.return=h.return,V=dt;break t}V=h.return}}var _t=e.current;for(V=_t;V!==null;){g=V;var ut=g.child;if(g.subtreeFlags&2064&&ut!==null)ut.return=g,V=ut;else t:for(g=_t;V!==null;){if(_=V,_.flags&2048)try{switch(_.tag){case 0:case 11:case 15:Qj(9,_)}}catch(kt){W(_,_.return,kt)}if(_===g){V=null;break t}var mt=_.sibling;if(mt!==null){mt.return=_.return,V=mt;break t}V=_.return}}if(K=o,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}s=!0}return s}finally{C=a,ok.transition=i}}return!1}function Xk(e,i,a){i=Ji(a,i),i=Ni(e,i,1),e=nh(e,i,1),i=R$1(),e!==null&&(Ac(e,1,i),Dk(e,i))}function W(e,i,a){if(e.tag===3)Xk(e,e,a);else for(;i!==null;){if(i.tag===3){Xk(i,e,a);break}else if(i.tag===1){var s=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ri===null||!Ri.has(s))){e=Ji(a,e),e=Qi(i,e,1),i=nh(i,e,1),e=R$1(),i!==null&&(Ac(i,1,e),Dk(i,e));break}}i=i.return}}function Ti(e,i,a){var s=e.pingCache;s!==null&&s.delete(i),i=R$1(),e.pingedLanes|=e.suspendedLanes&a,Q===e&&(Z&a)===a&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=a),Dk(e,i)}function Yk(e,i){i===0&&(e.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var a=R$1();e=ih(e,i),e!==null&&(Ac(e,i,a),Dk(e,a))}function uj(e){var i=e.memoizedState,a=0;i!==null&&(a=i.retryLane),Yk(e,a)}function bk(e,i){var a=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(a=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(p$1(314))}s!==null&&s.delete(i),Yk(e,a)}var Vk;Vk=function(e,i,a){if(e!==null)if(e.memoizedProps!==i.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&a)&&!(i.flags&128))return dh=!1,yj(e,i,a);dh=!!(e.flags&131072)}else dh=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var s=i.type;ij(e,i),e=i.pendingProps;var o=Yf(i,H.current);ch(i,a),o=Nh(null,i,s,e,o,a);var h=Sh();return i.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf(s)?(h=!0,cg(i)):h=!1,i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,kh(i),o.updater=Ei,i.stateNode=o,o._reactInternals=i,Ii(i,s,e,a),i=jj(null,i,s,!0,h,a)):(i.tag=0,I&&h&&vg(i),Xi(null,i,o,a),i=i.child),i;case 16:s=i.elementType;t:{switch(ij(e,i),e=i.pendingProps,o=s._init,s=o(s._payload),i.type=s,o=i.tag=Zk(s),e=Ci(s,e),o){case 0:i=cj(null,i,s,e,a);break t;case 1:i=hj(null,i,s,e,a);break t;case 11:i=Yi(null,i,s,e,a);break t;case 14:i=$i(null,i,s,Ci(s.type,e),a);break t}throw Error(p$1(306,s,""))}return i;case 0:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),cj(e,i,s,o,a);case 1:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),hj(e,i,s,o,a);case 3:t:{if(kj(i),e===null)throw Error(p$1(387));s=i.pendingProps,h=i.memoizedState,o=h.element,lh(e,i),qh(i,s,null,a);var g=i.memoizedState;if(s=g.element,h.isDehydrated)if(h={element:s,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},i.updateQueue.baseState=h,i.memoizedState=h,i.flags&256){o=Ji(Error(p$1(423)),i),i=lj(e,i,s,a,o);break t}else if(s!==o){o=Ji(Error(p$1(424)),i),i=lj(e,i,s,a,o);break t}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,a=Vg(i,null,s,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ig(),s===o){i=Zi(e,i,a);break t}Xi(e,i,s,a)}i=i.child}return i;case 5:return Ah(i),e===null&&Eg(i),s=i.type,o=i.pendingProps,h=e!==null?e.memoizedProps:null,g=o.children,Ef(s,o)?g=null:h!==null&&Ef(s,h)&&(i.flags|=32),gj(e,i),Xi(e,i,g,a),i.child;case 6:return e===null&&Eg(i),null;case 13:return oj(e,i,a);case 4:return yh(i,i.stateNode.containerInfo),s=i.pendingProps,e===null?i.child=Ug(i,null,s,a):Xi(e,i,s,a),i.child;case 11:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),Yi(e,i,s,o,a);case 7:return Xi(e,i,i.pendingProps,a),i.child;case 8:return Xi(e,i,i.pendingProps.children,a),i.child;case 12:return Xi(e,i,i.pendingProps.children,a),i.child;case 10:t:{if(s=i.type._context,o=i.pendingProps,h=i.memoizedProps,g=o.value,G(Wg,s._currentValue),s._currentValue=g,h!==null)if(He(h.value,g)){if(h.children===o.children&&!Wf.current){i=Zi(e,i,a);break t}}else for(h=i.child,h!==null&&(h.return=i);h!==null;){var _=h.dependencies;if(_!==null){g=h.child;for(var $=_.firstContext;$!==null;){if($.context===s){if(h.tag===1){$=mh(-1,a&-a),$.tag=2;var b=h.updateQueue;if(b!==null){b=b.shared;var tt=b.pending;tt===null?$.next=$:($.next=tt.next,tt.next=$),b.pending=$}}h.lanes|=a,$=h.alternate,$!==null&&($.lanes|=a),bh(h.return,a,i),_.lanes|=a;break}$=$.next}}else if(h.tag===10)g=h.type===i.type?null:h.child;else if(h.tag===18){if(g=h.return,g===null)throw Error(p$1(341));g.lanes|=a,_=g.alternate,_!==null&&(_.lanes|=a),bh(g,a,i),g=h.sibling}else g=h.child;if(g!==null)g.return=h;else for(g=h;g!==null;){if(g===i){g=null;break}if(h=g.sibling,h!==null){h.return=g.return,g=h;break}g=g.return}h=g}Xi(e,i,o.children,a),i=i.child}return i;case 9:return o=i.type,s=i.pendingProps.children,ch(i,a),o=eh(o),s=s(o),i.flags|=1,Xi(e,i,s,a),i.child;case 14:return s=i.type,o=Ci(s,i.pendingProps),o=Ci(s.type,o),$i(e,i,s,o,a);case 15:return bj(e,i,i.type,i.pendingProps,a);case 17:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),ij(e,i),i.tag=1,Zf(s)?(e=!0,cg(i)):e=!1,ch(i,a),Gi(i,s,o),Ii(i,s,o,a),jj(null,i,s,!0,e,a);case 19:return xj(e,i,a);case 22:return dj(e,i,a)}throw Error(p$1(156,i.tag))};function Fk(e,i){return ac(e,i)}function $k(e,i,a,s){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,i,a,s){return new $k(e,i,a,s)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,i){var a=e.alternate;return a===null?(a=Bg(e.tag,i,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=i,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,i=e.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Rg(e,i,a,s,o,h){var g=2;if(s=e,typeof e=="function")aj(e)&&(g=1);else if(typeof e=="string")g=5;else t:switch(e){case ya:return Tg(a.children,o,h,i);case za:g=8,o|=8;break;case Aa:return e=Bg(12,a,i,o|2),e.elementType=Aa,e.lanes=h,e;case Ea:return e=Bg(13,a,i,o),e.elementType=Ea,e.lanes=h,e;case Fa:return e=Bg(19,a,i,o),e.elementType=Fa,e.lanes=h,e;case Ia:return pj(a,o,h,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:g=10;break t;case Ca:g=9;break t;case Da:g=11;break t;case Ga:g=14;break t;case Ha:g=16,s=null;break t}throw Error(p$1(130,e==null?e:typeof e,""))}return i=Bg(g,a,i,o),i.elementType=e,i.type=s,i.lanes=h,i}function Tg(e,i,a,s){return e=Bg(7,e,s,i),e.lanes=a,e}function pj(e,i,a,s){return e=Bg(22,e,s,i),e.elementType=Ia,e.lanes=a,e.stateNode={isHidden:!1},e}function Qg(e,i,a){return e=Bg(6,e,null,i),e.lanes=a,e}function Sg(e,i,a){return i=Bg(4,e.children!==null?e.children:[],e.key,i),i.lanes=a,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function al(e,i,a,s,o){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function bl(e,i,a,s,o,h,g,_,$){return e=new al(e,i,a,_,$),i===1?(i=1,h===!0&&(i|=8)):i=0,h=Bg(3,null,null,i),e.current=h,h.stateNode=e,h.memoizedState={element:s,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(h),e}function cl(e,i,a){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:s==null?null:""+s,children:e,containerInfo:i,implementation:a}}function dl(e){if(!e)return Vf;e=e._reactInternals;t:{if(Vb(e)!==e||e.tag!==1)throw Error(p$1(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(i!==null);throw Error(p$1(171))}if(e.tag===1){var a=e.type;if(Zf(a))return bg(e,a,i)}return i}function el(e,i,a,s,o,h,g,_,$){return e=bl(a,s,!0,e,o,h,g,_,$),e.context=dl(null),a=e.current,s=R$1(),o=yi(a),h=mh(s,o),h.callback=i??null,nh(a,h,o),e.current.lanes=o,Ac(e,o,s),Dk(e,s),e}function fl(e,i,a,s){var o=i.current,h=R$1(),g=yi(o);return a=dl(a),i.context===null?i.context=a:i.pendingContext=a,i=mh(h,g),i.payload={element:e},s=s===void 0?null:s,s!==null&&(i.callback=s),e=nh(o,i,g),e!==null&&(gi(e,o,g,h),oh(e,o,g)),g}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<i?a:i}}function il(e,i){hl(e,i),(e=e.alternate)&&hl(e,i)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(p$1(409));fl(e,i,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Rk(function(){fl(null,e,null,null)}),i[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var i=Hc();e={blockedOn:null,target:e,priority:i};for(var a=0;a<Qc.length&&i!==0&&i<Qc[a].priority;a++);Qc.splice(a,0,e),a===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,i,a,s,o){if(o){if(typeof s=="function"){var h=s;s=function(){var b=gl(g);h.call(b)}}var g=el(i,s,e,0,null,!1,!1,"",pl);return e._reactRootContainer=g,e[uf]=g.current,sf(e.nodeType===8?e.parentNode:e),Rk(),g}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var _=s;s=function(){var b=gl($);_.call(b)}}var $=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=$,e[uf]=$.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl(i,$,a,s)}),$}function rl(e,i,a,s,o){var h=a._reactRootContainer;if(h){var g=h;if(typeof o=="function"){var _=o;o=function(){var $=gl(g);_.call($)}}fl(i,g,e,o)}else g=ql(a,i,e,o,s);return gl(g)}Ec=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var a=tc(i.pendingLanes);a!==0&&(Cc(i,a|1),Dk(i,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var s=ih(e,1);if(s!==null){var o=R$1();gi(s,e,1,o)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var i=ih(e,134217728);if(i!==null){var a=R$1();gi(i,e,134217728,a)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var i=yi(e),a=ih(e,i);if(a!==null){var s=R$1();gi(a,e,i,s)}il(e,i)}};Hc=function(){return C};Ic=function(e,i){var a=C;try{return C=e,i()}finally{C=a}};yb=function(e,i,a){switch(i){case"input":if(bb(e,a),i=a.name,a.type==="radio"&&i!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var s=a[i];if(s!==e&&s.form===e.form){var o=Db(s);if(!o)throw Error(p$1(90));Wa(s),bb(s,o)}}}break;case"textarea":ib(e,a);break;case"select":i=a.value,i!=null&&fb(e,!!a.multiple,i,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(i))throw Error(p$1(200));return cl(e,i,null,a)};reactDom_production_min.createRoot=function(e,i){if(!nl(e))throw Error(p$1(299));var a=!1,s="",o=kl;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(o=i.onRecoverableError)),i=bl(e,1,!1,null,null,a,!1,s,o),e[uf]=i.current,sf(e.nodeType===8?e.parentNode:e),new ll(i)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(p$1(188)):(e=Object.keys(e).join(","),Error(p$1(268,e)));return e=Zb(i),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,i,a){if(!ol(i))throw Error(p$1(200));return rl(null,e,i,!0,a)};reactDom_production_min.hydrateRoot=function(e,i,a){if(!nl(e))throw Error(p$1(405));var s=a!=null&&a.hydratedSources||null,o=!1,h="",g=kl;if(a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onRecoverableError!==void 0&&(g=a.onRecoverableError)),i=el(i,null,e,1,a??null,o,!1,h,g),e[uf]=i.current,sf(e),s)for(e=0;e<s.length;e++)a=s[e],o=a._getVersion,o=o(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,o]:i.mutableSourceEagerHydrationData.push(a,o);return new ml(i)};reactDom_production_min.render=function(e,i,a){if(!ol(i))throw Error(p$1(200));return rl(null,e,i,!1,a)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p$1(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,i,a,s){if(!ol(a))throw Error(p$1(200));if(e==null||e._reactInternals===void 0)throw Error(p$1(38));return rl(e,i,a,!1,s)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;var Yt=Object.defineProperty,Bt=e=>{throw TypeError(e)},Zt=(e,i,a)=>i in e?Yt(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,$e=(e,i,a)=>Zt(e,typeof i!="symbol"?i+"":i,a),Tt=(e,i,a)=>i.has(e)||Bt("Cannot "+a),St=(e,i,a)=>(Tt(e,i,"read from private field"),a?a.call(e):i.get(e)),It=(e,i,a)=>i.has(e)?Bt("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,a),Dt=(e,i,a,s)=>(Tt(e,i,"write to private field"),i.set(e,a),a),$t=(e,i,a)=>(Tt(e,i,"access private method"),a),m=Object.defineProperty,p=(e,i,a)=>i in e?m(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,c=(e,i,a)=>p(e,typeof i!="symbol"?i+"":i,a);class R{constructor(){c(this,"device"),c(this,"server"),c(this,"txCharacteristic"),c(this,"rxCharacteristic"),c(this,"SERVICE_UUID","7a230001-5475-a6a4-654c-8431f6ad49c4"),c(this,"TX_CHARACTERISTIC_UUID","7a230002-5475-a6a4-654c-8431f6ad49c4"),c(this,"RX_CHARACTERISTIC_UUID","7a230003-5475-a6a4-654c-8431f6ad49c4"),c(this,"maxPayload",60),c(this,"awaitingPrintResponse",!1),c(this,"awaitingDataResponse",!1),c(this,"printTimeoutId"),c(this,"printResponsePromise"),c(this,"printResolve"),c(this,"dataResponsePromise"),c(this,"dataResolve"),c(this,"onDataResponse"),c(this,"onPrintResponse"),c(this,"onDisconnectHandler"),c(this,"handleDisconnect",()=>{this.device=void 0,this.server=void 0,this.txCharacteristic=void 0,this.rxCharacteristic=void 0,this.onDisconnectHandler&&this.onDisconnectHandler()}),c(this,"notificationHandler",i=>{const a=i.target.value;if(!(!a||a.buffer.byteLength===0))if(a.byteLength>0&&a.getUint8(0)===1){const s=new Uint8Array(a.buffer,a.byteOffset+1,a.byteLength-1);if(this.awaitingDataResponse&&this.dataResolve&&(this.awaitingDataResponse=!1,this.dataResolve(s)),this.onDataResponse){const o=this.onDataResponse(s);o instanceof Promise&&o.catch(console.error)}}else{const s=new TextDecoder().decode(a);if(this.awaitingPrintResponse&&this.printResolve&&(this.awaitingPrintResponse=!1,this.printResolve(s)),this.onPrintResponse){const o=this.onPrintResponse(s);o instanceof Promise&&o.catch(console.error)}}})}setDataResponseHandler(i){this.onDataResponse=i}setPrintResponseHandler(i){this.onPrintResponse=i}setDisconnectHandler(i){this.onDisconnectHandler=i}async _attemptConnection(){var i,a,s,o;if(!this.device||!this.device.gatt)throw new Error("Bluetooth device or GATT interface not available for connection attempt.");this.txCharacteristic=void 0,this.rxCharacteristic=void 0,this.server=void 0;try{console.log(`Attempting to connect to GATT server on device: ${this.device.name||this.device.id}...`),this.server=await this.device.gatt.connect(),console.log("GATT server connected."),console.log("Getting primary service...");const h=await this.server.getPrimaryService(this.SERVICE_UUID);console.log("Primary service obtained."),console.log("Getting TX characteristic..."),this.txCharacteristic=await h.getCharacteristic(this.TX_CHARACTERISTIC_UUID),console.log("TX characteristic obtained."),console.log("Getting RX characteristic..."),this.rxCharacteristic=await h.getCharacteristic(this.RX_CHARACTERISTIC_UUID),console.log("RX characteristic obtained."),console.log("Starting notifications on RX characteristic..."),await this.rxCharacteristic.startNotifications(),this.rxCharacteristic.addEventListener("characteristicvaluechanged",this.notificationHandler),console.log("Notifications started."),await this.sendBreakSignal(!1),console.log("Fetching MTU size (max_length) from device...");const g=await this.sendLua("print(frame.bluetooth.max_length())",{awaitPrint:!0});if(g==null)throw new Error("Failed to get MTU size from device: no response.");const _=parseInt(g);if(isNaN(_)||_<=0)throw new Error(`Invalid MTU size received: '${g}'`);this.maxPayload=_,console.log(`MTU size set to: ${this.maxPayload}`)}catch(h){if(console.error("Error during connection attempt:",h),this.rxCharacteristic){try{(a=(i=this.device)==null?void 0:i.gatt)!=null&&a.connected&&await this.rxCharacteristic.stopNotifications()}catch{}this.rxCharacteristic.removeEventListener("characteristicvaluechanged",this.notificationHandler),this.rxCharacteristic=void 0}throw this.txCharacteristic=void 0,(o=(s=this.device)==null?void 0:s.gatt)!=null&&o.connected&&this.device.gatt.disconnect(),this.server=void 0,h}}async connect(i={}){var a;const{name:s,namePrefix:o,numAttempts:h=5,retryDelayMs:g=1e3}=i;if(!navigator.bluetooth)throw new Error("Web Bluetooth API not available.");if(!this.device){const b={filters:[s?{services:[this.SERVICE_UUID],name:s}:o?{services:[this.SERVICE_UUID],namePrefix:o}:{services:[this.SERVICE_UUID]}],optionalServices:[this.SERVICE_UUID]};try{if(console.log("Requesting Bluetooth device from user..."),this.device=await navigator.bluetooth.requestDevice(b),!this.device)throw new Error("No device selected by the user.");console.log(`Device selected: ${this.device.name||this.device.id}`)}catch(tt){throw console.error("Bluetooth device request failed:",tt),this.device=void 0,tt}}if(!this.device)throw new Error("Device not available after selection phase.");const _=this.device;_.removeEventListener("gattserverdisconnected",this.handleDisconnect),_.addEventListener("gattserverdisconnected",this.handleDisconnect);let $;for(let b=1;b<=h;b++){if(!this.device){console.warn(`Device (id: ${_.id}) was disconnected externally during connection attempts.`),$=$||new Error(`Device disconnected externally during connection attempt ${b}.`);break}try{return console.log(`Connection attempt ${b} of ${h} to device '${_.name||_.id}'...`),await this._attemptConnection(),console.log(`Successfully connected to ${_.name||_.id} on attempt ${b}.`),_.id||_.name||"Unknown Device"}catch(tt){if($=tt,console.error(`Attempt ${b} to connect to '${_.name||_.id}' failed:`,tt),tt instanceof Error&&tt.name==="NetworkError"&&(tt.message.includes("Connection attempt failed.")||tt.message.includes("GATT operation failed for unknown reason.")||tt.message.includes("GATT Server is disconnected.")||tt.message.includes("Bluetooth device is already connected."))&&b<h)console.log(`Retryable error encountered. Retrying in ${g/1e3}s...`),await new Promise(st=>setTimeout(st,g));else{console.log("Non-retryable error or max attempts reached. Aborting connection process.");break}}}throw console.error(`Failed to connect to device '${_.name||_.id}' after ${h} attempts or due to external disconnection.`),_.removeEventListener("gattserverdisconnected",this.handleDisconnect),(a=_.gatt)!=null&&a.connected&&_.gatt.disconnect(),this.server=void 0,this.txCharacteristic=void 0,this.rxCharacteristic=void 0,this.device=void 0,$||new Error(`Failed to connect to ${_.name||_.id} after ${h} attempts. No specific error recorded, or device disconnected externally.`)}async disconnect(){var i;this.device&&(i=this.device.gatt)!=null&&i.connected?this.device.gatt.disconnect():this.handleDisconnect()}isConnected(){return!!(this.device&&this.device.gatt&&this.device.gatt.connected)}getMaxPayload(i){return i?this.maxPayload:this.maxPayload-1}async transmit(i,a=!1){if(!this.txCharacteristic)throw new Error("Not connected or TX characteristic not available.");if(i.byteLength>this.maxPayload)throw new Error(`Payload length: ${i.byteLength} exceeds maximum BLE packet size: ${this.maxPayload}`);a&&console.log("Transmitting (hex):",Array.from(i).map(s=>s.toString(16).padStart(2,"0")).join(" ")),await this.txCharacteristic.writeValueWithResponse(i)}async sendLua(i,a={}){const{showMe:s=!1,awaitPrint:o=!1,timeout:h=5e3}=a,g=new TextEncoder().encode(i);if(g.byteLength>this.getMaxPayload(!0))throw new Error(`Lua string payload (${g.byteLength} bytes) is too large for max Lua payload (${this.getMaxPayload(!0)} bytes).`);if(o&&(this.printTimeoutId&&clearTimeout(this.printTimeoutId),this.awaitingPrintResponse=!0,this.printResponsePromise=new Promise((_,$)=>{this.printResolve=_,this.printTimeoutId=setTimeout(()=>{this.awaitingPrintResponse&&(this.awaitingPrintResponse=!1,this.printResolve=void 0,$(new Error(`Device didn't respond with a print within ${h}ms.`)))},h)}).finally(()=>{this.printTimeoutId&&(clearTimeout(this.printTimeoutId),this.printTimeoutId=void 0)})),await this.transmit(g,s),o)return this.printResponsePromise}async sendData(i,a={}){const{showMe:s=!1,awaitData:o=!1,timeout:h=5e3}=a;if(!this.txCharacteristic)throw new Error("Not connected or TX characteristic not available.");if(i.byteLength>this.getMaxPayload(!1))throw new Error(`Data payload (${i.byteLength} bytes) is too large for max data payload (${this.getMaxPayload(!1)} bytes).`);const g=new Uint8Array([1]),_=new Uint8Array(g.length+i.byteLength);_.set(g,0),_.set(i,g.length);let $;if(o&&(this.awaitingDataResponse=!0,this.dataResponsePromise=new Promise((b,tt)=>{this.dataResolve=b,$=setTimeout(()=>{this.awaitingDataResponse&&(this.awaitingDataResponse=!1,this.dataResolve=void 0,tt(new Error(`Device didn't respond with data within ${h}ms.`)))},h)}).finally(()=>{$&&clearTimeout($)})),await this.transmit(_,s),o)return this.dataResponsePromise}async sendResetSignal(i=!1){const a=new Uint8Array([4]);await this.transmit(a,i),await new Promise(s=>setTimeout(s,200))}async sendBreakSignal(i=!1){const a=new Uint8Array([3]);await this.transmit(a,i),await new Promise(s=>setTimeout(s,200))}async uploadFileFromString(i,a="main.lua"){let s=i.replace(/\r/g,"").replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/'/g,"\\'").replace(/"/g,'\\"');const o=await this.sendLua(`f=frame.file.open('${a}','w');print(1)`,{awaitPrint:!0});if(o!=="1")throw new Error(`Failed to open file ${a} on device. Response: ${o}`);const h=this.getMaxPayload(!0)-20;if(h<=0)throw new Error("Max payload size too small for file upload operations.");let g=0;for(;g<s.length;){let _=Math.min(h,s.length-g),$=s.substring(g,g+_);for(;$.endsWith("\\");){let tt=0;for(let st=$.length-1;st>=0&&$[st]==="\\";st--)tt++;if(tt%2!==0)if(_>1)_--,$=s.substring(g,g+_);else throw await this.sendLua("f:close();print(nil)",{awaitPrint:!0}),new Error("Cannot safely chunk content due to isolated escape character at chunk boundary.");else break}const b=await this.sendLua(`f:write("${$}");print(1)`,{awaitPrint:!0});if(b!=="1")throw await this.sendLua("f:close();print(nil)",{awaitPrint:!0}),new Error(`Failed to write chunk to ${a}. Response: ${b}`);g+=_}await this.sendLua("f:close();print(nil)",{awaitPrint:!0})}async uploadFile(i,a="main.lua"){await this.uploadFileFromString(i,a)}async sendMessage(i,a,s=!1){if(i<0||i>255)throw new Error(`Message code must be 0-255, got ${i}`);const o=a.byteLength;if(o>65535)throw new Error(`Payload size ${o} exceeds maximum 65535 bytes`);const h=this.getMaxPayload(!1),g=h-1-2,_=h-1;if(g<=0||_<=0)throw new Error("Max payload size too small for message sending protocol.");let $=0;const b=Math.min(g,o),tt=new Uint8Array(3+b);for(tt[0]=i,tt[1]=o>>8,tt[2]=o&255,tt.set(a.subarray(0,b),3),await this.sendData(tt,{showMe:s,awaitData:!0}),$+=b;$<o;){const st=o-$,at=Math.min(_,st),nt=new Uint8Array(1+at);nt[0]=i,nt.set(a.subarray($,$+at),1),await this.sendData(nt,{showMe:s,awaitData:!0}),$+=at}}}const stdDataMinLua="local a={}local b={}a.app_data_accum=b;local c={}a.app_data_block=c;local d={}a.app_data=d;local e={}a.parsers=e;function a.update_app_data_accum(f)rc,err=pcall(function()local g=string.byte(f,1)local h=a.app_data_accum[g]if h==nil or next(h)==nil then h={chunk_table={},num_chunks=0,size=0,recv_bytes=0}a.app_data_accum[g]=h end;if h.num_chunks==0 then h.size=string.byte(f,2)<<8|string.byte(f,3)h.chunk_table[1]=string.sub(f,4)h.num_chunks=1;h.recv_bytes=string.len(f)-3;if h.recv_bytes==h.size then a.app_data_block[g]=h.chunk_table[1]h.size=0;h.recv_bytes=0;h.num_chunks=0;h.chunk_table[1]=nil;b[g]=h end else h.chunk_table[h.num_chunks+1]=string.sub(f,2)h.num_chunks=h.num_chunks+1;h.recv_bytes=h.recv_bytes+string.len(f)-1;if h.recv_bytes==h.size then collectgarbage('collect')a.app_data_block[g]=table.concat(h.chunk_table)for i,j in pairs(h.chunk_table)do h.chunk_table[i]=nil end;collectgarbage('collect')h.size=0;h.recv_bytes=0;h.num_chunks=0;a.app_data_accum[g]=h end end;while true do if pcall(frame.bluetooth.send,'\\x00')then break end;frame.sleep(0.0025)end end)if rc==false then print('Error in data accumulator: '..err)while true do if pcall(frame.bluetooth.send,'\\x01')then break end;frame.sleep(0.0025)end;error(err)end end;frame.bluetooth.receive_callback(a.update_app_data_accum)function a.process_raw_items()local k=0;rc,err=pcall(function()collectgarbage('collect')for l,m in pairs(a.app_data_block)do if a.parsers[l]==nil then print('Error: No parser for flag: '..tostring(l))else a.app_data[l]=a.parsers[l](m,a.app_data[l])a.app_data_block[l]=nil;k=k+1 end end end)if rc==false then print('Error processing raw items: '..err)error(err)end;return k end;return a",stdAudioMinLua="local a={}local b=0x06;local c=0x05;local d=frame.bluetooth.max_length()if d%2==1 then d=d-1 end;function a.start(e)local f=e and e.sample_rate or 8000;local g=e and e.bit_depth or 8;pcall(frame.microphone.start,{sample_rate=f,bit_depth=g})end;function a.stop()pcall(frame.microphone.stop)end;function a.read_and_send_audio()audio_data=frame.microphone.read(d)if audio_data==nil then while true do if pcall(frame.bluetooth.send,string.char(b))then break end end;return nil elseif audio_data~=''then while true do if pcall(frame.bluetooth.send,string.char(c)..audio_data)then break end end;return string.len(audio_data)end;return 0 end;return a",stdCameraMinLua=`local a={}local b=0x07;local c=0x08;local d=0x11;local e=0x12;local f={'VERY_LOW','LOW','MEDIUM','HIGH','VERY_HIGH'}local g={'SPOT','CENTER_WEIGHTED','AVERAGE'}local h={metering='CENTER_WEIGHTED',exposure=0.1,exposure_speed=0.45,shutter_limit=16383,analog_gain_limit=16.0,white_balance_speed=0.5,rgb_gain_limit=287}local i={shutter=4096,analog_gain=1,red_gain=121,green_gain=64,blue_gain=140}a.is_auto_exp=true;function update_if_present(j,k)for l,m in pairs(k)do if m~=nil then j[l]=m end end end;function a.set_auto_exp_settings(n)update_if_present(h,n)a.is_auto_exp=true end;function a.set_manual_exp_settings(n)a.is_auto_exp=false;update_if_present(i,n)frame.camera.set_shutter(i.shutter)frame.camera.set_gain(i.analog_gain)frame.camera.set_white_balance(i.red_gain,i.green_gain,i.blue_gain)end;function a.parse_auto_exp_settings(o)local j={}j.metering=g[string.byte(o,1)+1]j.exposure=string.byte(o,2)/255.0;j.exposure_speed=string.byte(o,3)/255.0;j.shutter_limit=string.byte(o,4)<<8|(string.byte(o,5)&0x3FFF)j.analog_gain_limit=string.byte(o,6)&0xFF;j.white_balance_speed=string.byte(o,7)/255.0;j.rgb_gain_limit=string.byte(o,8)<<8|(string.byte(o,9)&0x3FF)return j end;function a.parse_manual_exp_settings(o)local j={}j.shutter=string.byte(o,1)<<8|(string.byte(o,2)&0x3FFF)j.analog_gain=string.byte(o,3)&0xFF;j.red_gain=string.byte(o,4)<<8|(string.byte(o,5)&0x3FF)j.green_gain=string.byte(o,6)<<8|(string.byte(o,7)&0x3FF)j.blue_gain=string.byte(o,8)<<8|(string.byte(o,9)&0x3FF)return j end;function a.parse_capture_settings(o)local j={}j.quality=f[string.byte(o,1)+1]local p=string.byte(o,2)<<8|string.byte(o,3)j.resolution=p*2;local q=string.byte(o,4)<<8|string.byte(o,5)j.pan=q-140;j.raw=string.byte(o,6)>0;return j end;function send_data(o)local r=false;local s=frame.time.utc()+2;while frame.time.utc()<s do if pcall(frame.bluetooth.send,o)then r=true;break end end;if not r then error('Error sending photo data')end end;function a.run_auto_exposure()return frame.camera.auto(h)end;function a.send_autoexp_result(t)local o=string.pack("<Bffffffffffffffff",d,t['error'],t['shutter'],t['analog_gain'],t['red_gain'],t['green_gain'],t['blue_gain'],t['brightness']['center_weighted_average'],t['brightness']['scene'],t['brightness']['matrix']['r'],t['brightness']['matrix']['g'],t['brightness']['matrix']['b'],t['brightness']['matrix']['average'],t['brightness']['spot']['r'],t['brightness']['spot']['g'],t['brightness']['spot']['b'],t['brightness']['spot']['average'])send_data(o)end;function a.send_metering_data()send_data(string.char(e)..frame.fpga_read(0x25,6))end;function a.capture_and_send(n)frame.camera.capture{resolution=n.resolution,quality=n.quality,pan=n.pan}while not frame.camera.image_ready()do frame.sleep(0.005)end;local o=''local u=n.raw;while true do if u then o=frame.camera.read_raw(frame.bluetooth.max_length()-1)else o=frame.camera.read(frame.bluetooth.max_length()-1)end;if o~=nil then send_data(string.char(b)..o)else send_data(string.char(c))break end end end;return a`,stdCodeMinLua="local _M={}function _M.parse_code(a)local b={}b.value=string.byte(a,1)return b end;return _M",stdIMUMinLua='local _M={}local a=0x0A;function _M.send_imu_data(b)local c=b or a;local d=frame.imu.raw()local e=string.pack("<Bxhhhhhh",c,d.compass.x,d.compass.y,d.compass.z,d.accelerometer.x,d.accelerometer.y,d.accelerometer.z)pcall(frame.bluetooth.send,e)end;return _M',stdImageSpriteBlockMinLua="local a={}function a.parse_image_sprite_block(b,c)if string.byte(b,1)==0xFF then if c~=nil then for d,e in pairs(c.sprites)do c.sprites[d]=nil end;c=nil;collectgarbage('collect')end;local f={}f.width=string.byte(b,2)<<8|string.byte(b,3)f.height=string.byte(b,4)<<8|string.byte(b,5)f.sprite_line_height=string.byte(b,6)<<8|string.byte(b,7)f.progressive_render=string.byte(b,8)==1;f.updatable=string.byte(b,9)==1;f.sprites={}local g=f.height+f.sprite_line_height-1;f.total_sprites=g//f.sprite_line_height;f.active_sprites=0;f.current_sprite_index=0;return f else if c==nil then return nil end;c.current_sprite_index=c.current_sprite_index+1;if c.current_sprite_index>c.total_sprites then if c.updatable then c.current_sprite_index=1 else return c end end;if c.active_sprites<c.total_sprites then c.active_sprites=c.active_sprites+1 end;local h={}h.width=string.byte(b,1)<<8|string.byte(b,2)h.height=string.byte(b,3)<<8|string.byte(b,4)h.compressed=string.byte(b,5)>0;h.bpp=string.byte(b,6)h.num_colors=string.byte(b,7)h.palette_data=string.sub(b,8,8+h.num_colors*3-1)h.pixel_data=string.sub(b,8+h.num_colors*3)c.sprites[c.current_sprite_index]=h;return c end end;function a.set_palette(i,j)local k={'VOID','WHITE','GREY','RED','PINK','DARKBROWN','BROWN','ORANGE','YELLOW','DARKGREEN','GREEN','LIGHTGREEN','NIGHTBLUE','SEABLUE','SKYBLUE','CLOUDBLUE'}for l=1,i do local m=(l-1)*3;frame.display.assign_color(k[l],string.byte(j,m+1),string.byte(j,m+2),string.byte(j,m+3))end end;return a",stdPlainTextMinLua="local _M={}local a={'VOID','WHITE','GREY','RED','PINK','DARKBROWN','BROWN','ORANGE','YELLOW','DARKGREEN','GREEN','LIGHTGREEN','NIGHTBLUE','SEABLUE','SKYBLUE','CLOUDBLUE'}function _M.parse_plain_text(b)local c={}c.x=string.byte(b,1)<<8|string.byte(b,2)c.y=string.byte(b,3)<<8|string.byte(b,4)c.palette_offset=string.byte(b,5)c.color=a[c.palette_offset%16+1]c.spacing=string.byte(b,6)c.string=string.sub(b,7)return c end;return _M",stdSpriteMinLua="local a={}function a.parse_sprite(b)local c={}c.width=string.byte(b,1)<<8|string.byte(b,2)c.height=string.byte(b,3)<<8|string.byte(b,4)c.compressed=string.byte(b,5)>0;c.bpp=string.byte(b,6)c.num_colors=string.byte(b,7)c.palette_data=string.sub(b,8,8+c.num_colors*3-1)c.pixel_data=string.sub(b,8+c.num_colors*3)return c end;function a.set_palette(d,e)local f={'VOID','WHITE','GREY','RED','PINK','DARKBROWN','BROWN','ORANGE','YELLOW','DARKGREEN','GREEN','LIGHTGREEN','NIGHTBLUE','SEABLUE','SKYBLUE','CLOUDBLUE'}for g=1,d do local h=(g-1)*3;frame.display.assign_color(f[g],string.byte(e,h+1),string.byte(e,h+2),string.byte(e,h+3))end end;return a",stdSpriteCoordsMinLua="local a={}function a.parse_sprite_coords(b)local c={}c.code=string.byte(b,1)c.x=string.byte(b,2)<<8|string.byte(b,3)c.y=string.byte(b,4)<<8|string.byte(b,5)c.offset=string.byte(b,6)return c end;return a",stdTapMinLua="local a={}local b=0x09;function a.send_tap()rc,err=pcall(frame.bluetooth.send,string.char(b))if rc==false then print(err)end end;return a",stdTextSpriteBlockMinLua="local a={}function a.parse_text_sprite_block(b,c)if string.byte(b,1)==0xFF then local d={}d.width=string.byte(b,2)<<8|string.byte(b,3)d.max_display_rows=string.byte(b,4)d.lines=string.byte(b,5)local e={}for f=0,d.lines-1 do local g={}g.x=string.byte(b,5+4*f+1)<<8|string.byte(b,5+4*f+2)g.y=string.byte(b,5+4*f+3)<<8|string.byte(b,5+4*f+4)table.insert(e,g)end;d.offsets=e;d.sprites={}d.last_sprite_index=0;d.first_sprite_index=0;return d else if c==nil then return nil end;c.last_sprite_index=c.last_sprite_index+1;if c.first_sprite_index==0 then c.first_sprite_index=1 end;if c.last_sprite_index-c.first_sprite_index+1>c.max_display_rows then c.sprites[c.first_sprite_index]=nil;c.first_sprite_index=c.first_sprite_index+1 end;local h={}h.width=string.byte(b,1)<<8|string.byte(b,2)h.height=string.byte(b,3)<<8|string.byte(b,4)h.compressed=string.byte(b,5)>0;h.bpp=string.byte(b,6)h.num_colors=string.byte(b,7)h.palette_data=string.sub(b,8,8+h.num_colors*3-1)h.pixel_data=string.sub(b,8+h.num_colors*3)c.sprites[c.last_sprite_index]=h;return c end end;return a";var StdLua=(e=>(e.DataMin="stdDataMin",e.AudioMin="stdAudioMin",e.CameraMin="stdCameraMin",e.CodeMin="stdCodeMin",e.IMUMin="stdIMUMin",e.ImageSpriteBlockMin="stdImageSpriteBlockMin",e.PlainTextMin="stdPlainTextMin",e.SpriteMin="stdSpriteMin",e.SpriteCoordsMin="stdSpriteCoordsMin",e.TapMin="stdTapMin",e.TextSpriteBlockMin="stdTextSpriteBlockMin",e))(StdLua||{});const standardLuaLibrarySources={stdDataMin:{content:stdDataMinLua,targetFileName:"data.min.lua"},stdAudioMin:{content:stdAudioMinLua,targetFileName:"audio.min.lua"},stdCameraMin:{content:stdCameraMinLua,targetFileName:"camera.min.lua"},stdCodeMin:{content:stdCodeMinLua,targetFileName:"code.min.lua"},stdIMUMin:{content:stdIMUMinLua,targetFileName:"imu.min.lua"},stdImageSpriteBlockMin:{content:stdImageSpriteBlockMinLua,targetFileName:"image_sprite_block.min.lua"},stdPlainTextMin:{content:stdPlainTextMinLua,targetFileName:"plain_text.min.lua"},stdSpriteMin:{content:stdSpriteMinLua,targetFileName:"sprite.min.lua"},stdSpriteCoordsMin:{content:stdSpriteCoordsMinLua,targetFileName:"sprite_coords.min.lua"},stdTapMin:{content:stdTapMinLua,targetFileName:"tap.min.lua"},stdTextSpriteBlockMin:{content:stdTextSpriteBlockMinLua,targetFileName:"text_sprite_block.min.lua"}};class FrameMsg{constructor(){$e(this,"ble"),$e(this,"dataResponseHandlers"),this.ble=new R,this.dataResponseHandlers=new Map,this.ble.setDataResponseHandler(this._handleDataResponse.bind(this))}async connect(i=!0,a={}){try{const s={name:a.name,namePrefix:a.namePrefix},o=await this.ble.connect(s);return i&&(await this.ble.sendBreakSignal(),await this.ble.sendResetSignal(),await this.ble.sendBreakSignal()),o}catch(s){throw this.ble.isConnected()&&await this.ble.disconnect(),s}}async disconnect(){this.ble.isConnected()&&await this.ble.disconnect()}isConnected(){return this.ble.isConnected()}async printShortText(i=""){const a=i.replace(/'/g,"\\'").replace(/\n/g,"");return this.ble.sendLua(`frame.display.text('${a}',1,1);frame.display.show();print(0)`,{awaitPrint:!0})}async uploadStdLuaLibs(i){for(const a of i){const s=standardLuaLibrarySources[a];s?await this.ble.uploadFileFromString(s.content,s.targetFileName):console.warn(`Standard Lua library key "${a}" not found. Skipping.`)}}async uploadFrameApp(i,a="frame_app.lua"){await this.ble.uploadFile(i,a)}async startFrameApp(i="frame_app",a=!0){return this.ble.sendLua(`require('${i}')`,{awaitPrint:a})}async stopFrameApp(i=!0){await this.ble.sendBreakSignal(),i&&await this.ble.sendResetSignal()}attachPrintResponseHandler(i=console.log){this.ble.setPrintResponseHandler(i)}detachPrintResponseHandler(){this.ble.setPrintResponseHandler(void 0)}async sendMessage(i,a,s=!1){await this.ble.sendMessage(i,a,s)}registerDataResponseHandler(i,a,s){for(const o of a){this.dataResponseHandlers.has(o)||this.dataResponseHandlers.set(o,[]);const h=this.dataResponseHandlers.get(o);h.find(g=>g.subscriber===i&&g.handler===s)||h.push({subscriber:i,handler:s})}}unregisterDataResponseHandler(i){this.dataResponseHandlers.forEach((a,s)=>{const o=a.filter(h=>h.subscriber!==i);o.length===0?this.dataResponseHandlers.delete(s):this.dataResponseHandlers.set(s,o)})}_handleDataResponse(i){if(i&&i.byteLength>0){const a=i[0];this.dataResponseHandlers.has(a)&&this.dataResponseHandlers.get(a).forEach(s=>{try{s.handler(i)}catch(o){console.error("Error in FrameMsg data response handler for msgCode",a,":",o)}})}}async sendLua(i,a={}){return this.ble.sendLua(i,a)}async sendData(i,a={}){return this.ble.sendData(i,a)}async sendResetSignal(i=!1){return this.ble.sendResetSignal(i)}async sendBreakSignal(i=!1){return this.ble.sendBreakSignal(i)}getMaxPayload(i){return this.ble?this.ble.getMaxPayload(i):(console.warn("FrameBle instance not initialized or not connected for getMaxPayload."),60)}}class AsyncQueue{constructor(){$e(this,"promises"),$e(this,"resolvers"),this.promises=[],this.resolvers=[]}add(){this.promises.push(new Promise(i=>{this.resolvers.push(i)}))}put(i){this.resolvers.length||this.add();const a=this.resolvers.shift();a&&a(i)}async get(){return this.promises.length||this.add(),this.promises.shift()||new Promise(a=>{this.resolvers.push(a),this.promises.push(this.get())})}isEmpty(){return this.promises.length===0}size(){return this.promises.length}clear(){this.resolvers.forEach(i=>{}),this.promises=[],this.resolvers=[]}}class TxPlainText{constructor(i,a=1,s=1,o=1,h=4){this.text=i,this.x=a,this.y=s,this.paletteOffset=o,this.spacing=h}pack(){const i=new TextEncoder().encode(this.text),a=new Uint8Array(6),s=new DataView(a.buffer);s.setUint16(0,this.x,!1),s.setUint16(2,this.y,!1),s.setUint8(4,this.paletteOffset&15),s.setUint8(5,this.spacing&255);const o=new Uint8Array(a.length+i.length);return o.set(a),o.set(i,a.length),o}}class TxCaptureSettings{constructor(i=512,a=4,s=0,o=!1){$e(this,"resolution"),$e(this,"qualityIndex"),$e(this,"pan"),$e(this,"raw"),this.resolution=i,this.qualityIndex=a,this.pan=s,this.raw=o}pack(){const i=new ArrayBuffer(6),a=new DataView(i),s=this.resolution/2,o=this.pan+140;return a.setUint8(0,this.qualityIndex&255),a.setUint16(1,s&65535,!1),a.setUint16(3,o&65535,!1),a.setUint8(5,this.raw?1:0),new Uint8Array(i)}}const bitMethods={getBit(e){return this.data[getSlot(e)]&1<<getShift(e)?1:0},setBit(e){this.data[getSlot(e)]|=1<<getShift(e)},clearBit(e){this.data[getSlot(e)]&=~(1<<getShift(e))},toggleBit(e){this.data[getSlot(e)]^=1<<getShift(e)},getBitXY(e,i){return e>=this.width||i>=this.height?0:this.getBit(i*this.width+e)},setBitXY(e,i){this.setBit(i*this.width+e)},clearBitXY(e,i){this.clearBit(i*this.width+e)},toggleBitXY(e,i){this.toggleBit(i*this.width+e)}};function getSlot(e){return e>>3}function getShift(e){return 7-(e&7)}function setBitMethods(e){for(const i in bitMethods)e.prototype[i]=bitMethods[i]}function checkProcessable(e,i={}){let{bitDepth:a,alpha:s,colorModel:o,components:h,channels:g}=i;if(typeof e!="string"||e.length===0)throw new TypeError("processName must be a string");if(a&&(Array.isArray(a)||(a=[a]),!a.includes(this.bitDepth)))throw new TypeError(`The process: ${e} can only be applied if bit depth is in: ${a}`);if(s&&(Array.isArray(s)||(s=[s]),!s.includes(this.alpha)))throw new TypeError(`The process: ${e} can only be applied if alpha is in: ${s}`);if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.colorModel)))throw new TypeError(`The process: ${e} can only be applied if color model is in: ${o}`);if(h&&(Array.isArray(h)||(h=[h]),!h.includes(this.components))){let _=`The process: ${e} can only be applied if the number of components is in: ${h}`;throw h.length===1&&h[0]===1?new TypeError(`${_}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(_)}if(g&&(Array.isArray(g)||(g=[g]),!g.includes(this.channels)))throw new TypeError(`The process: ${e} can only be applied if the number of channels is in: ${g}`)}function createBlob(e,i){e=e||[],i=i||{},typeof i=="string"&&(i={type:i});try{return new Blob(e,i)}catch(h){if(h.name!=="TypeError")throw h;for(var a=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,s=new a,o=0;o<e.length;o+=1)s.append(e[o]);return s.getBlob(i.type)}}function dataURLToBlob(e){var i=e.match(/data:([^;]+)/)[1],a=e.replace(/^[^,]+,/,""),s=binaryStringToArrayBuffer(atob(a));return createBlob([s],{type:i})}function canvasToBlob(e,i,a){return typeof e.toBlob=="function"?new Promise(function(s){e.toBlob(s,i,a)}):Promise.resolve(dataURLToBlob(e.toDataURL(i,a)))}function binaryStringToArrayBuffer(e){for(var i=e.length,a=new ArrayBuffer(i),s=new Uint8Array(a),o=-1;++o<i;)s[o]=e.charCodeAt(o);return a}function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var i=e.default;if(typeof i=="function"){var a=function s(){return this instanceof s?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};a.prototype=i.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var o=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return e[s]}})}),a}var src$5={};function decode$2(e,i="utf8"){return new TextDecoder(i).decode(e)}const encoder$1=new TextEncoder;function encode$1(e){return encoder$1.encode(e)}const defaultByteLength=1024*8,hostBigEndian=(()=>{const e=new Uint8Array(4),i=new Uint32Array(e.buffer);return!((i[0]=1)&e[0])})(),typedArrays={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class IOBuffer{constructor(i=defaultByteLength,a={}){$e(this,"buffer"),$e(this,"byteLength"),$e(this,"byteOffset"),$e(this,"length"),$e(this,"offset"),$e(this,"lastWrittenByte"),$e(this,"littleEndian"),$e(this,"_data"),$e(this,"_mark"),$e(this,"_marks");let s=!1;typeof i=="number"?i=new ArrayBuffer(i):(s=!0,this.lastWrittenByte=i.byteLength);const o=a.offset?a.offset>>>0:0,h=i.byteLength-o;let g=o;(ArrayBuffer.isView(i)||i instanceof IOBuffer)&&(i.byteLength!==i.buffer.byteLength&&(g=i.byteOffset+o),i=i.buffer),s?this.lastWrittenByte=h:this.lastWrittenByte=0,this.buffer=i,this.length=h,this.byteLength=h,this.byteOffset=g,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,g,h),this._mark=0,this._marks=[]}available(i=1){return this.offset+i<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(i=1){return this.offset+=i,this}back(i=1){return this.offset-=i,this}seek(i){return this.offset=i,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const i=this._marks.pop();if(i===void 0)throw new Error("Mark stack empty");return this.seek(i),this}rewind(){return this.offset=0,this}ensureAvailable(i=1){if(!this.available(i)){const a=(this.offset+i)*2,s=new Uint8Array(a);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(i=1){return this.readArray(i,"uint8")}readArray(i,a){const s=typedArrays[a].BYTES_PER_ELEMENT*i,o=this.byteOffset+this.offset,h=this.buffer.slice(o,o+s);if(this.littleEndian===hostBigEndian&&a!=="uint8"&&a!=="int8"){const _=new Uint8Array(this.buffer.slice(o,o+s));_.reverse();const $=new typedArrays[a](_.buffer);return this.offset+=s,$.reverse(),$}const g=new typedArrays[a](h);return this.offset+=s,g}readInt16(){const i=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,i}readUint16(){const i=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,i}readInt32(){const i=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,i}readUint32(){const i=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,i}readFloat32(){const i=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,i}readFloat64(){const i=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,i}readBigInt64(){const i=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,i}readBigUint64(){const i=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,i}readChar(){return String.fromCharCode(this.readInt8())}readChars(i=1){let a="";for(let s=0;s<i;s++)a+=this.readChar();return a}readUtf8(i=1){return decode$2(this.readBytes(i))}decodeText(i=1,a="utf8"){return decode$2(this.readBytes(i),a)}writeBoolean(i){return this.writeUint8(i?255:0),this}writeInt8(i){return this.ensureAvailable(1),this._data.setInt8(this.offset++,i),this._updateLastWrittenByte(),this}writeUint8(i){return this.ensureAvailable(1),this._data.setUint8(this.offset++,i),this._updateLastWrittenByte(),this}writeByte(i){return this.writeUint8(i)}writeBytes(i){this.ensureAvailable(i.length);for(let a=0;a<i.length;a++)this._data.setUint8(this.offset++,i[a]);return this._updateLastWrittenByte(),this}writeInt16(i){return this.ensureAvailable(2),this._data.setInt16(this.offset,i,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(i){return this.ensureAvailable(2),this._data.setUint16(this.offset,i,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(i){return this.ensureAvailable(4),this._data.setInt32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(i){return this.ensureAvailable(4),this._data.setUint32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(i){return this.ensureAvailable(4),this._data.setFloat32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(i){return this.ensureAvailable(8),this._data.setFloat64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(i){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(i){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(i){return this.writeUint8(i.charCodeAt(0))}writeChars(i){for(let a=0;a<i.length;a++)this.writeUint8(i.charCodeAt(a));return this}writeUtf8(i){return this.writeBytes(encode$1(i))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}const IOBuffer$1=Object.freeze(Object.defineProperty({__proto__:null,IOBuffer},Symbol.toStringTag,{value:"Module"})),require$$0$3=getAugmentedNamespace(IOBuffer$1);var constants$1,hasRequiredConstants$1;function requireConstants$1(){return hasRequiredConstants$1||(hasRequiredConstants$1=1,constants$1={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}),constants$1}var BMPEncoder_1,hasRequiredBMPEncoder;function requireBMPEncoder(){if(hasRequiredBMPEncoder)return BMPEncoder_1;hasRequiredBMPEncoder=1;const{IOBuffer:e}=require$$0$3,i=requireConstants$1(),a=[];for(let o=0;o<=8;o++)a.push(255<<o);class s extends e{constructor(h){if(h.bitDepth!==1)throw new Error("Only bitDepth of 1 is supported");if(!h.height||!h.width)throw new Error("ImageData width and height are required");super(h.data),this.width=h.width,this.height=h.height,this.bitDepth=h.bitDepth,this.channels=h.channels,this.components=h.components}encode(){this.encoded=new e,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const h=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(h),this.encoded.toArray()}writePixelArray(){let h=this.encoded;const g=Math.floor((this.bitDepth*this.width+31)/32)*4,_=Math.ceil(this.bitDepth*this.width/8),$=g-_,b=this.bitDepth*this.width%8,tt=b===0?0:8-b,st=g*this.height;let at,nt,lt=0,ft=0,pt=8;h.mark(),nt=this.readUint8();for(let dt=this.height-1;dt>=0;dt--){const _t=dt===0;h.reset(),h.skip(dt*g);for(let ut=0;ut<_;ut++){const mt=ut===_-1;ft<=tt&&mt?(h.writeByte(nt<<ft),(tt===0||tt===ft)&&!_t&&(at=nt,nt=this.readByte())):ft===0?(at=nt,nt=this.readUint8(),h.writeByte(at)):(at=nt,nt=this.readUint8(),h.writeByte(at<<ft&a[ft]|nt>>pt)),mt&&(lt+=b||0,h.skip($),ft=lt%8,pt=8-ft)}}g>_&&(h.reset(),h.skip(st-1),h.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(h){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(h)}writeBitmapV5Header(){const h=Math.floor((this.bitDepth*this.width+31)/32)*4*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(i.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(h).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(i.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(i.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}return BMPEncoder_1=s,BMPEncoder_1}var hasRequiredSrc$5;function requireSrc$5(){if(hasRequiredSrc$5)return src$5;hasRequiredSrc$5=1;const e=requireBMPEncoder();return src$5.encode=function(i){return new e(i).encode()},src$5}var srcExports$3=requireSrc$5();/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1$1(e){let i=e.length;for(;--i>=0;)e[i]=0}const STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1$1=3,MAX_MATCH$1$1=258,LENGTH_CODES$1$1=29,LITERALS$1$1=256,L_CODES$1$1=LITERALS$1$1+1+LENGTH_CODES$1$1,D_CODES$1$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN$1=512,static_ltree$1=new Array((L_CODES$1$1+2)*2);zero$1$1(static_ltree$1);const static_dtree$1=new Array(D_CODES$1$1*2);zero$1$1(static_dtree$1);const _dist_code$1=new Array(DIST_CODE_LEN$1);zero$1$1(_dist_code$1);const _length_code$1=new Array(MAX_MATCH$1$1-MIN_MATCH$1$1+1);zero$1$1(_length_code$1);const base_length$1=new Array(LENGTH_CODES$1$1);zero$1$1(base_length$1);const base_dist$1=new Array(D_CODES$1$1);zero$1$1(base_dist$1);function StaticTreeDesc(e,i,a,s,o){this.static_tree=e,this.extra_bits=i,this.extra_base=a,this.elems=s,this.max_length=o,this.has_stree=e&&e.length}let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(e,i){this.dyn_tree=e,this.max_code=0,this.stat_desc=i}const d_code=e=>e<256?_dist_code$1[e]:_dist_code$1[256+(e>>>7)],put_short=(e,i)=>{e.pending_buf[e.pending++]=i&255,e.pending_buf[e.pending++]=i>>>8&255},send_bits=(e,i,a)=>{e.bi_valid>Buf_size-a?(e.bi_buf|=i<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=i>>Buf_size-e.bi_valid,e.bi_valid+=a-Buf_size):(e.bi_buf|=i<<e.bi_valid&65535,e.bi_valid+=a)},send_code=(e,i,a)=>{send_bits(e,a[i*2],a[i*2+1])},bi_reverse=(e,i)=>{let a=0;do a|=e&1,e>>>=1,a<<=1;while(--i>0);return a>>>1},bi_flush=e=>{e.bi_valid===16?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},gen_bitlen=(e,i)=>{const a=i.dyn_tree,s=i.max_code,o=i.stat_desc.static_tree,h=i.stat_desc.has_stree,g=i.stat_desc.extra_bits,_=i.stat_desc.extra_base,$=i.stat_desc.max_length;let b,tt,st,at,nt,lt,ft=0;for(at=0;at<=MAX_BITS$1;at++)e.bl_count[at]=0;for(a[e.heap[e.heap_max]*2+1]=0,b=e.heap_max+1;b<HEAP_SIZE$1;b++)tt=e.heap[b],at=a[a[tt*2+1]*2+1]+1,at>$&&(at=$,ft++),a[tt*2+1]=at,!(tt>s)&&(e.bl_count[at]++,nt=0,tt>=_&&(nt=g[tt-_]),lt=a[tt*2],e.opt_len+=lt*(at+nt),h&&(e.static_len+=lt*(o[tt*2+1]+nt)));if(ft!==0){do{for(at=$-1;e.bl_count[at]===0;)at--;e.bl_count[at]--,e.bl_count[at+1]+=2,e.bl_count[$]--,ft-=2}while(ft>0);for(at=$;at!==0;at--)for(tt=e.bl_count[at];tt!==0;)st=e.heap[--b],!(st>s)&&(a[st*2+1]!==at&&(e.opt_len+=(at-a[st*2+1])*a[st*2],a[st*2+1]=at),tt--)}},gen_codes=(e,i,a)=>{const s=new Array(MAX_BITS$1+1);let o=0,h,g;for(h=1;h<=MAX_BITS$1;h++)o=o+a[h-1]<<1,s[h]=o;for(g=0;g<=i;g++){let _=e[g*2+1];_!==0&&(e[g*2]=bi_reverse(s[_]++,_))}},tr_static_init=()=>{let e,i,a,s,o;const h=new Array(MAX_BITS$1+1);for(a=0,s=0;s<LENGTH_CODES$1$1-1;s++)for(base_length$1[s]=a,e=0;e<1<<extra_lbits[s];e++)_length_code$1[a++]=s;for(_length_code$1[a-1]=s,o=0,s=0;s<16;s++)for(base_dist$1[s]=o,e=0;e<1<<extra_dbits[s];e++)_dist_code$1[o++]=s;for(o>>=7;s<D_CODES$1$1;s++)for(base_dist$1[s]=o<<7,e=0;e<1<<extra_dbits[s]-7;e++)_dist_code$1[256+o++]=s;for(i=0;i<=MAX_BITS$1;i++)h[i]=0;for(e=0;e<=143;)static_ltree$1[e*2+1]=8,e++,h[8]++;for(;e<=255;)static_ltree$1[e*2+1]=9,e++,h[9]++;for(;e<=279;)static_ltree$1[e*2+1]=7,e++,h[7]++;for(;e<=287;)static_ltree$1[e*2+1]=8,e++,h[8]++;for(gen_codes(static_ltree$1,L_CODES$1$1+1,h),e=0;e<D_CODES$1$1;e++)static_dtree$1[e*2+1]=5,static_dtree$1[e*2]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree$1,extra_lbits,LITERALS$1$1+1,L_CODES$1$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree$1,extra_dbits,0,D_CODES$1$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)},init_block=e=>{let i;for(i=0;i<L_CODES$1$1;i++)e.dyn_ltree[i*2]=0;for(i=0;i<D_CODES$1$1;i++)e.dyn_dtree[i*2]=0;for(i=0;i<BL_CODES$1;i++)e.bl_tree[i*2]=0;e.dyn_ltree[END_BLOCK*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},bi_windup=e=>{e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},smaller=(e,i,a,s)=>{const o=i*2,h=a*2;return e[o]<e[h]||e[o]===e[h]&&s[i]<=s[a]},pqdownheap=(e,i,a)=>{const s=e.heap[a];let o=a<<1;for(;o<=e.heap_len&&(o<e.heap_len&&smaller(i,e.heap[o+1],e.heap[o],e.depth)&&o++,!smaller(i,s,e.heap[o],e.depth));)e.heap[a]=e.heap[o],a=o,o<<=1;e.heap[a]=s},compress_block=(e,i,a)=>{let s,o,h=0,g,_;if(e.sym_next!==0)do s=e.pending_buf[e.sym_buf+h++]&255,s+=(e.pending_buf[e.sym_buf+h++]&255)<<8,o=e.pending_buf[e.sym_buf+h++],s===0?send_code(e,o,i):(g=_length_code$1[o],send_code(e,g+LITERALS$1$1+1,i),_=extra_lbits[g],_!==0&&(o-=base_length$1[g],send_bits(e,o,_)),s--,g=d_code(s),send_code(e,g,a),_=extra_dbits[g],_!==0&&(s-=base_dist$1[g],send_bits(e,s,_)));while(h<e.sym_next);send_code(e,END_BLOCK,i)},build_tree=(e,i)=>{const a=i.dyn_tree,s=i.stat_desc.static_tree,o=i.stat_desc.has_stree,h=i.stat_desc.elems;let g,_,$=-1,b;for(e.heap_len=0,e.heap_max=HEAP_SIZE$1,g=0;g<h;g++)a[g*2]!==0?(e.heap[++e.heap_len]=$=g,e.depth[g]=0):a[g*2+1]=0;for(;e.heap_len<2;)b=e.heap[++e.heap_len]=$<2?++$:0,a[b*2]=1,e.depth[b]=0,e.opt_len--,o&&(e.static_len-=s[b*2+1]);for(i.max_code=$,g=e.heap_len>>1;g>=1;g--)pqdownheap(e,a,g);b=h;do g=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,a,1),_=e.heap[1],e.heap[--e.heap_max]=g,e.heap[--e.heap_max]=_,a[b*2]=a[g*2]+a[_*2],e.depth[b]=(e.depth[g]>=e.depth[_]?e.depth[g]:e.depth[_])+1,a[g*2+1]=a[_*2+1]=b,e.heap[1]=b++,pqdownheap(e,a,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,i),gen_codes(a,$,e.bl_count)},scan_tree=(e,i,a)=>{let s,o=-1,h,g=i[0*2+1],_=0,$=7,b=4;for(g===0&&($=138,b=3),i[(a+1)*2+1]=65535,s=0;s<=a;s++)h=g,g=i[(s+1)*2+1],!(++_<$&&h===g)&&(_<b?e.bl_tree[h*2]+=_:h!==0?(h!==o&&e.bl_tree[h*2]++,e.bl_tree[REP_3_6*2]++):_<=10?e.bl_tree[REPZ_3_10*2]++:e.bl_tree[REPZ_11_138*2]++,_=0,o=h,g===0?($=138,b=3):h===g?($=6,b=3):($=7,b=4))},send_tree=(e,i,a)=>{let s,o=-1,h,g=i[0*2+1],_=0,$=7,b=4;for(g===0&&($=138,b=3),s=0;s<=a;s++)if(h=g,g=i[(s+1)*2+1],!(++_<$&&h===g)){if(_<b)do send_code(e,h,e.bl_tree);while(--_!==0);else h!==0?(h!==o&&(send_code(e,h,e.bl_tree),_--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,_-3,2)):_<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,_-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,_-11,7));_=0,o=h,g===0?($=138,b=3):h===g?($=6,b=3):($=7,b=4)}},build_bl_tree=e=>{let i;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),i=BL_CODES$1-1;i>=3&&e.bl_tree[bl_order[i]*2+1]===0;i--);return e.opt_len+=3*(i+1)+5+5+4,i},send_all_trees=(e,i,a,s)=>{let o;for(send_bits(e,i-257,5),send_bits(e,a-1,5),send_bits(e,s-4,4),o=0;o<s;o++)send_bits(e,e.bl_tree[bl_order[o]*2+1],3);send_tree(e,e.dyn_ltree,i-1),send_tree(e,e.dyn_dtree,a-1)},detect_data_type=e=>{let i=4093624447,a;for(a=0;a<=31;a++,i>>>=1)if(i&1&&e.dyn_ltree[a*2]!==0)return Z_BINARY;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Z_TEXT;for(a=32;a<LITERALS$1$1;a++)if(e.dyn_ltree[a*2]!==0)return Z_TEXT;return Z_BINARY};let static_init_done=!1;const _tr_init$1=e=>{static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)},_tr_stored_block$1=(e,i,a,s)=>{send_bits(e,(STORED_BLOCK<<1)+(s?1:0),3),bi_windup(e),put_short(e,a),put_short(e,~a),a&&e.pending_buf.set(e.window.subarray(i,i+a),e.pending),e.pending+=a},_tr_align$1=e=>{send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree$1),bi_flush(e)},_tr_flush_block$1=(e,i,a,s)=>{let o,h,g=0;e.level>0?(e.strm.data_type===Z_UNKNOWN$1&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),g=build_bl_tree(e),o=e.opt_len+3+7>>>3,h=e.static_len+3+7>>>3,h<=o&&(o=h)):o=h=a+5,a+4<=o&&i!==-1?_tr_stored_block$1(e,i,a,s):e.strategy===Z_FIXED$1||h===o?(send_bits(e,(STATIC_TREES<<1)+(s?1:0),3),compress_block(e,static_ltree$1,static_dtree$1)):(send_bits(e,(DYN_TREES<<1)+(s?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,g+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),s&&bi_windup(e)},_tr_tally$1=(e,i,a)=>(e.pending_buf[e.sym_buf+e.sym_next++]=i,e.pending_buf[e.sym_buf+e.sym_next++]=i>>8,e.pending_buf[e.sym_buf+e.sym_next++]=a,i===0?e.dyn_ltree[a*2]++:(e.matches++,i--,e.dyn_ltree[(_length_code$1[a]+LITERALS$1$1+1)*2]++,e.dyn_dtree[d_code(i)*2]++),e.sym_next===e.sym_end);var _tr_init_1=_tr_init$1,_tr_stored_block_1=_tr_stored_block$1,_tr_flush_block_1=_tr_flush_block$1,_tr_tally_1=_tr_tally$1,_tr_align_1=_tr_align$1,trees$1={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1};const adler32$1=(e,i,a,s)=>{let o=e&65535|0,h=e>>>16&65535|0,g=0;for(;a!==0;){g=a>2e3?2e3:a,a-=g;do o=o+i[s++]|0,h=h+o|0;while(--g);o%=65521,h%=65521}return o|h<<16|0};var adler32_1$2=adler32$1;const makeTable$1=()=>{let e,i=[];for(var a=0;a<256;a++){e=a;for(var s=0;s<8;s++)e=e&1?3988292384^e>>>1:e>>>1;i[a]=e}return i},crcTable$2=new Uint32Array(makeTable$1()),crc32$1=(e,i,a,s)=>{const o=crcTable$2,h=s+a;e^=-1;for(let g=s;g<h;g++)e=e>>>8^o[(e^i[g])&255];return e^-1};var crc32_1$2=crc32$1,messages$2={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=trees$1,{Z_NO_FLUSH:Z_NO_FLUSH$2,Z_PARTIAL_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH$1,Z_FINISH:Z_FINISH$3,Z_BLOCK:Z_BLOCK$1,Z_OK:Z_OK$3,Z_STREAM_END:Z_STREAM_END$3,Z_STREAM_ERROR:Z_STREAM_ERROR$2,Z_DATA_ERROR:Z_DATA_ERROR$2,Z_BUF_ERROR:Z_BUF_ERROR$1,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION$1,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY$1,Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED$2}=constants$2$1,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,GZIP_STATE=57,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=(e,i)=>(e.msg=messages$2[i],i),rank=e=>e*2-(e>4?9:0),zero=e=>{let i=e.length;for(;--i>=0;)e[i]=0},slide_hash=e=>{let i,a,s,o=e.w_size;i=e.hash_size,s=i;do a=e.head[--s],e.head[s]=a>=o?a-o:0;while(--i);i=o,s=i;do a=e.prev[--s],e.prev[s]=a>=o?a-o:0;while(--i)};let HASH_ZLIB=(e,i,a)=>(i<<e.hash_shift^a)&e.hash_mask,HASH=HASH_ZLIB;const flush_pending=e=>{const i=e.state;let a=i.pending;a>e.avail_out&&(a=e.avail_out),a!==0&&(e.output.set(i.pending_buf.subarray(i.pending_out,i.pending_out+a),e.next_out),e.next_out+=a,i.pending_out+=a,e.total_out+=a,e.avail_out-=a,i.pending-=a,i.pending===0&&(i.pending_out=0))},flush_block_only=(e,i)=>{_tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,i),e.block_start=e.strstart,flush_pending(e.strm)},put_byte=(e,i)=>{e.pending_buf[e.pending++]=i},putShortMSB=(e,i)=>{e.pending_buf[e.pending++]=i>>>8&255,e.pending_buf[e.pending++]=i&255},read_buf=(e,i,a,s)=>{let o=e.avail_in;return o>s&&(o=s),o===0?0:(e.avail_in-=o,i.set(e.input.subarray(e.next_in,e.next_in+o),a),e.state.wrap===1?e.adler=adler32_1$2(e.adler,i,o,a):e.state.wrap===2&&(e.adler=crc32_1$2(e.adler,i,o,a)),e.next_in+=o,e.total_in+=o,o)},longest_match=(e,i)=>{let a=e.max_chain_length,s=e.strstart,o,h,g=e.prev_length,_=e.nice_match;const $=e.strstart>e.w_size-MIN_LOOKAHEAD?e.strstart-(e.w_size-MIN_LOOKAHEAD):0,b=e.window,tt=e.w_mask,st=e.prev,at=e.strstart+MAX_MATCH;let nt=b[s+g-1],lt=b[s+g];e.prev_length>=e.good_match&&(a>>=2),_>e.lookahead&&(_=e.lookahead);do if(o=i,!(b[o+g]!==lt||b[o+g-1]!==nt||b[o]!==b[s]||b[++o]!==b[s+1])){s+=2,o++;do;while(b[++s]===b[++o]&&b[++s]===b[++o]&&b[++s]===b[++o]&&b[++s]===b[++o]&&b[++s]===b[++o]&&b[++s]===b[++o]&&b[++s]===b[++o]&&b[++s]===b[++o]&&s<at);if(h=MAX_MATCH-(at-s),s=at-MAX_MATCH,h>g){if(e.match_start=i,g=h,h>=_)break;nt=b[s+g-1],lt=b[s+g]}}while((i=st[i&tt])>$&&--a!==0);return g<=e.lookahead?g:e.lookahead},fill_window=e=>{const i=e.w_size;let a,s,o;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=i+(i-MIN_LOOKAHEAD)&&(e.window.set(e.window.subarray(i,i+i-s),0),e.match_start-=i,e.strstart-=i,e.block_start-=i,e.insert>e.strstart&&(e.insert=e.strstart),slide_hash(e),s+=i),e.strm.avail_in===0)break;if(a=read_buf(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=a,e.lookahead+e.insert>=MIN_MATCH)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=HASH(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=HASH(e,e.ins_h,e.window[o+MIN_MATCH-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<MIN_MATCH)););}while(e.lookahead<MIN_LOOKAHEAD&&e.strm.avail_in!==0)},deflate_stored=(e,i)=>{let a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s,o,h,g=0,_=e.strm.avail_in;do{if(s=65535,h=e.bi_valid+42>>3,e.strm.avail_out<h||(h=e.strm.avail_out-h,o=e.strstart-e.block_start,s>o+e.strm.avail_in&&(s=o+e.strm.avail_in),s>h&&(s=h),s<a&&(s===0&&i!==Z_FINISH$3||i===Z_NO_FLUSH$2||s!==o+e.strm.avail_in)))break;g=i===Z_FINISH$3&&s===o+e.strm.avail_in?1:0,_tr_stored_block(e,0,0,g),e.pending_buf[e.pending-4]=s,e.pending_buf[e.pending-3]=s>>8,e.pending_buf[e.pending-2]=~s,e.pending_buf[e.pending-1]=~s>>8,flush_pending(e.strm),o&&(o>s&&(o=s),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+o),e.strm.next_out),e.strm.next_out+=o,e.strm.avail_out-=o,e.strm.total_out+=o,e.block_start+=o,s-=o),s&&(read_buf(e.strm,e.strm.output,e.strm.next_out,s),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s)}while(g===0);return _-=e.strm.avail_in,_&&(_>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=_&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-_,e.strm.next_in),e.strstart),e.strstart+=_,e.insert+=_>e.w_size-e.insert?e.w_size-e.insert:_),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),g?BS_FINISH_DONE:i!==Z_NO_FLUSH$2&&i!==Z_FINISH$3&&e.strm.avail_in===0&&e.strstart===e.block_start?BS_BLOCK_DONE:(h=e.window_size-e.strstart,e.strm.avail_in>h&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,h+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),h>e.strm.avail_in&&(h=e.strm.avail_in),h&&(read_buf(e.strm,e.window,e.strstart,h),e.strstart+=h,e.insert+=h>e.w_size-e.insert?e.w_size-e.insert:h),e.high_water<e.strstart&&(e.high_water=e.strstart),h=e.bi_valid+42>>3,h=e.pending_buf_size-h>65535?65535:e.pending_buf_size-h,a=h>e.w_size?e.w_size:h,o=e.strstart-e.block_start,(o>=a||(o||i===Z_FINISH$3)&&i!==Z_NO_FLUSH$2&&e.strm.avail_in===0&&o<=h)&&(s=o>h?h:o,g=i===Z_FINISH$3&&e.strm.avail_in===0&&s===o?1:0,_tr_stored_block(e,e.block_start,s,g),e.block_start+=s,flush_pending(e.strm)),g?BS_FINISH_STARTED:BS_NEED_MORE)},deflate_fast=(e,i)=>{let a,s;for(;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&i===Z_NO_FLUSH$2)return BS_NEED_MORE;if(e.lookahead===0)break}if(a=0,e.lookahead>=MIN_MATCH&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),a!==0&&e.strstart-a<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,a)),e.match_length>=MIN_MATCH)if(s=_tr_tally(e,e.strstart-e.match_start,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=MIN_MATCH){e.match_length--;do e.strstart++,e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+1]);else s=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,i===Z_FINISH$3?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.sym_next&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=(e,i)=>{let a,s,o;for(;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&i===Z_NO_FLUSH$2)return BS_NEED_MORE;if(e.lookahead===0)break}if(a=0,e.lookahead>=MIN_MATCH&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=MIN_MATCH-1,a!==0&&e.prev_length<e.max_lazy_match&&e.strstart-a<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,a),e.match_length<=5&&(e.strategy===Z_FILTERED||e.match_length===MIN_MATCH&&e.strstart-e.match_start>4096)&&(e.match_length=MIN_MATCH-1)),e.prev_length>=MIN_MATCH&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-MIN_MATCH,s=_tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-MIN_MATCH),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=MIN_MATCH-1,e.strstart++,s&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}else if(e.match_available){if(s=_tr_tally(e,0,e.window[e.strstart-1]),s&&flush_block_only(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=_tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,i===Z_FINISH$3?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.sym_next&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=(e,i)=>{let a,s,o,h;const g=e.window;for(;;){if(e.lookahead<=MAX_MATCH){if(fill_window(e),e.lookahead<=MAX_MATCH&&i===Z_NO_FLUSH$2)return BS_NEED_MORE;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=MIN_MATCH&&e.strstart>0&&(o=e.strstart-1,s=g[o],s===g[++o]&&s===g[++o]&&s===g[++o])){h=e.strstart+MAX_MATCH;do;while(s===g[++o]&&s===g[++o]&&s===g[++o]&&s===g[++o]&&s===g[++o]&&s===g[++o]&&s===g[++o]&&s===g[++o]&&o<h);e.match_length=MAX_MATCH-(h-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=MIN_MATCH?(a=_tr_tally(e,1,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(a=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),a&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,i===Z_FINISH$3?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.sym_next&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=(e,i)=>{let a;for(;;){if(e.lookahead===0&&(fill_window(e),e.lookahead===0)){if(i===Z_NO_FLUSH$2)return BS_NEED_MORE;break}if(e.match_length=0,a=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,a&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,i===Z_FINISH$3?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.sym_next&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(e,i,a,s,o){this.good_length=e,this.max_lazy=i,this.nice_length=a,this.max_chain=s,this.func=o}const configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=e=>{e.window_size=2*e.w_size,zero(e.head),e.max_lazy_match=configuration_table[e.level].max_lazy,e.good_match=configuration_table[e.level].good_length,e.nice_match=configuration_table[e.level].nice_length,e.max_chain_length=configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=MIN_MATCH-1,e.match_available=0,e.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(HEAP_SIZE*2),this.dyn_dtree=new Uint16Array((2*D_CODES+1)*2),this.bl_tree=new Uint16Array((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateStateCheck=e=>{if(!e)return 1;const i=e.state;return!i||i.strm!==e||i.status!==INIT_STATE&&i.status!==GZIP_STATE&&i.status!==EXTRA_STATE&&i.status!==NAME_STATE&&i.status!==COMMENT_STATE&&i.status!==HCRC_STATE&&i.status!==BUSY_STATE&&i.status!==FINISH_STATE?1:0},deflateResetKeep=e=>{if(deflateStateCheck(e))return err(e,Z_STREAM_ERROR$2);e.total_in=e.total_out=0,e.data_type=Z_UNKNOWN;const i=e.state;return i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap===2?GZIP_STATE:i.wrap?INIT_STATE:BUSY_STATE,e.adler=i.wrap===2?0:1,i.last_flush=-2,_tr_init(i),Z_OK$3},deflateReset=e=>{const i=deflateResetKeep(e);return i===Z_OK$3&&lm_init(e.state),i},deflateSetHeader=(e,i)=>deflateStateCheck(e)||e.state.wrap!==2?Z_STREAM_ERROR$2:(e.state.gzhead=i,Z_OK$3),deflateInit2=(e,i,a,s,o,h)=>{if(!e)return Z_STREAM_ERROR$2;let g=1;if(i===Z_DEFAULT_COMPRESSION$1&&(i=6),s<0?(g=0,s=-s):s>15&&(g=2,s-=16),o<1||o>MAX_MEM_LEVEL||a!==Z_DEFLATED$2||s<8||s>15||i<0||i>9||h<0||h>Z_FIXED||s===8&&g!==1)return err(e,Z_STREAM_ERROR$2);s===8&&(s=9);const _=new DeflateState;return e.state=_,_.strm=e,_.status=INIT_STATE,_.wrap=g,_.gzhead=null,_.w_bits=s,_.w_size=1<<_.w_bits,_.w_mask=_.w_size-1,_.hash_bits=o+7,_.hash_size=1<<_.hash_bits,_.hash_mask=_.hash_size-1,_.hash_shift=~~((_.hash_bits+MIN_MATCH-1)/MIN_MATCH),_.window=new Uint8Array(_.w_size*2),_.head=new Uint16Array(_.hash_size),_.prev=new Uint16Array(_.w_size),_.lit_bufsize=1<<o+6,_.pending_buf_size=_.lit_bufsize*4,_.pending_buf=new Uint8Array(_.pending_buf_size),_.sym_buf=_.lit_bufsize,_.sym_end=(_.lit_bufsize-1)*3,_.level=i,_.strategy=h,_.method=a,deflateReset(e)},deflateInit=(e,i)=>deflateInit2(e,i,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1),deflate$2=(e,i)=>{if(deflateStateCheck(e)||i>Z_BLOCK$1||i<0)return e?err(e,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;const a=e.state;if(!e.output||e.avail_in!==0&&!e.input||a.status===FINISH_STATE&&i!==Z_FINISH$3)return err(e,e.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$2);const s=a.last_flush;if(a.last_flush=i,a.pending!==0){if(flush_pending(e),e.avail_out===0)return a.last_flush=-1,Z_OK$3}else if(e.avail_in===0&&rank(i)<=rank(s)&&i!==Z_FINISH$3)return err(e,Z_BUF_ERROR$1);if(a.status===FINISH_STATE&&e.avail_in!==0)return err(e,Z_BUF_ERROR$1);if(a.status===INIT_STATE&&a.wrap===0&&(a.status=BUSY_STATE),a.status===INIT_STATE){let o=Z_DEFLATED$2+(a.w_bits-8<<4)<<8,h=-1;if(a.strategy>=Z_HUFFMAN_ONLY||a.level<2?h=0:a.level<6?h=1:a.level===6?h=2:h=3,o|=h<<6,a.strstart!==0&&(o|=PRESET_DICT),o+=31-o%31,putShortMSB(a,o),a.strstart!==0&&(putShortMSB(a,e.adler>>>16),putShortMSB(a,e.adler&65535)),e.adler=1,a.status=BUSY_STATE,flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3}if(a.status===GZIP_STATE){if(e.adler=0,put_byte(a,31),put_byte(a,139),put_byte(a,8),a.gzhead)put_byte(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),put_byte(a,a.gzhead.time&255),put_byte(a,a.gzhead.time>>8&255),put_byte(a,a.gzhead.time>>16&255),put_byte(a,a.gzhead.time>>24&255),put_byte(a,a.level===9?2:a.strategy>=Z_HUFFMAN_ONLY||a.level<2?4:0),put_byte(a,a.gzhead.os&255),a.gzhead.extra&&a.gzhead.extra.length&&(put_byte(a,a.gzhead.extra.length&255),put_byte(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=EXTRA_STATE;else if(put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,a.level===9?2:a.strategy>=Z_HUFFMAN_ONLY||a.level<2?4:0),put_byte(a,OS_CODE),a.status=BUSY_STATE,flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3}if(a.status===EXTRA_STATE){if(a.gzhead.extra){let o=a.pending,h=(a.gzhead.extra.length&65535)-a.gzindex;for(;a.pending+h>a.pending_buf_size;){let _=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+_),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex+=_,flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3;o=0,h-=_}let g=new Uint8Array(a.gzhead.extra);a.pending_buf.set(g.subarray(a.gzindex,a.gzindex+h),a.pending),a.pending+=h,a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex=0}a.status=NAME_STATE}if(a.status===NAME_STATE){if(a.gzhead.name){let o=a.pending,h;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3;o=0}a.gzindex<a.gzhead.name.length?h=a.gzhead.name.charCodeAt(a.gzindex++)&255:h=0,put_byte(a,h)}while(h!==0);a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex=0}a.status=COMMENT_STATE}if(a.status===COMMENT_STATE){if(a.gzhead.comment){let o=a.pending,h;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3;o=0}a.gzindex<a.gzhead.comment.length?h=a.gzhead.comment.charCodeAt(a.gzindex++)&255:h=0,put_byte(a,h)}while(h!==0);a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o))}a.status=HCRC_STATE}if(a.status===HCRC_STATE){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(flush_pending(e),a.pending!==0))return a.last_flush=-1,Z_OK$3;put_byte(a,e.adler&255),put_byte(a,e.adler>>8&255),e.adler=0}if(a.status=BUSY_STATE,flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3}if(e.avail_in!==0||a.lookahead!==0||i!==Z_NO_FLUSH$2&&a.status!==FINISH_STATE){let o=a.level===0?deflate_stored(a,i):a.strategy===Z_HUFFMAN_ONLY?deflate_huff(a,i):a.strategy===Z_RLE?deflate_rle(a,i):configuration_table[a.level].func(a,i);if((o===BS_FINISH_STARTED||o===BS_FINISH_DONE)&&(a.status=FINISH_STATE),o===BS_NEED_MORE||o===BS_FINISH_STARTED)return e.avail_out===0&&(a.last_flush=-1),Z_OK$3;if(o===BS_BLOCK_DONE&&(i===Z_PARTIAL_FLUSH?_tr_align(a):i!==Z_BLOCK$1&&(_tr_stored_block(a,0,0,!1),i===Z_FULL_FLUSH$1&&(zero(a.head),a.lookahead===0&&(a.strstart=0,a.block_start=0,a.insert=0))),flush_pending(e),e.avail_out===0))return a.last_flush=-1,Z_OK$3}return i!==Z_FINISH$3?Z_OK$3:a.wrap<=0?Z_STREAM_END$3:(a.wrap===2?(put_byte(a,e.adler&255),put_byte(a,e.adler>>8&255),put_byte(a,e.adler>>16&255),put_byte(a,e.adler>>24&255),put_byte(a,e.total_in&255),put_byte(a,e.total_in>>8&255),put_byte(a,e.total_in>>16&255),put_byte(a,e.total_in>>24&255)):(putShortMSB(a,e.adler>>>16),putShortMSB(a,e.adler&65535)),flush_pending(e),a.wrap>0&&(a.wrap=-a.wrap),a.pending!==0?Z_OK$3:Z_STREAM_END$3)},deflateEnd=e=>{if(deflateStateCheck(e))return Z_STREAM_ERROR$2;const i=e.state.status;return e.state=null,i===BUSY_STATE?err(e,Z_DATA_ERROR$2):Z_OK$3},deflateSetDictionary=(e,i)=>{let a=i.length;if(deflateStateCheck(e))return Z_STREAM_ERROR$2;const s=e.state,o=s.wrap;if(o===2||o===1&&s.status!==INIT_STATE||s.lookahead)return Z_STREAM_ERROR$2;if(o===1&&(e.adler=adler32_1$2(e.adler,i,a,0)),s.wrap=0,a>=s.w_size){o===0&&(zero(s.head),s.strstart=0,s.block_start=0,s.insert=0);let $=new Uint8Array(s.w_size);$.set(i.subarray(a-s.w_size,a),0),i=$,a=s.w_size}const h=e.avail_in,g=e.next_in,_=e.input;for(e.avail_in=a,e.next_in=0,e.input=i,fill_window(s);s.lookahead>=MIN_MATCH;){let $=s.strstart,b=s.lookahead-(MIN_MATCH-1);do s.ins_h=HASH(s,s.ins_h,s.window[$+MIN_MATCH-1]),s.prev[$&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=$,$++;while(--b);s.strstart=$,s.lookahead=MIN_MATCH-1,fill_window(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,e.next_in=g,e.input=_,e.avail_in=h,s.wrap=o,Z_OK$3};var deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2$1=deflate$2,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1$2={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2$1,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo};const _has$1=(e,i)=>Object.prototype.hasOwnProperty.call(e,i);var assign$1=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const a=i.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(const s in a)_has$1(a,s)&&(e[s]=a[s])}}return e},flattenChunks$1=e=>{let i=0;for(let s=0,o=e.length;s<o;s++)i+=e[s].length;const a=new Uint8Array(i);for(let s=0,o=0,h=e.length;s<h;s++){let g=e[s];a.set(g,o),o+=g.length}return a},common$2={assign:assign$1,flattenChunks:flattenChunks$1};let STR_APPLY_UIA_OK$1=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{STR_APPLY_UIA_OK$1=!1}const _utf8len$1=new Uint8Array(256);for(let e=0;e<256;e++)_utf8len$1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_utf8len$1[254]=_utf8len$1[254]=1;var string2buf$1=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let i,a,s,o,h,g=e.length,_=0;for(o=0;o<g;o++)a=e.charCodeAt(o),(a&64512)===55296&&o+1<g&&(s=e.charCodeAt(o+1),(s&64512)===56320&&(a=65536+(a-55296<<10)+(s-56320),o++)),_+=a<128?1:a<2048?2:a<65536?3:4;for(i=new Uint8Array(_),h=0,o=0;h<_;o++)a=e.charCodeAt(o),(a&64512)===55296&&o+1<g&&(s=e.charCodeAt(o+1),(s&64512)===56320&&(a=65536+(a-55296<<10)+(s-56320),o++)),a<128?i[h++]=a:a<2048?(i[h++]=192|a>>>6,i[h++]=128|a&63):a<65536?(i[h++]=224|a>>>12,i[h++]=128|a>>>6&63,i[h++]=128|a&63):(i[h++]=240|a>>>18,i[h++]=128|a>>>12&63,i[h++]=128|a>>>6&63,i[h++]=128|a&63);return i};const buf2binstring$1=(e,i)=>{if(i<65534&&e.subarray&&STR_APPLY_UIA_OK$1)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let a="";for(let s=0;s<i;s++)a+=String.fromCharCode(e[s]);return a};var buf2string$1=(e,i)=>{const a=i||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,i));let s,o;const h=new Array(a*2);for(o=0,s=0;s<a;){let g=e[s++];if(g<128){h[o++]=g;continue}let _=_utf8len$1[g];if(_>4){h[o++]=65533,s+=_-1;continue}for(g&=_===2?31:_===3?15:7;_>1&&s<a;)g=g<<6|e[s++]&63,_--;if(_>1){h[o++]=65533;continue}g<65536?h[o++]=g:(g-=65536,h[o++]=55296|g>>10&1023,h[o++]=56320|g&1023)}return buf2binstring$1(h,o)},utf8border$1=(e,i)=>{i=i||e.length,i>e.length&&(i=e.length);let a=i-1;for(;a>=0&&(e[a]&192)===128;)a--;return a<0||a===0?i:a+_utf8len$1[e[a]]>i?a:i},strings$2={string2buf:string2buf$1,buf2string:buf2string$1,utf8border:utf8border$1};function ZStream$1(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream$2=ZStream$1;const toString$1$1=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$1,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH:Z_FINISH$2,Z_OK:Z_OK$2,Z_STREAM_END:Z_STREAM_END$2,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED:Z_DEFLATED$1}=constants$2$1;function Deflate$1(e){this.options=common$2.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},e||{});let i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream$2,this.strm.avail_out=0;let a=deflate_1$2.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(a!==Z_OK$2)throw new Error(messages$2[a]);if(i.header&&deflate_1$2.deflateSetHeader(this.strm,i.header),i.dictionary){let s;if(typeof i.dictionary=="string"?s=strings$2.string2buf(i.dictionary):toString$1$1.call(i.dictionary)==="[object ArrayBuffer]"?s=new Uint8Array(i.dictionary):s=i.dictionary,a=deflate_1$2.deflateSetDictionary(this.strm,s),a!==Z_OK$2)throw new Error(messages$2[a]);this._dict_set=!0}}Deflate$1.prototype.push=function(e,i){const a=this.strm,s=this.options.chunkSize;let o,h;if(this.ended)return!1;for(i===~~i?h=i:h=i===!0?Z_FINISH$2:Z_NO_FLUSH$1,typeof e=="string"?a.input=strings$2.string2buf(e):toString$1$1.call(e)==="[object ArrayBuffer]"?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){if(a.avail_out===0&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),(h===Z_SYNC_FLUSH||h===Z_FULL_FLUSH)&&a.avail_out<=6){this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;continue}if(o=deflate_1$2.deflate(a,h),o===Z_STREAM_END$2)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),o=deflate_1$2.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===Z_OK$2;if(a.avail_out===0){this.onData(a.output);continue}if(h>0&&a.next_out>0){this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;continue}if(a.avail_in===0)break}return!0};Deflate$1.prototype.onData=function(e){this.chunks.push(e)};Deflate$1.prototype.onEnd=function(e){e===Z_OK$2&&(this.result=common$2.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function deflate$1$1(e,i){const a=new Deflate$1(i);if(a.push(e,!0),a.err)throw a.msg||messages$2[a.err];return a.result}var deflate_2=deflate$1$1,deflate_1$1={deflate:deflate_2};const BAD$1$1=16209,TYPE$1$1=16191;var inffast$2=function(e,i){let a,s,o,h,g,_,$,b,tt,st,at,nt,lt,ft,pt,dt,_t,ut,mt,kt,bt,vt,Et,Mt;const At=e.state;a=e.next_in,Et=e.input,s=a+(e.avail_in-5),o=e.next_out,Mt=e.output,h=o-(i-e.avail_out),g=o+(e.avail_out-257),_=At.dmax,$=At.wsize,b=At.whave,tt=At.wnext,st=At.window,at=At.hold,nt=At.bits,lt=At.lencode,ft=At.distcode,pt=(1<<At.lenbits)-1,dt=(1<<At.distbits)-1;t:do{nt<15&&(at+=Et[a++]<<nt,nt+=8,at+=Et[a++]<<nt,nt+=8),_t=lt[at&pt];e:for(;;){if(ut=_t>>>24,at>>>=ut,nt-=ut,ut=_t>>>16&255,ut===0)Mt[o++]=_t&65535;else if(ut&16){mt=_t&65535,ut&=15,ut&&(nt<ut&&(at+=Et[a++]<<nt,nt+=8),mt+=at&(1<<ut)-1,at>>>=ut,nt-=ut),nt<15&&(at+=Et[a++]<<nt,nt+=8,at+=Et[a++]<<nt,nt+=8),_t=ft[at&dt];n:for(;;){if(ut=_t>>>24,at>>>=ut,nt-=ut,ut=_t>>>16&255,ut&16){if(kt=_t&65535,ut&=15,nt<ut&&(at+=Et[a++]<<nt,nt+=8,nt<ut&&(at+=Et[a++]<<nt,nt+=8)),kt+=at&(1<<ut)-1,kt>_){e.msg="invalid distance too far back",At.mode=BAD$1$1;break t}if(at>>>=ut,nt-=ut,ut=o-h,kt>ut){if(ut=kt-ut,ut>b&&At.sane){e.msg="invalid distance too far back",At.mode=BAD$1$1;break t}if(bt=0,vt=st,tt===0){if(bt+=$-ut,ut<mt){mt-=ut;do Mt[o++]=st[bt++];while(--ut);bt=o-kt,vt=Mt}}else if(tt<ut){if(bt+=$+tt-ut,ut-=tt,ut<mt){mt-=ut;do Mt[o++]=st[bt++];while(--ut);if(bt=0,tt<mt){ut=tt,mt-=ut;do Mt[o++]=st[bt++];while(--ut);bt=o-kt,vt=Mt}}}else if(bt+=tt-ut,ut<mt){mt-=ut;do Mt[o++]=st[bt++];while(--ut);bt=o-kt,vt=Mt}for(;mt>2;)Mt[o++]=vt[bt++],Mt[o++]=vt[bt++],Mt[o++]=vt[bt++],mt-=3;mt&&(Mt[o++]=vt[bt++],mt>1&&(Mt[o++]=vt[bt++]))}else{bt=o-kt;do Mt[o++]=Mt[bt++],Mt[o++]=Mt[bt++],Mt[o++]=Mt[bt++],mt-=3;while(mt>2);mt&&(Mt[o++]=Mt[bt++],mt>1&&(Mt[o++]=Mt[bt++]))}}else if(ut&64){e.msg="invalid distance code",At.mode=BAD$1$1;break t}else{_t=ft[(_t&65535)+(at&(1<<ut)-1)];continue n}break}}else if(ut&64)if(ut&32){At.mode=TYPE$1$1;break t}else{e.msg="invalid literal/length code",At.mode=BAD$1$1;break t}else{_t=lt[(_t&65535)+(at&(1<<ut)-1)];continue e}break}}while(a<s&&o<g);mt=nt>>3,a-=mt,nt-=mt<<3,at&=(1<<nt)-1,e.next_in=a,e.next_out=o,e.avail_in=a<s?5+(s-a):5-(a-s),e.avail_out=o<g?257+(g-o):257-(o-g),At.hold=at,At.bits=nt};const MAXBITS$1=15,ENOUGH_LENS$1$1=852,ENOUGH_DISTS$1$1=592,CODES$1$1=0,LENS$1$1=1,DISTS$1$1=2,lbase$1=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext$1=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase$1=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext$1=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table$1=(e,i,a,s,o,h,g,_)=>{const $=_.bits;let b=0,tt=0,st=0,at=0,nt=0,lt=0,ft=0,pt=0,dt=0,_t=0,ut,mt,kt,bt,vt,Et=null,Mt;const At=new Uint16Array(MAXBITS$1+1),zt=new Uint16Array(MAXBITS$1+1);let Vt=null,Gt,Kt,Wt;for(b=0;b<=MAXBITS$1;b++)At[b]=0;for(tt=0;tt<s;tt++)At[i[a+tt]]++;for(nt=$,at=MAXBITS$1;at>=1&&At[at]===0;at--);if(nt>at&&(nt=at),at===0)return o[h++]=1<<24|64<<16|0,o[h++]=1<<24|64<<16|0,_.bits=1,0;for(st=1;st<at&&At[st]===0;st++);for(nt<st&&(nt=st),pt=1,b=1;b<=MAXBITS$1;b++)if(pt<<=1,pt-=At[b],pt<0)return-1;if(pt>0&&(e===CODES$1$1||at!==1))return-1;for(zt[1]=0,b=1;b<MAXBITS$1;b++)zt[b+1]=zt[b]+At[b];for(tt=0;tt<s;tt++)i[a+tt]!==0&&(g[zt[i[a+tt]]++]=tt);if(e===CODES$1$1?(Et=Vt=g,Mt=20):e===LENS$1$1?(Et=lbase$1,Vt=lext$1,Mt=257):(Et=dbase$1,Vt=dext$1,Mt=0),_t=0,tt=0,b=st,vt=h,lt=nt,ft=0,kt=-1,dt=1<<nt,bt=dt-1,e===LENS$1$1&&dt>ENOUGH_LENS$1$1||e===DISTS$1$1&&dt>ENOUGH_DISTS$1$1)return 1;for(;;){Gt=b-ft,g[tt]+1<Mt?(Kt=0,Wt=g[tt]):g[tt]>=Mt?(Kt=Vt[g[tt]-Mt],Wt=Et[g[tt]-Mt]):(Kt=96,Wt=0),ut=1<<b-ft,mt=1<<lt,st=mt;do mt-=ut,o[vt+(_t>>ft)+mt]=Gt<<24|Kt<<16|Wt|0;while(mt!==0);for(ut=1<<b-1;_t&ut;)ut>>=1;if(ut!==0?(_t&=ut-1,_t+=ut):_t=0,tt++,--At[b]===0){if(b===at)break;b=i[a+g[tt]]}if(b>nt&&(_t&bt)!==kt){for(ft===0&&(ft=nt),vt+=st,lt=b-ft,pt=1<<lt;lt+ft<at&&(pt-=At[lt+ft],!(pt<=0));)lt++,pt<<=1;if(dt+=1<<lt,e===LENS$1$1&&dt>ENOUGH_LENS$1$1||e===DISTS$1$1&&dt>ENOUGH_DISTS$1$1)return 1;kt=_t&bt,o[kt]=nt<<24|lt<<16|vt-h|0}}return _t!==0&&(o[vt+_t]=b-ft<<24|64<<16|0),_.bits=nt,0};var inftrees$2=inflate_table$1;const CODES$2=0,LENS$2=1,DISTS$2=2,{Z_FINISH:Z_FINISH$1$1,Z_BLOCK:Z_BLOCK$2,Z_TREES:Z_TREES$1,Z_OK:Z_OK$1$1,Z_STREAM_END:Z_STREAM_END$1$1,Z_NEED_DICT:Z_NEED_DICT$1$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1$1,Z_DATA_ERROR:Z_DATA_ERROR$1$1,Z_MEM_ERROR:Z_MEM_ERROR$1$1,Z_BUF_ERROR:Z_BUF_ERROR$2,Z_DEFLATED:Z_DEFLATED$3}=constants$2$1,HEAD$1=16180,FLAGS$1=16181,TIME$1=16182,OS$1=16183,EXLEN$1=16184,EXTRA$1=16185,NAME$1=16186,COMMENT$1=16187,HCRC$1=16188,DICTID$1=16189,DICT$1=16190,TYPE$2=16191,TYPEDO$1=16192,STORED$1=16193,COPY_$1=16194,COPY$1=16195,TABLE$1=16196,LENLENS$1=16197,CODELENS$1=16198,LEN_$1=16199,LEN$1=16200,LENEXT$1=16201,DIST$1=16202,DISTEXT$1=16203,MATCH$1=16204,LIT$1=16205,CHECK$1=16206,LENGTH$1=16207,DONE$1=16208,BAD$2=16209,MEM$1=16210,SYNC$1=16211,ENOUGH_LENS$2=852,ENOUGH_DISTS$2=592,MAX_WBITS$2=15,DEF_WBITS$1=MAX_WBITS$2,zswap32$1=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function InflateState$1(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck$1=e=>{if(!e)return 1;const i=e.state;return!i||i.strm!==e||i.mode<HEAD$1||i.mode>SYNC$1?1:0},inflateResetKeep$1=e=>{if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;const i=e.state;return e.total_in=e.total_out=i.total=0,e.msg="",i.wrap&&(e.adler=i.wrap&1),i.mode=HEAD$1,i.last=0,i.havedict=0,i.flags=-1,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new Int32Array(ENOUGH_LENS$2),i.distcode=i.distdyn=new Int32Array(ENOUGH_DISTS$2),i.sane=1,i.back=-1,Z_OK$1$1},inflateReset$1=e=>{if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;const i=e.state;return i.wsize=0,i.whave=0,i.wnext=0,inflateResetKeep$1(e)},inflateReset2$1=(e,i)=>{let a;if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;const s=e.state;return i<0?(a=0,i=-i):(a=(i>>4)+5,i<48&&(i&=15)),i&&(i<8||i>15)?Z_STREAM_ERROR$1$1:(s.window!==null&&s.wbits!==i&&(s.window=null),s.wrap=a,s.wbits=i,inflateReset$1(e))},inflateInit2$1=(e,i)=>{if(!e)return Z_STREAM_ERROR$1$1;const a=new InflateState$1;e.state=a,a.strm=e,a.window=null,a.mode=HEAD$1;const s=inflateReset2$1(e,i);return s!==Z_OK$1$1&&(e.state=null),s},inflateInit$1=e=>inflateInit2$1(e,DEF_WBITS$1);let virgin$1=!0,lenfix$1,distfix$1;const fixedtables$1=e=>{if(virgin$1){lenfix$1=new Int32Array(512),distfix$1=new Int32Array(32);let i=0;for(;i<144;)e.lens[i++]=8;for(;i<256;)e.lens[i++]=9;for(;i<280;)e.lens[i++]=7;for(;i<288;)e.lens[i++]=8;for(inftrees$2(LENS$2,e.lens,0,288,lenfix$1,0,e.work,{bits:9}),i=0;i<32;)e.lens[i++]=5;inftrees$2(DISTS$2,e.lens,0,32,distfix$1,0,e.work,{bits:5}),virgin$1=!1}e.lencode=lenfix$1,e.lenbits=9,e.distcode=distfix$1,e.distbits=5},updatewindow$1=(e,i,a,s)=>{let o;const h=e.state;return h.window===null&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new Uint8Array(h.wsize)),s>=h.wsize?(h.window.set(i.subarray(a-h.wsize,a),0),h.wnext=0,h.whave=h.wsize):(o=h.wsize-h.wnext,o>s&&(o=s),h.window.set(i.subarray(a-s,a-s+o),h.wnext),s-=o,s?(h.window.set(i.subarray(a-s,a),0),h.wnext=s,h.whave=h.wsize):(h.wnext+=o,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=o))),0},inflate$2$1=(e,i)=>{let a,s,o,h,g,_,$,b,tt,st,at,nt,lt,ft,pt=0,dt,_t,ut,mt,kt,bt,vt,Et;const Mt=new Uint8Array(4);let At,zt;const Vt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck$1(e)||!e.output||!e.input&&e.avail_in!==0)return Z_STREAM_ERROR$1$1;a=e.state,a.mode===TYPE$2&&(a.mode=TYPEDO$1),g=e.next_out,o=e.output,$=e.avail_out,h=e.next_in,s=e.input,_=e.avail_in,b=a.hold,tt=a.bits,st=_,at=$,Et=Z_OK$1$1;t:for(;;)switch(a.mode){case HEAD$1:if(a.wrap===0){a.mode=TYPEDO$1;break}for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.wrap&2&&b===35615){a.wbits===0&&(a.wbits=15),a.check=0,Mt[0]=b&255,Mt[1]=b>>>8&255,a.check=crc32_1$2(a.check,Mt,2,0),b=0,tt=0,a.mode=FLAGS$1;break}if(a.head&&(a.head.done=!1),!(a.wrap&1)||(((b&255)<<8)+(b>>8))%31){e.msg="incorrect header check",a.mode=BAD$2;break}if((b&15)!==Z_DEFLATED$3){e.msg="unknown compression method",a.mode=BAD$2;break}if(b>>>=4,tt-=4,vt=(b&15)+8,a.wbits===0&&(a.wbits=vt),vt>15||vt>a.wbits){e.msg="invalid window size",a.mode=BAD$2;break}a.dmax=1<<a.wbits,a.flags=0,e.adler=a.check=1,a.mode=b&512?DICTID$1:TYPE$2,b=0,tt=0;break;case FLAGS$1:for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.flags=b,(a.flags&255)!==Z_DEFLATED$3){e.msg="unknown compression method",a.mode=BAD$2;break}if(a.flags&57344){e.msg="unknown header flags set",a.mode=BAD$2;break}a.head&&(a.head.text=b>>8&1),a.flags&512&&a.wrap&4&&(Mt[0]=b&255,Mt[1]=b>>>8&255,a.check=crc32_1$2(a.check,Mt,2,0)),b=0,tt=0,a.mode=TIME$1;case TIME$1:for(;tt<32;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.head&&(a.head.time=b),a.flags&512&&a.wrap&4&&(Mt[0]=b&255,Mt[1]=b>>>8&255,Mt[2]=b>>>16&255,Mt[3]=b>>>24&255,a.check=crc32_1$2(a.check,Mt,4,0)),b=0,tt=0,a.mode=OS$1;case OS$1:for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.head&&(a.head.xflags=b&255,a.head.os=b>>8),a.flags&512&&a.wrap&4&&(Mt[0]=b&255,Mt[1]=b>>>8&255,a.check=crc32_1$2(a.check,Mt,2,0)),b=0,tt=0,a.mode=EXLEN$1;case EXLEN$1:if(a.flags&1024){for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.length=b,a.head&&(a.head.extra_len=b),a.flags&512&&a.wrap&4&&(Mt[0]=b&255,Mt[1]=b>>>8&255,a.check=crc32_1$2(a.check,Mt,2,0)),b=0,tt=0}else a.head&&(a.head.extra=null);a.mode=EXTRA$1;case EXTRA$1:if(a.flags&1024&&(nt=a.length,nt>_&&(nt=_),nt&&(a.head&&(vt=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(s.subarray(h,h+nt),vt)),a.flags&512&&a.wrap&4&&(a.check=crc32_1$2(a.check,s,nt,h)),_-=nt,h+=nt,a.length-=nt),a.length))break t;a.length=0,a.mode=NAME$1;case NAME$1:if(a.flags&2048){if(_===0)break t;nt=0;do vt=s[h+nt++],a.head&&vt&&a.length<65536&&(a.head.name+=String.fromCharCode(vt));while(vt&&nt<_);if(a.flags&512&&a.wrap&4&&(a.check=crc32_1$2(a.check,s,nt,h)),_-=nt,h+=nt,vt)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=COMMENT$1;case COMMENT$1:if(a.flags&4096){if(_===0)break t;nt=0;do vt=s[h+nt++],a.head&&vt&&a.length<65536&&(a.head.comment+=String.fromCharCode(vt));while(vt&&nt<_);if(a.flags&512&&a.wrap&4&&(a.check=crc32_1$2(a.check,s,nt,h)),_-=nt,h+=nt,vt)break t}else a.head&&(a.head.comment=null);a.mode=HCRC$1;case HCRC$1:if(a.flags&512){for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.wrap&4&&b!==(a.check&65535)){e.msg="header crc mismatch",a.mode=BAD$2;break}b=0,tt=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=TYPE$2;break;case DICTID$1:for(;tt<32;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}e.adler=a.check=zswap32$1(b),b=0,tt=0,a.mode=DICT$1;case DICT$1:if(a.havedict===0)return e.next_out=g,e.avail_out=$,e.next_in=h,e.avail_in=_,a.hold=b,a.bits=tt,Z_NEED_DICT$1$1;e.adler=a.check=1,a.mode=TYPE$2;case TYPE$2:if(i===Z_BLOCK$2||i===Z_TREES$1)break t;case TYPEDO$1:if(a.last){b>>>=tt&7,tt-=tt&7,a.mode=CHECK$1;break}for(;tt<3;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}switch(a.last=b&1,b>>>=1,tt-=1,b&3){case 0:a.mode=STORED$1;break;case 1:if(fixedtables$1(a),a.mode=LEN_$1,i===Z_TREES$1){b>>>=2,tt-=2;break t}break;case 2:a.mode=TABLE$1;break;case 3:e.msg="invalid block type",a.mode=BAD$2}b>>>=2,tt-=2;break;case STORED$1:for(b>>>=tt&7,tt-=tt&7;tt<32;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if((b&65535)!==(b>>>16^65535)){e.msg="invalid stored block lengths",a.mode=BAD$2;break}if(a.length=b&65535,b=0,tt=0,a.mode=COPY_$1,i===Z_TREES$1)break t;case COPY_$1:a.mode=COPY$1;case COPY$1:if(nt=a.length,nt){if(nt>_&&(nt=_),nt>$&&(nt=$),nt===0)break t;o.set(s.subarray(h,h+nt),g),_-=nt,h+=nt,$-=nt,g+=nt,a.length-=nt;break}a.mode=TYPE$2;break;case TABLE$1:for(;tt<14;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.nlen=(b&31)+257,b>>>=5,tt-=5,a.ndist=(b&31)+1,b>>>=5,tt-=5,a.ncode=(b&15)+4,b>>>=4,tt-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=BAD$2;break}a.have=0,a.mode=LENLENS$1;case LENLENS$1:for(;a.have<a.ncode;){for(;tt<3;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.lens[Vt[a.have++]]=b&7,b>>>=3,tt-=3}for(;a.have<19;)a.lens[Vt[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,At={bits:a.lenbits},Et=inftrees$2(CODES$2,a.lens,0,19,a.lencode,0,a.work,At),a.lenbits=At.bits,Et){e.msg="invalid code lengths set",a.mode=BAD$2;break}a.have=0,a.mode=CODELENS$1;case CODELENS$1:for(;a.have<a.nlen+a.ndist;){for(;pt=a.lencode[b&(1<<a.lenbits)-1],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(ut<16)b>>>=dt,tt-=dt,a.lens[a.have++]=ut;else{if(ut===16){for(zt=dt+2;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(b>>>=dt,tt-=dt,a.have===0){e.msg="invalid bit length repeat",a.mode=BAD$2;break}vt=a.lens[a.have-1],nt=3+(b&3),b>>>=2,tt-=2}else if(ut===17){for(zt=dt+3;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}b>>>=dt,tt-=dt,vt=0,nt=3+(b&7),b>>>=3,tt-=3}else{for(zt=dt+7;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}b>>>=dt,tt-=dt,vt=0,nt=11+(b&127),b>>>=7,tt-=7}if(a.have+nt>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=BAD$2;break}for(;nt--;)a.lens[a.have++]=vt}}if(a.mode===BAD$2)break;if(a.lens[256]===0){e.msg="invalid code -- missing end-of-block",a.mode=BAD$2;break}if(a.lenbits=9,At={bits:a.lenbits},Et=inftrees$2(LENS$2,a.lens,0,a.nlen,a.lencode,0,a.work,At),a.lenbits=At.bits,Et){e.msg="invalid literal/lengths set",a.mode=BAD$2;break}if(a.distbits=6,a.distcode=a.distdyn,At={bits:a.distbits},Et=inftrees$2(DISTS$2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,At),a.distbits=At.bits,Et){e.msg="invalid distances set",a.mode=BAD$2;break}if(a.mode=LEN_$1,i===Z_TREES$1)break t;case LEN_$1:a.mode=LEN$1;case LEN$1:if(_>=6&&$>=258){e.next_out=g,e.avail_out=$,e.next_in=h,e.avail_in=_,a.hold=b,a.bits=tt,inffast$2(e,at),g=e.next_out,o=e.output,$=e.avail_out,h=e.next_in,s=e.input,_=e.avail_in,b=a.hold,tt=a.bits,a.mode===TYPE$2&&(a.back=-1);break}for(a.back=0;pt=a.lencode[b&(1<<a.lenbits)-1],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(_t&&!(_t&240)){for(mt=dt,kt=_t,bt=ut;pt=a.lencode[bt+((b&(1<<mt+kt)-1)>>mt)],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(mt+dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}b>>>=mt,tt-=mt,a.back+=mt}if(b>>>=dt,tt-=dt,a.back+=dt,a.length=ut,_t===0){a.mode=LIT$1;break}if(_t&32){a.back=-1,a.mode=TYPE$2;break}if(_t&64){e.msg="invalid literal/length code",a.mode=BAD$2;break}a.extra=_t&15,a.mode=LENEXT$1;case LENEXT$1:if(a.extra){for(zt=a.extra;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.length+=b&(1<<a.extra)-1,b>>>=a.extra,tt-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=DIST$1;case DIST$1:for(;pt=a.distcode[b&(1<<a.distbits)-1],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(!(_t&240)){for(mt=dt,kt=_t,bt=ut;pt=a.distcode[bt+((b&(1<<mt+kt)-1)>>mt)],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(mt+dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}b>>>=mt,tt-=mt,a.back+=mt}if(b>>>=dt,tt-=dt,a.back+=dt,_t&64){e.msg="invalid distance code",a.mode=BAD$2;break}a.offset=ut,a.extra=_t&15,a.mode=DISTEXT$1;case DISTEXT$1:if(a.extra){for(zt=a.extra;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.offset+=b&(1<<a.extra)-1,b>>>=a.extra,tt-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=BAD$2;break}a.mode=MATCH$1;case MATCH$1:if($===0)break t;if(nt=at-$,a.offset>nt){if(nt=a.offset-nt,nt>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=BAD$2;break}nt>a.wnext?(nt-=a.wnext,lt=a.wsize-nt):lt=a.wnext-nt,nt>a.length&&(nt=a.length),ft=a.window}else ft=o,lt=g-a.offset,nt=a.length;nt>$&&(nt=$),$-=nt,a.length-=nt;do o[g++]=ft[lt++];while(--nt);a.length===0&&(a.mode=LEN$1);break;case LIT$1:if($===0)break t;o[g++]=a.length,$--,a.mode=LEN$1;break;case CHECK$1:if(a.wrap){for(;tt<32;){if(_===0)break t;_--,b|=s[h++]<<tt,tt+=8}if(at-=$,e.total_out+=at,a.total+=at,a.wrap&4&&at&&(e.adler=a.check=a.flags?crc32_1$2(a.check,o,at,g-at):adler32_1$2(a.check,o,at,g-at)),at=$,a.wrap&4&&(a.flags?b:zswap32$1(b))!==a.check){e.msg="incorrect data check",a.mode=BAD$2;break}b=0,tt=0}a.mode=LENGTH$1;case LENGTH$1:if(a.wrap&&a.flags){for(;tt<32;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.wrap&4&&b!==(a.total&4294967295)){e.msg="incorrect length check",a.mode=BAD$2;break}b=0,tt=0}a.mode=DONE$1;case DONE$1:Et=Z_STREAM_END$1$1;break t;case BAD$2:Et=Z_DATA_ERROR$1$1;break t;case MEM$1:return Z_MEM_ERROR$1$1;case SYNC$1:default:return Z_STREAM_ERROR$1$1}return e.next_out=g,e.avail_out=$,e.next_in=h,e.avail_in=_,a.hold=b,a.bits=tt,(a.wsize||at!==e.avail_out&&a.mode<BAD$2&&(a.mode<CHECK$1||i!==Z_FINISH$1$1))&&updatewindow$1(e,e.output,e.next_out,at-e.avail_out),st-=e.avail_in,at-=e.avail_out,e.total_in+=st,e.total_out+=at,a.total+=at,a.wrap&4&&at&&(e.adler=a.check=a.flags?crc32_1$2(a.check,o,at,e.next_out-at):adler32_1$2(a.check,o,at,e.next_out-at)),e.data_type=a.bits+(a.last?64:0)+(a.mode===TYPE$2?128:0)+(a.mode===LEN_$1||a.mode===COPY_$1?256:0),(st===0&&at===0||i===Z_FINISH$1$1)&&Et===Z_OK$1$1&&(Et=Z_BUF_ERROR$2),Et},inflateEnd$1=e=>{if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;let i=e.state;return i.window&&(i.window=null),e.state=null,Z_OK$1$1},inflateGetHeader$1=(e,i)=>{if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;const a=e.state;return a.wrap&2?(a.head=i,i.done=!1,Z_OK$1$1):Z_STREAM_ERROR$1$1},inflateSetDictionary$1=(e,i)=>{const a=i.length;let s,o,h;return inflateStateCheck$1(e)||(s=e.state,s.wrap!==0&&s.mode!==DICT$1)?Z_STREAM_ERROR$1$1:s.mode===DICT$1&&(o=1,o=adler32_1$2(o,i,a,0),o!==s.check)?Z_DATA_ERROR$1$1:(h=updatewindow$1(e,i,a,a),h?(s.mode=MEM$1,Z_MEM_ERROR$1$1):(s.havedict=1,Z_OK$1$1))};var inflateReset_1$1=inflateReset$1,inflateReset2_1$1=inflateReset2$1,inflateResetKeep_1$1=inflateResetKeep$1,inflateInit_1$1=inflateInit$1,inflateInit2_1$1=inflateInit2$1,inflate_2$1$1=inflate$2$1,inflateEnd_1$1=inflateEnd$1,inflateGetHeader_1$1=inflateGetHeader$1,inflateSetDictionary_1$1=inflateSetDictionary$1,inflateInfo$1="pako inflate (from Nodeca project)",inflate_1$2$1={inflateReset:inflateReset_1$1,inflateReset2:inflateReset2_1$1,inflateResetKeep:inflateResetKeep_1$1,inflateInit:inflateInit_1$1,inflateInit2:inflateInit2_1$1,inflate:inflate_2$1$1,inflateEnd:inflateEnd_1$1,inflateGetHeader:inflateGetHeader_1$1,inflateSetDictionary:inflateSetDictionary_1$1,inflateInfo:inflateInfo$1};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader$2=GZheader$1;const toString$2=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$3,Z_FINISH:Z_FINISH$4,Z_OK:Z_OK$4,Z_STREAM_END:Z_STREAM_END$4,Z_NEED_DICT:Z_NEED_DICT$2,Z_STREAM_ERROR:Z_STREAM_ERROR$3,Z_DATA_ERROR:Z_DATA_ERROR$3,Z_MEM_ERROR:Z_MEM_ERROR$2}=constants$2$1;function Inflate$1$1(e){this.options=common$2.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),i.windowBits>=0&&i.windowBits<16&&!(e&&e.windowBits)&&(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&!(i.windowBits&15)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream$2,this.strm.avail_out=0;let a=inflate_1$2$1.inflateInit2(this.strm,i.windowBits);if(a!==Z_OK$4)throw new Error(messages$2[a]);if(this.header=new gzheader$2,inflate_1$2$1.inflateGetHeader(this.strm,this.header),i.dictionary&&(typeof i.dictionary=="string"?i.dictionary=strings$2.string2buf(i.dictionary):toString$2.call(i.dictionary)==="[object ArrayBuffer]"&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(a=inflate_1$2$1.inflateSetDictionary(this.strm,i.dictionary),a!==Z_OK$4)))throw new Error(messages$2[a])}Inflate$1$1.prototype.push=function(e,i){const a=this.strm,s=this.options.chunkSize,o=this.options.dictionary;let h,g,_;if(this.ended)return!1;for(i===~~i?g=i:g=i===!0?Z_FINISH$4:Z_NO_FLUSH$3,toString$2.call(e)==="[object ArrayBuffer]"?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(a.avail_out===0&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),h=inflate_1$2$1.inflate(a,g),h===Z_NEED_DICT$2&&o&&(h=inflate_1$2$1.inflateSetDictionary(a,o),h===Z_OK$4?h=inflate_1$2$1.inflate(a,g):h===Z_DATA_ERROR$3&&(h=Z_NEED_DICT$2));a.avail_in>0&&h===Z_STREAM_END$4&&a.state.wrap>0&&e[a.next_in]!==0;)inflate_1$2$1.inflateReset(a),h=inflate_1$2$1.inflate(a,g);switch(h){case Z_STREAM_ERROR$3:case Z_DATA_ERROR$3:case Z_NEED_DICT$2:case Z_MEM_ERROR$2:return this.onEnd(h),this.ended=!0,!1}if(_=a.avail_out,a.next_out&&(a.avail_out===0||h===Z_STREAM_END$4))if(this.options.to==="string"){let $=strings$2.utf8border(a.output,a.next_out),b=a.next_out-$,tt=strings$2.buf2string(a.output,$);a.next_out=b,a.avail_out=s-b,b&&a.output.set(a.output.subarray($,$+b),0),this.onData(tt)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(!(h===Z_OK$4&&_===0)){if(h===Z_STREAM_END$4)return h=inflate_1$2$1.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,!0;if(a.avail_in===0)break}}return!0};Inflate$1$1.prototype.onData=function(e){this.chunks.push(e)};Inflate$1$1.prototype.onEnd=function(e){e===Z_OK$4&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common$2.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function inflate$1$2(e,i){const a=new Inflate$1$1(i);if(a.push(e),a.err)throw a.msg||messages$2[a.err];return a.result}var Inflate_1$1=Inflate$1$1,inflate_2$2=inflate$1$2,inflate_1$1$1={Inflate:Inflate_1$1,inflate:inflate_2$2};const{deflate:deflate$3}=deflate_1$1,{Inflate,inflate:inflate$4}=inflate_1$1$1;var deflate_1=deflate$3,Inflate_1=Inflate,inflate_1$3=inflate$4;const crcTable$1=[];for(let e=0;e<256;e++){let i=e;for(let a=0;a<8;a++)i&1?i=3988292384^i>>>1:i=i>>>1;crcTable$1[e]=i}const initialCrc=4294967295;function updateCrc(e,i,a){let s=e;for(let o=0;o<a;o++)s=crcTable$1[(s^i[o])&255]^s>>>8;return s}function crc(e,i){return(updateCrc(initialCrc,e,i)^initialCrc)>>>0}function checkCrc(e,i,a){const s=e.readUint32(),o=crc(new Uint8Array(e.buffer,e.byteOffset+e.offset-i-4,i),i);if(o!==s)throw new Error(`CRC mismatch for chunk ${a}. Expected ${s}, found ${o}`)}function writeCrc(e,i){e.writeUint32(crc(new Uint8Array(e.buffer,e.byteOffset+e.offset-i,i),i))}function unfilterNone(e,i,a){for(let s=0;s<a;s++)i[s]=e[s]}function unfilterSub(e,i,a,s){let o=0;for(;o<s;o++)i[o]=e[o];for(;o<a;o++)i[o]=e[o]+i[o-s]&255}function unfilterUp(e,i,a,s){let o=0;if(a.length===0)for(;o<s;o++)i[o]=e[o];else for(;o<s;o++)i[o]=e[o]+a[o]&255}function unfilterAverage(e,i,a,s,o){let h=0;if(a.length===0){for(;h<o;h++)i[h]=e[h];for(;h<s;h++)i[h]=e[h]+(i[h-o]>>1)&255}else{for(;h<o;h++)i[h]=e[h]+(a[h]>>1)&255;for(;h<s;h++)i[h]=e[h]+(i[h-o]+a[h]>>1)&255}}function unfilterPaeth(e,i,a,s,o){let h=0;if(a.length===0){for(;h<o;h++)i[h]=e[h];for(;h<s;h++)i[h]=e[h]+i[h-o]&255}else{for(;h<o;h++)i[h]=e[h]+a[h]&255;for(;h<s;h++)i[h]=e[h]+paethPredictor(i[h-o],a[h],a[h-o])&255}}function paethPredictor(e,i,a){const s=e+i-a,o=Math.abs(s-e),h=Math.abs(s-i),g=Math.abs(s-a);return o<=h&&o<=g?e:h<=g?i:a}const uint16=new Uint16Array([255]),uint8=new Uint8Array(uint16.buffer),osIsLittleEndian=uint8[0]===255,empty=new Uint8Array(0);function decodeInterlaceNull(e){const{data:i,width:a,height:s,channels:o,depth:h}=e,g=o*h/8,_=a*g,$=new Uint8Array(s*_);let b=empty,tt=0,st,at;for(let nt=0;nt<s;nt++){switch(st=i.subarray(tt+1,tt+1+_),at=$.subarray(nt*_,(nt+1)*_),i[tt]){case 0:unfilterNone(st,at,_);break;case 1:unfilterSub(st,at,_,g);break;case 2:unfilterUp(st,at,b,_);break;case 3:unfilterAverage(st,at,b,_,g);break;case 4:unfilterPaeth(st,at,b,_,g);break;default:throw new Error(`Unsupported filter: ${i[tt]}`)}b=at,tt+=_+1}if(h===16){const nt=new Uint16Array($.buffer);if(osIsLittleEndian)for(let lt=0;lt<nt.length;lt++)nt[lt]=swap16(nt[lt]);return nt}else return $}function swap16(e){return(e&255)<<8|e>>8&255}const pngSignature=Uint8Array.of(137,80,78,71,13,10,26,10);function writeSignature(e){e.writeBytes(pngSignature)}function checkSignature(e){if(!hasPngSignature(e.readBytes(pngSignature.length)))throw new Error("wrong PNG signature")}function hasPngSignature(e){if(e.length<pngSignature.length)return!1;for(let i=0;i<pngSignature.length;i++)if(e[i]!==pngSignature[i])return!1;return!0}const textChunkName="tEXt",NULL=0,latin1Decoder=new TextDecoder("latin1");function validateKeyword(e){if(validateLatin1(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const latin1Regex=/^[\u0000-\u00FF]*$/;function validateLatin1(e){if(!latin1Regex.test(e))throw new Error("invalid latin1 text")}function decodetEXt(e,i,a){const s=readKeyword(i);e[s]=readLatin1(i,a-s.length-1)}function encodetEXt(e,i,a){validateKeyword(i),validateLatin1(a);const s=i.length+1+a.length;e.writeUint32(s),e.writeChars(textChunkName),e.writeChars(i),e.writeByte(NULL),e.writeChars(a),writeCrc(e,s+4)}function readKeyword(e){for(e.mark();e.readByte()!==NULL;);const i=e.offset;e.reset();const a=latin1Decoder.decode(e.readBytes(i-e.offset-1));return e.skip(1),validateKeyword(a),a}function readLatin1(e,i){return latin1Decoder.decode(e.readBytes(i))}const ColorType={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},CompressionMethod={UNKNOWN:-1,DEFLATE:0},FilterMethod={UNKNOWN:-1,ADAPTIVE:0},InterlaceMethod={UNKNOWN:-1,NO_INTERLACE:0};class PngDecoder extends IOBuffer{constructor(i,a={}){super(i),$e(this,"_checkCrc"),$e(this,"_inflator"),$e(this,"_png"),$e(this,"_end"),$e(this,"_hasPalette"),$e(this,"_palette"),$e(this,"_hasTransparency"),$e(this,"_transparency"),$e(this,"_compressionMethod"),$e(this,"_filterMethod"),$e(this,"_interlaceMethod"),$e(this,"_colorType");const{checkCrc:s=!1}=a;this._checkCrc=s,this._inflator=new Inflate_1,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=CompressionMethod.UNKNOWN,this._filterMethod=FilterMethod.UNKNOWN,this._interlaceMethod=InterlaceMethod.UNKNOWN,this._colorType=ColorType.UNKNOWN,this.setBigEndian()}decode(){for(checkSignature(this);!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeChunk(){const i=this.readUint32(),a=this.readChars(4),s=this.offset;switch(a){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(i);break;case"IDAT":this.decodeIDAT(i);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(i);break;case"iCCP":this.decodeiCCP(i);break;case textChunkName:decodetEXt(this._png.text,this,i);break;case"pHYs":this.decodepHYs();break;default:this.skip(i);break}if(this.offset-s!==i)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?checkCrc(this,i+4,a):this.skip(4)}decodeIHDR(){const i=this._png;i.width=this.readUint32(),i.height=this.readUint32(),i.depth=checkBitDepth(this.readUint8());const a=this.readUint8();this._colorType=a;let s;switch(a){case ColorType.GREYSCALE:s=1;break;case ColorType.TRUECOLOUR:s=3;break;case ColorType.INDEXED_COLOUR:s=1;break;case ColorType.GREYSCALE_ALPHA:s=2;break;case ColorType.TRUECOLOUR_ALPHA:s=4;break;case ColorType.UNKNOWN:default:throw new Error(`Unknown color type: ${a}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(i){if(i%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${i}`);const a=i/3;this._hasPalette=!0;const s=[];this._palette=s;for(let o=0;o<a;o++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(i){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,i)),this.skip(i)}decodetRNS(i){switch(this._colorType){case ColorType.GREYSCALE:case ColorType.TRUECOLOUR:{if(i%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${i}`);if(i/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${i/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(i/2);for(let a=0;a<i/2;a++)this._transparency[a]=this.readUint16();break}case ColorType.INDEXED_COLOUR:{if(i>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${i} vs ${this._palette.length})`);let a=0;for(;a<i;a++){const s=this.readByte();this._palette[a].push(s)}for(;a<this._palette.length;a++)this._palette[a].push(255);break}case ColorType.UNKNOWN:case ColorType.GREYSCALE_ALPHA:case ColorType.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(i){const a=readKeyword(this),s=this.readUint8();if(s!==CompressionMethod.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const o=this.readBytes(i-a.length-2);this._png.iccEmbeddedProfile={name:a,profile:inflate_1$3(o)}}decodepHYs(){const i=this.readUint32(),a=this.readUint32(),s=this.readByte();this._png.resolution={x:i,y:a,unit:s}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const i=this._inflator.result;if(this._filterMethod!==FilterMethod.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===InterlaceMethod.NO_INTERLACE)this._png.data=decodeInterlaceNull({data:i,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}}function checkBitDepth(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}const defaultZlibOptions={level:3};class PngEncoder extends IOBuffer{constructor(i,a={}){super(),$e(this,"_png"),$e(this,"_zlibOptions"),$e(this,"_colorType"),this._colorType=ColorType.UNKNOWN,this._zlibOptions={...defaultZlibOptions,...a.zlib},this._png=this._checkData(i),this.setBigEndian()}encode(){if(writeSignature(this),this.encodeIHDR(),this.encodeData(),this._png.text)for(const[i,a]of Object.entries(this._png.text))encodetEXt(this,i,a);return this.encodeIEND(),this.toArray()}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(CompressionMethod.DEFLATE),this.writeByte(FilterMethod.ADAPTIVE),this.writeByte(InterlaceMethod.NO_INTERLACE),writeCrc(this,17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),writeCrc(this,4)}encodeIDAT(i){this.writeUint32(i.length),this.writeChars("IDAT"),this.writeBytes(i),writeCrc(this,i.length+4)}encodeData(){const{width:i,height:a,channels:s,depth:o,data:h}=this._png,g=s*i,_=new IOBuffer().setBigEndian();let $=0;for(let st=0;st<a;st++)if(_.writeByte(0),o===8)$=writeDataBytes(h,_,g,$);else if(o===16)$=writeDataUint16(h,_,g,$);else throw new Error("unreachable");const b=_.toArray(),tt=deflate_1(b,this._zlibOptions);this.encodeIDAT(tt)}_checkData(i){const{colorType:a,channels:s,depth:o}=getColorType(i),h={width:checkInteger(i.width,"width"),height:checkInteger(i.height,"height"),channels:s,data:i.data,depth:o,text:i.text};this._colorType=a;const g=h.width*h.height*s;if(h.data.length!==g)throw new RangeError(`wrong data size. Found ${h.data.length}, expected ${g}`);return h}}function checkInteger(e,i){if(Number.isInteger(e)&&e>0)return e;throw new TypeError(`${i} must be a positive integer`)}function getColorType(e){const{channels:i=4,depth:a=8}=e;if(i!==4&&i!==3&&i!==2&&i!==1)throw new RangeError(`unsupported number of channels: ${i}`);if(a!==8&&a!==16)throw new RangeError(`unsupported bit depth: ${a}`);const s={channels:i,depth:a,colorType:ColorType.UNKNOWN};switch(i){case 4:s.colorType=ColorType.TRUECOLOUR_ALPHA;break;case 3:s.colorType=ColorType.TRUECOLOUR;break;case 1:s.colorType=ColorType.GREYSCALE;break;case 2:s.colorType=ColorType.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return s}function writeDataBytes(e,i,a,s){for(let o=0;o<a;o++)i.writeByte(e[s++]);return s}function writeDataUint16(e,i,a,s){for(let o=0;o<a;o++)i.writeUint16(e[s++]);return s}var ResolutionUnitSpecifier;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(ResolutionUnitSpecifier||(ResolutionUnitSpecifier={}));function decodePng(e,i){return new PngDecoder(e,i).decode()}function encodePng$1(e,i){return new PngEncoder(e,i).encode()}var encoder={exports:{}},hasRequiredEncoder;function requireEncoder(){return hasRequiredEncoder||(hasRequiredEncoder=1,function(e){function i(s){var o=Math.floor,h=new Array(64),g=new Array(64),_=new Array(64),$=new Array(64),b,tt,st,at,nt=new Array(65535),lt=new Array(65535),ft=new Array(64),pt=new Array(64),dt=[],_t=0,ut=7,mt=new Array(64),kt=new Array(64),bt=new Array(64),vt=new Array(256),Et=new Array(2048),Mt,At=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],zt=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Vt=[0,1,2,3,4,5,6,7,8,9,10,11],Gt=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Kt=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Wt=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],sn=[0,1,2,3,4,5,6,7,8,9,10,11],on=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Xt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ln(wn){for(var jn=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],er=0;er<64;er++){var Vn=o((jn[er]*wn+50)/100);Vn<1?Vn=1:Vn>255&&(Vn=255),h[At[er]]=Vn}for(var Rn=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ar=0;ar<64;ar++){var Hn=o((Rn[ar]*wn+50)/100);Hn<1?Hn=1:Hn>255&&(Hn=255),g[At[ar]]=Hn}for(var Fn=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],qn=0,ir=0;ir<8;ir++)for(var Nn=0;Nn<8;Nn++)_[qn]=1/(h[At[qn]]*Fn[ir]*Fn[Nn]*8),$[qn]=1/(g[At[qn]]*Fn[ir]*Fn[Nn]*8),qn++}function nn(wn,jn){for(var er=0,Vn=0,Rn=new Array,ar=1;ar<=16;ar++){for(var Hn=1;Hn<=wn[ar];Hn++)Rn[jn[Vn]]=[],Rn[jn[Vn]][0]=er,Rn[jn[Vn]][1]=ar,Vn++,er++;er*=2}return Rn}function gn(){b=nn(zt,Vt),tt=nn(Wt,sn),st=nn(Gt,Kt),at=nn(on,Xt)}function dn(){for(var wn=1,jn=2,er=1;er<=15;er++){for(var Vn=wn;Vn<jn;Vn++)lt[32767+Vn]=er,nt[32767+Vn]=[],nt[32767+Vn][1]=er,nt[32767+Vn][0]=Vn;for(var Rn=-(jn-1);Rn<=-wn;Rn++)lt[32767+Rn]=er,nt[32767+Rn]=[],nt[32767+Rn][1]=er,nt[32767+Rn][0]=jn-1+Rn;wn<<=1,jn<<=1}}function $n(){for(var wn=0;wn<256;wn++)Et[wn]=19595*wn,Et[wn+256>>0]=38470*wn,Et[wn+512>>0]=7471*wn+32768,Et[wn+768>>0]=-11059*wn,Et[wn+1024>>0]=-21709*wn,Et[wn+1280>>0]=32768*wn+8421375,Et[wn+1536>>0]=-27439*wn,Et[wn+1792>>0]=-5329*wn}function En(wn){for(var jn=wn[0],er=wn[1]-1;er>=0;)jn&1<<er&&(_t|=1<<ut),er--,ut--,ut<0&&(_t==255?(qt(255),qt(0)):qt(_t),ut=7,_t=0)}function qt(wn){dt.push(wn)}function en(wn){qt(wn>>8&255),qt(wn&255)}function Tn(wn,jn){var er,Vn,Rn,ar,Hn,Fn,qn,ir,Nn=0,Kn,Ut=8,xn=64;for(Kn=0;Kn<Ut;++Kn){er=wn[Nn],Vn=wn[Nn+1],Rn=wn[Nn+2],ar=wn[Nn+3],Hn=wn[Nn+4],Fn=wn[Nn+5],qn=wn[Nn+6],ir=wn[Nn+7];var kn=er+ir,Pn=er-ir,tn=Vn+qn,vn=Vn-qn,Pt=Rn+Fn,An=Rn-Fn,sr=ar+Hn,wt=ar-Hn,mn=kn+sr,yn=kn-sr,Ft=tn+Pt,Qt=tn-Pt;wn[Nn]=mn+Ft,wn[Nn+4]=mn-Ft;var cn=(Qt+yn)*.707106781;wn[Nn+2]=yn+cn,wn[Nn+6]=yn-cn,mn=wt+An,Ft=An+vn,Qt=vn+Pn;var tr=(mn-Qt)*.382683433,ct=.5411961*mn+tr,rt=1.306562965*Qt+tr,et=Ft*.707106781,it=Pn+et,ht=Pn-et;wn[Nn+5]=ht+ct,wn[Nn+3]=ht-ct,wn[Nn+1]=it+rt,wn[Nn+7]=it-rt,Nn+=8}for(Nn=0,Kn=0;Kn<Ut;++Kn){er=wn[Nn],Vn=wn[Nn+8],Rn=wn[Nn+16],ar=wn[Nn+24],Hn=wn[Nn+32],Fn=wn[Nn+40],qn=wn[Nn+48],ir=wn[Nn+56];var yt=er+ir,Lt=er-ir,Nt=Vn+qn,Ct=Vn-qn,Ht=Rn+Fn,rn=Rn-Fn,jt=ar+Hn,pn=ar-Hn,Mn=yt+jt,un=yt-jt,_n=Nt+Ht,On=Nt-Ht;wn[Nn]=Mn+_n,wn[Nn+32]=Mn-_n;var _e=(On+un)*.707106781;wn[Nn+16]=un+_e,wn[Nn+48]=un-_e,Mn=pn+rn,_n=rn+Ct,On=Ct+Lt;var Dn=(Mn-On)*.382683433,Yn=.5411961*Mn+Dn,hr=1.306562965*On+Dn,cr=_n*.707106781,kr=Lt+cr,rr=Lt-cr;wn[Nn+40]=rr+Yn,wn[Nn+24]=rr-Yn,wn[Nn+8]=kr+hr,wn[Nn+56]=kr-hr,Nn++}var lr;for(Kn=0;Kn<xn;++Kn)lr=wn[Kn]*jn[Kn],ft[Kn]=lr>0?lr+.5|0:lr-.5|0;return ft}function Sn(){en(65504),en(16),qt(74),qt(70),qt(73),qt(70),qt(0),qt(1),qt(1),qt(0),en(1),en(1),qt(0),qt(0)}function fn(wn){if(wn){en(65505),wn[0]===69&&wn[1]===120&&wn[2]===105&&wn[3]===102?en(wn.length+2):(en(wn.length+5+2),qt(69),qt(120),qt(105),qt(102),qt(0));for(var jn=0;jn<wn.length;jn++)qt(wn[jn])}}function Wn(wn,jn){en(65472),en(17),qt(8),en(jn),en(wn),qt(3),qt(1),qt(17),qt(0),qt(2),qt(17),qt(1),qt(3),qt(17),qt(1)}function Zn(){en(65499),en(132),qt(0);for(var wn=0;wn<64;wn++)qt(h[wn]);qt(1);for(var jn=0;jn<64;jn++)qt(g[jn])}function Gn(){en(65476),en(418),qt(0);for(var wn=0;wn<16;wn++)qt(zt[wn+1]);for(var jn=0;jn<=11;jn++)qt(Vt[jn]);qt(16);for(var er=0;er<16;er++)qt(Gt[er+1]);for(var Vn=0;Vn<=161;Vn++)qt(Kt[Vn]);qt(1);for(var Rn=0;Rn<16;Rn++)qt(Wt[Rn+1]);for(var ar=0;ar<=11;ar++)qt(sn[ar]);qt(17);for(var Hn=0;Hn<16;Hn++)qt(on[Hn+1]);for(var Fn=0;Fn<=161;Fn++)qt(Xt[Fn])}function zn(wn){typeof wn>"u"||wn.constructor!==Array||wn.forEach(jn=>{if(typeof jn=="string"){en(65534);var er=jn.length;en(er+2);var Vn;for(Vn=0;Vn<er;Vn++)qt(jn.charCodeAt(Vn))}})}function Bn(){en(65498),en(12),qt(3),qt(1),qt(0),qt(2),qt(17),qt(3),qt(17),qt(0),qt(63),qt(0)}function or(wn,jn,er,Vn,Rn){for(var ar=Rn[0],Hn=Rn[240],Fn,qn=16,ir=63,Nn=64,Kn=Tn(wn,jn),Ut=0;Ut<Nn;++Ut)pt[At[Ut]]=Kn[Ut];var xn=pt[0]-er;er=pt[0],xn==0?En(Vn[0]):(Fn=32767+xn,En(Vn[lt[Fn]]),En(nt[Fn]));for(var kn=63;kn>0&&pt[kn]==0;kn--);if(kn==0)return En(ar),er;for(var Pn=1,tn;Pn<=kn;){for(var vn=Pn;pt[Pn]==0&&Pn<=kn;++Pn);var Pt=Pn-vn;if(Pt>=qn){tn=Pt>>4;for(var An=1;An<=tn;++An)En(Hn);Pt=Pt&15}Fn=32767+pt[Pn],En(Rn[(Pt<<4)+lt[Fn]]),En(nt[Fn]),Pn++}return kn!=ir&&En(ar),er}function Jn(){for(var wn=String.fromCharCode,jn=0;jn<256;jn++)vt[jn]=wn(jn)}this.encode=function(wn,jn){new Date().getTime(),jn&&Un(jn),dt=new Array,_t=0,ut=7,en(65496),Sn(),zn(wn.comments),fn(wn.exifBuffer),Zn(),Wn(wn.width,wn.height),Gn(),Bn();var er=0,Vn=0,Rn=0;_t=0,ut=7,this.encode.displayName="_encode_";for(var ar=wn.data,Hn=wn.width,Fn=wn.height,qn=Hn*4,ir,Nn=0,Kn,Ut,xn,kn,Pn,tn,vn,Pt;Nn<Fn;){for(ir=0;ir<qn;){for(kn=qn*Nn+ir,Pn=kn,tn=-1,vn=0,Pt=0;Pt<64;Pt++)vn=Pt>>3,tn=(Pt&7)*4,Pn=kn+vn*qn+tn,Nn+vn>=Fn&&(Pn-=qn*(Nn+1+vn-Fn)),ir+tn>=qn&&(Pn-=ir+tn-qn+4),Kn=ar[Pn++],Ut=ar[Pn++],xn=ar[Pn++],mt[Pt]=(Et[Kn]+Et[Ut+256>>0]+Et[xn+512>>0]>>16)-128,kt[Pt]=(Et[Kn+768>>0]+Et[Ut+1024>>0]+Et[xn+1280>>0]>>16)-128,bt[Pt]=(Et[Kn+1280>>0]+Et[Ut+1536>>0]+Et[xn+1792>>0]>>16)-128;er=or(mt,_,er,b,st),Vn=or(kt,$,Vn,tt,at),Rn=or(bt,$,Rn,tt,at),ir+=32}Nn+=8}if(ut>=0){var An=[];An[1]=ut+1,An[0]=(1<<ut+1)-1,En(An)}return en(65497),Buffer.from(dt)};function Un(wn){if(wn<=0&&(wn=1),wn>100&&(wn=100),Mt!=wn){var jn=0;wn<50?jn=Math.floor(5e3/wn):jn=Math.floor(200-wn*2),ln(jn),Mt=wn}}function nr(){var wn=new Date().getTime();s||(s=50),Jn(),gn(),dn(),$n(),Un(s),new Date().getTime()-wn}nr()}e.exports=a;function a(s,o){typeof o>"u"&&(o=50);var h=new i(o),g=h.encode(s,o);return{data:g,width:s.width,height:s.height}}}(encoder)),encoder.exports}var decoder={exports:{}},hasRequiredDecoder;function requireDecoder(){return hasRequiredDecoder||(hasRequiredDecoder=1,function(e){var i=function(){var s=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,h=799,g=3406,_=2276,$=1567,b=3784,tt=5793,st=2896;function at(){}function nt(mt,kt){for(var bt=0,vt=[],Et,Mt,At=16;At>0&&!mt[At-1];)At--;vt.push({children:[],index:0});var zt=vt[0],Vt;for(Et=0;Et<At;Et++){for(Mt=0;Mt<mt[Et];Mt++){for(zt=vt.pop(),zt.children[zt.index]=kt[bt];zt.index>0;){if(vt.length===0)throw new Error("Could not recreate Huffman Table");zt=vt.pop()}for(zt.index++,vt.push(zt);vt.length<=Et;)vt.push(Vt={children:[],index:0}),zt.children[zt.index]=Vt.children,zt=Vt;bt++}Et+1<At&&(vt.push(Vt={children:[],index:0}),zt.children[zt.index]=Vt.children,zt=Vt)}return vt[0].children}function lt(mt,kt,bt,vt,Et,Mt,At,zt,Vt,Gt){bt.precision,bt.samplesPerLine,bt.scanLines;var Kt=bt.mcusPerLine,Wt=bt.progressive;bt.maxH,bt.maxV;var sn=kt,on=0,Xt=0;function ln(){if(Xt>0)return Xt--,on>>Xt&1;if(on=mt[kt++],on==255){var Hn=mt[kt++];if(Hn)throw new Error("unexpected marker: "+(on<<8|Hn).toString(16))}return Xt=7,on>>>7}function nn(Hn){for(var Fn=Hn,qn;(qn=ln())!==null;){if(Fn=Fn[qn],typeof Fn=="number")return Fn;if(typeof Fn!="object")throw new Error("invalid huffman sequence")}return null}function gn(Hn){for(var Fn=0;Hn>0;){var qn=ln();if(qn===null)return;Fn=Fn<<1|qn,Hn--}return Fn}function dn(Hn){var Fn=gn(Hn);return Fn>=1<<Hn-1?Fn:Fn+(-1<<Hn)+1}function $n(Hn,Fn){var qn=nn(Hn.huffmanTableDC),ir=qn===0?0:dn(qn);Fn[0]=Hn.pred+=ir;for(var Nn=1;Nn<64;){var Kn=nn(Hn.huffmanTableAC),Ut=Kn&15,xn=Kn>>4;if(Ut===0){if(xn<15)break;Nn+=16;continue}Nn+=xn;var kn=s[Nn];Fn[kn]=dn(Ut),Nn++}}function En(Hn,Fn){var qn=nn(Hn.huffmanTableDC),ir=qn===0?0:dn(qn)<<Vt;Fn[0]=Hn.pred+=ir}function qt(Hn,Fn){Fn[0]|=ln()<<Vt}var en=0;function Tn(Hn,Fn){if(en>0){en--;return}for(var qn=Mt,ir=At;qn<=ir;){var Nn=nn(Hn.huffmanTableAC),Kn=Nn&15,Ut=Nn>>4;if(Kn===0){if(Ut<15){en=gn(Ut)+(1<<Ut)-1;break}qn+=16;continue}qn+=Ut;var xn=s[qn];Fn[xn]=dn(Kn)*(1<<Vt),qn++}}var Sn=0,fn;function Wn(Hn,Fn){for(var qn=Mt,ir=At,Nn=0;qn<=ir;){var Kn=s[qn],Ut=Fn[Kn]<0?-1:1;switch(Sn){case 0:var xn=nn(Hn.huffmanTableAC),kn=xn&15,Nn=xn>>4;if(kn===0)Nn<15?(en=gn(Nn)+(1<<Nn),Sn=4):(Nn=16,Sn=1);else{if(kn!==1)throw new Error("invalid ACn encoding");fn=dn(kn),Sn=Nn?2:3}continue;case 1:case 2:Fn[Kn]?Fn[Kn]+=(ln()<<Vt)*Ut:(Nn--,Nn===0&&(Sn=Sn==2?3:0));break;case 3:Fn[Kn]?Fn[Kn]+=(ln()<<Vt)*Ut:(Fn[Kn]=fn<<Vt,Sn=0);break;case 4:Fn[Kn]&&(Fn[Kn]+=(ln()<<Vt)*Ut);break}qn++}Sn===4&&(en--,en===0&&(Sn=0))}function Zn(Hn,Fn,qn,ir,Nn){var Kn=qn/Kt|0,Ut=qn%Kt,xn=Kn*Hn.v+ir,kn=Ut*Hn.h+Nn;Hn.blocks[xn]===void 0&&Gt.tolerantDecoding||Fn(Hn,Hn.blocks[xn][kn])}function Gn(Hn,Fn,qn){var ir=qn/Hn.blocksPerLine|0,Nn=qn%Hn.blocksPerLine;Hn.blocks[ir]===void 0&&Gt.tolerantDecoding||Fn(Hn,Hn.blocks[ir][Nn])}var zn=vt.length,Bn,or,Jn,Un,nr,wn;Wt?Mt===0?wn=zt===0?En:qt:wn=zt===0?Tn:Wn:wn=$n;var jn=0,er,Vn;zn==1?Vn=vt[0].blocksPerLine*vt[0].blocksPerColumn:Vn=Kt*bt.mcusPerColumn,Et||(Et=Vn);for(var Rn,ar;jn<Vn;){for(or=0;or<zn;or++)vt[or].pred=0;if(en=0,zn==1)for(Bn=vt[0],nr=0;nr<Et;nr++)Gn(Bn,wn,jn),jn++;else for(nr=0;nr<Et;nr++){for(or=0;or<zn;or++)for(Bn=vt[or],Rn=Bn.h,ar=Bn.v,Jn=0;Jn<ar;Jn++)for(Un=0;Un<Rn;Un++)Zn(Bn,wn,jn,Jn,Un);if(jn++,jn===Vn)break}if(jn===Vn)do{if(mt[kt]===255&&mt[kt+1]!==0)break;kt+=1}while(kt<mt.length-2);if(Xt=0,er=mt[kt]<<8|mt[kt+1],er<65280)throw new Error("marker was not found");if(er>=65488&&er<=65495)kt+=2;else break}return kt-sn}function ft(mt,kt){var bt=[],vt=kt.blocksPerLine,Et=kt.blocksPerColumn,Mt=vt<<3,At=new Int32Array(64),zt=new Uint8Array(64);function Vt(gn,dn,$n){var En=kt.quantizationTable,qt,en,Tn,Sn,fn,Wn,Zn,Gn,zn,Bn=$n,or;for(or=0;or<64;or++)Bn[or]=gn[or]*En[or];for(or=0;or<8;++or){var Jn=8*or;if(Bn[1+Jn]==0&&Bn[2+Jn]==0&&Bn[3+Jn]==0&&Bn[4+Jn]==0&&Bn[5+Jn]==0&&Bn[6+Jn]==0&&Bn[7+Jn]==0){zn=tt*Bn[0+Jn]+512>>10,Bn[0+Jn]=zn,Bn[1+Jn]=zn,Bn[2+Jn]=zn,Bn[3+Jn]=zn,Bn[4+Jn]=zn,Bn[5+Jn]=zn,Bn[6+Jn]=zn,Bn[7+Jn]=zn;continue}qt=tt*Bn[0+Jn]+128>>8,en=tt*Bn[4+Jn]+128>>8,Tn=Bn[2+Jn],Sn=Bn[6+Jn],fn=st*(Bn[1+Jn]-Bn[7+Jn])+128>>8,Gn=st*(Bn[1+Jn]+Bn[7+Jn])+128>>8,Wn=Bn[3+Jn]<<4,Zn=Bn[5+Jn]<<4,zn=qt-en+1>>1,qt=qt+en+1>>1,en=zn,zn=Tn*b+Sn*$+128>>8,Tn=Tn*$-Sn*b+128>>8,Sn=zn,zn=fn-Zn+1>>1,fn=fn+Zn+1>>1,Zn=zn,zn=Gn+Wn+1>>1,Wn=Gn-Wn+1>>1,Gn=zn,zn=qt-Sn+1>>1,qt=qt+Sn+1>>1,Sn=zn,zn=en-Tn+1>>1,en=en+Tn+1>>1,Tn=zn,zn=fn*_+Gn*g+2048>>12,fn=fn*g-Gn*_+2048>>12,Gn=zn,zn=Wn*h+Zn*o+2048>>12,Wn=Wn*o-Zn*h+2048>>12,Zn=zn,Bn[0+Jn]=qt+Gn,Bn[7+Jn]=qt-Gn,Bn[1+Jn]=en+Zn,Bn[6+Jn]=en-Zn,Bn[2+Jn]=Tn+Wn,Bn[5+Jn]=Tn-Wn,Bn[3+Jn]=Sn+fn,Bn[4+Jn]=Sn-fn}for(or=0;or<8;++or){var Un=or;if(Bn[8+Un]==0&&Bn[16+Un]==0&&Bn[24+Un]==0&&Bn[32+Un]==0&&Bn[40+Un]==0&&Bn[48+Un]==0&&Bn[56+Un]==0){zn=tt*$n[or+0]+8192>>14,Bn[0+Un]=zn,Bn[8+Un]=zn,Bn[16+Un]=zn,Bn[24+Un]=zn,Bn[32+Un]=zn,Bn[40+Un]=zn,Bn[48+Un]=zn,Bn[56+Un]=zn;continue}qt=tt*Bn[0+Un]+2048>>12,en=tt*Bn[32+Un]+2048>>12,Tn=Bn[16+Un],Sn=Bn[48+Un],fn=st*(Bn[8+Un]-Bn[56+Un])+2048>>12,Gn=st*(Bn[8+Un]+Bn[56+Un])+2048>>12,Wn=Bn[24+Un],Zn=Bn[40+Un],zn=qt-en+1>>1,qt=qt+en+1>>1,en=zn,zn=Tn*b+Sn*$+2048>>12,Tn=Tn*$-Sn*b+2048>>12,Sn=zn,zn=fn-Zn+1>>1,fn=fn+Zn+1>>1,Zn=zn,zn=Gn+Wn+1>>1,Wn=Gn-Wn+1>>1,Gn=zn,zn=qt-Sn+1>>1,qt=qt+Sn+1>>1,Sn=zn,zn=en-Tn+1>>1,en=en+Tn+1>>1,Tn=zn,zn=fn*_+Gn*g+2048>>12,fn=fn*g-Gn*_+2048>>12,Gn=zn,zn=Wn*h+Zn*o+2048>>12,Wn=Wn*o-Zn*h+2048>>12,Zn=zn,Bn[0+Un]=qt+Gn,Bn[56+Un]=qt-Gn,Bn[8+Un]=en+Zn,Bn[48+Un]=en-Zn,Bn[16+Un]=Tn+Wn,Bn[40+Un]=Tn-Wn,Bn[24+Un]=Sn+fn,Bn[32+Un]=Sn-fn}for(or=0;or<64;++or){var nr=128+(Bn[or]+8>>4);dn[or]=nr<0?0:nr>255?255:nr}}ut(Mt*Et*8);for(var Gt,Kt,Wt=0;Wt<Et;Wt++){var sn=Wt<<3;for(Gt=0;Gt<8;Gt++)bt.push(new Uint8Array(Mt));for(var on=0;on<vt;on++){Vt(kt.blocks[Wt][on],zt,At);var Xt=0,ln=on<<3;for(Kt=0;Kt<8;Kt++){var nn=bt[sn+Kt];for(Gt=0;Gt<8;Gt++)nn[ln+Gt]=zt[Xt++]}}}return bt}function pt(mt){return mt<0?0:mt>255?255:mt}at.prototype={load:function(mt){var kt=new XMLHttpRequest;kt.open("GET",mt,!0),kt.responseType="arraybuffer",kt.onload=(function(){var bt=new Uint8Array(kt.response||kt.mozResponseArrayBuffer);this.parse(bt),this.onload&&this.onload()}).bind(this),kt.send(null)},parse:function(mt){var kt=this.opts.maxResolutionInMP*1e3*1e3,bt=0;mt.length;function vt(){var Kn=mt[bt]<<8|mt[bt+1];return bt+=2,Kn}function Et(){var Kn=vt(),Ut=mt.subarray(bt,bt+Kn-2);return bt+=Ut.length,Ut}function Mt(Kn){var Ut=1,xn=1,kn,Pn;for(Pn in Kn.components)Kn.components.hasOwnProperty(Pn)&&(kn=Kn.components[Pn],Ut<kn.h&&(Ut=kn.h),xn<kn.v&&(xn=kn.v));var tn=Math.ceil(Kn.samplesPerLine/8/Ut),vn=Math.ceil(Kn.scanLines/8/xn);for(Pn in Kn.components)if(Kn.components.hasOwnProperty(Pn)){kn=Kn.components[Pn];var Pt=Math.ceil(Math.ceil(Kn.samplesPerLine/8)*kn.h/Ut),An=Math.ceil(Math.ceil(Kn.scanLines/8)*kn.v/xn),sr=tn*kn.h,wt=vn*kn.v,mn=wt*sr,yn=[];ut(mn*256);for(var Ft=0;Ft<wt;Ft++){for(var Qt=[],cn=0;cn<sr;cn++)Qt.push(new Int32Array(64));yn.push(Qt)}kn.blocksPerLine=Pt,kn.blocksPerColumn=An,kn.blocks=yn}Kn.maxH=Ut,Kn.maxV=xn,Kn.mcusPerLine=tn,Kn.mcusPerColumn=vn}var At=null,zt=null,Vt,Gt,Kt=[],Wt=[],sn=[],on=[],Xt=vt(),ln=-1;if(this.comments=[],Xt!=65496)throw new Error("SOI not found");for(Xt=vt();Xt!=65497;){var nn,gn;switch(Xt){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var dn=Et();if(Xt===65534){var $n=String.fromCharCode.apply(null,dn);this.comments.push($n)}Xt===65504&&dn[0]===74&&dn[1]===70&&dn[2]===73&&dn[3]===70&&dn[4]===0&&(At={version:{major:dn[5],minor:dn[6]},densityUnits:dn[7],xDensity:dn[8]<<8|dn[9],yDensity:dn[10]<<8|dn[11],thumbWidth:dn[12],thumbHeight:dn[13],thumbData:dn.subarray(14,14+3*dn[12]*dn[13])}),Xt===65505&&dn[0]===69&&dn[1]===120&&dn[2]===105&&dn[3]===102&&dn[4]===0&&(this.exifBuffer=dn.subarray(5,dn.length)),Xt===65518&&dn[0]===65&&dn[1]===100&&dn[2]===111&&dn[3]===98&&dn[4]===101&&dn[5]===0&&(zt={version:dn[6],flags0:dn[7]<<8|dn[8],flags1:dn[9]<<8|dn[10],transformCode:dn[11]});break;case 65499:for(var En=vt(),qt=En+bt-2;bt<qt;){var en=mt[bt++];ut(256);var Tn=new Int32Array(64);if(en>>4)if(en>>4===1)for(gn=0;gn<64;gn++){var Sn=s[gn];Tn[Sn]=vt()}else throw new Error("DQT: invalid table spec");else for(gn=0;gn<64;gn++){var Sn=s[gn];Tn[Sn]=mt[bt++]}Kt[en&15]=Tn}break;case 65472:case 65473:case 65474:vt(),Vt={},Vt.extended=Xt===65473,Vt.progressive=Xt===65474,Vt.precision=mt[bt++],Vt.scanLines=vt(),Vt.samplesPerLine=vt(),Vt.components={},Vt.componentsOrder=[];var fn=Vt.scanLines*Vt.samplesPerLine;if(fn>kt){var Wn=Math.ceil((fn-kt)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${Wn}MP`)}var Zn=mt[bt++],Gn;for(nn=0;nn<Zn;nn++){Gn=mt[bt];var zn=mt[bt+1]>>4,Bn=mt[bt+1]&15,or=mt[bt+2];if(zn<=0||Bn<=0)throw new Error("Invalid sampling factor, expected values above 0");Vt.componentsOrder.push(Gn),Vt.components[Gn]={h:zn,v:Bn,quantizationIdx:or},bt+=3}Mt(Vt),Wt.push(Vt);break;case 65476:var Jn=vt();for(nn=2;nn<Jn;){var Un=mt[bt++],nr=new Uint8Array(16),wn=0;for(gn=0;gn<16;gn++,bt++)wn+=nr[gn]=mt[bt];ut(16+wn);var jn=new Uint8Array(wn);for(gn=0;gn<wn;gn++,bt++)jn[gn]=mt[bt];nn+=17+wn,(Un>>4?sn:on)[Un&15]=nt(nr,jn)}break;case 65501:vt(),Gt=vt();break;case 65500:vt(),vt();break;case 65498:vt();var er=mt[bt++],Vn=[],Rn;for(nn=0;nn<er;nn++){Rn=Vt.components[mt[bt++]];var ar=mt[bt++];Rn.huffmanTableDC=on[ar>>4],Rn.huffmanTableAC=sn[ar&15],Vn.push(Rn)}var Hn=mt[bt++],Fn=mt[bt++],qn=mt[bt++],ir=lt(mt,bt,Vt,Vn,Gt,Hn,Fn,qn>>4,qn&15,this.opts);bt+=ir;break;case 65535:mt[bt]!==255&&bt--;break;default:if(mt[bt-3]==255&&mt[bt-2]>=192&&mt[bt-2]<=254){bt-=3;break}else if(Xt===224||Xt==225){if(ln!==-1)throw new Error(`first unknown JPEG marker at offset ${ln.toString(16)}, second unknown JPEG marker ${Xt.toString(16)} at offset ${(bt-1).toString(16)}`);ln=bt-1;const Kn=vt();if(mt[bt+Kn-2]===255){bt+=Kn-2;break}}throw new Error("unknown JPEG marker "+Xt.toString(16))}Xt=vt()}if(Wt.length!=1)throw new Error("only single frame JPEGs supported");for(var nn=0;nn<Wt.length;nn++){var Nn=Wt[nn].components;for(var gn in Nn)Nn[gn].quantizationTable=Kt[Nn[gn].quantizationIdx],delete Nn[gn].quantizationIdx}this.width=Vt.samplesPerLine,this.height=Vt.scanLines,this.jfif=At,this.adobe=zt,this.components=[];for(var nn=0;nn<Vt.componentsOrder.length;nn++){var Rn=Vt.components[Vt.componentsOrder[nn]];this.components.push({lines:ft(Vt,Rn),scaleX:Rn.h/Vt.maxH,scaleY:Rn.v/Vt.maxV})}},getData:function(mt,kt){var bt=this.width/mt,vt=this.height/kt,Et,Mt,At,zt,Vt,Gt,Kt,Wt,sn,on,Xt=0,ln,nn,gn,dn,$n,En,qt,en,Tn,Sn,fn,Wn=mt*kt*this.components.length;ut(Wn);var Zn=new Uint8Array(Wn);switch(this.components.length){case 1:for(Et=this.components[0],on=0;on<kt;on++)for(Vt=Et.lines[0|on*Et.scaleY*vt],sn=0;sn<mt;sn++)ln=Vt[0|sn*Et.scaleX*bt],Zn[Xt++]=ln;break;case 2:for(Et=this.components[0],Mt=this.components[1],on=0;on<kt;on++)for(Vt=Et.lines[0|on*Et.scaleY*vt],Gt=Mt.lines[0|on*Mt.scaleY*vt],sn=0;sn<mt;sn++)ln=Vt[0|sn*Et.scaleX*bt],Zn[Xt++]=ln,ln=Gt[0|sn*Mt.scaleX*bt],Zn[Xt++]=ln;break;case 3:for(fn=!0,this.adobe&&this.adobe.transformCode?fn=!0:typeof this.opts.colorTransform<"u"&&(fn=!!this.opts.colorTransform),Et=this.components[0],Mt=this.components[1],At=this.components[2],on=0;on<kt;on++)for(Vt=Et.lines[0|on*Et.scaleY*vt],Gt=Mt.lines[0|on*Mt.scaleY*vt],Kt=At.lines[0|on*At.scaleY*vt],sn=0;sn<mt;sn++)fn?(ln=Vt[0|sn*Et.scaleX*bt],nn=Gt[0|sn*Mt.scaleX*bt],gn=Kt[0|sn*At.scaleX*bt],en=pt(ln+1.402*(gn-128)),Tn=pt(ln-.3441363*(nn-128)-.71413636*(gn-128)),Sn=pt(ln+1.772*(nn-128))):(en=Vt[0|sn*Et.scaleX*bt],Tn=Gt[0|sn*Mt.scaleX*bt],Sn=Kt[0|sn*At.scaleX*bt]),Zn[Xt++]=en,Zn[Xt++]=Tn,Zn[Xt++]=Sn;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(fn=!1,this.adobe&&this.adobe.transformCode?fn=!0:typeof this.opts.colorTransform<"u"&&(fn=!!this.opts.colorTransform),Et=this.components[0],Mt=this.components[1],At=this.components[2],zt=this.components[3],on=0;on<kt;on++)for(Vt=Et.lines[0|on*Et.scaleY*vt],Gt=Mt.lines[0|on*Mt.scaleY*vt],Kt=At.lines[0|on*At.scaleY*vt],Wt=zt.lines[0|on*zt.scaleY*vt],sn=0;sn<mt;sn++)fn?(ln=Vt[0|sn*Et.scaleX*bt],nn=Gt[0|sn*Mt.scaleX*bt],gn=Kt[0|sn*At.scaleX*bt],dn=Wt[0|sn*zt.scaleX*bt],$n=255-pt(ln+1.402*(gn-128)),En=255-pt(ln-.3441363*(nn-128)-.71413636*(gn-128)),qt=255-pt(ln+1.772*(nn-128))):($n=Vt[0|sn*Et.scaleX*bt],En=Gt[0|sn*Mt.scaleX*bt],qt=Kt[0|sn*At.scaleX*bt],dn=Wt[0|sn*zt.scaleX*bt]),Zn[Xt++]=255-$n,Zn[Xt++]=255-En,Zn[Xt++]=255-qt,Zn[Xt++]=255-dn;break;default:throw new Error("Unsupported color mode")}return Zn},copyToImageData:function(mt,kt){var bt=mt.width,vt=mt.height,Et=mt.data,Mt=this.getData(bt,vt),At=0,zt=0,Vt,Gt,Kt,Wt,sn,on,Xt,ln,nn;switch(this.components.length){case 1:for(Gt=0;Gt<vt;Gt++)for(Vt=0;Vt<bt;Vt++)Kt=Mt[At++],Et[zt++]=Kt,Et[zt++]=Kt,Et[zt++]=Kt,kt&&(Et[zt++]=255);break;case 3:for(Gt=0;Gt<vt;Gt++)for(Vt=0;Vt<bt;Vt++)Xt=Mt[At++],ln=Mt[At++],nn=Mt[At++],Et[zt++]=Xt,Et[zt++]=ln,Et[zt++]=nn,kt&&(Et[zt++]=255);break;case 4:for(Gt=0;Gt<vt;Gt++)for(Vt=0;Vt<bt;Vt++)sn=Mt[At++],on=Mt[At++],Kt=Mt[At++],Wt=Mt[At++],Xt=255-pt(sn*(1-Wt/255)+Wt),ln=255-pt(on*(1-Wt/255)+Wt),nn=255-pt(Kt*(1-Wt/255)+Wt),Et[zt++]=Xt,Et[zt++]=ln,Et[zt++]=nn,kt&&(Et[zt++]=255);break;default:throw new Error("Unsupported color mode")}}};var dt=0,_t=0;function ut(mt=0){var kt=dt+mt;if(kt>_t){var bt=Math.ceil((kt-_t)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${bt}MB`)}dt=kt}return at.resetMaxMemoryUsage=function(mt){dt=0,_t=mt},at.getBytesAllocated=function(){return dt},at.requestMemoryAllocation=ut,at}();e.exports=a;function a(s,o={}){var h={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},g={...h,...o},_=new Uint8Array(s),$=new i;$.opts=g,i.resetMaxMemoryUsage(g.maxMemoryUsageInMB*1024*1024),$.parse(_);var b=g.formatAsRGBA?4:3,tt=$.width*$.height*b;try{i.requestMemoryAllocation(tt);var st={width:$.width,height:$.height,exifBuffer:$.exifBuffer,data:g.useTArray?new Uint8Array(tt):Buffer.alloc(tt)};$.comments.length>0&&(st.comments=$.comments)}catch(at){throw at instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+tt):at instanceof ReferenceError&&at.message==="Buffer is not defined"?new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true"):at}return $.copyToImageData(st,g.formatAsRGBA),st}}(decoder)),decoder.exports}var jpegJs,hasRequiredJpegJs;function requireJpegJs(){if(hasRequiredJpegJs)return jpegJs;hasRequiredJpegJs=1;var e=requireEncoder(),i=requireDecoder();return jpegJs={encode:e,decode:i},jpegJs}var jpegJsExports=requireJpegJs();const jpeg=getDefaultExportFromCjs(jpegJsExports);let chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256);for(let e=0;e<chars.length;e++)lookup[chars.charCodeAt(e)]=e;function encode(e){let i,a=e.length,s="";for(i=0;i<a;i+=3)s+=chars[e[i]>>2],s+=chars[(e[i]&3)<<4|e[i+1]>>4],s+=chars[(e[i+1]&15)<<2|e[i+2]>>6],s+=chars[e[i+2]&63];return a%3===2?s=`${s.substring(0,s.length-1)}=`:a%3===1&&(s=`${s.substring(0,s.length-2)}==`),s}function decode$1(e){let i=e.length*.75,a=e.length,s=0,o,h,g,_;e[e.length-1]==="="&&(i--,e[e.length-2]==="="&&i--);const $=new Uint8Array(i);for(let b=0;b<a;b+=4)o=lookup[e.charCodeAt(b)],h=lookup[e.charCodeAt(b+1)],g=lookup[e.charCodeAt(b+2)],_=lookup[e.charCodeAt(b+3)],$[s++]=o<<2|h>>4,$[s++]=(h&15)<<4|g>>2,$[s++]=(g&3)<<6|_&63;return $}function toBase64URL(e,i){const a=encode(e);return`data:${i};base64,${a}`}const ImageData$1=self.ImageData,DOMImage=self.Image;function createCanvas(e,i){let a=self.document.createElement("canvas");return a.width=e,a.height=i,a}function fetchBinary(e,{withCredentials:i=!1}={}){return new Promise(function(a,s){let o=new self.XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.withCredentials=i,o.onload=function(h){this.status!==200?s(h):a(this.response)},o.onerror=s,o.send()})}function createWriteStream(){throw new Error("createWriteStream does not exist in the browser")}function writeFile(){throw new Error("writeFile does not exist in the browser")}function getType(e){return e.includes("/")||(e=`image/${e}`),e}function encodeJpeg(e,i={}){const a={width:e.width,height:e.height,data:e.getRGBAData()};return jpegJsExports.encode(a,i.quality).data}function encodePng(e,i){const a={width:e.width,height:e.height,channels:e.channels,depth:e.bitDepth,data:e.data};return(a.depth===1||a.depth===32)&&(a.depth=8,a.channels=4,a.data=e.getRGBAData()),encodePng$1(a,i)}const exportMethods={save(e,i={}){const{useCanvas:a=!1,encoder:s=void 0}=i;let{format:o}=i;if(!o){const h=/\.(?<format>[a-zA-Z]+)$/.exec(e);h&&(o=h.groups.format.toLowerCase())}if(!o)throw new Error("file format not provided");return new Promise((h,g)=>{let _,$;switch(o.toLowerCase()){case"png":{a?_=this.getCanvas().pngStream():$=encodePng(this,s);break}case"jpg":case"jpeg":a?_=this.getCanvas().jpegStream():$=encodeJpeg(this,s);break;case"bmp":$=srcExports$3.encode(this,s);break;default:throw new RangeError(`invalid output format: ${o}`)}if(_){let b=createWriteStream();b.on("finish",h),b.on("error",g),_.pipe(b)}else $&&writeFile()})},toDataURL(e="image/png",i={}){typeof e=="object"&&(i=e,e="image/png");const{useCanvas:a=!1,encoder:s=void 0}=i;e=getType(e);function o(h,g){const _=h(g,s);return toBase64URL(_,e)}return e==="image/bmp"?o(srcExports$3.encode,this):e==="image/png"&&!a?o(encodePng,this):e==="image/jpeg"&&!a?o(encodeJpeg,this):this.getCanvas().toDataURL(e)},toBuffer(e={}){const{format:i="png",encoder:a=void 0}=e;switch(i.toLowerCase()){case"png":return encodePng(this,a);case"jpeg":case"jpg":return encodeJpeg(this,a);case"bmp":return srcExports$3.encode(this,a);default:throw new RangeError(`invalid output format: ${i}`)}},toBase64(e="image/png",i={}){if(i.async)return this.toDataURL(e,i).then(function(a){return a.substring(a.indexOf(",")+1)});{const a=this.toDataURL(e,i);return a.substring(a.indexOf(",")+1)}},toBlob(e="image/png",i=.8){return canvasToBlob(this.getCanvas(),e,i)},getCanvas(){const e=new ImageData$1(this.getRGBAData({clamped:!0}),this.width,this.height);let i=createCanvas(this.width,this.height);return i.getContext("2d").putImageData(e,0,0),i}};function setExportMethods(e){for(const i in exportMethods)e.prototype[i]=exportMethods[i]}var hasOwn$1={exports:{}};const version$1="1.0.1",require$$0$2={version:version$1};var hasRequiredHasOwn;function requireHasOwn(){return hasRequiredHasOwn||(hasRequiredHasOwn=1,function(e,i){var a=Object.prototype.hasOwnProperty;e.exports=i=function(s,o){return a.call(o,s)},i.version=require$$0$2.version}(hasOwn$1,hasOwn$1.exports)),hasOwn$1.exports}var hasOwnExports=requireHasOwn();const hasOwn=getDefaultExportFromCjs(hasOwnExports);let computedPropertyDescriptor$1={configurable:!0,enumerable:!1,get:void 0};function extendMethod(e,i,a={}){let{inPlace:s=!1,returnThis:o=!0,partialArgs:h=[]}=a;return s?Image$1.prototype[e]=function(...g){this.computed=null;let _=i.apply(this,[...h,...g]);return o?this:_}:Image$1.prototype[e]=function(...g){return i.apply(this,[...h,...g])},Image$1}function extendProperty(e,i,a={}){let{partialArgs:s=[]}=a;return computedPropertyDescriptor$1.get=function(){if(this.computed===null)this.computed={};else if(hasOwn(e,this.computed))return this.computed[e];let o=i.apply(this,s);return this.computed[e]=o,o},Object.defineProperty(Image$1.prototype,e,computedPropertyDescriptor$1),Image$1}const GREY$1="GREY",RGB$1="RGB",HSL="HSL",HSV="HSV",CMYK$1="CMYK",ColorModel=Object.freeze(Object.defineProperty({__proto__:null,CMYK:CMYK$1,GREY:GREY$1,HSL,HSV,RGB:RGB$1},Symbol.toStringTag,{value:"Module"}));function getRGBAData(e={}){const{clamped:i}=e;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const a=this.width*this.height*4;let s=i?new Uint8ClampedArray(a):new Uint8Array(a);return this.bitDepth===1?fillDataFromBinary(this,s):this.bitDepth===32?(this.checkProcessable("getRGBAData",{alpha:0}),this.components===1?fillDataFromGrey32(this,s):this.components===3&&(this.checkProcessable("getRGBAData",{colorModel:[RGB$1]}),fillDataFromRGB32(this,s))):this.components===1?fillDataFromGrey(this,s):this.components===3&&(this.checkProcessable("getRGBAData",{colorModel:[RGB$1]}),fillDataFromRGB(this,s)),this.alpha===1?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),copyAlpha(this,s)):fillAlpha(this,s),s}function fillDataFromBinary(e,i){for(let a=0;a<e.size;a++){const s=e.getBit(a);i[a*4]=s*255,i[a*4+1]=s*255,i[a*4+2]=s*255}}function fillDataFromGrey32(e,i){const a=e.min[0],s=e.max[0]-a;for(let o=0;o<e.size;o++){const h=Math.floor(255*(e.data[o]-a)/s);i[o*4]=h,i[o*4+1]=h,i[o*4+2]=h}}function fillDataFromRGB32(e,i){const a=Math.min(...e.min),s=Math.max(...e.max)-a;for(let o=0;o<e.size;o++){const h=Math.floor(255*(e.data[o*3]-a)/s),g=Math.floor(255*(e.data[o*3+1]-a)/s),_=Math.floor(255*(e.data[o*3+2]-a)/s);i[o*4]=h,i[o*4+1]=g,i[o*4+2]=_}}function fillDataFromGrey(e,i){for(let a=0;a<e.size;a++)i[a*4]=e.data[a*e.channels]>>>e.bitDepth-8,i[a*4+1]=e.data[a*e.channels]>>>e.bitDepth-8,i[a*4+2]=e.data[a*e.channels]>>>e.bitDepth-8}function fillDataFromRGB(e,i){for(let a=0;a<e.size;a++)i[a*4]=e.data[a*e.channels]>>>e.bitDepth-8,i[a*4+1]=e.data[a*e.channels+1]>>>e.bitDepth-8,i[a*4+2]=e.data[a*e.channels+2]>>>e.bitDepth-8}function copyAlpha(e,i){for(let a=0;a<e.size;a++)i[a*4+3]=e.data[a*e.channels+e.components]>>e.bitDepth-8}function fillAlpha(e,i){for(let a=0;a<e.size;a++)i[a*4+3]=255}const BINARY="BINARY",GREY="GREY",GREYA="GREYA",RGB="RGB",RGBA="RGBA",CMYK="CMYK",CMYKA="CMYKA",kinds={};kinds[BINARY]={components:1,alpha:0,bitDepth:1,colorModel:GREY$1};kinds[GREYA]={components:1,alpha:1,bitDepth:8,colorModel:GREY$1};kinds[GREY]={components:1,alpha:0,bitDepth:8,colorModel:GREY$1};kinds[RGBA]={components:3,alpha:1,bitDepth:8,colorModel:RGB$1};kinds[RGB]={components:3,alpha:0,bitDepth:8,colorModel:RGB$1};kinds[CMYK]={components:4,alpha:0,bitDepth:8,colorModel:CMYK$1};kinds[CMYKA]={components:4,alpha:1,bitDepth:8,colorModel:CMYK$1};function getKind(e){const i=kinds[e];if(!i)throw new RangeError(`invalid image kind: ${e}`);return i}const validBitDepth=[1,8,16,32];function verifyKindDefinition(e){const{components:i,alpha:a,bitDepth:s,colorModel:o}=e;if(!Number.isInteger(i)||i<=0)throw new RangeError(`invalid components: ${i}. Must be a positive integer`);if(a!==0&&a!==1&&typeof a!="boolean")throw new TypeError(`invalid alpha: ${a}: must be a boolean, 0 or 1`);if(!validBitDepth.includes(s))throw new RangeError(`invalid bitDepth: ${s}. Must be one of ${validBitDepth.join(", ")}`);if(!ColorModel[o])throw new RangeError(`invalid colorModel: ${o}. Must be one of ${Object.keys(ColorModel).join(", ")}`)}function getTheoreticalPixelArraySize(e,i,a){let s=i*e;return a===1&&(s=Math.ceil(s/8)),s}function createPixelArray(e,i,a,s,o,h){const g=s*e;let _;switch(o){case 1:_=new Uint8Array(Math.ceil(g/8));break;case 8:_=new Uint8Array(g);break;case 16:_=new Uint16Array(g);break;case 32:_=new Float32Array(g);break;default:throw new Error(`Cannot create pixel array for bit depth ${o}`)}if(a)for(let $=i;$<_.length;$+=s)_[$]=h;return _}var src$4={},IOBuffer_1,hasRequiredIOBuffer;function requireIOBuffer(){if(hasRequiredIOBuffer)return IOBuffer_1;hasRequiredIOBuffer=1;const e=1024*8,i=[];class a{constructor(o,h){h=h||{},o===void 0&&(o=e),typeof o=="number"&&(o=new ArrayBuffer(o));let g=o.byteLength;const _=h.offset?h.offset>>>0:0;o.buffer&&(g=o.byteLength-_,o.byteLength!==o.buffer.byteLength?o=o.buffer.slice(o.byteOffset+_,o.byteOffset+o.byteLength):_?o=o.buffer.slice(_):o=o.buffer),this.buffer=o,this.length=g,this.byteLength=g,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=g||e,this._mark=0}available(o){return o===void 0&&(o=1),this.offset+o<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(o){o===void 0&&(o=1),this.offset+=o}seek(o){this.offset=o}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(o){if(o===void 0&&(o=1),!this.available(o)){const h=this._increment+this._increment;this._increment=h;const g=this.length+h,_=new Uint8Array(g);_.set(new Uint8Array(this.buffer)),this.buffer=_.buffer,this.length=g,this._data=new DataView(this.buffer)}}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(o){o===void 0&&(o=1);for(var h=new Uint8Array(o),g=0;g<o;g++)h[g]=this.readByte();return h}readInt16(){var o=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,o}readUint16(){var o=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,o}readInt32(){var o=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,o}readUint32(){var o=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,o}readFloat32(){var o=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,o}readFloat64(){var o=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,o}readChar(){return String.fromCharCode(this.readInt8())}readChars(o){o===void 0&&(o=1),i.length=o;for(var h=0;h<o;h++)i[h]=this.readChar();return i.join("")}writeBoolean(o){this.writeUint8(o?255:0)}writeInt8(o){this.ensureAvailable(1),this._data.setInt8(this.offset++,o)}writeUint8(o){this.ensureAvailable(1),this._data.setUint8(this.offset++,o)}writeByte(o){this.writeUint8(o)}writeBytes(o){this.ensureAvailable(o.length);for(var h=0;h<o.length;h++)this._data.setUint8(this.offset++,o[h])}writeInt16(o){this.ensureAvailable(2),this._data.setInt16(this.offset,o,this.littleEndian),this.offset+=2}writeUint16(o){this.ensureAvailable(2),this._data.setUint16(this.offset,o,this.littleEndian),this.offset+=2}writeInt32(o){this.ensureAvailable(4),this._data.setInt32(this.offset,o,this.littleEndian),this.offset+=4}writeUint32(o){this.ensureAvailable(4),this._data.setUint32(this.offset,o,this.littleEndian),this.offset+=4}writeFloat32(o){this.ensureAvailable(4),this._data.setFloat32(this.offset,o,this.littleEndian),this.offset+=4}writeFloat64(o){this.ensureAvailable(8),this._data.setFloat64(this.offset,o,this.littleEndian),this.offset+=8}writeChar(o){this.writeUint8(o.charCodeAt(0))}writeChars(o){for(var h=0;h<o.length;h++)this.writeUint8(o.charCodeAt(h))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}return IOBuffer_1=a,IOBuffer_1}var src$3={},standard$1,hasRequiredStandard;function requireStandard(){if(hasRequiredStandard)return standard$1;hasRequiredStandard=1;const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},i={};for(var a in e)i[e[a]]=a;return standard$1={tagsById:e,tagsByName:i},standard$1}var exif$1,hasRequiredExif;function requireExif(){if(hasRequiredExif)return exif$1;hasRequiredExif=1;const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},i={};for(var a in e)i[e[a]]=a;return exif$1={tagsById:e,tagsByName:i},exif$1}var gps$1,hasRequiredGps;function requireGps(){if(hasRequiredGps)return gps$1;hasRequiredGps=1;const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},i={};for(var a in e)i[e[a]]=a;return gps$1={tagsById:e,tagsByName:i},gps$1}var ifd,hasRequiredIfd;function requireIfd(){if(hasRequiredIfd)return ifd;hasRequiredIfd=1;const e={standard:requireStandard(),exif:requireExif(),gps:requireGps()};class i{constructor(s){if(!s)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=s,this._map=null}get(s){if(typeof s=="number")return this.fields.get(s);if(typeof s=="string")return this.fields.get(e[this.kind].tagsByName[s]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const o=e[this.kind].tagsById;for(var s of this.fields.keys())o[s]&&(this._map[o[s]]=this.fields.get(s))}return this._map}}return ifd=i,ifd}var tiffIfd,hasRequiredTiffIfd;function requireTiffIfd(){if(hasRequiredTiffIfd)return tiffIfd;hasRequiredTiffIfd=1;const e=requireIfd(),i=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class a extends e{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var h=new Date,g=i.exec(this.dateTime);return h.setFullYear(g[1],g[2]-1,g[3]),h.setHours(g[4],g[5],g[6]),h}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return s(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return s(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}function s(o){return typeof o=="number"?[o]:o}return tiffIfd=a,tiffIfd}var ifdValue={},hasRequiredIfdValue;function requireIfdValue(){if(hasRequiredIfdValue)return ifdValue;hasRequiredIfdValue=1;var e=new Map([[1,[1,i]],[2,[1,a]],[3,[2,s]],[4,[4,o]],[5,[8,h]],[6,[1,g]],[7,[1,i]],[8,[2,_]],[9,[4,$]],[10,[8,b]],[11,[4,tt]],[12,[8,st]]]);ifdValue.getByteLength=function(at,nt){return e.get(at)[0]*nt},ifdValue.readData=function(at,nt,lt){return e.get(nt)[1](at,lt)};function i(at,nt){if(nt===1)return at.readUint8();for(var lt=new Uint8Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readUint8();return lt}function a(at,nt){for(var lt=[],ft="",pt=0;pt<nt;pt++){var dt=String.fromCharCode(at.readUint8());dt==="\0"?(lt.push(ft),ft=""):ft+=dt}return lt.length===1?lt[0]:lt}function s(at,nt){if(nt===1)return at.readUint16();for(var lt=new Uint16Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readUint16();return lt}function o(at,nt){if(nt===1)return at.readUint32();for(var lt=new Uint32Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readUint32();return lt}function h(at,nt){if(nt===1)return at.readUint32()/at.readUint32();for(var lt=new Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readUint32()/at.readUint32();return lt}function g(at,nt){if(nt===1)return at.readInt8();for(var lt=new Int8Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readInt8();return lt}function _(at,nt){if(nt===1)return at.readInt16();for(var lt=new Int16Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readInt16();return lt}function $(at,nt){if(nt===1)return at.readInt32();for(var lt=new Int32Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readInt32();return lt}function b(at,nt){if(nt===1)return at.readInt32()/at.readInt32();for(var lt=new Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readInt32()/at.readInt32();return lt}function tt(at,nt){if(nt===1)return at.readFloat32();for(var lt=new Float32Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readFloat32();return lt}function st(at,nt){if(nt===1)return at.readFloat64();for(var lt=new Float64Array(nt),ft=0;ft<nt;ft++)lt[ft]=at.readFloat64();return lt}return ifdValue}var tiffDecoder,hasRequiredTiffDecoder;function requireTiffDecoder(){if(hasRequiredTiffDecoder)return tiffDecoder;hasRequiredTiffDecoder=1;const e=requireIOBuffer(),i=requireIfd(),a=requireTiffIfd(),s=requireIfdValue(),o={ignoreImageData:!1,onlyFirst:!1};class h extends e{constructor(nt,lt){super(nt,lt),this._nextIFD=0}decode(nt){nt=Object.assign({},o,nt);const lt=[];for(this.decodeHeader();this._nextIFD;)if(lt.push(this.decodeIFD(nt)),nt.onlyFirst)return lt[0];return lt}decodeHeader(){let nt=this.readUint16();if(nt===18761)this.setLittleEndian();else if(nt===19789)this.setBigEndian();else throw new Error("invalid byte order: 0x"+nt.toString(16));if(nt=this.readUint16(),nt!==42)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(nt){this.seek(this._nextIFD);var lt;nt.kind?lt=new i(nt.kind):lt=new a;const ft=this.readUint16();for(var pt=0;pt<ft;pt++)this.decodeIFDEntry(lt);return nt.ignoreImageData||this.decodeImageData(lt),this._nextIFD=this.readUint32(),lt}decodeIFDEntry(nt){const lt=this.offset,ft=this.readUint16(),pt=this.readUint16(),dt=this.readUint32();if(pt<1||pt>12){this.skip(4);return}s.getByteLength(pt,dt)>4&&this.seek(this.readUint32());const _t=s.readData(this,pt,dt);if(nt.fields.set(ft,_t),ft===34665||ft===34853){let ut=this.offset,mt;ft===34665?mt="exif":ft===34853&&(mt="gps"),this._nextIFD=_t,nt[mt]=this.decodeIFD({kind:mt,ignoreImageData:!0}),this.offset=ut}this.seek(lt),this.skip(12)}decodeImageData(nt){const lt=nt.orientation;switch(lt&&lt!==1&&tt("orientation",lt),nt.type){case 1:case 2:this.readStripData(nt);break;default:tt("image type",nt.type);break}}readStripData(nt){const lt=nt.width,ft=nt.height,pt=st(nt.bitsPerSample),dt=nt.sampleFormat;let _t=lt*ft;const ut=g(_t,1,pt,dt),mt=nt.compression,kt=nt.rowsPerStrip*lt,bt=nt.stripOffsets,vt=nt.stripByteCounts;for(var Et=0,Mt=0;Mt<bt.length;Mt++){var At=this.getStripData(mt,bt[Mt],vt[Mt]),zt=_t>kt?kt:_t;_t-=zt,pt===8?Et=_(ut,At,Et,zt):pt===16?Et=$(ut,At,Et,zt,this.isLittleEndian()):pt===32&&dt===3?Et=b(ut,At,Et,zt,this.isLittleEndian()):tt("bitDepth",pt)}nt.data=ut}getStripData(nt,lt,ft){switch(nt){case 1:return new DataView(this.buffer,lt,ft);case 2:case 32773:return tt("Compression",nt);default:throw new Error("invalid compression: "+nt)}}}tiffDecoder=h;function g(at,nt,lt,ft){return lt===8?new Uint8Array(at*nt):lt===16?new Uint16Array(at*nt):lt===32&&ft===3?new Float32Array(at*nt):tt("bit depth / sample format",lt+" / "+ft)}function _(at,nt,lt,ft){for(var pt=0;pt<ft;pt++)at[lt++]=nt.getUint8(pt);return lt}function $(at,nt,lt,ft,pt){for(var dt=0;dt<ft*2;dt+=2)at[lt++]=nt.getUint16(dt,pt);return lt}function b(at,nt,lt,ft,pt){for(var dt=0;dt<ft*4;dt+=4)at[lt++]=nt.getFloat32(dt,pt);return lt}function tt(at,nt){throw new Error("Unsupported "+at+": "+nt)}function st(at){if(at.length){const lt=at;at=lt[0];for(var nt=0;nt<lt.length;nt++)lt[nt]!==at&&tt("bit depth",lt)}return at}return tiffDecoder}var decode,hasRequiredDecode$1;function requireDecode$1(){if(hasRequiredDecode$1)return decode;hasRequiredDecode$1=1;const e=requireTiffDecoder();return decode=function(i,a){return new e(i,a).decode(a)},decode}var hasRequiredSrc$4;function requireSrc$4(){return hasRequiredSrc$4||(hasRequiredSrc$4=1,src$3.decode=requireDecode$1()),src$3}var decode_1,hasRequiredDecode;function requireDecode(){if(hasRequiredDecode)return decode_1;hasRequiredDecode=1;const e=requireIOBuffer(),i=requireSrc$4();function a(s){const o=new e(s),h={};if(o.setBigEndian(),o.readUint16()!==65496)throw new Error("SOI marker not found. Not a valid JPEG file");if(o.readUint16()===65505){o.readUint16();const g=o.readBytes(6);if(g[0]===69&&g[1]===120&&g[2]===105&&g[3]===102&&g[4]===0&&g[5]===0){const _=i.decode(o,{onlyFirst:!0,ignoreImageData:!0,offset:o.offset});h.exif=_}}return h}return decode_1=a,decode_1}var hasRequiredSrc$3;function requireSrc$3(){return hasRequiredSrc$3||(hasRequiredSrc$3=1,src$4.decode=requireDecode()),src$4}var srcExports$2=requireSrc$3(),imageType$1={exports:{}},fileType={exports:{}},hasRequiredFileType;function requireFileType(){return hasRequiredFileType||(hasRequiredFileType=1,function(module){const toBytes=e=>[...e].map(i=>i.charCodeAt(0)),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(e,i=0){let a=e[i],s=1,o=0;for(;++o<8;)s*=256,a+=e[i+o]*s;return a}const fileType=e=>{if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const i=e instanceof Uint8Array?e:new Uint8Array(e);if(!(i&&i.length>1))return null;const a=(o,h)=>{h=Object.assign({offset:0},h);for(let g=0;g<o.length;g++)if(h.mask){if(o[g]!==(h.mask[g]&i[g+h.offset]))return!1}else if(o[g]!==i[g+h.offset])return!1;return!0},s=(o,h)=>a(toBytes(o),h);if(a([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(a([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(a([71,73,70]))return{ext:"gif",mime:"image/gif"};if(a([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(a([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((a([73,73,42,0])||a([77,77,0,42]))&&a([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(a([73,73,42,0])||a([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(a([66,77]))return{ext:"bmp",mime:"image/bmp"};if(a([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(a([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(a([80,75,3,4])){if(a([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(a(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(s("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(s("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(s("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const o=($,b=0)=>$.findIndex((tt,st,at)=>st>=b&&at[st]===80&&at[st+1]===75&&at[st+2]===3&&at[st+3]===4);let h=0,g=!1,_=null;do{const $=h+30;if(g||(g=a(oxmlContentTypes,{offset:$})||a(oxmlRels,{offset:$})),_||(s("word/",{offset:$})?_={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:s("ppt/",{offset:$})?_={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:s("xl/",{offset:$})&&(_={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),g&&_)return _;h=o(i,$)}while(h>=0);if(_)return _}if(a([80,75])&&(i[2]===3||i[2]===5||i[2]===7)&&(i[3]===4||i[3]===6||i[3]===8))return{ext:"zip",mime:"application/zip"};if(a([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(a([82,97,114,33,26,7])&&(i[6]===0||i[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(a([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(a([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(a([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(a([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(a([51,103,112,53])||a([0,0,0])&&a([102,116,121,112],{offset:4})&&(a([109,112,52,49],{offset:8})||a([109,112,52,50],{offset:8})||a([105,115,111,109],{offset:8})||a([105,115,111,50],{offset:8})||a([109,109,112,52],{offset:8})||a([77,52,86],{offset:8})||a([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(a([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(a([26,69,223,163])){const o=i.subarray(4,4100),h=o.findIndex((g,_,$)=>$[_]===66&&$[_+1]===130);if(h!==-1){const g=h+3,_=$=>[...$].every((b,tt)=>o[g+tt]===b.charCodeAt(0));if(_("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(_("webm"))return{ext:"webm",mime:"video/webm"}}}if(a([0,0,0,20,102,116,121,112,113,116,32,32])||a([102,114,101,101],{offset:4})||a([102,116,121,112,113,116,32,32],{offset:4})||a([109,100,97,116],{offset:4})||a([109,111,111,118],{offset:4})||a([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(a([82,73,70,70])){if(a([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(a([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(a([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(a([48,38,178,117,142,102,207,17,166,217])){let o=30;do{const h=readUInt64LE(i,o+16);if(a([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:o})){if(a([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:o+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(a([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:o+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}o+=h}while(o+24<=i.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(a([0,0,1,186])||a([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(a([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let o=0;o<2&&o<i.length-16;o++){if(a([73,68,51],{offset:o})||a([255,226],{offset:o,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(a([255,228],{offset:o,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(a([255,248],{offset:o,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(a([255,240],{offset:o,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(a([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(a([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(a([79,103,103,83]))return a([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:a([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:a([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:a([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:a([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(a([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(a([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(a([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(a([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(a([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(a([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((i[0]===67||i[0]===70)&&a([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(a([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(a([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(a([119,79,70,70])&&(a([0,1,0,0],{offset:4})||a([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(a([119,79,70,50])&&(a([0,1,0,0],{offset:4})||a([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(a([76,80],{offset:34})&&(a([0,0,1],{offset:8})||a([1,0,2],{offset:8})||a([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(a([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(a([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(a([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(a([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(a([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(a([37,33]))return{ext:"ps",mime:"application/postscript"};if(a([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(a([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(a([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(a([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(a([77,83,67,70])||a([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(a([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(a([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(a([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(a([31,160])||a([31,157]))return{ext:"Z",mime:"application/x-compress"};if(a([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(a([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(a([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(a([71],{offset:4})&&(a([71],{offset:192})||a([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(a([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(a([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(a([0,0,0,12,106,80,32,32,13,10,135,10])){if(a([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(a([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(a([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(a([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(a([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(s("<?xml "))return{ext:"xml",mime:"application/xml"};if(a([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(a([102,116,121,112],{offset:4})){if(a([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(a([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(a([104,101,105,99],{offset:8})||a([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(a([104,101,118,99],{offset:8})||a([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return a([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:a([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:a([77,80,43])?{ext:"mpc",mime:"audio/x-musepack"}:a([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:a([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:a([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:a([212,195,178,161])||a([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",()=>{const e=new stream.PassThrough,i=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{e.fileType=fileType(i)}catch(a){reject(a)}readableStream.unshift(i),stream.pipeline?resolve(stream.pipeline(readableStream,e,()=>{})):resolve(readableStream.pipe(e))})})}(fileType)),fileType.exports}var hasRequiredImageType;function requireImageType(){if(hasRequiredImageType)return imageType$1.exports;hasRequiredImageType=1;const e=requireFileType(),i=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),a=s=>{const o=e(s);return i.has(o&&o.ext)?o:null};return imageType$1.exports=a,imageType$1.exports.default=a,Object.defineProperty(a,"minimumBytes",{value:e.minimumBytes}),imageType$1.exports}var imageTypeExports=requireImageType();const imageType=getDefaultExportFromCjs(imageTypeExports);function guessStripByteCounts(e){if(e.compression!==1)throw new Error("missing mandatory StripByteCounts field in compressed image");const i=e.rowsPerStrip*e.width*e.samplesPerPixel*(e.bitsPerSample/8);return new Array(e.stripOffsets.length).fill(i)}function applyHorizontalDifferencing8Bit(e,i,a){let s=0;for(;s<e.length;){for(let o=a;o<i*a;o+=a)for(let h=0;h<a;h++)e[s+o+h]=e[s+o+h]+e[s+o-(a-h)]&255;s+=i*a}}function applyHorizontalDifferencing16Bit(e,i,a){let s=0;for(;s<e.length;){for(let o=a;o<i*a;o+=a)for(let h=0;h<a;h++)e[s+o+h]=e[s+o+h]+e[s+o-(a-h)]&65535;s+=i*a}}const tagsById$2={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},tagsByName$2={};for(let e in tagsById$2)tagsByName$2[tagsById$2[e]]=Number(e);const exif=Object.freeze(Object.defineProperty({__proto__:null,tagsById:tagsById$2,tagsByName:tagsByName$2},Symbol.toStringTag,{value:"Module"})),tagsById$1={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},tagsByName$1={};for(let e in tagsById$1)tagsByName$1[tagsById$1[e]]=Number(e);const gps=Object.freeze(Object.defineProperty({__proto__:null,tagsById:tagsById$1,tagsByName:tagsByName$1},Symbol.toStringTag,{value:"Module"})),tagsById={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},tagsByName={};for(let e in tagsById)tagsByName[tagsById[e]]=Number(e);const standard=Object.freeze(Object.defineProperty({__proto__:null,tagsById,tagsByName},Symbol.toStringTag,{value:"Module"})),tags={standard,exif,gps};class IFD{constructor(i){if(!i)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=i,this._hasMap=!1,this._map={}}get(i){if(typeof i=="number")return this.fields.get(i);if(typeof i=="string")return this.fields.get(tags[this.kind].tagsByName[i]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const i=tags[this.kind].tagsById;for(let a of this.fields.keys())i[a]&&(this._map[i[a]]=this.fields.get(a));this._hasMap=!0}return this._map}}let types=new Map([[1,[1,readByte]],[2,[1,readASCII]],[3,[2,readShort]],[4,[4,readLong]],[5,[8,readRational]],[6,[1,readSByte]],[7,[1,readByte]],[8,[2,readSShort]],[9,[4,readSLong]],[10,[8,readSRational]],[11,[4,readFloat]],[12,[8,readDouble]]]);function getByteLength(e,i){const a=types.get(e);if(!a)throw new Error(`type not found: ${e}`);return a[0]*i}function readData(e,i,a){const s=types.get(i);if(!s)throw new Error(`type not found: ${i}`);return s[1](e,a)}function readByte(e,i){if(i===1)return e.readUint8();let a=new Uint8Array(i);for(let s=0;s<i;s++)a[s]=e.readUint8();return a}function readASCII(e,i){let a=[],s="";for(let o=0;o<i;o++){let h=String.fromCharCode(e.readUint8());h==="\0"?(a.push(s),s=""):s+=h}return a.length===1?a[0]:a}function readShort(e,i){if(i===1)return e.readUint16();let a=new Uint16Array(i);for(let s=0;s<i;s++)a[s]=e.readUint16();return a}function readLong(e,i){if(i===1)return e.readUint32();let a=new Uint32Array(i);for(let s=0;s<i;s++)a[s]=e.readUint32();return a}function readRational(e,i){if(i===1)return e.readUint32()/e.readUint32();let a=new Array(i);for(let s=0;s<i;s++)a[s]=e.readUint32()/e.readUint32();return a}function readSByte(e,i){if(i===1)return e.readInt8();let a=new Int8Array(i);for(let s=0;s<i;s++)a[s]=e.readInt8();return a}function readSShort(e,i){if(i===1)return e.readInt16();let a=new Int16Array(i);for(let s=0;s<i;s++)a[s]=e.readInt16();return a}function readSLong(e,i){if(i===1)return e.readInt32();let a=new Int32Array(i);for(let s=0;s<i;s++)a[s]=e.readInt32();return a}function readSRational(e,i){if(i===1)return e.readInt32()/e.readInt32();let a=new Array(i);for(let s=0;s<i;s++)a[s]=e.readInt32()/e.readInt32();return a}function readFloat(e,i){if(i===1)return e.readFloat32();let a=new Float32Array(i);for(let s=0;s<i;s++)a[s]=e.readFloat32();return a}function readDouble(e,i){if(i===1)return e.readFloat64();let a=new Float64Array(i);for(let s=0;s<i;s++)a[s]=e.readFloat64();return a}const CLEAR_CODE=256,EOI_CODE=257,TABLE_START=258,MIN_BIT_LENGTH=9;let stringTable=[];function initializeStringTable(){if(stringTable.length===0){for(let i=0;i<256;i++)stringTable.push([i]);const e=[];for(let i=256;i<4096;i++)stringTable.push(e)}}const andTable=[511,1023,2047,4095],bitJumps=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class LzwDecoder{constructor(i){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=TABLE_START,this.currentBitLength=MIN_BIT_LENGTH,this.stripArray=new Uint8Array(i.buffer,i.byteOffset,i.byteLength),this.outData=new IOBuffer(i.byteLength),this.initializeTable()}decode(){let i=0,a=0;for(;(i=this.getNextCode())!==EOI_CODE;)if(i===CLEAR_CODE){if(this.initializeTable(),i=this.getNextCode(),i===EOI_CODE)break;this.writeString(this.stringFromCode(i)),a=i}else if(this.isInTable(i))this.writeString(this.stringFromCode(i)),this.addStringToTable(this.stringFromCode(a).concat(this.stringFromCode(i)[0])),a=i;else{const o=this.stringFromCode(a).concat(this.stringFromCode(a)[0]);this.writeString(o),this.addStringToTable(o),a=i}const s=this.outData.toArray();return new DataView(s.buffer,s.byteOffset,s.byteLength)}initializeTable(){initializeStringTable(),this.tableLength=TABLE_START,this.currentBitLength=MIN_BIT_LENGTH}writeString(i){this.outData.writeBytes(i)}stringFromCode(i){return stringTable[i]}isInTable(i){return i<this.tableLength}addStringToTable(i){if(stringTable[this.tableLength++]=i,stringTable.length>4096)throw stringTable=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===bitJumps[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|this.stripArray[this.bytePointer++]&255,this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|this.stripArray[this.bytePointer++]&255,this.nextBits+=8);const i=this.nextData>>this.nextBits-this.currentBitLength&andTable[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:i}}function decompressLzw(e){return new LzwDecoder(e).decode()}const dateTimeRegex=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class TiffIfd extends IFD{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let i=new Date,a=dateTimeRegex.exec(this.dateTime);if(a===null)throw new Error(`invalid dateTime: ${this.dateTime}`);return i.setFullYear(Number(a[1]),Number(a[2])-1,Number(a[3])),i.setHours(Number(a[4]),Number(a[5]),Number(a[6])),i}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const i=this.get("BitsPerSample");return i&&typeof i!="number"?i[0]:i}get alpha(){const i=this.extraSamples;return i?i[0]!==0:!1}get associatedAlpha(){const i=this.extraSamples;return i?i[0]===1:!1}get extraSamples(){return alwaysArray(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return alwaysArray(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return alwaysArray(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const i=2**this.bitsPerSample,a=this.get("ColorMap");if(!a)return;if(a.length!==3*i)throw new Error(`ColorMap size must be ${i}`);const s=[];for(let o=0;o<i;o++)s.push([a[o],a[o+i],a[o+2*i]]);return s}}function alwaysArray(e){return typeof e=="number"?[e]:e}function zero$1(e){let i=e.length;for(;--i>=0;)e[i]=0}const MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);const adler32=(e,i,a,s)=>{let o=e&65535|0,h=e>>>16&65535|0,g=0;for(;a!==0;){g=a>2e3?2e3:a,a-=g;do o=o+i[s++]|0,h=h+o|0;while(--g);o%=65521,h%=65521}return o|h<<16|0};var adler32_1$1=adler32;const makeTable=()=>{let e,i=[];for(var a=0;a<256;a++){e=a;for(var s=0;s<8;s++)e=e&1?3988292384^e>>>1:e>>>1;i[a]=e}return i},crcTable=new Uint32Array(makeTable()),crc32=(e,i,a,s)=>{const o=crcTable,h=s+a;e^=-1;for(let g=s;g<h;g++)e=e>>>8^o[(e^i[g])&255];return e^-1};var crc32_1$1=crc32,messages$1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const _has=(e,i)=>Object.prototype.hasOwnProperty.call(e,i);var assign=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const a=i.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(const s in a)_has(a,s)&&(e[s]=a[s])}}return e},flattenChunks=e=>{let i=0;for(let s=0,o=e.length;s<o;s++)i+=e[s].length;const a=new Uint8Array(i);for(let s=0,o=0,h=e.length;s<h;s++){let g=e[s];a.set(g,o),o+=g.length}return a},common$1={assign,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let e=0;e<256;e++)_utf8len[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let i,a,s,o,h,g=e.length,_=0;for(o=0;o<g;o++)a=e.charCodeAt(o),(a&64512)===55296&&o+1<g&&(s=e.charCodeAt(o+1),(s&64512)===56320&&(a=65536+(a-55296<<10)+(s-56320),o++)),_+=a<128?1:a<2048?2:a<65536?3:4;for(i=new Uint8Array(_),h=0,o=0;h<_;o++)a=e.charCodeAt(o),(a&64512)===55296&&o+1<g&&(s=e.charCodeAt(o+1),(s&64512)===56320&&(a=65536+(a-55296<<10)+(s-56320),o++)),a<128?i[h++]=a:a<2048?(i[h++]=192|a>>>6,i[h++]=128|a&63):a<65536?(i[h++]=224|a>>>12,i[h++]=128|a>>>6&63,i[h++]=128|a&63):(i[h++]=240|a>>>18,i[h++]=128|a>>>12&63,i[h++]=128|a>>>6&63,i[h++]=128|a&63);return i};const buf2binstring=(e,i)=>{if(i<65534&&e.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let a="";for(let s=0;s<i;s++)a+=String.fromCharCode(e[s]);return a};var buf2string=(e,i)=>{const a=i||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,i));let s,o;const h=new Array(a*2);for(o=0,s=0;s<a;){let g=e[s++];if(g<128){h[o++]=g;continue}let _=_utf8len[g];if(_>4){h[o++]=65533,s+=_-1;continue}for(g&=_===2?31:_===3?15:7;_>1&&s<a;)g=g<<6|e[s++]&63,_--;if(_>1){h[o++]=65533;continue}g<65536?h[o++]=g:(g-=65536,h[o++]=55296|g>>10&1023,h[o++]=56320|g&1023)}return buf2binstring(h,o)},utf8border=(e,i)=>{i=i||e.length,i>e.length&&(i=e.length);let a=i-1;for(;a>=0&&(e[a]&192)===128;)a--;return a<0||a===0?i:a+_utf8len[e[a]]>i?a:i},strings$1={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream$1=ZStream;const BAD$1=16209,TYPE$1=16191;var inffast$1=function e(i,a){let s,o,h,g,_,$,b,tt,st,at,nt,lt,ft,pt,dt,_t,ut,mt,kt,bt,vt,Et,Mt,At;const zt=i.state;s=i.next_in,Mt=i.input,o=s+(i.avail_in-5),h=i.next_out,At=i.output,g=h-(a-i.avail_out),_=h+(i.avail_out-257),$=zt.dmax,b=zt.wsize,tt=zt.whave,st=zt.wnext,at=zt.window,nt=zt.hold,lt=zt.bits,ft=zt.lencode,pt=zt.distcode,dt=(1<<zt.lenbits)-1,_t=(1<<zt.distbits)-1;t:do{lt<15&&(nt+=Mt[s++]<<lt,lt+=8,nt+=Mt[s++]<<lt,lt+=8),ut=ft[nt&dt];e:for(;;){if(mt=ut>>>24,nt>>>=mt,lt-=mt,mt=ut>>>16&255,mt===0)At[h++]=ut&65535;else if(mt&16){kt=ut&65535,mt&=15,mt&&(lt<mt&&(nt+=Mt[s++]<<lt,lt+=8),kt+=nt&(1<<mt)-1,nt>>>=mt,lt-=mt),lt<15&&(nt+=Mt[s++]<<lt,lt+=8,nt+=Mt[s++]<<lt,lt+=8),ut=pt[nt&_t];n:for(;;){if(mt=ut>>>24,nt>>>=mt,lt-=mt,mt=ut>>>16&255,mt&16){if(bt=ut&65535,mt&=15,lt<mt&&(nt+=Mt[s++]<<lt,lt+=8,lt<mt&&(nt+=Mt[s++]<<lt,lt+=8)),bt+=nt&(1<<mt)-1,bt>$){i.msg="invalid distance too far back",zt.mode=BAD$1;break t}if(nt>>>=mt,lt-=mt,mt=h-g,bt>mt){if(mt=bt-mt,mt>tt&&zt.sane){i.msg="invalid distance too far back",zt.mode=BAD$1;break t}if(vt=0,Et=at,st===0){if(vt+=b-mt,mt<kt){kt-=mt;do At[h++]=at[vt++];while(--mt);vt=h-bt,Et=At}}else if(st<mt){if(vt+=b+st-mt,mt-=st,mt<kt){kt-=mt;do At[h++]=at[vt++];while(--mt);if(vt=0,st<kt){mt=st,kt-=mt;do At[h++]=at[vt++];while(--mt);vt=h-bt,Et=At}}}else if(vt+=st-mt,mt<kt){kt-=mt;do At[h++]=at[vt++];while(--mt);vt=h-bt,Et=At}for(;kt>2;)At[h++]=Et[vt++],At[h++]=Et[vt++],At[h++]=Et[vt++],kt-=3;kt&&(At[h++]=Et[vt++],kt>1&&(At[h++]=Et[vt++]))}else{vt=h-bt;do At[h++]=At[vt++],At[h++]=At[vt++],At[h++]=At[vt++],kt-=3;while(kt>2);kt&&(At[h++]=At[vt++],kt>1&&(At[h++]=At[vt++]))}}else if(mt&64){i.msg="invalid distance code",zt.mode=BAD$1;break t}else{ut=pt[(ut&65535)+(nt&(1<<mt)-1)];continue n}break}}else if(mt&64)if(mt&32){zt.mode=TYPE$1;break t}else{i.msg="invalid literal/length code",zt.mode=BAD$1;break t}else{ut=ft[(ut&65535)+(nt&(1<<mt)-1)];continue e}break}}while(s<o&&h<_);kt=lt>>3,s-=kt,lt-=kt<<3,nt&=(1<<lt)-1,i.next_in=s,i.next_out=h,i.avail_in=s<o?5+(o-s):5-(s-o),i.avail_out=h<_?257+(_-h):257-(h-_),zt.hold=nt,zt.bits=lt};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(e,i,a,s,o,h,g,_)=>{const $=_.bits;let b=0,tt=0,st=0,at=0,nt=0,lt=0,ft=0,pt=0,dt=0,_t=0,ut,mt,kt,bt,vt,Et=null,Mt;const At=new Uint16Array(MAXBITS+1),zt=new Uint16Array(MAXBITS+1);let Vt=null,Gt,Kt,Wt;for(b=0;b<=MAXBITS;b++)At[b]=0;for(tt=0;tt<s;tt++)At[i[a+tt]]++;for(nt=$,at=MAXBITS;at>=1&&At[at]===0;at--);if(nt>at&&(nt=at),at===0)return o[h++]=1<<24|64<<16|0,o[h++]=1<<24|64<<16|0,_.bits=1,0;for(st=1;st<at&&At[st]===0;st++);for(nt<st&&(nt=st),pt=1,b=1;b<=MAXBITS;b++)if(pt<<=1,pt-=At[b],pt<0)return-1;if(pt>0&&(e===CODES$1||at!==1))return-1;for(zt[1]=0,b=1;b<MAXBITS;b++)zt[b+1]=zt[b]+At[b];for(tt=0;tt<s;tt++)i[a+tt]!==0&&(g[zt[i[a+tt]]++]=tt);if(e===CODES$1?(Et=Vt=g,Mt=20):e===LENS$1?(Et=lbase,Vt=lext,Mt=257):(Et=dbase,Vt=dext,Mt=0),_t=0,tt=0,b=st,vt=h,lt=nt,ft=0,kt=-1,dt=1<<nt,bt=dt-1,e===LENS$1&&dt>ENOUGH_LENS$1||e===DISTS$1&&dt>ENOUGH_DISTS$1)return 1;for(;;){Gt=b-ft,g[tt]+1<Mt?(Kt=0,Wt=g[tt]):g[tt]>=Mt?(Kt=Vt[g[tt]-Mt],Wt=Et[g[tt]-Mt]):(Kt=96,Wt=0),ut=1<<b-ft,mt=1<<lt,st=mt;do mt-=ut,o[vt+(_t>>ft)+mt]=Gt<<24|Kt<<16|Wt|0;while(mt!==0);for(ut=1<<b-1;_t&ut;)ut>>=1;if(ut!==0?(_t&=ut-1,_t+=ut):_t=0,tt++,--At[b]===0){if(b===at)break;b=i[a+g[tt]]}if(b>nt&&(_t&bt)!==kt){for(ft===0&&(ft=nt),vt+=st,lt=b-ft,pt=1<<lt;lt+ft<at&&(pt-=At[lt+ft],!(pt<=0));)lt++,pt<<=1;if(dt+=1<<lt,e===LENS$1&&dt>ENOUGH_LENS$1||e===DISTS$1&&dt>ENOUGH_DISTS$1)return 1;kt=_t&bt,o[kt]=nt<<24|lt<<16|vt-h|0}}return _t!==0&&(o[vt+_t]=b-ft<<24|64<<16|0),_.bits=nt,0};var inftrees$1=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=e=>{if(!e)return 1;const i=e.state;return!i||i.strm!==e||i.mode<HEAD||i.mode>SYNC?1:0},inflateResetKeep=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const i=e.state;return e.total_in=e.total_out=i.total=0,e.msg="",i.wrap&&(e.adler=i.wrap&1),i.mode=HEAD,i.last=0,i.havedict=0,i.flags=-1,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new Int32Array(ENOUGH_LENS),i.distcode=i.distdyn=new Int32Array(ENOUGH_DISTS),i.sane=1,i.back=-1,Z_OK$1},inflateReset=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const i=e.state;return i.wsize=0,i.whave=0,i.wnext=0,inflateResetKeep(e)},inflateReset2=(e,i)=>{let a;if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const s=e.state;return i<0?(a=0,i=-i):(a=(i>>4)+5,i<48&&(i&=15)),i&&(i<8||i>15)?Z_STREAM_ERROR$1:(s.window!==null&&s.wbits!==i&&(s.window=null),s.wrap=a,s.wbits=i,inflateReset(e))},inflateInit2=(e,i)=>{if(!e)return Z_STREAM_ERROR$1;const a=new InflateState;e.state=a,a.strm=e,a.window=null,a.mode=HEAD;const s=inflateReset2(e,i);return s!==Z_OK$1&&(e.state=null),s},inflateInit=e=>inflateInit2(e,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=e=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let i=0;for(;i<144;)e.lens[i++]=8;for(;i<256;)e.lens[i++]=9;for(;i<280;)e.lens[i++]=7;for(;i<288;)e.lens[i++]=8;for(inftrees$1(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),i=0;i<32;)e.lens[i++]=5;inftrees$1(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=(e,i,a,s)=>{let o;const h=e.state;return h.window===null&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new Uint8Array(h.wsize)),s>=h.wsize?(h.window.set(i.subarray(a-h.wsize,a),0),h.wnext=0,h.whave=h.wsize):(o=h.wsize-h.wnext,o>s&&(o=s),h.window.set(i.subarray(a-s,a-s+o),h.wnext),s-=o,s?(h.window.set(i.subarray(a-s,a),0),h.wnext=s,h.whave=h.wsize):(h.wnext+=o,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=o))),0},inflate$2=(e,i)=>{let a,s,o,h,g,_,$,b,tt,st,at,nt,lt,ft,pt=0,dt,_t,ut,mt,kt,bt,vt,Et;const Mt=new Uint8Array(4);let At,zt;const Vt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(e)||!e.output||!e.input&&e.avail_in!==0)return Z_STREAM_ERROR$1;a=e.state,a.mode===TYPE&&(a.mode=TYPEDO),g=e.next_out,o=e.output,$=e.avail_out,h=e.next_in,s=e.input,_=e.avail_in,b=a.hold,tt=a.bits,st=_,at=$,Et=Z_OK$1;t:for(;;)switch(a.mode){case HEAD:if(a.wrap===0){a.mode=TYPEDO;break}for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.wrap&2&&b===35615){a.wbits===0&&(a.wbits=15),a.check=0,Mt[0]=b&255,Mt[1]=b>>>8&255,a.check=crc32_1$1(a.check,Mt,2,0),b=0,tt=0,a.mode=FLAGS;break}if(a.head&&(a.head.done=!1),!(a.wrap&1)||(((b&255)<<8)+(b>>8))%31){e.msg="incorrect header check",a.mode=BAD;break}if((b&15)!==Z_DEFLATED){e.msg="unknown compression method",a.mode=BAD;break}if(b>>>=4,tt-=4,vt=(b&15)+8,a.wbits===0&&(a.wbits=vt),vt>15||vt>a.wbits){e.msg="invalid window size",a.mode=BAD;break}a.dmax=1<<a.wbits,a.flags=0,e.adler=a.check=1,a.mode=b&512?DICTID:TYPE,b=0,tt=0;break;case FLAGS:for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.flags=b,(a.flags&255)!==Z_DEFLATED){e.msg="unknown compression method",a.mode=BAD;break}if(a.flags&57344){e.msg="unknown header flags set",a.mode=BAD;break}a.head&&(a.head.text=b>>8&1),a.flags&512&&a.wrap&4&&(Mt[0]=b&255,Mt[1]=b>>>8&255,a.check=crc32_1$1(a.check,Mt,2,0)),b=0,tt=0,a.mode=TIME;case TIME:for(;tt<32;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.head&&(a.head.time=b),a.flags&512&&a.wrap&4&&(Mt[0]=b&255,Mt[1]=b>>>8&255,Mt[2]=b>>>16&255,Mt[3]=b>>>24&255,a.check=crc32_1$1(a.check,Mt,4,0)),b=0,tt=0,a.mode=OS;case OS:for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.head&&(a.head.xflags=b&255,a.head.os=b>>8),a.flags&512&&a.wrap&4&&(Mt[0]=b&255,Mt[1]=b>>>8&255,a.check=crc32_1$1(a.check,Mt,2,0)),b=0,tt=0,a.mode=EXLEN;case EXLEN:if(a.flags&1024){for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.length=b,a.head&&(a.head.extra_len=b),a.flags&512&&a.wrap&4&&(Mt[0]=b&255,Mt[1]=b>>>8&255,a.check=crc32_1$1(a.check,Mt,2,0)),b=0,tt=0}else a.head&&(a.head.extra=null);a.mode=EXTRA;case EXTRA:if(a.flags&1024&&(nt=a.length,nt>_&&(nt=_),nt&&(a.head&&(vt=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(s.subarray(h,h+nt),vt)),a.flags&512&&a.wrap&4&&(a.check=crc32_1$1(a.check,s,nt,h)),_-=nt,h+=nt,a.length-=nt),a.length))break t;a.length=0,a.mode=NAME;case NAME:if(a.flags&2048){if(_===0)break t;nt=0;do vt=s[h+nt++],a.head&&vt&&a.length<65536&&(a.head.name+=String.fromCharCode(vt));while(vt&&nt<_);if(a.flags&512&&a.wrap&4&&(a.check=crc32_1$1(a.check,s,nt,h)),_-=nt,h+=nt,vt)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=COMMENT;case COMMENT:if(a.flags&4096){if(_===0)break t;nt=0;do vt=s[h+nt++],a.head&&vt&&a.length<65536&&(a.head.comment+=String.fromCharCode(vt));while(vt&&nt<_);if(a.flags&512&&a.wrap&4&&(a.check=crc32_1$1(a.check,s,nt,h)),_-=nt,h+=nt,vt)break t}else a.head&&(a.head.comment=null);a.mode=HCRC;case HCRC:if(a.flags&512){for(;tt<16;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.wrap&4&&b!==(a.check&65535)){e.msg="header crc mismatch",a.mode=BAD;break}b=0,tt=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=TYPE;break;case DICTID:for(;tt<32;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}e.adler=a.check=zswap32(b),b=0,tt=0,a.mode=DICT;case DICT:if(a.havedict===0)return e.next_out=g,e.avail_out=$,e.next_in=h,e.avail_in=_,a.hold=b,a.bits=tt,Z_NEED_DICT$1;e.adler=a.check=1,a.mode=TYPE;case TYPE:if(i===Z_BLOCK||i===Z_TREES)break t;case TYPEDO:if(a.last){b>>>=tt&7,tt-=tt&7,a.mode=CHECK;break}for(;tt<3;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}switch(a.last=b&1,b>>>=1,tt-=1,b&3){case 0:a.mode=STORED;break;case 1:if(fixedtables(a),a.mode=LEN_,i===Z_TREES){b>>>=2,tt-=2;break t}break;case 2:a.mode=TABLE;break;case 3:e.msg="invalid block type",a.mode=BAD}b>>>=2,tt-=2;break;case STORED:for(b>>>=tt&7,tt-=tt&7;tt<32;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if((b&65535)!==(b>>>16^65535)){e.msg="invalid stored block lengths",a.mode=BAD;break}if(a.length=b&65535,b=0,tt=0,a.mode=COPY_,i===Z_TREES)break t;case COPY_:a.mode=COPY;case COPY:if(nt=a.length,nt){if(nt>_&&(nt=_),nt>$&&(nt=$),nt===0)break t;o.set(s.subarray(h,h+nt),g),_-=nt,h+=nt,$-=nt,g+=nt,a.length-=nt;break}a.mode=TYPE;break;case TABLE:for(;tt<14;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.nlen=(b&31)+257,b>>>=5,tt-=5,a.ndist=(b&31)+1,b>>>=5,tt-=5,a.ncode=(b&15)+4,b>>>=4,tt-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=BAD;break}a.have=0,a.mode=LENLENS;case LENLENS:for(;a.have<a.ncode;){for(;tt<3;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.lens[Vt[a.have++]]=b&7,b>>>=3,tt-=3}for(;a.have<19;)a.lens[Vt[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,At={bits:a.lenbits},Et=inftrees$1(CODES,a.lens,0,19,a.lencode,0,a.work,At),a.lenbits=At.bits,Et){e.msg="invalid code lengths set",a.mode=BAD;break}a.have=0,a.mode=CODELENS;case CODELENS:for(;a.have<a.nlen+a.ndist;){for(;pt=a.lencode[b&(1<<a.lenbits)-1],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(ut<16)b>>>=dt,tt-=dt,a.lens[a.have++]=ut;else{if(ut===16){for(zt=dt+2;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(b>>>=dt,tt-=dt,a.have===0){e.msg="invalid bit length repeat",a.mode=BAD;break}vt=a.lens[a.have-1],nt=3+(b&3),b>>>=2,tt-=2}else if(ut===17){for(zt=dt+3;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}b>>>=dt,tt-=dt,vt=0,nt=3+(b&7),b>>>=3,tt-=3}else{for(zt=dt+7;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}b>>>=dt,tt-=dt,vt=0,nt=11+(b&127),b>>>=7,tt-=7}if(a.have+nt>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=BAD;break}for(;nt--;)a.lens[a.have++]=vt}}if(a.mode===BAD)break;if(a.lens[256]===0){e.msg="invalid code -- missing end-of-block",a.mode=BAD;break}if(a.lenbits=9,At={bits:a.lenbits},Et=inftrees$1(LENS,a.lens,0,a.nlen,a.lencode,0,a.work,At),a.lenbits=At.bits,Et){e.msg="invalid literal/lengths set",a.mode=BAD;break}if(a.distbits=6,a.distcode=a.distdyn,At={bits:a.distbits},Et=inftrees$1(DISTS,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,At),a.distbits=At.bits,Et){e.msg="invalid distances set",a.mode=BAD;break}if(a.mode=LEN_,i===Z_TREES)break t;case LEN_:a.mode=LEN;case LEN:if(_>=6&&$>=258){e.next_out=g,e.avail_out=$,e.next_in=h,e.avail_in=_,a.hold=b,a.bits=tt,inffast$1(e,at),g=e.next_out,o=e.output,$=e.avail_out,h=e.next_in,s=e.input,_=e.avail_in,b=a.hold,tt=a.bits,a.mode===TYPE&&(a.back=-1);break}for(a.back=0;pt=a.lencode[b&(1<<a.lenbits)-1],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(_t&&!(_t&240)){for(mt=dt,kt=_t,bt=ut;pt=a.lencode[bt+((b&(1<<mt+kt)-1)>>mt)],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(mt+dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}b>>>=mt,tt-=mt,a.back+=mt}if(b>>>=dt,tt-=dt,a.back+=dt,a.length=ut,_t===0){a.mode=LIT;break}if(_t&32){a.back=-1,a.mode=TYPE;break}if(_t&64){e.msg="invalid literal/length code",a.mode=BAD;break}a.extra=_t&15,a.mode=LENEXT;case LENEXT:if(a.extra){for(zt=a.extra;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.length+=b&(1<<a.extra)-1,b>>>=a.extra,tt-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=DIST;case DIST:for(;pt=a.distcode[b&(1<<a.distbits)-1],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(!(_t&240)){for(mt=dt,kt=_t,bt=ut;pt=a.distcode[bt+((b&(1<<mt+kt)-1)>>mt)],dt=pt>>>24,_t=pt>>>16&255,ut=pt&65535,!(mt+dt<=tt);){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}b>>>=mt,tt-=mt,a.back+=mt}if(b>>>=dt,tt-=dt,a.back+=dt,_t&64){e.msg="invalid distance code",a.mode=BAD;break}a.offset=ut,a.extra=_t&15,a.mode=DISTEXT;case DISTEXT:if(a.extra){for(zt=a.extra;tt<zt;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}a.offset+=b&(1<<a.extra)-1,b>>>=a.extra,tt-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=BAD;break}a.mode=MATCH;case MATCH:if($===0)break t;if(nt=at-$,a.offset>nt){if(nt=a.offset-nt,nt>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=BAD;break}nt>a.wnext?(nt-=a.wnext,lt=a.wsize-nt):lt=a.wnext-nt,nt>a.length&&(nt=a.length),ft=a.window}else ft=o,lt=g-a.offset,nt=a.length;nt>$&&(nt=$),$-=nt,a.length-=nt;do o[g++]=ft[lt++];while(--nt);a.length===0&&(a.mode=LEN);break;case LIT:if($===0)break t;o[g++]=a.length,$--,a.mode=LEN;break;case CHECK:if(a.wrap){for(;tt<32;){if(_===0)break t;_--,b|=s[h++]<<tt,tt+=8}if(at-=$,e.total_out+=at,a.total+=at,a.wrap&4&&at&&(e.adler=a.check=a.flags?crc32_1$1(a.check,o,at,g-at):adler32_1$1(a.check,o,at,g-at)),at=$,a.wrap&4&&(a.flags?b:zswap32(b))!==a.check){e.msg="incorrect data check",a.mode=BAD;break}b=0,tt=0}a.mode=LENGTH;case LENGTH:if(a.wrap&&a.flags){for(;tt<32;){if(_===0)break t;_--,b+=s[h++]<<tt,tt+=8}if(a.wrap&4&&b!==(a.total&4294967295)){e.msg="incorrect length check",a.mode=BAD;break}b=0,tt=0}a.mode=DONE;case DONE:Et=Z_STREAM_END$1;break t;case BAD:Et=Z_DATA_ERROR$1;break t;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return e.next_out=g,e.avail_out=$,e.next_in=h,e.avail_in=_,a.hold=b,a.bits=tt,(a.wsize||at!==e.avail_out&&a.mode<BAD&&(a.mode<CHECK||i!==Z_FINISH$1))&&updatewindow(e,e.output,e.next_out,at-e.avail_out),st-=e.avail_in,at-=e.avail_out,e.total_in+=st,e.total_out+=at,a.total+=at,a.wrap&4&&at&&(e.adler=a.check=a.flags?crc32_1$1(a.check,o,at,e.next_out-at):adler32_1$1(a.check,o,at,e.next_out-at)),e.data_type=a.bits+(a.last?64:0)+(a.mode===TYPE?128:0)+(a.mode===LEN_||a.mode===COPY_?256:0),(st===0&&at===0||i===Z_FINISH$1)&&Et===Z_OK$1&&(Et=Z_BUF_ERROR),Et},inflateEnd=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;let i=e.state;return i.window&&(i.window=null),e.state=null,Z_OK$1},inflateGetHeader=(e,i)=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const a=e.state;return a.wrap&2?(a.head=i,i.done=!1,Z_OK$1):Z_STREAM_ERROR$1},inflateSetDictionary=(e,i)=>{const a=i.length;let s,o,h;return inflateStateCheck(e)||(s=e.state,s.wrap!==0&&s.mode!==DICT)?Z_STREAM_ERROR$1:s.mode===DICT&&(o=1,o=adler32_1$1(o,i,a,0),o!==s.check)?Z_DATA_ERROR$1:(h=updatewindow(e,i,a,a),h?(s.mode=MEM,Z_MEM_ERROR$1):(s.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader$1=GZheader;const toString$1=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(e){this.options=common$1.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),i.windowBits>=0&&i.windowBits<16&&!(e&&e.windowBits)&&(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&!(i.windowBits&15)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream$1,this.strm.avail_out=0;let a=inflate_1$2.inflateInit2(this.strm,i.windowBits);if(a!==Z_OK)throw new Error(messages$1[a]);if(this.header=new gzheader$1,inflate_1$2.inflateGetHeader(this.strm,this.header),i.dictionary&&(typeof i.dictionary=="string"?i.dictionary=strings$1.string2buf(i.dictionary):toString$1.call(i.dictionary)==="[object ArrayBuffer]"&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(a=inflate_1$2.inflateSetDictionary(this.strm,i.dictionary),a!==Z_OK)))throw new Error(messages$1[a])}Inflate$1.prototype.push=function(e,i){const a=this.strm,s=this.options.chunkSize,o=this.options.dictionary;let h,g,_;if(this.ended)return!1;for(i===~~i?g=i:g=i===!0?Z_FINISH:Z_NO_FLUSH,toString$1.call(e)==="[object ArrayBuffer]"?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(a.avail_out===0&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),h=inflate_1$2.inflate(a,g),h===Z_NEED_DICT&&o&&(h=inflate_1$2.inflateSetDictionary(a,o),h===Z_OK?h=inflate_1$2.inflate(a,g):h===Z_DATA_ERROR&&(h=Z_NEED_DICT));a.avail_in>0&&h===Z_STREAM_END&&a.state.wrap>0&&e[a.next_in]!==0;)inflate_1$2.inflateReset(a),h=inflate_1$2.inflate(a,g);switch(h){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(h),this.ended=!0,!1}if(_=a.avail_out,a.next_out&&(a.avail_out===0||h===Z_STREAM_END))if(this.options.to==="string"){let $=strings$1.utf8border(a.output,a.next_out),b=a.next_out-$,tt=strings$1.buf2string(a.output,$);a.next_out=b,a.avail_out=s-b,b&&a.output.set(a.output.subarray($,$+b),0),this.onData(tt)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(!(h===Z_OK&&_===0)){if(h===Z_STREAM_END)return h=inflate_1$2.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,!0;if(a.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(e){this.chunks.push(e)};Inflate$1.prototype.onEnd=function(e){e===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function inflate$1$1(e,i){const a=new Inflate$1(i);if(a.push(e),a.err)throw a.msg||messages$1[a.err];return a.result}var inflate_2=inflate$1$1,inflate_1$1={inflate:inflate_2};const{inflate:inflate$3}=inflate_1$1;var inflate_1=inflate$3;function decompressZlib(e){const i=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=inflate_1(i);return new DataView(a.buffer,a.byteOffset,a.byteLength)}const defaultOptions$3={ignoreImageData:!1,onlyFirst:!1};class TIFFDecoder extends IOBuffer{constructor(i){super(i),this._nextIFD=0}get isMultiPage(){let i=0;for(this.decodeHeader();this._nextIFD;)if(i++,this.decodeIFD({ignoreImageData:!0},!0),i===2)return!0;if(i===1)return!1;throw unsupported("ifdCount",i)}get pageCount(){let i=0;for(this.decodeHeader();this._nextIFD;)i++,this.decodeIFD({ignoreImageData:!0},!0);if(i>0)return i;throw unsupported("ifdCount",i)}decode(i={}){i=Object.assign({},defaultOptions$3,i);const a=[];for(this.decodeHeader();this._nextIFD;)if(a.push(this.decodeIFD(i,!0)),i.onlyFirst)return[a[0]];return a}decodeHeader(){const i=this.readUint16();if(i===18761)this.setLittleEndian();else if(i===19789)this.setBigEndian();else throw new Error(`invalid byte order: 0x${i.toString(16)}`);if(this.readUint16()!==42)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(i,a){this.seek(this._nextIFD);let s;if(a)s=new TiffIfd;else{if(!i.kind)throw new Error("kind is missing");s=new IFD(i.kind)}const o=this.readUint16();for(let h=0;h<o;h++)this.decodeIFDEntry(s);if(!i.ignoreImageData){if(!(s instanceof TiffIfd))throw new Error("must be a tiff ifd");this.decodeImageData(s)}return this._nextIFD=this.readUint32(),s}decodeIFDEntry(i){const a=this.offset,s=this.readUint16(),o=this.readUint16(),h=this.readUint32();if(o<1||o>12){this.skip(4);return}getByteLength(o,h)>4&&this.seek(this.readUint32());const g=readData(this,o,h);if(i.fields.set(s,g),s===34665||s===34853){let _=this.offset,$="exif";s===34665?$="exif":s===34853&&($="gps"),this._nextIFD=g,i[$]=this.decodeIFD({kind:$,ignoreImageData:!0},!1),this.offset=_}this.seek(a),this.skip(12)}decodeImageData(i){const a=i.orientation;if(a&&a!==1)throw unsupported("orientation",a);switch(i.type){case 0:case 1:case 2:case 3:this.readStripData(i);break;default:throw unsupported("image type",i.type)}if(this.applyPredictor(i),this.convertAlpha(i),i.type===0){const s=i.bitsPerSample,o=Math.pow(2,s)-1;for(let h=0;h<i.data.length;h++)i.data[h]=o-i.data[h]}}readStripData(i){const a=i.width,s=i.height,o=i.bitsPerSample,h=i.sampleFormat,g=a*s*i.samplesPerPixel,_=getDataArray(g,o,h),$=i.rowsPerStrip*a*i.samplesPerPixel,b=i.stripOffsets,tt=i.stripByteCounts||guessStripByteCounts(i);let st=g,at=0;for(let nt=0;nt<b.length;nt++){let lt=new DataView(this.buffer,this.byteOffset+b[nt],tt[nt]),ft=st>$?$:st;st-=ft;let pt=lt;switch(i.compression){case 1:break;case 5:{pt=decompressLzw(lt);break}case 8:{pt=decompressZlib(lt);break}case 2:throw unsupported("Compression","CCITT Group 3");case 32773:throw unsupported("Compression","PackBits");default:throw unsupported("Compression",i.compression)}at=this.fillUncompressed(o,h,_,pt,at,ft)}i.data=_}fillUncompressed(i,a,s,o,h,g){if(i===8)return fill8bit(s,o,h,g);if(i===16)return fill16bit(s,o,h,g,this.isLittleEndian());if(i===32&&a===3)return fillFloat32(s,o,h,g,this.isLittleEndian());throw unsupported("bitDepth",i)}applyPredictor(i){const a=i.bitsPerSample;switch(i.predictor){case 1:break;case 2:{if(a===8)applyHorizontalDifferencing8Bit(i.data,i.width,i.components);else if(a===16)applyHorizontalDifferencing16Bit(i.data,i.width,i.components);else throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${a}`);break}default:throw new Error(`invalid predictor: ${i.predictor}`)}}convertAlpha(i){if(i.alpha&&i.associatedAlpha){const{data:a,components:s,maxSampleValue:o}=i;for(let h=0;h<a.length;h+=s){const g=a[h+s-1];for(let _=0;_<s-1;_++)a[h+_]=Math.round(a[h+_]*o/g)}}}}function getDataArray(e,i,a){if(i===8)return new Uint8Array(e);if(i===16)return new Uint16Array(e);if(i===32&&a===3)return new Float32Array(e);throw unsupported("bit depth / sample format",`${i} / ${a}`)}function fill8bit(e,i,a,s){for(let o=0;o<s;o++)e[a++]=i.getUint8(o);return a}function fill16bit(e,i,a,s,o){for(let h=0;h<s*2;h+=2)e[a++]=i.getUint16(h,o);return a}function fillFloat32(e,i,a,s,o){for(let h=0;h<s*4;h+=4)e[a++]=i.getFloat32(h,o);return a}function unsupported(e,i){return new Error(`Unsupported ${e}: ${i}`)}function decodeTIFF(e,i){return new TIFFDecoder(e).decode(i)}function matchAndCrop(e={}){let{algorithm:i="matchToPrevious",ignoreBorder:a=[0,0]}=e;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let s=i==="matchToPrevious",o=this[0],h=[];h[0]={position:[0,0],image:this[0]};let g=[0,0];for(let at=1;at<this.length;at++){let nt=o.getBestMatch(this[at],{border:a});h[at]={position:[nt[0]+g[0],nt[1]+g[1]],image:this[at]},s&&(g[0]+=nt[0],g[1]+=nt[1],o=this[at])}let _=0,$=0,b=0,tt=0;for(let at=0;at<h.length;at++){let nt=h[at];nt.position[0]>_&&(_=nt.position[0]),nt.position[0]<$&&($=nt.position[0]),nt.position[1]>b&&(b=nt.position[1]),nt.position[1]<tt&&(tt=nt.position[1])}$=0-$,tt=0-tt;for(let at=0;at<h.length;at++){let nt=h[at];nt.crop=nt.image.crop({x:_-nt.position[0],y:b-nt.position[1],width:o.width-$-_,height:o.height-tt-b})}let st=[];for(let at=0;at<h.length;at++)st[at]=h[at].crop;return new Stack(st)}function min$2(){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].min;for(let i=1;i<this.length;i++)for(let a=0;a<e.length;a++)e[a]=Math.min(e[a],this[i].min[a]);return e}function max$2(){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].max;for(let i=1;i<this.length;i++)for(let a=0;a<e.length;a++)e[a]=Math.max(e[a],this[i].max[a]);return e}function median$2(e){let i=e.reduce((g,_)=>g+_);if(i===0)throw new Error("unreachable");let a=0,s=0,o=i/2,h;for(;;){if(e[a]>0){if(h!==void 0)return(h+a)/2;if(s+=e[a],s>o)return a;s===o&&(h=a)}a++}}function mean$2(e){let i=0,a=0;for(let s=0;s<e.length;s++)i+=e[s],a+=e[s]*s;return i===0?0:a/i}function median$1(){this.checkProcessable("median",{bitDepth:[8,16]});let e=this.getHistograms({maxSlots:this[0].maxValue+1}),i=new Array(e.length);for(let a=0;a<e.length;a++){let s=e[a];i[a]=median$2(s)}return i}function histogram(e){this.checkProcessable("min",{bitDepth:[8,16]});let i=this[0].getHistogram(e);for(let a=1;a<this.length;a++){let s=this[a].getHistogram(e);for(let o=0;o<i.length;o++)i[o]+=s[o]}return i}function histograms(e){this.checkProcessable("min",{bitDepth:[8,16]});let i=this[0].getHistograms(e),a=i[0].length;for(let s=1;s<this.length;s++){let o=this[s].getHistograms(e);for(let h=0;h<i.length;h++)for(let g=0;g<a;g++)i[h][g]+=o[h][g]}return i}function averageImage(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let e=new Uint32Array(this[0].data.length);for(let s=0;s<this.length;s++){let o=this[s];for(let h=0;h<this[0].data.length;h++)e[h]+=o.data[h]}let i=Image$1.createFrom(this[0]),a=i.data;for(let s=0;s<this[0].data.length;s++)a[s]=e[s]/this.length;return i}function maxImage(){this.checkProcessable("max",{bitDepth:[8,16]});let e=Image$1.createFrom(this[0]);e.data.fill(0);for(const i of this)for(let a=0;a<e.data.length;a++)e.data[a]=Math.max(i.data[a],e.data[a]);return e}function minImage(){this.checkProcessable("max",{bitDepth:[8,16]});let e=Image$1.createFrom(this[0]);e.data.fill(e.maxValue);for(const i of this)for(let a=0;a<e.data.length;a++)e.data[a]=Math.min(i.data[a],e.data[a]);return e}function extend$2(e){e.extendMethod("matchAndCrop",matchAndCrop),e.extendMethod("getMin",min$2),e.extendMethod("getMax",max$2),e.extendMethod("getMedian",median$1),e.extendMethod("getHistogram",histogram),e.extendMethod("getHistograms",histograms),e.extendMethod("getAverage",averageImage),e.extendMethod("getAverageImage",averageImage),e.extendMethod("getMaxImage",maxImage),e.extendMethod("getMinImage",minImage)}let computedPropertyDescriptor={configurable:!0,enumerable:!1,get:void 0};class Stack extends Array{constructor(i){if(Array.isArray(i)){super(i.length);for(let a=0;a<i.length;a++)this[a]=i[a]}else typeof i=="number"?super(i):super();this.computed=null}static load(i){return Promise.all(i.map(Image$1.load)).then(a=>new Stack(a))}static extendMethod(i,a,s={}){let{inPlace:o=!1,returnThis:h=!0,partialArgs:g=[]}=s;return o?Stack.prototype[i]=function(..._){this.computed=null;let $=a.apply(this,[...g,..._]);return h?this:$}:Stack.prototype[i]=function(..._){return a.apply(this,[...g,..._])},Stack}static extendProperty(i,a,s={}){let{partialArgs:o=[]}=s;return computedPropertyDescriptor.get=function(){if(this.computed===null)this.computed={};else if(hasOwn(i,this.computed))return this.computed[i];let h=a.apply(this,o);return this.computed[i]=h,h},Object.defineProperty(Stack.prototype,i,computedPropertyDescriptor),Stack}checkProcessable(i,a={}){if(typeof i!="string")throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(this.size===0)throw new TypeError(`The process: ${i} can not be applied on an empty stack`);this[0].checkProcessable(i,a);for(let s=1;s<this.length;s++){if((a.sameSize===void 0||a.sameSize)&&this[0].width!==this[s].width)throw new TypeError(`The process: ${i} can not be applied if width is not identical in all images`);if((a.sameSize===void 0||a.sameSize)&&this[0].height!==this[s].height)throw new TypeError(`The process: ${i} can not be applied if height is not identical in all images`);if((a.sameAlpha===void 0||a.sameAlpha)&&this[0].alpha!==this[s].alpha)throw new TypeError(`The process: ${i} can not be applied if alpha is not identical in all images`);if((a.sameBitDepth===void 0||a.sameBitDepth)&&this[0].bitDepth!==this[s].bitDepth)throw new TypeError(`The process: ${i} can not be applied if bitDepth is not identical in all images`);if((a.sameColorModel===void 0||a.sameColorModel)&&this[0].colorModel!==this[s].colorModel)throw new TypeError(`The process: ${i} can not be applied if colorModel is not identical in all images`);if((a.sameNumberChannels===void 0||a.sameNumberChannels)&&this[0].channels!==this[s].channels)throw new TypeError(`The process: ${i} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(Stack.prototype.map=function(e,i){if(typeof e!="function")throw new TypeError(`${e} is not a function`);let a=new Stack(this.length);for(let s=0;s<this.length;s++)a[s]=e.call(i,this[s],s,this);return a});extend$2(Stack);const isDataURL=/^data:[a-z]+\/(?:[a-z]+);base64,/;function load(e,i){if(typeof e=="string")return loadURL(e,i);if(e instanceof ArrayBuffer)return Promise.resolve(loadBinary(new Uint8Array(e),void 0,i&&i.ignorePalette));if(e.buffer)return Promise.resolve(loadBinary(e,void 0,i&&i.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')}function loadBinary(e,i,a){const s=imageType(e);if(s)switch(s.mime){case"image/png":return loadPNG(e);case"image/jpeg":return loadJPEG(e);case"image/tiff":return loadTIFF(e,a);default:return loadGeneric(o(s.mime))}return loadGeneric(o("application/octet-stream"));function o(h){return i||toBase64URL(e,h)}}function loadURL(e,i){const a=e.slice(0,64).match(isDataURL);let s;return a!==null?s=Promise.resolve(decode$1(e.slice(a[0].length))):s=fetchBinary(e,i),s.then(o=>{const h=new Uint8Array(o);return loadBinary(h,a?e:void 0,i&&i.ignorePalette)})}function loadPNG(e){const i=decodePng(e);let a=i.channels,s,o=0;return a===2||a===4?(s=a-1,o=1):s=a,i.palette?loadPNGFromPalette(i):new Image$1(i.width,i.height,i.data,{components:s,alpha:o,bitDepth:i.depth,meta:{text:i.text}})}function loadPNGFromPalette(e){const i=e.width*e.height,a=e.palette[0].length,s=new Uint8Array(i*a),o=8/e.depth,h=e.depth<8?o:1,g=parseInt("1".repeat(e.depth),2),_=a===4;let $=0;for(let b=0;b<i;b++){const tt=Math.floor(b/h);let st=e.data[tt];e.depth<8&&(st=st>>>e.depth*(o-1-b%o)&g);const at=e.palette[st];s[$++]=at[0],s[$++]=at[1],s[$++]=at[2],_&&(s[$++]=at[3])}return new Image$1(e.width,e.height,s,{components:3,alpha:_,bitDepth:8})}function loadJPEG(e){const i=srcExports$2.decode(e);let a;i.exif&&(a=getMetadata(i.exif));const s=jpegJsExports.decode(e,{useTArray:!0,maxMemoryUsageInMB:1024});let o=new Image$1(s.width,s.height,s.data,{meta:a});if(a&&a.tiff.tags.Orientation){const h=a.tiff.tags.Orientation;h>2&&(o=o.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[h])),[2,4,5,7].includes(h)&&(o=o.flipX())}return o}function loadTIFF(e,i){let a=decodeTIFF(e);return a.length===1?getImageFromIFD(a[0],i):new Stack(a.map(function(s){return getImageFromIFD(s,i)}))}function getMetadata(e){const i={tiff:{fields:e.fields,tags:e.map}};return e.exif&&(i.exif=e.exif),e.gps&&(i.gps=e.gps),i}function getImageFromIFD(e,i){if(!i&&e.type===3){const a=new Uint16Array(3*e.width*e.height),s=e.palette;let o=0;for(let h=0;h<e.data.length;h++){const g=e.data[h],_=s[g];a[o++]=_[0],a[o++]=_[1],a[o++]=_[2]}return new Image$1(e.width,e.height,a,{components:3,alpha:e.alpha,colorModel:RGB$1,bitDepth:16,meta:getMetadata(e)})}else return new Image$1(e.width,e.height,e.data,{components:e.type===2?3:1,alpha:e.alpha,colorModel:e.type===2?RGB$1:GREY$1,bitDepth:e.bitsPerSample.length?e.bitsPerSample[0]:e.bitsPerSample,meta:getMetadata(e)})}function loadGeneric(e,i){return i=i||{},new Promise(function(a,s){let o=new DOMImage;o.onload=function(){let h=o.width,g=o.height,_=createCanvas(h,g).getContext("2d");_.drawImage(o,0,0,h,g);let $=_.getImageData(0,0,h,g).data;a(new Image$1(h,g,$,i))},o.onerror=function(){s(new Error(`Could not load ${e}`))},o.src=e})}const valueMethods={getValueXY(e,i,a){return this.data[(i*this.width+e)*this.channels+a]},setValueXY(e,i,a,s){return this.data[(i*this.width+e)*this.channels+a]=s,this.computed=null,this},getValue(e,i){return this.data[e*this.channels+i]},setValue(e,i,a){return this.data[e*this.channels+i]=a,this.computed=null,this},getPixelXY(e,i){return this.getPixel(i*this.width+e)},setPixelXY(e,i,a){return this.setPixel(i*this.width+e,a)},getPixel(e){const i=new Array(this.channels),a=e*this.channels;for(let s=0;s<this.channels;s++)i[s]=this.data[a+s];return i},setPixel(e,i){const a=e*this.channels;for(let s=0;s<i.length;s++)this.data[a+s]=i[s];return this.computed=null,this}};function setValueMethods(e){for(const i in valueMethods)e.prototype[i]=valueMethods[i]}function getImageParameters(e){return{width:e.width,height:e.height,components:e.components,alpha:e.alpha,colorModel:e.colorModel,bitDepth:e.bitDepth}}function getOutputImage(e,i,a,s={}){const{out:o}=i;if(o===void 0)return s.copy?e.clone():Image$1.createFrom(e,a);{if(!Image$1.isImage(o))throw new TypeError("out must be an Image object");const h=Object.assign(getImageParameters(e),a);for(const g in h)if(o[g]!==h[g])throw new RangeError(`cannot use out. Its ${g} must be "${h[g]}" (found "${o[g]}")`);return o}}function getOutputImageOrInPlace(e,i,a){if(i.inPlace!==void 0&&typeof i.inPlace!="boolean")throw new TypeError("inPlace option must be a boolean");if(i.inPlace){if(i.out!==void 0)throw new TypeError("out option must not be set if inPlace option is true");return e}return getOutputImage(e,i,null,a)}function abs(e={}){this.checkProcessable("abs",{bitDepth:[32]});const i=getOutputImageOrInPlace(this,e);return absolute(this,i),i}function absolute(e,i){for(let a=0;a<e.data.length;a++)i.data[a]=Math.abs(e.data[a])}function copyAlphaChannel(e,i){if(e.alpha===1&&i.alpha===1)for(let a=0;a<e.size;a++)i.data[a*i.channels+i.components]=e.data[a*e.channels+e.components]}function invert(e={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const i=getOutputImageOrInPlace(this,e);return this.bitDepth===1?invertBinary(this,i):(invertColor(this,i),this!==i&&copyAlphaChannel(this,i)),i}function invertBinary(e,i){for(let a=0;a<e.data.length;a++)i.data[a]=~e.data[a]}function invertColor(e,i){for(let a=0;a<e.data.length;a+=e.channels)for(let s=0;s<e.components;s++)i.data[a+s]=e.maxValue-e.data[a+s]}function flipX(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let e=0;e<this.height;e++){let i=e*this.width*this.channels;for(let a=0;a<Math.floor(this.width/2);a++){let s=a*this.channels+i,o=(this.width-a-1)*this.channels+i;for(let h=0;h<this.channels;h++){let g=this.data[s+h];this.data[s+h]=this.data[o+h],this.data[o+h]=g}}}return this}function flipY(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let e=0;e<Math.floor(this.height/2);e++)for(let i=0;i<this.width;i++){let a=i*this.channels+e*this.width*this.channels,s=i*this.channels+(this.height-1-e)*this.channels*this.width;for(let o=0;o<this.channels;o++){let h=this.data[a+o];this.data[a+o]=this.data[s+o],this.data[s+o]=h}}return this}function blurFilter(e={}){const{radius:i=1}=e;if(i<1)throw new Error("radius must be greater than 1");const a=2*i+1,s=new Array(a);for(let o=0;o<a;o++){s[o]=new Array(a);for(let h=0;h<a;h++)s[o][h]=1/(a*a)}return this.convolution(s)}var medianQuickselect_min={exports:{}},hasRequiredMedianQuickselect_min;function requireMedianQuickselect_min(){return hasRequiredMedianQuickselect_min||(hasRequiredMedianQuickselect_min=1,function(e){(function(){function i(o){for(var h=0,g=o.length-1,_=void 0,$=void 0,b=void 0,tt=s(h,g);;){if(g<=h)return o[tt];if(g==h+1)return o[h]>o[g]&&a(o,h,g),o[tt];for(_=s(h,g),o[_]>o[g]&&a(o,_,g),o[h]>o[g]&&a(o,h,g),o[_]>o[h]&&a(o,_,h),a(o,_,h+1),$=h+1,b=g;;){do $++;while(o[h]>o[$]);do b--;while(o[b]>o[h]);if(b<$)break;a(o,$,b)}a(o,h,b),b<=tt&&(h=$),b>=tt&&(g=b-1)}}var a=function(o,h,g){var _;return _=[o[g],o[h]],o[h]=_[0],o[g]=_[1],_},s=function(o,h){return~~((o+h)/2)};e.exports?e.exports=i:window.median=i})()}(medianQuickselect_min)),medianQuickselect_min.exports}var medianQuickselect_minExports=requireMedianQuickselect_min();const quickSelectMedian=getDefaultExportFromCjs(medianQuickselect_minExports);function validateArrayOfChannels(e,i={}){let{channels:a,allowAlpha:s,defaultAlpha:o}=i;return typeof s!="boolean"&&(s=!0),typeof a>"u"?allChannels(e,o):validateChannels(e,a,s)}function allChannels(e,i){let a=i?e.channels:e.components,s=new Array(a);for(let o=0;o<a;o++)s[o]=o;return s}function validateChannels(e,i,a){Array.isArray(i)||(i=[i]);for(let s=0;s<i.length;s++)i[s]=validateChannel(e,i[s],a);return i}function validateChannel(e,i,a=!0){if(i===void 0)throw new RangeError(`validateChannel : the channel has to be >=0 and <${e.channels}`);if(typeof i=="string"){switch(e.colorModel){case GREY$1:break;case RGB$1:if("rgb".includes(i))switch(i){case"r":i=0;break;case"g":i=1;break;case"b":i=2;break}break;case HSL:if("hsl".includes(i))switch(i){case"h":i=0;break;case"s":i=1;break;case"l":i=2;break}break;case HSV:if("hsv".includes(i))switch(i){case"h":i=0;break;case"s":i=1;break;case"v":i=2;break}break;case CMYK$1:if("cmyk".includes(i))switch(i){case"c":i=0;break;case"m":i=1;break;case"y":i=2;break;case"k":i=3;break}break;default:throw new Error(`Unexpected color model: ${e.colorModel}`)}if(i==="a"){if(!e.alpha)throw new Error("validateChannel : the image does not contain alpha channel");i=e.components}if(typeof i=="string")throw new Error(`validateChannel : undefined channel: ${i}`)}if(i>=e.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${e.channels}`);if(!a&&i>=e.components)throw new RangeError("validateChannel : alpha channel may not be selected");return i}function medianFilter(e={}){let{radius:i=1,border:a="copy",channels:s}=e;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),i<1)throw new Error("radius must be greater than 0");s=validateArrayOfChannels(this,s);let o=i,h=i,g=Image$1.createFrom(this),_=(o*2+1)*(h*2+1),$=new Array(_);for(let b=0;b<s.length;b++){let tt=s[b];for(let st=h;st<this.height-h;st++)for(let at=o;at<this.width-o;at++){let nt=0;for(let ft=-h;ft<=h;ft++)for(let pt=-o;pt<=o;pt++){let dt=((st+ft)*this.width+at+pt)*this.channels+tt;$[nt++]=this.data[dt]}let lt=(st*this.width+at)*this.channels+tt;g.data[lt]=quickSelectMedian($)}}if(this.alpha&&!s.includes(this.channels))for(let b=this.components;b<this.data.length;b=b+this.channels)g.data[b]=this.data[b];return g.setBorder({size:[o,h],algorithm:a}),g}function gaussianFilter(e={}){let{radius:i=1,sigma:a,channels:s,border:o="copy"}=e;this.checkProcessable("gaussian",{bitDepth:[8,16]});const h=getKernel(i,a);return this.convolution([h,h],{border:o,channels:s,algorithm:"separable"})}function getKernel(e,i){const a=e*2+1,s=new Array(a),o=i||((a-1)*.5-1)*.3+.8,h=-.5/(o*o);let g=0;for(let _=0;_<a;_++){const $=_-e,b=Math.exp(h*$*$);s[_]=b,g+=b}for(let _=0;_<a;_++)s[_]/=g;return s}const SOBEL_X=[[-1,0,1],[-2,0,2],[-1,0,1]],SOBEL_Y=[[-1,-2,-1],[0,0,0],[1,2,1]],SCHARR_X=[[3,0,-3],[10,0,-10],[3,0,-3]],SCHARR_Y=[[3,10,3],[0,0,0],[-3,-10,-3]];var src$2={},fftlib={},hasRequiredFftlib;function requireFftlib(){return hasRequiredFftlib||(hasRequiredFftlib=1,function(e){(function(){var i;i=e;var a={release:"0.3.0",date:"2013-03"};i.toString=function(){return"version "+a.release+", released "+a.date};for(var s=0,o=null,h=null,g={init:function(b){if(b!==0&&!(b&b-1))s=b,g._initArray(),g._makeBitReversalTable(),g._makeCosSinTable();else throw new Error("init: radix-2 required")},fft1d:function(b,tt){g.fft(b,tt,1)},ifft1d:function(b,tt){var st=1/s;g.fft(b,tt,-1);for(var at=0;at<s;at++)b[at]*=st,tt[at]*=st},bt1d:function(b,tt){g.fft(b,tt,-1)},fft2d:function(b,tt){for(var st=[],at=[],nt=0,lt=0;lt<s;lt++){nt=lt*s;for(var ft=0;ft<s;ft++)st[ft]=b[ft+nt],at[ft]=tt[ft+nt];g.fft1d(st,at);for(var pt=0;pt<s;pt++)b[pt+nt]=st[pt],tt[pt+nt]=at[pt]}for(var dt=0;dt<s;dt++){for(var _t=0;_t<s;_t++)nt=dt+_t*s,st[_t]=b[nt],at[_t]=tt[nt];g.fft1d(st,at);for(var ut=0;ut<s;ut++)nt=dt+ut*s,b[nt]=st[ut],tt[nt]=at[ut]}},ifft2d:function(b,tt){for(var st=[],at=[],nt=0,lt=0;lt<s;lt++){nt=lt*s;for(var ft=0;ft<s;ft++)st[ft]=b[ft+nt],at[ft]=tt[ft+nt];g.ifft1d(st,at);for(var pt=0;pt<s;pt++)b[pt+nt]=st[pt],tt[pt+nt]=at[pt]}for(var dt=0;dt<s;dt++){for(var _t=0;_t<s;_t++)nt=dt+_t*s,st[_t]=b[nt],at[_t]=tt[nt];g.ifft1d(st,at);for(var ut=0;ut<s;ut++)nt=dt+ut*s,b[nt]=st[ut],tt[nt]=at[ut]}},fft:function(b,tt,st){for(var at,nt,lt,ft,pt,dt,_t,ut,mt,kt=s>>2,bt=0;bt<s;bt++)ft=o[bt],bt<ft&&(pt=b[bt],b[bt]=b[ft],b[ft]=pt,pt=tt[bt],tt[bt]=tt[ft],tt[ft]=pt);for(var vt=1;vt<s;vt<<=1){nt=0,at=s/(vt<<1);for(var Et=0;Et<vt;Et++){dt=h[nt+kt],_t=st*h[nt];for(var Mt=Et;Mt<s;Mt+=vt<<1)lt=Mt+vt,ut=dt*b[lt]+_t*tt[lt],mt=dt*tt[lt]-_t*b[lt],b[lt]=b[Mt]-ut,b[Mt]+=ut,tt[lt]=tt[Mt]-mt,tt[Mt]+=mt;nt+=at}}},_initArray:function(){typeof Uint32Array<"u"?o=new Uint32Array(s):o=[],typeof Float64Array<"u"?h=new Float64Array(s*1.25):h=[]},_paddingZero:function(){},_makeBitReversalTable:function(){var b=0,tt=0,st=0;for(o[0]=0;++b<s;){for(st=s>>1;st<=tt;)tt-=st,st>>=1;tt+=st,o[b]=tt}},_makeCosSinTable:function(){var b=s>>1,tt=s>>2,st=s>>3,at=b+tt,nt=Math.sin(Math.PI/s),lt=2*nt*nt,ft=Math.sqrt(lt*(2-lt)),pt=h[tt]=1,dt=h[0]=0;nt=2*lt;for(var _t=1;_t<st;_t++)pt-=lt,lt+=nt*pt,dt+=ft,ft-=nt*dt,h[_t]=dt,h[tt-_t]=pt;st!==0&&(h[st]=Math.sqrt(.5));for(var ut=0;ut<tt;ut++)h[b-ut]=h[ut];for(var mt=0;mt<at;mt++)h[mt+b]=-h[mt]}},_=["init","fft1d","ifft1d","fft2d","ifft2d"],$=0;$<_.length;$++)i[_[$]]=g[_[$]];return i.bt=g.bt1d,i.fft=g.fft1d,i.ifft=g.ifft1d,i}).call(fftlib)}(fftlib)),fftlib}var FFTUtils_1,hasRequiredFFTUtils;function requireFFTUtils(){if(hasRequiredFFTUtils)return FFTUtils_1;hasRequiredFFTUtils=1;var e=requireFftlib(),i={DEBUG:!1,ifft2DArray:function(a,s,o){var h=new Array(s*o),g=s/2,_=(o-1)*2;e.init(g);for(var $={re:new Array(g),im:new Array(g)},b=0;b<o;b++){for(var tt=g-1;tt>=0;tt--)$.re[tt]=a[tt*2*o+b],$.im[tt]=a[(tt*2+1)*o+b];e.bt($.re,$.im);for(var tt=g-1;tt>=0;tt--)h[tt*2*o+b]=$.re[tt],h[(tt*2+1)*o+b]=$.im[tt]}var st=new Array(g*_);e.init(_);for(var at={re:new Array(_),im:new Array(_)},nt=_*g,tt=0;tt<s;tt+=2){at.re[0]=h[tt*o],at.im[0]=h[(tt+1)*o];for(var b=1;b<o;b++)at.re[b]=h[tt*o+b],at.im[b]=h[(tt+1)*o+b],at.re[_-b]=h[tt*o+b],at.im[_-b]=-h[(tt+1)*o+b];e.bt(at.re,at.im);for(var lt=tt/2*_,b=_-1;b>=0;b--)st[lt+b]=at.re[b]/nt}return st},fft2DArray:function(a,s,o,h){Object.assign({},{inplace:!0});var g=o/2+1,_=s*2,$=new Array(_*g);e.init(o);for(var b={re:new Array(o),im:new Array(o)},tt={re:new Array(o),im:new Array(o)},st={re:new Array(o),im:new Array(o)},at,nt,lt,ft,pt,dt=0;dt<s/2;dt++){at=dt*2*o,b.re=a.slice(at,at+o),at=(dt*2+1)*o,b.im=a.slice(at,at+o),e.fft1d(b.re,b.im),this.reconstructTwoRealFFT(b,tt,st),nt=dt*4*g,lt=(dt*4+1)*g,ft=(dt*4+2)*g,pt=(dt*4+3)*g;for(var _t=g-1;_t>=0;_t--)$[nt+_t]=tt.re[_t],$[lt+_t]=tt.im[_t],$[ft+_t]=st.re[_t],$[pt+_t]=st.im[_t]}tt=null,st=null;var ut=new Array(_*g);e.init(s);for(var mt={re:new Array(s),im:new Array(s)},kt=g-1;kt>=0;kt--){for(var dt=s-1;dt>=0;dt--)mt.re[dt]=$[dt*2*g+kt],mt.im[dt]=$[(dt*2+1)*g+kt],isNaN(mt.re[dt])&&(mt.re[dt]=0),isNaN(mt.im[dt])&&(mt.im[dt]=0);e.fft1d(mt.re,mt.im);for(var dt=s-1;dt>=0;dt--)ut[dt*2*g+kt]=mt.re[dt],ut[(dt*2+1)*g+kt]=mt.im[dt]}return ut},reconstructTwoRealFFT:function(a,s,o){var h=a.re.length;s.re[0]=a.re[0],s.im[0]=0,o.re[0]=a.im[0],o.im[0]=0;for(var g,_,$,b,tt,st=h/2;st>0;st--)tt=h-st,g=.5*(a.re[st]-a.re[tt]),_=.5*(a.re[st]+a.re[tt]),$=.5*(a.im[st]-a.im[tt]),b=.5*(a.im[st]+a.im[tt]),s.re[st]=_,s.im[st]=$,s.re[tt]=_,s.im[tt]=-$,o.re[st]=b,o.im[st]=-g,o.re[tt]=b,o.im[tt]=g},convolute2DI:function(a,s,o,h){for(var g,_,$=0;$<o/2;$++)for(var b=0;b<h;b++)g=a[$*2*h+b]*s[$*2*h+b]-a[($*2+1)*h+b]*s[($*2+1)*h+b],_=a[$*2*h+b]*s[($*2+1)*h+b]+a[($*2+1)*h+b]*s[$*2*h+b],a[$*2*h+b]=g,a[($*2+1)*h+b]=_},convolute:function(a,s,o,h,g){for(var _=new Array(h*o),$=0;$<o*h;$++)_[$]=a[$];_=this.fft2DArray(_,o,h);for(var b=s.length,tt=s[0].length,st=new Array(h*o),$=0;$<h*o;$++)st[$]=0;for(var at,nt,lt=Math.floor((b-1)/2),ft=Math.floor((tt-1)/2),pt=0;pt<b;pt++){at=(pt-lt+o)%o;for(var dt=0;dt<tt;dt++)nt=(dt-ft+h)%h,st[at*h+nt]=s[pt][dt]}st=this.fft2DArray(st,o,h);var _t=o*2,ut=h/2+1;return this.convolute2DI(_,st,_t,ut),this.ifft2DArray(_,_t,ut)},toRadix2:function(a,s,o){var h,g,_,$,b=o,tt=s;if(!(o!==0&&!(o&o-1))){for(b=0;o>>++b;);b=1<<b}if(!(s!==0&&!(s&s-1))){for(tt=0;s>>++tt;);tt=1<<tt}if(tt==s&&b==o)return{data:a,rows:s,cols:o};var st=new Array(tt*b),at=Math.floor((tt-s)/2)-s,nt=Math.floor((b-o)/2)-o;for(h=0;h<tt;h++)for(_=h*b,$=(h-at)%s*o,g=0;g<b;g++)st[_+g]=a[$+(g-nt)%o];return{data:st,rows:tt,cols:b}},crop:function(a,s,o,h,g,_){if(s==h&&o==g)return a;Object.assign({},_);var $=new Array(g*h),b=Math.floor((s-h)/2),tt=Math.floor((o-g)/2),st,at,nt,lt;for(nt=0;nt<h;nt++)for(st=nt*g,at=(nt+b)*o,lt=0;lt<g;lt++)$[st+lt]=a[at+(lt+tt)];return $}};return FFTUtils_1=i,FFTUtils_1}var hasRequiredSrc$2;function requireSrc$2(){return hasRequiredSrc$2||(hasRequiredSrc$2=1,src$2.FFTUtils=requireFFTUtils(),src$2.FFT=requireFftlib()),src$2}var src$1,hasRequiredSrc$1;function requireSrc$1(){if(hasRequiredSrc$1)return src$1;hasRequiredSrc$1=1;var e=requireSrc$2().FFTUtils;function i(h,g,_){var $=o(h),b=$.data,tt=Object.assign({normalize:!1,divisor:1,rows:$.rows,cols:$.cols},_),st,at;if(tt.rows&&tt.cols)st=tt.rows,at=tt.cols;else throw new Error("Invalid number of rows or columns "+st+" "+at);var nt=tt.divisor,lt,ft,pt=g.length,dt=g[0].length;if(tt.normalize)for(nt=0,lt=0;lt<pt;lt++)for(ft=0;ft<dt;ft++)nt+=g[lt][ft];if(nt===0)throw new RangeError("convolution: The divisor is equal to zero");var _t=e.toRadix2(b,st,at),ut=e.convolute(_t.data,g,_t.rows,_t.cols);if(ut=e.crop(ut,_t.rows,_t.cols,st,at),nt!=0&&nt!=1)for(lt=0;lt<ut.length;lt++)ut[lt]/=nt;return ut}function a(h,g,_){var $=o(h),b=$.data,tt=Object.assign({normalize:!1,divisor:1,rows:$.rows,cols:$.cols},_),st,at;if(tt.rows&&tt.cols)st=tt.rows,at=tt.cols;else throw new Error("Invalid number of rows or columns "+st+" "+at);var nt=tt.divisor,lt=g.length,ft=g[0].length,pt,dt,_t,ut,mt,kt,bt,vt,Et;if(tt.normalize)for(nt=0,pt=0;pt<lt;pt++)for(dt=0;dt<ft;dt++)nt+=g[pt][dt];if(nt===0)throw new RangeError("convolution: The divisor is equal to zero");var Mt=new Array(st*at),At=Math.floor(lt/2),zt=Math.floor(ft/2);for(ut=0;ut<st;ut++)for(_t=0;_t<at;_t++){for(kt=0,dt=0;dt<lt;dt++)for(pt=0;pt<ft;pt++)bt=g[lt-dt-1][ft-pt-1],vt=(ut+dt-At+st)%st,Et=(_t+pt-zt+at)%at,mt=vt*at+Et,kt+=b[mt]*bt;mt=ut*at+_t,Mt[mt]=kt/nt}return Mt}function s(h,g,_){var $=1e3;_&&_.factor&&($=_.factor);var b=new Array(g),tt,st,at,nt;$*=-1;var lt=(g-1)/2,ft=2*h*h;for(tt=0;tt<g;tt++)for(b[tt]=new Array(g),nt=(tt-lt)*(tt-lt),st=0;st<g;st++)at=-((st-lt)*(st-lt)+nt)/ft,b[tt][st]=Math.round($*(1+at)*Math.exp(at));return b}function o(h){var g=h,_,$;if(typeof h[0]!="number"){_=h.length,$=h[0].length,g=new Array(_*$);for(var b=0;b<_;b++)for(var tt=0;tt<$;tt++)g[b*$+tt]=h[b][tt]}else{var st=Math.sqrt(h.length);Number.isInteger(st)&&(_=st,$=st)}return{data:g,rows:_,cols:$}}return src$1={fft:i,direct:a,kernelFactory:{LoG:s},matrix2Array:o},src$1}var srcExports$1=requireSrc$1(),_isFinite,hasRequired_isFinite;function require_isFinite(){return hasRequired_isFinite||(hasRequired_isFinite=1,_isFinite=Number.isFinite||function(e){return!(typeof e!="number"||e!==e||e===1/0||e===-1/0)}),_isFinite}var isInteger$1,hasRequiredIsInteger;function requireIsInteger(){if(hasRequiredIsInteger)return isInteger$1;hasRequiredIsInteger=1;var e=require_isFinite();return isInteger$1=Number.isInteger||function(i){return typeof i=="number"&&e(i)&&Math.floor(i)===i},isInteger$1}var isIntegerExports=requireIsInteger();const isInteger=getDefaultExportFromCjs(isIntegerExports);function validateKernel(e){let i,a;if(Array.isArray(e))if(Array.isArray(e[0])){if(!(e.length&1)||!(e[0].length&1))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");i=Math.floor(e.length/2),a=Math.floor(e[0].length/2)}else{let s=Math.sqrt(e.length);if(isInteger(s))a=i=Math.floor(Math.sqrt(e.length)/2);else throw new RangeError("validateKernel: Kernel array should be a square");let o=new Array(s);for(let h=0;h<s;h++){o[h]=new Array(s);for(let g=0;g<s;g++)o[h][g]=e[h*s+g]}e=o}else throw new Error(`validateKernel: Invalid Kernel: ${e}`);return{kernel:e,kWidth:a,kHeight:i}}function clamp(e,i){return Math.round(Math.min(Math.max(e,0),i.maxValue))}function directConvolution(e,i,a){if(a===void 0){const h=e.length+i.length-1;a=new Array(h)}fill(a);for(var s=0;s<e.length;s++)for(var o=0;o<i.length;o++)a[s+o]+=e[s]*i[o];return a}function fill(e){for(var i=0;i<e.length;i++)e[i]=0}var fft,hasRequiredFft;function requireFft(){if(hasRequiredFft)return fft;hasRequiredFft=1;function e(i){if(this.size=i|0,this.size<=1||(this.size&this.size-1)!==0)throw new Error("FFT size must be a power of two and bigger than 1");this._csize=i<<1;for(var a=new Array(this.size*2),s=0;s<a.length;s+=2){const b=Math.PI*s/this.size;a[s]=Math.cos(b),a[s+1]=-Math.sin(b)}this.table=a;for(var o=0,h=1;this.size>h;h<<=1)o++;this._width=o%2===0?o-1:o,this._bitrev=new Array(1<<this._width);for(var g=0;g<this._bitrev.length;g++){this._bitrev[g]=0;for(var _=0;_<this._width;_+=2){var $=this._width-_-2;this._bitrev[g]|=(g>>>_&3)<<$}}this._out=null,this._data=null,this._inv=0}return fft=e,e.prototype.fromComplexArray=function(i,a){for(var s=a||new Array(i.length>>>1),o=0;o<i.length;o+=2)s[o>>>1]=i[o];return s},e.prototype.createComplexArray=function(){const i=new Array(this._csize);for(var a=0;a<i.length;a++)i[a]=0;return i},e.prototype.toComplexArray=function(i,a){for(var s=a||this.createComplexArray(),o=0;o<s.length;o+=2)s[o]=i[o>>>1],s[o+1]=0;return s},e.prototype.completeSpectrum=function(i){for(var a=this._csize,s=a>>>1,o=2;o<s;o+=2)i[a-o]=i[o],i[a-o+1]=-i[o+1]},e.prototype.transform=function(i,a){if(i===a)throw new Error("Input and output buffers must be different");this._out=i,this._data=a,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(i,a){if(i===a)throw new Error("Input and output buffers must be different");this._out=i,this._data=a,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(i,a){if(i===a)throw new Error("Input and output buffers must be different");this._out=i,this._data=a,this._inv=1,this._transform4();for(var s=0;s<i.length;s++)i[s]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var i=this._out,a=this._csize,s=this._width,o=1<<s,h=a/o<<1,g,_,$=this._bitrev;if(h===4)for(g=0,_=0;g<a;g+=h,_++){const ft=$[_];this._singleTransform2(g,ft,o)}else for(g=0,_=0;g<a;g+=h,_++){const ft=$[_];this._singleTransform4(g,ft,o)}var b=this._inv?-1:1,tt=this.table;for(o>>=2;o>=2;o>>=2){h=a/o<<1;var st=h>>>2;for(g=0;g<a;g+=h)for(var at=g+st,nt=g,lt=0;nt<at;nt+=2,lt+=o){const ft=nt,pt=ft+st,dt=pt+st,_t=dt+st,ut=i[ft],mt=i[ft+1],kt=i[pt],bt=i[pt+1],vt=i[dt],Et=i[dt+1],Mt=i[_t],At=i[_t+1],zt=ut,Vt=mt,Gt=tt[lt],Kt=b*tt[lt+1],Wt=kt*Gt-bt*Kt,sn=kt*Kt+bt*Gt,on=tt[2*lt],Xt=b*tt[2*lt+1],ln=vt*on-Et*Xt,nn=vt*Xt+Et*on,gn=tt[3*lt],dn=b*tt[3*lt+1],$n=Mt*gn-At*dn,En=Mt*dn+At*gn,qt=zt+ln,en=Vt+nn,Tn=zt-ln,Sn=Vt-nn,fn=Wt+$n,Wn=sn+En,Zn=b*(Wt-$n),Gn=b*(sn-En),zn=qt+fn,Bn=en+Wn,or=qt-fn,Jn=en-Wn,Un=Tn+Gn,nr=Sn-Zn,wn=Tn-Gn,jn=Sn+Zn;i[ft]=zn,i[ft+1]=Bn,i[pt]=Un,i[pt+1]=nr,i[dt]=or,i[dt+1]=Jn,i[_t]=wn,i[_t+1]=jn}}},e.prototype._singleTransform2=function(i,a,s){const o=this._out,h=this._data,g=h[a],_=h[a+1],$=h[a+s],b=h[a+s+1],tt=g+$,st=_+b,at=g-$,nt=_-b;o[i]=tt,o[i+1]=st,o[i+2]=at,o[i+3]=nt},e.prototype._singleTransform4=function(i,a,s){const o=this._out,h=this._data,g=this._inv?-1:1,_=s*2,$=s*3,b=h[a],tt=h[a+1],st=h[a+s],at=h[a+s+1],nt=h[a+_],lt=h[a+_+1],ft=h[a+$],pt=h[a+$+1],dt=b+nt,_t=tt+lt,ut=b-nt,mt=tt-lt,kt=st+ft,bt=at+pt,vt=g*(st-ft),Et=g*(at-pt),Mt=dt+kt,At=_t+bt,zt=ut+Et,Vt=mt-vt,Gt=dt-kt,Kt=_t-bt,Wt=ut-Et,sn=mt+vt;o[i]=Mt,o[i+1]=At,o[i+2]=zt,o[i+3]=Vt,o[i+4]=Gt,o[i+5]=Kt,o[i+6]=Wt,o[i+7]=sn},e.prototype._realTransform4=function(){var i=this._out,a=this._csize,s=this._width,o=1<<s,h=a/o<<1,g,_,$=this._bitrev;if(h===4)for(g=0,_=0;g<a;g+=h,_++){const Pn=$[_];this._singleRealTransform2(g,Pn>>>1,o>>>1)}else for(g=0,_=0;g<a;g+=h,_++){const Pn=$[_];this._singleRealTransform4(g,Pn>>>1,o>>>1)}var b=this._inv?-1:1,tt=this.table;for(o>>=2;o>=2;o>>=2){h=a/o<<1;var st=h>>>1,at=st>>>1,nt=at>>>1;for(g=0;g<a;g+=h)for(var lt=0,ft=0;lt<=nt;lt+=2,ft+=o){var pt=g+lt,dt=pt+at,_t=dt+at,ut=_t+at,mt=i[pt],kt=i[pt+1],bt=i[dt],vt=i[dt+1],Et=i[_t],Mt=i[_t+1],At=i[ut],zt=i[ut+1],Vt=mt,Gt=kt,Kt=tt[ft],Wt=b*tt[ft+1],sn=bt*Kt-vt*Wt,on=bt*Wt+vt*Kt,Xt=tt[2*ft],ln=b*tt[2*ft+1],nn=Et*Xt-Mt*ln,gn=Et*ln+Mt*Xt,dn=tt[3*ft],$n=b*tt[3*ft+1],En=At*dn-zt*$n,qt=At*$n+zt*dn,en=Vt+nn,Tn=Gt+gn,Sn=Vt-nn,fn=Gt-gn,Wn=sn+En,Zn=on+qt,Gn=b*(sn-En),zn=b*(on-qt),Bn=en+Wn,or=Tn+Zn,Jn=Sn+zn,Un=fn-Gn;if(i[pt]=Bn,i[pt+1]=or,i[dt]=Jn,i[dt+1]=Un,lt===0){var nr=en-Wn,wn=Tn-Zn;i[_t]=nr,i[_t+1]=wn;continue}if(lt!==nt){var jn=Sn,er=-fn,Vn=en,Rn=-Tn,ar=-b*zn,Hn=-b*Gn,Fn=-b*Zn,qn=-b*Wn,ir=jn+ar,Nn=er+Hn,Kn=Vn+qn,Ut=Rn-Fn,xn=g+at-lt,kn=g+st-lt;i[xn]=ir,i[xn+1]=Nn,i[kn]=Kn,i[kn+1]=Ut}}}},e.prototype._singleRealTransform2=function(i,a,s){const o=this._out,h=this._data,g=h[a],_=h[a+s],$=g+_,b=g-_;o[i]=$,o[i+1]=0,o[i+2]=b,o[i+3]=0},e.prototype._singleRealTransform4=function(i,a,s){const o=this._out,h=this._data,g=this._inv?-1:1,_=s*2,$=s*3,b=h[a],tt=h[a+s],st=h[a+_],at=h[a+$],nt=b+st,lt=b-st,ft=tt+at,pt=g*(tt-at),dt=nt+ft,_t=lt,ut=-pt,mt=nt-ft,kt=lt,bt=pt;o[i]=dt,o[i+1]=0,o[i+2]=_t,o[i+3]=ut,o[i+4]=mt,o[i+5]=0,o[i+6]=kt,o[i+7]=bt},fft}requireFft();function convolutionSeparable(e,i,a,s){const o=new Array(e.length);let h,g,_,$;$=i[1],_=($.length-1)/2,g=new Array(a+$.length-1),h=new Array(a);for(let b=0;b<s;b++){for(let tt=0;tt<a;tt++)h[tt]=e[b*a+tt];directConvolution(h,$,g);for(let tt=0;tt<a;tt++)o[b*a+tt]=g[_+tt]}$=i[0],_=($.length-1)/2,g=new Array(s+$.length-1),h=new Array(s);for(let b=0;b<a;b++){for(let tt=0;tt<s;tt++)h[tt]=o[tt*a+b];directConvolution(h,$,g);for(let tt=0;tt<s;tt++)o[tt*a+b]=g[_+tt]}return o}var matrix$1={};const toString=Object.prototype.toString;function isAnyArray(e){const i=toString.call(e);return i.endsWith("Array]")&&!i.includes("Big")}const libEsm=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(libEsm);function max$1(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!isAnyArray(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var a=i.fromIndex,s=a===void 0?0:a,o=i.toIndex,h=o===void 0?e.length:o;if(s<0||s>=e.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(h<=s||h>e.length||!Number.isInteger(h))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var g=e[s],_=s+1;_<h;_++)e[_]>g&&(g=e[_]);return g}function min$1(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!isAnyArray(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var a=i.fromIndex,s=a===void 0?0:a,o=i.toIndex,h=o===void 0?e.length:o;if(s<0||s>=e.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(h<=s||h>e.length||!Number.isInteger(h))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var g=e[s],_=s+1;_<h;_++)e[_]<g&&(g=e[_]);return g}function rescale(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(isAnyArray(e)){if(e.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var a;if(i.output!==void 0){if(!isAnyArray(i.output))throw new TypeError("output option must be an array if specified");a=i.output}else a=new Array(e.length);var s=min$1(e),o=max$1(e);if(s===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=i.min,g=h===void 0?i.autoMinMax?s:0:h,_=i.max,$=_===void 0?i.autoMinMax?o:1:_;if(g>=$)throw new RangeError("min option must be smaller than max option");for(var b=($-g)/(o-s),tt=0;tt<e.length;tt++)a[tt]=(e[tt]-s)*b+g;return a}const libEs6=Object.freeze(Object.defineProperty({__proto__:null,default:rescale},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(libEs6);var hasRequiredMatrix;function requireMatrix(){var e,i,a;if(hasRequiredMatrix)return matrix$1;hasRequiredMatrix=1,Object.defineProperty(matrix$1,"__esModule",{value:!0});var s=require$$0$1,o=require$$1;const h=" ".repeat(2),g=" ".repeat(4);function _(){return $(this)}function $(ct,rt={}){const{maxRows:et=15,maxColumns:it=10,maxNumSize:ht=8,padMinus:yt="auto"}=rt;return`${ct.constructor.name} {
${h}[
${g}${b(ct,et,it,ht,yt)}
${h}]
${h}rows: ${ct.rows}
${h}columns: ${ct.columns}
}`}function b(ct,rt,et,it,ht){const{rows:yt,columns:Lt}=ct,Nt=Math.min(yt,rt),Ct=Math.min(Lt,et),Ht=[];if(ht==="auto"){ht=!1;t:for(let rn=0;rn<Nt;rn++)for(let jt=0;jt<Ct;jt++)if(ct.get(rn,jt)<0){ht=!0;break t}}for(let rn=0;rn<Nt;rn++){let jt=[];for(let pn=0;pn<Ct;pn++)jt.push(tt(ct.get(rn,pn),it,ht));Ht.push(`${jt.join(" ")}`)}return Ct!==Lt&&(Ht[Ht.length-1]+=` ... ${Lt-et} more columns`),Nt!==yt&&Ht.push(`... ${yt-rt} more rows`),Ht.join(`
${g}`)}function tt(ct,rt,et){return(ct>=0&&et?` ${st(ct,rt-1)}`:st(ct,rt)).padEnd(rt)}function st(ct,rt){let et=ct.toString();if(et.length<=rt)return et;let it=ct.toFixed(rt);if(it.length>rt&&(it=ct.toFixed(Math.max(0,rt-(it.length-rt)))),it.length<=rt&&!it.startsWith("0.000")&&!it.startsWith("-0.000"))return it;let ht=ct.toExponential(rt);return ht.length>rt&&(ht=ct.toExponential(Math.max(0,rt-(ht.length-rt)))),ht.slice(0)}function at(ct,rt){ct.prototype.add=function(et){return typeof et=="number"?this.addS(et):this.addM(et)},ct.prototype.addS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)+et);return this},ct.prototype.addM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)+et.get(it,ht));return this},ct.add=function(et,it){return new rt(et).add(it)},ct.prototype.sub=function(et){return typeof et=="number"?this.subS(et):this.subM(et)},ct.prototype.subS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)-et);return this},ct.prototype.subM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)-et.get(it,ht));return this},ct.sub=function(et,it){return new rt(et).sub(it)},ct.prototype.subtract=ct.prototype.sub,ct.prototype.subtractS=ct.prototype.subS,ct.prototype.subtractM=ct.prototype.subM,ct.subtract=ct.sub,ct.prototype.mul=function(et){return typeof et=="number"?this.mulS(et):this.mulM(et)},ct.prototype.mulS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)*et);return this},ct.prototype.mulM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)*et.get(it,ht));return this},ct.mul=function(et,it){return new rt(et).mul(it)},ct.prototype.multiply=ct.prototype.mul,ct.prototype.multiplyS=ct.prototype.mulS,ct.prototype.multiplyM=ct.prototype.mulM,ct.multiply=ct.mul,ct.prototype.div=function(et){return typeof et=="number"?this.divS(et):this.divM(et)},ct.prototype.divS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)/et);return this},ct.prototype.divM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)/et.get(it,ht));return this},ct.div=function(et,it){return new rt(et).div(it)},ct.prototype.divide=ct.prototype.div,ct.prototype.divideS=ct.prototype.divS,ct.prototype.divideM=ct.prototype.divM,ct.divide=ct.div,ct.prototype.mod=function(et){return typeof et=="number"?this.modS(et):this.modM(et)},ct.prototype.modS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)%et);return this},ct.prototype.modM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)%et.get(it,ht));return this},ct.mod=function(et,it){return new rt(et).mod(it)},ct.prototype.modulus=ct.prototype.mod,ct.prototype.modulusS=ct.prototype.modS,ct.prototype.modulusM=ct.prototype.modM,ct.modulus=ct.mod,ct.prototype.and=function(et){return typeof et=="number"?this.andS(et):this.andM(et)},ct.prototype.andS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)&et);return this},ct.prototype.andM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)&et.get(it,ht));return this},ct.and=function(et,it){return new rt(et).and(it)},ct.prototype.or=function(et){return typeof et=="number"?this.orS(et):this.orM(et)},ct.prototype.orS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)|et);return this},ct.prototype.orM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)|et.get(it,ht));return this},ct.or=function(et,it){return new rt(et).or(it)},ct.prototype.xor=function(et){return typeof et=="number"?this.xorS(et):this.xorM(et)},ct.prototype.xorS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)^et);return this},ct.prototype.xorM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)^et.get(it,ht));return this},ct.xor=function(et,it){return new rt(et).xor(it)},ct.prototype.leftShift=function(et){return typeof et=="number"?this.leftShiftS(et):this.leftShiftM(et)},ct.prototype.leftShiftS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)<<et);return this},ct.prototype.leftShiftM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)<<et.get(it,ht));return this},ct.leftShift=function(et,it){return new rt(et).leftShift(it)},ct.prototype.signPropagatingRightShift=function(et){return typeof et=="number"?this.signPropagatingRightShiftS(et):this.signPropagatingRightShiftM(et)},ct.prototype.signPropagatingRightShiftS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)>>et);return this},ct.prototype.signPropagatingRightShiftM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)>>et.get(it,ht));return this},ct.signPropagatingRightShift=function(et,it){return new rt(et).signPropagatingRightShift(it)},ct.prototype.rightShift=function(et){return typeof et=="number"?this.rightShiftS(et):this.rightShiftM(et)},ct.prototype.rightShiftS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)>>>et);return this},ct.prototype.rightShiftM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)>>>et.get(it,ht));return this},ct.rightShift=function(et,it){return new rt(et).rightShift(it)},ct.prototype.zeroFillRightShift=ct.prototype.rightShift,ct.prototype.zeroFillRightShiftS=ct.prototype.rightShiftS,ct.prototype.zeroFillRightShiftM=ct.prototype.rightShiftM,ct.zeroFillRightShift=ct.rightShift,ct.prototype.not=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,~this.get(et,it));return this},ct.not=function(et){return new rt(et).not()},ct.prototype.abs=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.abs(this.get(et,it)));return this},ct.abs=function(et){return new rt(et).abs()},ct.prototype.acos=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.acos(this.get(et,it)));return this},ct.acos=function(et){return new rt(et).acos()},ct.prototype.acosh=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.acosh(this.get(et,it)));return this},ct.acosh=function(et){return new rt(et).acosh()},ct.prototype.asin=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.asin(this.get(et,it)));return this},ct.asin=function(et){return new rt(et).asin()},ct.prototype.asinh=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.asinh(this.get(et,it)));return this},ct.asinh=function(et){return new rt(et).asinh()},ct.prototype.atan=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.atan(this.get(et,it)));return this},ct.atan=function(et){return new rt(et).atan()},ct.prototype.atanh=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.atanh(this.get(et,it)));return this},ct.atanh=function(et){return new rt(et).atanh()},ct.prototype.cbrt=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.cbrt(this.get(et,it)));return this},ct.cbrt=function(et){return new rt(et).cbrt()},ct.prototype.ceil=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.ceil(this.get(et,it)));return this},ct.ceil=function(et){return new rt(et).ceil()},ct.prototype.clz32=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.clz32(this.get(et,it)));return this},ct.clz32=function(et){return new rt(et).clz32()},ct.prototype.cos=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.cos(this.get(et,it)));return this},ct.cos=function(et){return new rt(et).cos()},ct.prototype.cosh=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.cosh(this.get(et,it)));return this},ct.cosh=function(et){return new rt(et).cosh()},ct.prototype.exp=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.exp(this.get(et,it)));return this},ct.exp=function(et){return new rt(et).exp()},ct.prototype.expm1=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.expm1(this.get(et,it)));return this},ct.expm1=function(et){return new rt(et).expm1()},ct.prototype.floor=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.floor(this.get(et,it)));return this},ct.floor=function(et){return new rt(et).floor()},ct.prototype.fround=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.fround(this.get(et,it)));return this},ct.fround=function(et){return new rt(et).fround()},ct.prototype.log=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.log(this.get(et,it)));return this},ct.log=function(et){return new rt(et).log()},ct.prototype.log1p=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.log1p(this.get(et,it)));return this},ct.log1p=function(et){return new rt(et).log1p()},ct.prototype.log10=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.log10(this.get(et,it)));return this},ct.log10=function(et){return new rt(et).log10()},ct.prototype.log2=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.log2(this.get(et,it)));return this},ct.log2=function(et){return new rt(et).log2()},ct.prototype.round=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.round(this.get(et,it)));return this},ct.round=function(et){return new rt(et).round()},ct.prototype.sign=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.sign(this.get(et,it)));return this},ct.sign=function(et){return new rt(et).sign()},ct.prototype.sin=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.sin(this.get(et,it)));return this},ct.sin=function(et){return new rt(et).sin()},ct.prototype.sinh=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.sinh(this.get(et,it)));return this},ct.sinh=function(et){return new rt(et).sinh()},ct.prototype.sqrt=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.sqrt(this.get(et,it)));return this},ct.sqrt=function(et){return new rt(et).sqrt()},ct.prototype.tan=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.tan(this.get(et,it)));return this},ct.tan=function(et){return new rt(et).tan()},ct.prototype.tanh=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.tanh(this.get(et,it)));return this},ct.tanh=function(et){return new rt(et).tanh()},ct.prototype.trunc=function(){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,Math.trunc(this.get(et,it)));return this},ct.trunc=function(et){return new rt(et).trunc()},ct.pow=function(et,it){return new rt(et).pow(it)},ct.prototype.pow=function(et){return typeof et=="number"?this.powS(et):this.powM(et)},ct.prototype.powS=function(et){for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)**et);return this},ct.prototype.powM=function(et){if(et=rt.checkMatrix(et),this.rows!==et.rows||this.columns!==et.columns)throw new RangeError("Matrices dimensions must be equal");for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.set(it,ht,this.get(it,ht)**et.get(it,ht));return this}}function nt(ct,rt,et){let it=et?ct.rows:ct.rows-1;if(rt<0||rt>it)throw new RangeError("Row index out of range")}function lt(ct,rt,et){let it=et?ct.columns:ct.columns-1;if(rt<0||rt>it)throw new RangeError("Column index out of range")}function ft(ct,rt){if(rt.to1DArray&&(rt=rt.to1DArray()),rt.length!==ct.columns)throw new RangeError("vector size must be the same as the number of columns");return rt}function pt(ct,rt){if(rt.to1DArray&&(rt=rt.to1DArray()),rt.length!==ct.rows)throw new RangeError("vector size must be the same as the number of rows");return rt}function dt(ct,rt){if(!s.isAnyArray(rt))throw new TypeError("row indices must be an array");for(let et=0;et<rt.length;et++)if(rt[et]<0||rt[et]>=ct.rows)throw new RangeError("row indices are out of range")}function _t(ct,rt){if(!s.isAnyArray(rt))throw new TypeError("column indices must be an array");for(let et=0;et<rt.length;et++)if(rt[et]<0||rt[et]>=ct.columns)throw new RangeError("column indices are out of range")}function ut(ct,rt,et,it,ht){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(kt("startRow",rt),kt("endRow",et),kt("startColumn",it),kt("endColumn",ht),rt>et||it>ht||rt<0||rt>=ct.rows||et<0||et>=ct.rows||it<0||it>=ct.columns||ht<0||ht>=ct.columns)throw new RangeError("Submatrix indices are out of range")}function mt(ct,rt=0){let et=[];for(let it=0;it<ct;it++)et.push(rt);return et}function kt(ct,rt){if(typeof rt!="number")throw new TypeError(`${ct} must be a number`)}function bt(ct){if(ct.isEmpty())throw new Error("Empty matrix has no elements to index")}function vt(ct){let rt=mt(ct.rows);for(let et=0;et<ct.rows;++et)for(let it=0;it<ct.columns;++it)rt[et]+=ct.get(et,it);return rt}function Et(ct){let rt=mt(ct.columns);for(let et=0;et<ct.rows;++et)for(let it=0;it<ct.columns;++it)rt[it]+=ct.get(et,it);return rt}function Mt(ct){let rt=0;for(let et=0;et<ct.rows;et++)for(let it=0;it<ct.columns;it++)rt+=ct.get(et,it);return rt}function At(ct){let rt=mt(ct.rows,1);for(let et=0;et<ct.rows;++et)for(let it=0;it<ct.columns;++it)rt[et]*=ct.get(et,it);return rt}function zt(ct){let rt=mt(ct.columns,1);for(let et=0;et<ct.rows;++et)for(let it=0;it<ct.columns;++it)rt[it]*=ct.get(et,it);return rt}function Vt(ct){let rt=1;for(let et=0;et<ct.rows;et++)for(let it=0;it<ct.columns;it++)rt*=ct.get(et,it);return rt}function Gt(ct,rt,et){const it=ct.rows,ht=ct.columns,yt=[];for(let Lt=0;Lt<it;Lt++){let Nt=0,Ct=0,Ht=0;for(let rn=0;rn<ht;rn++)Ht=ct.get(Lt,rn)-et[Lt],Nt+=Ht,Ct+=Ht*Ht;rt?yt.push((Ct-Nt*Nt/ht)/(ht-1)):yt.push((Ct-Nt*Nt/ht)/ht)}return yt}function Kt(ct,rt,et){const it=ct.rows,ht=ct.columns,yt=[];for(let Lt=0;Lt<ht;Lt++){let Nt=0,Ct=0,Ht=0;for(let rn=0;rn<it;rn++)Ht=ct.get(rn,Lt)-et[Lt],Nt+=Ht,Ct+=Ht*Ht;rt?yt.push((Ct-Nt*Nt/it)/(it-1)):yt.push((Ct-Nt*Nt/it)/it)}return yt}function Wt(ct,rt,et){const it=ct.rows,ht=ct.columns,yt=it*ht;let Lt=0,Nt=0,Ct=0;for(let Ht=0;Ht<it;Ht++)for(let rn=0;rn<ht;rn++)Ct=ct.get(Ht,rn)-et,Lt+=Ct,Nt+=Ct*Ct;return rt?(Nt-Lt*Lt/yt)/(yt-1):(Nt-Lt*Lt/yt)/yt}function sn(ct,rt){for(let et=0;et<ct.rows;et++)for(let it=0;it<ct.columns;it++)ct.set(et,it,ct.get(et,it)-rt[et])}function on(ct,rt){for(let et=0;et<ct.rows;et++)for(let it=0;it<ct.columns;it++)ct.set(et,it,ct.get(et,it)-rt[it])}function Xt(ct,rt){for(let et=0;et<ct.rows;et++)for(let it=0;it<ct.columns;it++)ct.set(et,it,ct.get(et,it)-rt)}function ln(ct){const rt=[];for(let et=0;et<ct.rows;et++){let it=0;for(let ht=0;ht<ct.columns;ht++)it+=ct.get(et,ht)**2/(ct.columns-1);rt.push(Math.sqrt(it))}return rt}function nn(ct,rt){for(let et=0;et<ct.rows;et++)for(let it=0;it<ct.columns;it++)ct.set(et,it,ct.get(et,it)/rt[et])}function gn(ct){const rt=[];for(let et=0;et<ct.columns;et++){let it=0;for(let ht=0;ht<ct.rows;ht++)it+=ct.get(ht,et)**2/(ct.rows-1);rt.push(Math.sqrt(it))}return rt}function dn(ct,rt){for(let et=0;et<ct.rows;et++)for(let it=0;it<ct.columns;it++)ct.set(et,it,ct.get(et,it)/rt[it])}function $n(ct){const rt=ct.size-1;let et=0;for(let it=0;it<ct.columns;it++)for(let ht=0;ht<ct.rows;ht++)et+=ct.get(ht,it)**2/rt;return Math.sqrt(et)}function En(ct,rt){for(let et=0;et<ct.rows;et++)for(let it=0;it<ct.columns;it++)ct.set(et,it,ct.get(et,it)/rt)}class qt{static from1DArray(rt,et,it){if(rt*et!==it.length)throw new RangeError("data length does not match given dimensions");let ht=new fn(rt,et);for(let yt=0;yt<rt;yt++)for(let Lt=0;Lt<et;Lt++)ht.set(yt,Lt,it[yt*et+Lt]);return ht}static rowVector(rt){let et=new fn(1,rt.length);for(let it=0;it<rt.length;it++)et.set(0,it,rt[it]);return et}static columnVector(rt){let et=new fn(rt.length,1);for(let it=0;it<rt.length;it++)et.set(it,0,rt[it]);return et}static zeros(rt,et){return new fn(rt,et)}static ones(rt,et){return new fn(rt,et).fill(1)}static rand(rt,et,it={}){if(typeof it!="object")throw new TypeError("options must be an object");const{random:ht=Math.random}=it;let yt=new fn(rt,et);for(let Lt=0;Lt<rt;Lt++)for(let Nt=0;Nt<et;Nt++)yt.set(Lt,Nt,ht());return yt}static randInt(rt,et,it={}){if(typeof it!="object")throw new TypeError("options must be an object");const{min:ht=0,max:yt=1e3,random:Lt=Math.random}=it;if(!Number.isInteger(ht))throw new TypeError("min must be an integer");if(!Number.isInteger(yt))throw new TypeError("max must be an integer");if(ht>=yt)throw new RangeError("min must be smaller than max");let Nt=yt-ht,Ct=new fn(rt,et);for(let Ht=0;Ht<rt;Ht++)for(let rn=0;rn<et;rn++){let jt=ht+Math.round(Lt()*Nt);Ct.set(Ht,rn,jt)}return Ct}static eye(rt,et,it){et===void 0&&(et=rt),it===void 0&&(it=1);let ht=Math.min(rt,et),yt=this.zeros(rt,et);for(let Lt=0;Lt<ht;Lt++)yt.set(Lt,Lt,it);return yt}static diag(rt,et,it){let ht=rt.length;et===void 0&&(et=ht),it===void 0&&(it=et);let yt=Math.min(ht,et,it),Lt=this.zeros(et,it);for(let Nt=0;Nt<yt;Nt++)Lt.set(Nt,Nt,rt[Nt]);return Lt}static min(rt,et){rt=this.checkMatrix(rt),et=this.checkMatrix(et);let it=rt.rows,ht=rt.columns,yt=new fn(it,ht);for(let Lt=0;Lt<it;Lt++)for(let Nt=0;Nt<ht;Nt++)yt.set(Lt,Nt,Math.min(rt.get(Lt,Nt),et.get(Lt,Nt)));return yt}static max(rt,et){rt=this.checkMatrix(rt),et=this.checkMatrix(et);let it=rt.rows,ht=rt.columns,yt=new this(it,ht);for(let Lt=0;Lt<it;Lt++)for(let Nt=0;Nt<ht;Nt++)yt.set(Lt,Nt,Math.max(rt.get(Lt,Nt),et.get(Lt,Nt)));return yt}static checkMatrix(rt){return qt.isMatrix(rt)?rt:new fn(rt)}static isMatrix(rt){return rt!=null&&rt.klass==="Matrix"}get size(){return this.rows*this.columns}apply(rt){if(typeof rt!="function")throw new TypeError("callback must be a function");for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)rt.call(this,et,it);return this}to1DArray(){let rt=[];for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)rt.push(this.get(et,it));return rt}to2DArray(){let rt=[];for(let et=0;et<this.rows;et++){rt.push([]);for(let it=0;it<this.columns;it++)rt[et].push(this.get(et,it))}return rt}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let rt=0;rt<this.rows;rt++)for(let et=0;et<=rt;et++)if(this.get(rt,et)!==this.get(et,rt))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let rt=0;rt<this.rows;rt++)if(this.get(rt,rt)!==0)return!1;return!0}isEchelonForm(){let rt=0,et=0,it=-1,ht=!0,yt=!1;for(;rt<this.rows&&ht;){for(et=0,yt=!1;et<this.columns&&yt===!1;)this.get(rt,et)===0?et++:this.get(rt,et)===1&&et>it?(yt=!0,it=et):(ht=!1,yt=!0);rt++}return ht}isReducedEchelonForm(){let rt=0,et=0,it=-1,ht=!0,yt=!1;for(;rt<this.rows&&ht;){for(et=0,yt=!1;et<this.columns&&yt===!1;)this.get(rt,et)===0?et++:this.get(rt,et)===1&&et>it?(yt=!0,it=et):(ht=!1,yt=!0);for(let Lt=et+1;Lt<this.rows;Lt++)this.get(rt,Lt)!==0&&(ht=!1);rt++}return ht}echelonForm(){let rt=this.clone(),et=0,it=0;for(;et<rt.rows&&it<rt.columns;){let ht=et;for(let yt=et;yt<rt.rows;yt++)rt.get(yt,it)>rt.get(ht,it)&&(ht=yt);if(rt.get(ht,it)===0)it++;else{rt.swapRows(et,ht);let yt=rt.get(et,it);for(let Lt=it;Lt<rt.columns;Lt++)rt.set(et,Lt,rt.get(et,Lt)/yt);for(let Lt=et+1;Lt<rt.rows;Lt++){let Nt=rt.get(Lt,it)/rt.get(et,it);rt.set(Lt,it,0);for(let Ct=it+1;Ct<rt.columns;Ct++)rt.set(Lt,Ct,rt.get(Lt,Ct)-rt.get(et,Ct)*Nt)}et++,it++}}return rt}reducedEchelonForm(){let rt=this.echelonForm(),et=rt.columns,it=rt.rows,ht=it-1;for(;ht>=0;)if(rt.maxRow(ht)===0)ht--;else{let yt=0,Lt=!1;for(;yt<it&&Lt===!1;)rt.get(ht,yt)===1?Lt=!0:yt++;for(let Nt=0;Nt<ht;Nt++){let Ct=rt.get(Nt,yt);for(let Ht=yt;Ht<et;Ht++){let rn=rt.get(Nt,Ht)-Ct*rt.get(ht,Ht);rt.set(Nt,Ht,rn)}}ht--}return rt}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(rt={}){if(typeof rt!="object")throw new TypeError("options must be an object");const{rows:et=1,columns:it=1}=rt;if(!Number.isInteger(et)||et<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(it)||it<=0)throw new TypeError("columns must be a positive integer");let ht=new fn(this.rows*et,this.columns*it);for(let yt=0;yt<et;yt++)for(let Lt=0;Lt<it;Lt++)ht.setSubMatrix(this,this.rows*yt,this.columns*Lt);return ht}fill(rt){for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,rt);return this}neg(){return this.mulS(-1)}getRow(rt){nt(this,rt);let et=[];for(let it=0;it<this.columns;it++)et.push(this.get(rt,it));return et}getRowVector(rt){return fn.rowVector(this.getRow(rt))}setRow(rt,et){nt(this,rt),et=ft(this,et);for(let it=0;it<this.columns;it++)this.set(rt,it,et[it]);return this}swapRows(rt,et){nt(this,rt),nt(this,et);for(let it=0;it<this.columns;it++){let ht=this.get(rt,it);this.set(rt,it,this.get(et,it)),this.set(et,it,ht)}return this}getColumn(rt){lt(this,rt);let et=[];for(let it=0;it<this.rows;it++)et.push(this.get(it,rt));return et}getColumnVector(rt){return fn.columnVector(this.getColumn(rt))}setColumn(rt,et){lt(this,rt),et=pt(this,et);for(let it=0;it<this.rows;it++)this.set(it,rt,et[it]);return this}swapColumns(rt,et){lt(this,rt),lt(this,et);for(let it=0;it<this.rows;it++){let ht=this.get(it,rt);this.set(it,rt,this.get(it,et)),this.set(it,et,ht)}return this}addRowVector(rt){rt=ft(this,rt);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,this.get(et,it)+rt[it]);return this}subRowVector(rt){rt=ft(this,rt);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,this.get(et,it)-rt[it]);return this}mulRowVector(rt){rt=ft(this,rt);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,this.get(et,it)*rt[it]);return this}divRowVector(rt){rt=ft(this,rt);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,this.get(et,it)/rt[it]);return this}addColumnVector(rt){rt=pt(this,rt);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,this.get(et,it)+rt[et]);return this}subColumnVector(rt){rt=pt(this,rt);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,this.get(et,it)-rt[et]);return this}mulColumnVector(rt){rt=pt(this,rt);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,this.get(et,it)*rt[et]);return this}divColumnVector(rt){rt=pt(this,rt);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)this.set(et,it,this.get(et,it)/rt[et]);return this}mulRow(rt,et){nt(this,rt);for(let it=0;it<this.columns;it++)this.set(rt,it,this.get(rt,it)*et);return this}mulColumn(rt,et){lt(this,rt);for(let it=0;it<this.rows;it++)this.set(it,rt,this.get(it,rt)*et);return this}max(rt){if(this.isEmpty())return NaN;switch(rt){case"row":{const et=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.get(it,ht)>et[it]&&(et[it]=this.get(it,ht));return et}case"column":{const et=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.get(it,ht)>et[ht]&&(et[ht]=this.get(it,ht));return et}case void 0:{let et=this.get(0,0);for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.get(it,ht)>et&&(et=this.get(it,ht));return et}default:throw new Error(`invalid option: ${rt}`)}}maxIndex(){bt(this);let rt=this.get(0,0),et=[0,0];for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.get(it,ht)>rt&&(rt=this.get(it,ht),et[0]=it,et[1]=ht);return et}min(rt){if(this.isEmpty())return NaN;switch(rt){case"row":{const et=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.get(it,ht)<et[it]&&(et[it]=this.get(it,ht));return et}case"column":{const et=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.get(it,ht)<et[ht]&&(et[ht]=this.get(it,ht));return et}case void 0:{let et=this.get(0,0);for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.get(it,ht)<et&&(et=this.get(it,ht));return et}default:throw new Error(`invalid option: ${rt}`)}}minIndex(){bt(this);let rt=this.get(0,0),et=[0,0];for(let it=0;it<this.rows;it++)for(let ht=0;ht<this.columns;ht++)this.get(it,ht)<rt&&(rt=this.get(it,ht),et[0]=it,et[1]=ht);return et}maxRow(rt){if(nt(this,rt),this.isEmpty())return NaN;let et=this.get(rt,0);for(let it=1;it<this.columns;it++)this.get(rt,it)>et&&(et=this.get(rt,it));return et}maxRowIndex(rt){nt(this,rt),bt(this);let et=this.get(rt,0),it=[rt,0];for(let ht=1;ht<this.columns;ht++)this.get(rt,ht)>et&&(et=this.get(rt,ht),it[1]=ht);return it}minRow(rt){if(nt(this,rt),this.isEmpty())return NaN;let et=this.get(rt,0);for(let it=1;it<this.columns;it++)this.get(rt,it)<et&&(et=this.get(rt,it));return et}minRowIndex(rt){nt(this,rt),bt(this);let et=this.get(rt,0),it=[rt,0];for(let ht=1;ht<this.columns;ht++)this.get(rt,ht)<et&&(et=this.get(rt,ht),it[1]=ht);return it}maxColumn(rt){if(lt(this,rt),this.isEmpty())return NaN;let et=this.get(0,rt);for(let it=1;it<this.rows;it++)this.get(it,rt)>et&&(et=this.get(it,rt));return et}maxColumnIndex(rt){lt(this,rt),bt(this);let et=this.get(0,rt),it=[0,rt];for(let ht=1;ht<this.rows;ht++)this.get(ht,rt)>et&&(et=this.get(ht,rt),it[0]=ht);return it}minColumn(rt){if(lt(this,rt),this.isEmpty())return NaN;let et=this.get(0,rt);for(let it=1;it<this.rows;it++)this.get(it,rt)<et&&(et=this.get(it,rt));return et}minColumnIndex(rt){lt(this,rt),bt(this);let et=this.get(0,rt),it=[0,rt];for(let ht=1;ht<this.rows;ht++)this.get(ht,rt)<et&&(et=this.get(ht,rt),it[0]=ht);return it}diag(){let rt=Math.min(this.rows,this.columns),et=[];for(let it=0;it<rt;it++)et.push(this.get(it,it));return et}norm(rt="frobenius"){switch(rt){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${rt}`)}}cumulativeSum(){let rt=0;for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)rt+=this.get(et,it),this.set(et,it,rt);return this}dot(rt){qt.isMatrix(rt)&&(rt=rt.to1DArray());let et=this.to1DArray();if(et.length!==rt.length)throw new RangeError("vectors do not have the same size");let it=0;for(let ht=0;ht<et.length;ht++)it+=et[ht]*rt[ht];return it}mmul(rt){rt=fn.checkMatrix(rt);let et=this.rows,it=this.columns,ht=rt.columns,yt=new fn(et,ht),Lt=new Float64Array(it);for(let Nt=0;Nt<ht;Nt++){for(let Ct=0;Ct<it;Ct++)Lt[Ct]=rt.get(Ct,Nt);for(let Ct=0;Ct<et;Ct++){let Ht=0;for(let rn=0;rn<it;rn++)Ht+=this.get(Ct,rn)*Lt[rn];yt.set(Ct,Nt,Ht)}}return yt}mpow(rt){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(rt)||rt<0)throw new RangeError("Exponent must be a non-negative integer");let et=fn.eye(this.rows),it=this;for(let ht=rt;ht>=1;ht/=2)ht&1&&(et=et.mmul(it)),it=it.mmul(it);return et}strassen2x2(rt){rt=fn.checkMatrix(rt);let et=new fn(2,2);const it=this.get(0,0),ht=rt.get(0,0),yt=this.get(0,1),Lt=rt.get(0,1),Nt=this.get(1,0),Ct=rt.get(1,0),Ht=this.get(1,1),rn=rt.get(1,1),jt=(it+Ht)*(ht+rn),pn=(Nt+Ht)*ht,Mn=it*(Lt-rn),un=Ht*(Ct-ht),_n=(it+yt)*rn,On=(Nt-it)*(ht+Lt),_e=(yt-Ht)*(Ct+rn),Dn=jt+un-_n+_e,Yn=Mn+_n,hr=pn+un,cr=jt-pn+Mn+On;return et.set(0,0,Dn),et.set(0,1,Yn),et.set(1,0,hr),et.set(1,1,cr),et}strassen3x3(rt){rt=fn.checkMatrix(rt);let et=new fn(3,3);const it=this.get(0,0),ht=this.get(0,1),yt=this.get(0,2),Lt=this.get(1,0),Nt=this.get(1,1),Ct=this.get(1,2),Ht=this.get(2,0),rn=this.get(2,1),jt=this.get(2,2),pn=rt.get(0,0),Mn=rt.get(0,1),un=rt.get(0,2),_n=rt.get(1,0),On=rt.get(1,1),_e=rt.get(1,2),Dn=rt.get(2,0),Yn=rt.get(2,1),hr=rt.get(2,2),cr=(it+ht+yt-Lt-Nt-rn-jt)*On,kr=(it-Lt)*(-Mn+On),rr=Nt*(-pn+Mn+_n-On-_e-Dn+hr),lr=(-it+Lt+Nt)*(pn-Mn+On),Sr=(Lt+Nt)*(-pn+Mn),an=it*pn,Cn=(-it+Ht+rn)*(pn-un+_e),Xn=(-it+Ht)*(un-_e),In=(Ht+rn)*(-pn+un),br=(it+ht+yt-Nt-Ct-Ht-rn)*_e,vr=rn*(-pn+un+_n-On-_e-Dn+Yn),Er=(-yt+rn+jt)*(On+Dn-Yn),xr=(yt-jt)*(On-Yn),fr=yt*Dn,_r=(rn+jt)*(-Dn+Yn),Ar=(-yt+Nt+Ct)*(_e+Dn-hr),$r=(yt-Ct)*(_e-hr),Ir=(Nt+Ct)*(-Dn+hr),pr=ht*_n,ur=Ct*Yn,wr=Lt*un,Lr=Ht*Mn,Tr=jt*hr,Nr=an+fr+pr,Ps=cr+lr+Sr+an+Er+fr+_r,xa=an+Cn+In+br+fr+Ar+Ir,Zr=kr+rr+lr+an+fr+Ar+$r,Rr=kr+lr+Sr+an+ur,Yr=fr+Ar+$r+Ir+wr,_i=an+Cn+Xn+vr+Er+xr+fr,na=Er+xr+fr+_r+Lr,as=an+Cn+Xn+In+Tr;return et.set(0,0,Nr),et.set(0,1,Ps),et.set(0,2,xa),et.set(1,0,Zr),et.set(1,1,Rr),et.set(1,2,Yr),et.set(2,0,_i),et.set(2,1,na),et.set(2,2,as),et}mmulStrassen(rt){rt=fn.checkMatrix(rt);let et=this.clone(),it=et.rows,ht=et.columns,yt=rt.rows,Lt=rt.columns;ht!==yt&&console.warn(`Multiplying ${it} x ${ht} and ${yt} x ${Lt} matrix: dimensions do not match.`);function Nt(jt,pn,Mn){let un=jt.rows,_n=jt.columns;if(un===pn&&_n===Mn)return jt;{let On=qt.zeros(pn,Mn);return On=On.setSubMatrix(jt,0,0),On}}let Ct=Math.max(it,yt),Ht=Math.max(ht,Lt);et=Nt(et,Ct,Ht),rt=Nt(rt,Ct,Ht);function rn(jt,pn,Mn,un){if(Mn<=512||un<=512)return jt.mmul(pn);Mn%2===1&&un%2===1?(jt=Nt(jt,Mn+1,un+1),pn=Nt(pn,Mn+1,un+1)):Mn%2===1?(jt=Nt(jt,Mn+1,un),pn=Nt(pn,Mn+1,un)):un%2===1&&(jt=Nt(jt,Mn,un+1),pn=Nt(pn,Mn,un+1));let _n=parseInt(jt.rows/2,10),On=parseInt(jt.columns/2,10),_e=jt.subMatrix(0,_n-1,0,On-1),Dn=pn.subMatrix(0,_n-1,0,On-1),Yn=jt.subMatrix(0,_n-1,On,jt.columns-1),hr=pn.subMatrix(0,_n-1,On,pn.columns-1),cr=jt.subMatrix(_n,jt.rows-1,0,On-1),kr=pn.subMatrix(_n,pn.rows-1,0,On-1),rr=jt.subMatrix(_n,jt.rows-1,On,jt.columns-1),lr=pn.subMatrix(_n,pn.rows-1,On,pn.columns-1),Sr=rn(qt.add(_e,rr),qt.add(Dn,lr),_n,On),an=rn(qt.add(cr,rr),Dn,_n,On),Cn=rn(_e,qt.sub(hr,lr),_n,On),Xn=rn(rr,qt.sub(kr,Dn),_n,On),In=rn(qt.add(_e,Yn),lr,_n,On),br=rn(qt.sub(cr,_e),qt.add(Dn,hr),_n,On),vr=rn(qt.sub(Yn,rr),qt.add(kr,lr),_n,On),Er=qt.add(Sr,Xn);Er.sub(In),Er.add(vr);let xr=qt.add(Cn,In),fr=qt.add(an,Xn),_r=qt.sub(Sr,an);_r.add(Cn),_r.add(br);let Ar=qt.zeros(2*Er.rows,2*Er.columns);return Ar=Ar.setSubMatrix(Er,0,0),Ar=Ar.setSubMatrix(xr,Er.rows,0),Ar=Ar.setSubMatrix(fr,0,Er.columns),Ar=Ar.setSubMatrix(_r,Er.rows,Er.columns),Ar.subMatrix(0,Mn-1,0,un-1)}return rn(et,rt,Ct,Ht)}scaleRows(rt={}){if(typeof rt!="object")throw new TypeError("options must be an object");const{min:et=0,max:it=1}=rt;if(!Number.isFinite(et))throw new TypeError("min must be a number");if(!Number.isFinite(it))throw new TypeError("max must be a number");if(et>=it)throw new RangeError("min must be smaller than max");let ht=new fn(this.rows,this.columns);for(let yt=0;yt<this.rows;yt++){const Lt=this.getRow(yt);Lt.length>0&&o(Lt,{min:et,max:it,output:Lt}),ht.setRow(yt,Lt)}return ht}scaleColumns(rt={}){if(typeof rt!="object")throw new TypeError("options must be an object");const{min:et=0,max:it=1}=rt;if(!Number.isFinite(et))throw new TypeError("min must be a number");if(!Number.isFinite(it))throw new TypeError("max must be a number");if(et>=it)throw new RangeError("min must be smaller than max");let ht=new fn(this.rows,this.columns);for(let yt=0;yt<this.columns;yt++){const Lt=this.getColumn(yt);Lt.length&&o(Lt,{min:et,max:it,output:Lt}),ht.setColumn(yt,Lt)}return ht}flipRows(){const rt=Math.ceil(this.columns/2);for(let et=0;et<this.rows;et++)for(let it=0;it<rt;it++){let ht=this.get(et,it),yt=this.get(et,this.columns-1-it);this.set(et,it,yt),this.set(et,this.columns-1-it,ht)}return this}flipColumns(){const rt=Math.ceil(this.rows/2);for(let et=0;et<this.columns;et++)for(let it=0;it<rt;it++){let ht=this.get(it,et),yt=this.get(this.rows-1-it,et);this.set(it,et,yt),this.set(this.rows-1-it,et,ht)}return this}kroneckerProduct(rt){rt=fn.checkMatrix(rt);let et=this.rows,it=this.columns,ht=rt.rows,yt=rt.columns,Lt=new fn(et*ht,it*yt);for(let Nt=0;Nt<et;Nt++)for(let Ct=0;Ct<it;Ct++)for(let Ht=0;Ht<ht;Ht++)for(let rn=0;rn<yt;rn++)Lt.set(ht*Nt+Ht,yt*Ct+rn,this.get(Nt,Ct)*rt.get(Ht,rn));return Lt}kroneckerSum(rt){if(rt=fn.checkMatrix(rt),!this.isSquare()||!rt.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let et=this.rows,it=rt.rows,ht=this.kroneckerProduct(fn.eye(it,it)),yt=fn.eye(et,et).kroneckerProduct(rt);return ht.add(yt)}transpose(){let rt=new fn(this.columns,this.rows);for(let et=0;et<this.rows;et++)for(let it=0;it<this.columns;it++)rt.set(it,et,this.get(et,it));return rt}sortRows(rt=en){for(let et=0;et<this.rows;et++)this.setRow(et,this.getRow(et).sort(rt));return this}sortColumns(rt=en){for(let et=0;et<this.columns;et++)this.setColumn(et,this.getColumn(et).sort(rt));return this}subMatrix(rt,et,it,ht){ut(this,rt,et,it,ht);let yt=new fn(et-rt+1,ht-it+1);for(let Lt=rt;Lt<=et;Lt++)for(let Nt=it;Nt<=ht;Nt++)yt.set(Lt-rt,Nt-it,this.get(Lt,Nt));return yt}subMatrixRow(rt,et,it){if(et===void 0&&(et=0),it===void 0&&(it=this.columns-1),et>it||et<0||et>=this.columns||it<0||it>=this.columns)throw new RangeError("Argument out of range");let ht=new fn(rt.length,it-et+1);for(let yt=0;yt<rt.length;yt++)for(let Lt=et;Lt<=it;Lt++){if(rt[yt]<0||rt[yt]>=this.rows)throw new RangeError(`Row index out of range: ${rt[yt]}`);ht.set(yt,Lt-et,this.get(rt[yt],Lt))}return ht}subMatrixColumn(rt,et,it){if(et===void 0&&(et=0),it===void 0&&(it=this.rows-1),et>it||et<0||et>=this.rows||it<0||it>=this.rows)throw new RangeError("Argument out of range");let ht=new fn(it-et+1,rt.length);for(let yt=0;yt<rt.length;yt++)for(let Lt=et;Lt<=it;Lt++){if(rt[yt]<0||rt[yt]>=this.columns)throw new RangeError(`Column index out of range: ${rt[yt]}`);ht.set(Lt-et,yt,this.get(Lt,rt[yt]))}return ht}setSubMatrix(rt,et,it){if(rt=fn.checkMatrix(rt),rt.isEmpty())return this;let ht=et+rt.rows-1,yt=it+rt.columns-1;ut(this,et,ht,it,yt);for(let Lt=0;Lt<rt.rows;Lt++)for(let Nt=0;Nt<rt.columns;Nt++)this.set(et+Lt,it+Nt,rt.get(Lt,Nt));return this}selection(rt,et){dt(this,rt),_t(this,et);let it=new fn(rt.length,et.length);for(let ht=0;ht<rt.length;ht++){let yt=rt[ht];for(let Lt=0;Lt<et.length;Lt++){let Nt=et[Lt];it.set(ht,Lt,this.get(yt,Nt))}}return it}trace(){let rt=Math.min(this.rows,this.columns),et=0;for(let it=0;it<rt;it++)et+=this.get(it,it);return et}clone(){return this.constructor.copy(this,new fn(this.rows,this.columns))}static copy(rt,et){for(const[it,ht,yt]of rt.entries())et.set(it,ht,yt);return et}sum(rt){switch(rt){case"row":return vt(this);case"column":return Et(this);case void 0:return Mt(this);default:throw new Error(`invalid option: ${rt}`)}}product(rt){switch(rt){case"row":return At(this);case"column":return zt(this);case void 0:return Vt(this);default:throw new Error(`invalid option: ${rt}`)}}mean(rt){const et=this.sum(rt);switch(rt){case"row":{for(let it=0;it<this.rows;it++)et[it]/=this.columns;return et}case"column":{for(let it=0;it<this.columns;it++)et[it]/=this.rows;return et}case void 0:return et/this.size;default:throw new Error(`invalid option: ${rt}`)}}variance(rt,et={}){if(typeof rt=="object"&&(et=rt,rt=void 0),typeof et!="object")throw new TypeError("options must be an object");const{unbiased:it=!0,mean:ht=this.mean(rt)}=et;if(typeof it!="boolean")throw new TypeError("unbiased must be a boolean");switch(rt){case"row":{if(!s.isAnyArray(ht))throw new TypeError("mean must be an array");return Gt(this,it,ht)}case"column":{if(!s.isAnyArray(ht))throw new TypeError("mean must be an array");return Kt(this,it,ht)}case void 0:{if(typeof ht!="number")throw new TypeError("mean must be a number");return Wt(this,it,ht)}default:throw new Error(`invalid option: ${rt}`)}}standardDeviation(rt,et){typeof rt=="object"&&(et=rt,rt=void 0);const it=this.variance(rt,et);if(rt===void 0)return Math.sqrt(it);for(let ht=0;ht<it.length;ht++)it[ht]=Math.sqrt(it[ht]);return it}center(rt,et={}){if(typeof rt=="object"&&(et=rt,rt=void 0),typeof et!="object")throw new TypeError("options must be an object");const{center:it=this.mean(rt)}=et;switch(rt){case"row":{if(!s.isAnyArray(it))throw new TypeError("center must be an array");return sn(this,it),this}case"column":{if(!s.isAnyArray(it))throw new TypeError("center must be an array");return on(this,it),this}case void 0:{if(typeof it!="number")throw new TypeError("center must be a number");return Xt(this,it),this}default:throw new Error(`invalid option: ${rt}`)}}scale(rt,et={}){if(typeof rt=="object"&&(et=rt,rt=void 0),typeof et!="object")throw new TypeError("options must be an object");let it=et.scale;switch(rt){case"row":{if(it===void 0)it=ln(this);else if(!s.isAnyArray(it))throw new TypeError("scale must be an array");return nn(this,it),this}case"column":{if(it===void 0)it=gn(this);else if(!s.isAnyArray(it))throw new TypeError("scale must be an array");return dn(this,it),this}case void 0:{if(it===void 0)it=$n(this);else if(typeof it!="number")throw new TypeError("scale must be a number");return En(this,it),this}default:throw new Error(`invalid option: ${rt}`)}}toString(rt){return $(this,rt)}[Symbol.iterator](){return this.entries()}*entries(){for(let rt=0;rt<this.rows;rt++)for(let et=0;et<this.columns;et++)yield[rt,et,this.get(rt,et)]}*values(){for(let rt=0;rt<this.rows;rt++)for(let et=0;et<this.columns;et++)yield this.get(rt,et)}}qt.prototype.klass="Matrix",typeof Symbol<"u"&&(qt.prototype[Symbol.for("nodejs.util.inspect.custom")]=_);function en(ct,rt){return ct-rt}function Tn(ct){return ct.every(rt=>typeof rt=="number")}qt.random=qt.rand,qt.randomInt=qt.randInt,qt.diagonal=qt.diag,qt.prototype.diagonal=qt.prototype.diag,qt.identity=qt.eye,qt.prototype.negate=qt.prototype.neg,qt.prototype.tensorProduct=qt.prototype.kroneckerProduct;const Sn=class Qs extends qt{constructor(rt,et){if(super(),It(this,e),$e(this,"data"),Qs.isMatrix(rt))$t(this,e,i).call(this,rt.rows,rt.columns),Qs.copy(rt,this);else if(Number.isInteger(rt)&&rt>=0)$t(this,e,i).call(this,rt,et);else if(s.isAnyArray(rt)){const it=rt;if(rt=it.length,et=rt?it[0].length:0,typeof et!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let ht=0;ht<rt;ht++){if(it[ht].length!==et)throw new RangeError("Inconsistent array dimensions");if(!Tn(it[ht]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(it[ht]))}this.rows=rt,this.columns=et}else throw new TypeError("First argument must be a positive number or an array")}set(rt,et,it){return this.data[rt][et]=it,this}get(rt,et){return this.data[rt][et]}removeRow(rt){return nt(this,rt),this.data.splice(rt,1),this.rows-=1,this}addRow(rt,et){return et===void 0&&(et=rt,rt=this.rows),nt(this,rt,!0),et=Float64Array.from(ft(this,et)),this.data.splice(rt,0,et),this.rows+=1,this}removeColumn(rt){lt(this,rt);for(let et=0;et<this.rows;et++){const it=new Float64Array(this.columns-1);for(let ht=0;ht<rt;ht++)it[ht]=this.data[et][ht];for(let ht=rt+1;ht<this.columns;ht++)it[ht-1]=this.data[et][ht];this.data[et]=it}return this.columns-=1,this}addColumn(rt,et){typeof et>"u"&&(et=rt,rt=this.columns),lt(this,rt,!0),et=pt(this,et);for(let it=0;it<this.rows;it++){const ht=new Float64Array(this.columns+1);let yt=0;for(;yt<rt;yt++)ht[yt]=this.data[it][yt];for(ht[yt++]=et[it];yt<this.columns+1;yt++)ht[yt]=this.data[it][yt-1];this.data[it]=ht}return this.columns+=1,this}};e=new WeakSet,i=function(ct,rt){if(this.data=[],Number.isInteger(rt)&&rt>=0)for(let et=0;et<ct;et++)this.data.push(new Float64Array(rt));else throw new TypeError("nColumns must be a positive integer");this.rows=ct,this.columns=rt};let fn=Sn;at(qt,fn);const Wn=class Js extends qt{constructor(rt){if(super(),It(this,a),fn.isMatrix(rt)){if(!rt.isSymmetric())throw new TypeError("not symmetric data");Dt(this,a,fn.copy(rt,new fn(rt.rows,rt.rows)))}else if(Number.isInteger(rt)&&rt>=0)Dt(this,a,new fn(rt,rt));else if(Dt(this,a,new fn(rt)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return St(this,a).size}get rows(){return St(this,a).rows}get columns(){return St(this,a).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(rt){return fn.isMatrix(rt)&&rt.klassType==="SymmetricMatrix"}static zeros(rt){return new this(rt)}static ones(rt){return new this(rt).fill(1)}clone(){const rt=new Js(this.diagonalSize);for(const[et,it,ht]of this.upperRightEntries())rt.set(et,it,ht);return rt}toMatrix(){return new fn(this)}get(rt,et){return St(this,a).get(rt,et)}set(rt,et,it){return St(this,a).set(rt,et,it),St(this,a).set(et,rt,it),this}removeCross(rt){return St(this,a).removeRow(rt),St(this,a).removeColumn(rt),this}addCross(rt,et){et===void 0&&(et=rt,rt=this.diagonalSize);const it=et.slice();return it.splice(rt,1),St(this,a).addRow(rt,it),St(this,a).addColumn(rt,et),this}applyMask(rt){if(rt.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const et=[];for(const[it,ht]of rt.entries())ht||et.push(it);et.reverse();for(const it of et)this.removeCross(it);return this}toCompact(){const{diagonalSize:rt}=this,et=new Array(rt*(rt+1)/2);for(let it=0,ht=0,yt=0;yt<et.length;yt++)et[yt]=this.get(ht,it),++it>=rt&&(it=++ht);return et}static fromCompact(rt){const et=rt.length,it=(Math.sqrt(8*et+1)-1)/2;if(!Number.isInteger(it))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(rt)}`);const ht=new Js(it);for(let yt=0,Lt=0,Nt=0;Nt<et;Nt++)ht.set(yt,Lt,rt[Nt]),++yt>=it&&(yt=++Lt);return ht}*upperRightEntries(){for(let rt=0,et=0;rt<this.diagonalSize;void 0){const it=this.get(rt,et);yield[rt,et,it],++et>=this.diagonalSize&&(et=++rt)}}*upperRightValues(){for(let rt=0,et=0;rt<this.diagonalSize;void 0)yield this.get(rt,et),++et>=this.diagonalSize&&(et=++rt)}};a=new WeakMap;let Zn=Wn;Zn.prototype.klassType="SymmetricMatrix";class Gn extends Zn{static isDistanceMatrix(rt){return Zn.isSymmetricMatrix(rt)&&rt.klassSubType==="DistanceMatrix"}constructor(rt){if(super(rt),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(rt,et,it){return rt===et&&(it=0),super.set(rt,et,it)}addCross(rt,et){return et===void 0&&(et=rt,rt=this.diagonalSize),et=et.slice(),et[rt]=0,super.addCross(rt,et)}toSymmetricMatrix(){return new Zn(this)}clone(){const rt=new Gn(this.diagonalSize);for(const[et,it,ht]of this.upperRightEntries())et!==it&&rt.set(et,it,ht);return rt}toCompact(){const{diagonalSize:rt}=this,et=(rt-1)*rt/2,it=new Array(et);for(let ht=1,yt=0,Lt=0;Lt<it.length;Lt++)it[Lt]=this.get(yt,ht),++ht>=rt&&(ht=++yt+1);return it}static fromCompact(rt){const et=rt.length;if(et===0)return new this(0);const it=(Math.sqrt(8*et+1)+1)/2;if(!Number.isInteger(it))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(rt)}`);const ht=new this(it);for(let yt=1,Lt=0,Nt=0;Nt<et;Nt++)ht.set(yt,Lt,rt[Nt]),++yt>=it&&(yt=++Lt+1);return ht}}Gn.prototype.klassSubType="DistanceMatrix";class zn extends qt{constructor(rt,et,it){super(),this.matrix=rt,this.rows=et,this.columns=it}}class Bn extends zn{constructor(rt,et){lt(rt,et),super(rt,rt.rows,1),this.column=et}set(rt,et,it){return this.matrix.set(rt,this.column,it),this}get(rt){return this.matrix.get(rt,this.column)}}class or extends zn{constructor(rt,et){_t(rt,et),super(rt,rt.rows,et.length),this.columnIndices=et}set(rt,et,it){return this.matrix.set(rt,this.columnIndices[et],it),this}get(rt,et){return this.matrix.get(rt,this.columnIndices[et])}}class Jn extends zn{constructor(rt){super(rt,rt.rows,rt.columns)}set(rt,et,it){return this.matrix.set(rt,this.columns-et-1,it),this}get(rt,et){return this.matrix.get(rt,this.columns-et-1)}}class Un extends zn{constructor(rt){super(rt,rt.rows,rt.columns)}set(rt,et,it){return this.matrix.set(this.rows-rt-1,et,it),this}get(rt,et){return this.matrix.get(this.rows-rt-1,et)}}class nr extends zn{constructor(rt,et){nt(rt,et),super(rt,1,rt.columns),this.row=et}set(rt,et,it){return this.matrix.set(this.row,et,it),this}get(rt,et){return this.matrix.get(this.row,et)}}class wn extends zn{constructor(rt,et){dt(rt,et),super(rt,et.length,rt.columns),this.rowIndices=et}set(rt,et,it){return this.matrix.set(this.rowIndices[rt],et,it),this}get(rt,et){return this.matrix.get(this.rowIndices[rt],et)}}class jn extends zn{constructor(rt,et,it){dt(rt,et),_t(rt,it),super(rt,et.length,it.length),this.rowIndices=et,this.columnIndices=it}set(rt,et,it){return this.matrix.set(this.rowIndices[rt],this.columnIndices[et],it),this}get(rt,et){return this.matrix.get(this.rowIndices[rt],this.columnIndices[et])}}class er extends zn{constructor(rt,et,it,ht,yt){ut(rt,et,it,ht,yt),super(rt,it-et+1,yt-ht+1),this.startRow=et,this.startColumn=ht}set(rt,et,it){return this.matrix.set(this.startRow+rt,this.startColumn+et,it),this}get(rt,et){return this.matrix.get(this.startRow+rt,this.startColumn+et)}}class Vn extends zn{constructor(rt){super(rt,rt.columns,rt.rows)}set(rt,et,it){return this.matrix.set(et,rt,it),this}get(rt,et){return this.matrix.get(et,rt)}}class Rn extends qt{constructor(rt,et={}){const{rows:it=1}=et;if(rt.length%it!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=it,this.columns=rt.length/it,this.data=rt}set(rt,et,it){let ht=this._calculateIndex(rt,et);return this.data[ht]=it,this}get(rt,et){let it=this._calculateIndex(rt,et);return this.data[it]}_calculateIndex(rt,et){return rt*this.columns+et}}class ar extends qt{constructor(rt){super(),this.data=rt,this.rows=rt.length,this.columns=rt[0].length}set(rt,et,it){return this.data[rt][et]=it,this}get(rt,et){return this.data[rt][et]}}function Hn(ct,rt){if(s.isAnyArray(ct))return ct[0]&&s.isAnyArray(ct[0])?new ar(ct):new Rn(ct,rt);throw new Error("the argument is not an array")}class Fn{constructor(rt){rt=ar.checkMatrix(rt);let et=rt.clone(),it=et.rows,ht=et.columns,yt=new Float64Array(it),Lt=1,Nt,Ct,Ht,rn,jt,pn,Mn,un,_n;for(Nt=0;Nt<it;Nt++)yt[Nt]=Nt;for(un=new Float64Array(it),Ct=0;Ct<ht;Ct++){for(Nt=0;Nt<it;Nt++)un[Nt]=et.get(Nt,Ct);for(Nt=0;Nt<it;Nt++){for(_n=Math.min(Nt,Ct),jt=0,Ht=0;Ht<_n;Ht++)jt+=et.get(Nt,Ht)*un[Ht];un[Nt]-=jt,et.set(Nt,Ct,un[Nt])}for(rn=Ct,Nt=Ct+1;Nt<it;Nt++)Math.abs(un[Nt])>Math.abs(un[rn])&&(rn=Nt);if(rn!==Ct){for(Ht=0;Ht<ht;Ht++)pn=et.get(rn,Ht),et.set(rn,Ht,et.get(Ct,Ht)),et.set(Ct,Ht,pn);Mn=yt[rn],yt[rn]=yt[Ct],yt[Ct]=Mn,Lt=-Lt}if(Ct<it&&et.get(Ct,Ct)!==0)for(Nt=Ct+1;Nt<it;Nt++)et.set(Nt,Ct,et.get(Nt,Ct)/et.get(Ct,Ct))}this.LU=et,this.pivotVector=yt,this.pivotSign=Lt}isSingular(){let rt=this.LU,et=rt.columns;for(let it=0;it<et;it++)if(rt.get(it,it)===0)return!0;return!1}solve(rt){rt=fn.checkMatrix(rt);let et=this.LU;if(et.rows!==rt.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let it=rt.columns,ht=rt.subMatrixRow(this.pivotVector,0,it-1),yt=et.columns,Lt,Nt,Ct;for(Ct=0;Ct<yt;Ct++)for(Lt=Ct+1;Lt<yt;Lt++)for(Nt=0;Nt<it;Nt++)ht.set(Lt,Nt,ht.get(Lt,Nt)-ht.get(Ct,Nt)*et.get(Lt,Ct));for(Ct=yt-1;Ct>=0;Ct--){for(Nt=0;Nt<it;Nt++)ht.set(Ct,Nt,ht.get(Ct,Nt)/et.get(Ct,Ct));for(Lt=0;Lt<Ct;Lt++)for(Nt=0;Nt<it;Nt++)ht.set(Lt,Nt,ht.get(Lt,Nt)-ht.get(Ct,Nt)*et.get(Lt,Ct))}return ht}get determinant(){let rt=this.LU;if(!rt.isSquare())throw new Error("Matrix must be square");let et=this.pivotSign,it=rt.columns;for(let ht=0;ht<it;ht++)et*=rt.get(ht,ht);return et}get lowerTriangularMatrix(){let rt=this.LU,et=rt.rows,it=rt.columns,ht=new fn(et,it);for(let yt=0;yt<et;yt++)for(let Lt=0;Lt<it;Lt++)yt>Lt?ht.set(yt,Lt,rt.get(yt,Lt)):yt===Lt?ht.set(yt,Lt,1):ht.set(yt,Lt,0);return ht}get upperTriangularMatrix(){let rt=this.LU,et=rt.rows,it=rt.columns,ht=new fn(et,it);for(let yt=0;yt<et;yt++)for(let Lt=0;Lt<it;Lt++)yt<=Lt?ht.set(yt,Lt,rt.get(yt,Lt)):ht.set(yt,Lt,0);return ht}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function qn(ct,rt){let et=0;return Math.abs(ct)>Math.abs(rt)?(et=rt/ct,Math.abs(ct)*Math.sqrt(1+et*et)):rt!==0?(et=ct/rt,Math.abs(rt)*Math.sqrt(1+et*et)):0}class ir{constructor(rt){rt=ar.checkMatrix(rt);let et=rt.clone(),it=rt.rows,ht=rt.columns,yt=new Float64Array(ht),Lt,Nt,Ct,Ht;for(Ct=0;Ct<ht;Ct++){let rn=0;for(Lt=Ct;Lt<it;Lt++)rn=qn(rn,et.get(Lt,Ct));if(rn!==0){for(et.get(Ct,Ct)<0&&(rn=-rn),Lt=Ct;Lt<it;Lt++)et.set(Lt,Ct,et.get(Lt,Ct)/rn);for(et.set(Ct,Ct,et.get(Ct,Ct)+1),Nt=Ct+1;Nt<ht;Nt++){for(Ht=0,Lt=Ct;Lt<it;Lt++)Ht+=et.get(Lt,Ct)*et.get(Lt,Nt);for(Ht=-Ht/et.get(Ct,Ct),Lt=Ct;Lt<it;Lt++)et.set(Lt,Nt,et.get(Lt,Nt)+Ht*et.get(Lt,Ct))}}yt[Ct]=-rn}this.QR=et,this.Rdiag=yt}solve(rt){rt=fn.checkMatrix(rt);let et=this.QR,it=et.rows;if(rt.rows!==it)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let ht=rt.columns,yt=rt.clone(),Lt=et.columns,Nt,Ct,Ht,rn;for(Ht=0;Ht<Lt;Ht++)for(Ct=0;Ct<ht;Ct++){for(rn=0,Nt=Ht;Nt<it;Nt++)rn+=et.get(Nt,Ht)*yt.get(Nt,Ct);for(rn=-rn/et.get(Ht,Ht),Nt=Ht;Nt<it;Nt++)yt.set(Nt,Ct,yt.get(Nt,Ct)+rn*et.get(Nt,Ht))}for(Ht=Lt-1;Ht>=0;Ht--){for(Ct=0;Ct<ht;Ct++)yt.set(Ht,Ct,yt.get(Ht,Ct)/this.Rdiag[Ht]);for(Nt=0;Nt<Ht;Nt++)for(Ct=0;Ct<ht;Ct++)yt.set(Nt,Ct,yt.get(Nt,Ct)-yt.get(Ht,Ct)*et.get(Nt,Ht))}return yt.subMatrix(0,Lt-1,0,ht-1)}isFullRank(){let rt=this.QR.columns;for(let et=0;et<rt;et++)if(this.Rdiag[et]===0)return!1;return!0}get upperTriangularMatrix(){let rt=this.QR,et=rt.columns,it=new fn(et,et),ht,yt;for(ht=0;ht<et;ht++)for(yt=0;yt<et;yt++)ht<yt?it.set(ht,yt,rt.get(ht,yt)):ht===yt?it.set(ht,yt,this.Rdiag[ht]):it.set(ht,yt,0);return it}get orthogonalMatrix(){let rt=this.QR,et=rt.rows,it=rt.columns,ht=new fn(et,it),yt,Lt,Nt,Ct;for(Nt=it-1;Nt>=0;Nt--){for(yt=0;yt<et;yt++)ht.set(yt,Nt,0);for(ht.set(Nt,Nt,1),Lt=Nt;Lt<it;Lt++)if(rt.get(Nt,Nt)!==0){for(Ct=0,yt=Nt;yt<et;yt++)Ct+=rt.get(yt,Nt)*ht.get(yt,Lt);for(Ct=-Ct/rt.get(Nt,Nt),yt=Nt;yt<et;yt++)ht.set(yt,Lt,ht.get(yt,Lt)+Ct*rt.get(yt,Nt))}}return ht}}class Nn{constructor(rt,et={}){if(rt=ar.checkMatrix(rt),rt.isEmpty())throw new Error("Matrix must be non-empty");let it=rt.rows,ht=rt.columns;const{computeLeftSingularVectors:yt=!0,computeRightSingularVectors:Lt=!0,autoTranspose:Nt=!1}=et;let Ct=!!yt,Ht=!!Lt,rn=!1,jt;if(it<ht)if(!Nt)jt=rt.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{jt=rt.transpose(),it=jt.rows,ht=jt.columns,rn=!0;let an=Ct;Ct=Ht,Ht=an}else jt=rt.clone();let pn=Math.min(it,ht),Mn=Math.min(it+1,ht),un=new Float64Array(Mn),_n=new fn(it,pn),On=new fn(ht,ht),_e=new Float64Array(ht),Dn=new Float64Array(it),Yn=new Float64Array(Mn);for(let an=0;an<Mn;an++)Yn[an]=an;let hr=Math.min(it-1,ht),cr=Math.max(0,Math.min(ht-2,it)),kr=Math.max(hr,cr);for(let an=0;an<kr;an++){if(an<hr){un[an]=0;for(let Cn=an;Cn<it;Cn++)un[an]=qn(un[an],jt.get(Cn,an));if(un[an]!==0){jt.get(an,an)<0&&(un[an]=-un[an]);for(let Cn=an;Cn<it;Cn++)jt.set(Cn,an,jt.get(Cn,an)/un[an]);jt.set(an,an,jt.get(an,an)+1)}un[an]=-un[an]}for(let Cn=an+1;Cn<ht;Cn++){if(an<hr&&un[an]!==0){let Xn=0;for(let In=an;In<it;In++)Xn+=jt.get(In,an)*jt.get(In,Cn);Xn=-Xn/jt.get(an,an);for(let In=an;In<it;In++)jt.set(In,Cn,jt.get(In,Cn)+Xn*jt.get(In,an))}_e[Cn]=jt.get(an,Cn)}if(Ct&&an<hr)for(let Cn=an;Cn<it;Cn++)_n.set(Cn,an,jt.get(Cn,an));if(an<cr){_e[an]=0;for(let Cn=an+1;Cn<ht;Cn++)_e[an]=qn(_e[an],_e[Cn]);if(_e[an]!==0){_e[an+1]<0&&(_e[an]=0-_e[an]);for(let Cn=an+1;Cn<ht;Cn++)_e[Cn]/=_e[an];_e[an+1]+=1}if(_e[an]=-_e[an],an+1<it&&_e[an]!==0){for(let Cn=an+1;Cn<it;Cn++)Dn[Cn]=0;for(let Cn=an+1;Cn<it;Cn++)for(let Xn=an+1;Xn<ht;Xn++)Dn[Cn]+=_e[Xn]*jt.get(Cn,Xn);for(let Cn=an+1;Cn<ht;Cn++){let Xn=-_e[Cn]/_e[an+1];for(let In=an+1;In<it;In++)jt.set(In,Cn,jt.get(In,Cn)+Xn*Dn[In])}}if(Ht)for(let Cn=an+1;Cn<ht;Cn++)On.set(Cn,an,_e[Cn])}}let rr=Math.min(ht,it+1);if(hr<ht&&(un[hr]=jt.get(hr,hr)),it<rr&&(un[rr-1]=0),cr+1<rr&&(_e[cr]=jt.get(cr,rr-1)),_e[rr-1]=0,Ct){for(let an=hr;an<pn;an++){for(let Cn=0;Cn<it;Cn++)_n.set(Cn,an,0);_n.set(an,an,1)}for(let an=hr-1;an>=0;an--)if(un[an]!==0){for(let Cn=an+1;Cn<pn;Cn++){let Xn=0;for(let In=an;In<it;In++)Xn+=_n.get(In,an)*_n.get(In,Cn);Xn=-Xn/_n.get(an,an);for(let In=an;In<it;In++)_n.set(In,Cn,_n.get(In,Cn)+Xn*_n.get(In,an))}for(let Cn=an;Cn<it;Cn++)_n.set(Cn,an,-_n.get(Cn,an));_n.set(an,an,1+_n.get(an,an));for(let Cn=0;Cn<an-1;Cn++)_n.set(Cn,an,0)}else{for(let Cn=0;Cn<it;Cn++)_n.set(Cn,an,0);_n.set(an,an,1)}}if(Ht)for(let an=ht-1;an>=0;an--){if(an<cr&&_e[an]!==0)for(let Cn=an+1;Cn<ht;Cn++){let Xn=0;for(let In=an+1;In<ht;In++)Xn+=On.get(In,an)*On.get(In,Cn);Xn=-Xn/On.get(an+1,an);for(let In=an+1;In<ht;In++)On.set(In,Cn,On.get(In,Cn)+Xn*On.get(In,an))}for(let Cn=0;Cn<ht;Cn++)On.set(Cn,an,0);On.set(an,an,1)}let lr=rr-1,Sr=Number.EPSILON;for(;rr>0;){let an,Cn;for(an=rr-2;an>=-1&&an!==-1;an--){const Xn=Number.MIN_VALUE+Sr*Math.abs(un[an]+Math.abs(un[an+1]));if(Math.abs(_e[an])<=Xn||Number.isNaN(_e[an])){_e[an]=0;break}}if(an===rr-2)Cn=4;else{let Xn;for(Xn=rr-1;Xn>=an&&Xn!==an;Xn--){let In=(Xn!==rr?Math.abs(_e[Xn]):0)+(Xn!==an+1?Math.abs(_e[Xn-1]):0);if(Math.abs(un[Xn])<=Sr*In){un[Xn]=0;break}}Xn===an?Cn=3:Xn===rr-1?Cn=1:(Cn=2,an=Xn)}switch(an++,Cn){case 1:{let Xn=_e[rr-2];_e[rr-2]=0;for(let In=rr-2;In>=an;In--){let br=qn(un[In],Xn),vr=un[In]/br,Er=Xn/br;if(un[In]=br,In!==an&&(Xn=-Er*_e[In-1],_e[In-1]=vr*_e[In-1]),Ht)for(let xr=0;xr<ht;xr++)br=vr*On.get(xr,In)+Er*On.get(xr,rr-1),On.set(xr,rr-1,-Er*On.get(xr,In)+vr*On.get(xr,rr-1)),On.set(xr,In,br)}break}case 2:{let Xn=_e[an-1];_e[an-1]=0;for(let In=an;In<rr;In++){let br=qn(un[In],Xn),vr=un[In]/br,Er=Xn/br;if(un[In]=br,Xn=-Er*_e[In],_e[In]=vr*_e[In],Ct)for(let xr=0;xr<it;xr++)br=vr*_n.get(xr,In)+Er*_n.get(xr,an-1),_n.set(xr,an-1,-Er*_n.get(xr,In)+vr*_n.get(xr,an-1)),_n.set(xr,In,br)}break}case 3:{const Xn=Math.max(Math.abs(un[rr-1]),Math.abs(un[rr-2]),Math.abs(_e[rr-2]),Math.abs(un[an]),Math.abs(_e[an])),In=un[rr-1]/Xn,br=un[rr-2]/Xn,vr=_e[rr-2]/Xn,Er=un[an]/Xn,xr=_e[an]/Xn,fr=((br+In)*(br-In)+vr*vr)/2,_r=In*vr*(In*vr);let Ar=0;(fr!==0||_r!==0)&&(fr<0?Ar=0-Math.sqrt(fr*fr+_r):Ar=Math.sqrt(fr*fr+_r),Ar=_r/(fr+Ar));let $r=(Er+In)*(Er-In)+Ar,Ir=Er*xr;for(let pr=an;pr<rr-1;pr++){let ur=qn($r,Ir);ur===0&&(ur=Number.MIN_VALUE);let wr=$r/ur,Lr=Ir/ur;if(pr!==an&&(_e[pr-1]=ur),$r=wr*un[pr]+Lr*_e[pr],_e[pr]=wr*_e[pr]-Lr*un[pr],Ir=Lr*un[pr+1],un[pr+1]=wr*un[pr+1],Ht)for(let Tr=0;Tr<ht;Tr++)ur=wr*On.get(Tr,pr)+Lr*On.get(Tr,pr+1),On.set(Tr,pr+1,-Lr*On.get(Tr,pr)+wr*On.get(Tr,pr+1)),On.set(Tr,pr,ur);if(ur=qn($r,Ir),ur===0&&(ur=Number.MIN_VALUE),wr=$r/ur,Lr=Ir/ur,un[pr]=ur,$r=wr*_e[pr]+Lr*un[pr+1],un[pr+1]=-Lr*_e[pr]+wr*un[pr+1],Ir=Lr*_e[pr+1],_e[pr+1]=wr*_e[pr+1],Ct&&pr<it-1)for(let Tr=0;Tr<it;Tr++)ur=wr*_n.get(Tr,pr)+Lr*_n.get(Tr,pr+1),_n.set(Tr,pr+1,-Lr*_n.get(Tr,pr)+wr*_n.get(Tr,pr+1)),_n.set(Tr,pr,ur)}_e[rr-2]=$r;break}case 4:{if(un[an]<=0&&(un[an]=un[an]<0?-un[an]:0,Ht))for(let Xn=0;Xn<=lr;Xn++)On.set(Xn,an,-On.get(Xn,an));for(;an<lr&&!(un[an]>=un[an+1]);){let Xn=un[an];if(un[an]=un[an+1],un[an+1]=Xn,Ht&&an<ht-1)for(let In=0;In<ht;In++)Xn=On.get(In,an+1),On.set(In,an+1,On.get(In,an)),On.set(In,an,Xn);if(Ct&&an<it-1)for(let In=0;In<it;In++)Xn=_n.get(In,an+1),_n.set(In,an+1,_n.get(In,an)),_n.set(In,an,Xn);an++}rr--;break}}}if(rn){let an=On;On=_n,_n=an}this.m=it,this.n=ht,this.s=un,this.U=_n,this.V=On}solve(rt){let et=rt,it=this.threshold,ht=this.s.length,yt=fn.zeros(ht,ht);for(let pn=0;pn<ht;pn++)Math.abs(this.s[pn])<=it?yt.set(pn,pn,0):yt.set(pn,pn,1/this.s[pn]);let Lt=this.U,Nt=this.rightSingularVectors,Ct=Nt.mmul(yt),Ht=Nt.rows,rn=Lt.rows,jt=fn.zeros(Ht,rn);for(let pn=0;pn<Ht;pn++)for(let Mn=0;Mn<rn;Mn++){let un=0;for(let _n=0;_n<ht;_n++)un+=Ct.get(pn,_n)*Lt.get(Mn,_n);jt.set(pn,Mn,un)}return jt.mmul(et)}solveForDiagonal(rt){return this.solve(fn.diag(rt))}inverse(){let rt=this.V,et=this.threshold,it=rt.rows,ht=rt.columns,yt=new fn(it,this.s.length);for(let rn=0;rn<it;rn++)for(let jt=0;jt<ht;jt++)Math.abs(this.s[jt])>et&&yt.set(rn,jt,rt.get(rn,jt)/this.s[jt]);let Lt=this.U,Nt=Lt.rows,Ct=Lt.columns,Ht=new fn(it,Nt);for(let rn=0;rn<it;rn++)for(let jt=0;jt<Nt;jt++){let pn=0;for(let Mn=0;Mn<Ct;Mn++)pn+=yt.get(rn,Mn)*Lt.get(jt,Mn);Ht.set(rn,jt,pn)}return Ht}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let rt=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,et=0,it=this.s;for(let ht=0,yt=it.length;ht<yt;ht++)it[ht]>rt&&et++;return et}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return fn.diag(this.s)}}function Kn(ct,rt=!1){return ct=ar.checkMatrix(ct),rt?new Nn(ct).inverse():Ut(ct,fn.eye(ct.rows))}function Ut(ct,rt,et=!1){return ct=ar.checkMatrix(ct),rt=ar.checkMatrix(rt),et?new Nn(ct).solve(rt):ct.isSquare()?new Fn(ct).solve(rt):new ir(ct).solve(rt)}function xn(ct){if(ct=fn.checkMatrix(ct),ct.isSquare()){if(ct.columns===0)return 1;let rt,et,it,ht;if(ct.columns===2)return rt=ct.get(0,0),et=ct.get(0,1),it=ct.get(1,0),ht=ct.get(1,1),rt*ht-et*it;if(ct.columns===3){let yt,Lt,Nt;return yt=new jn(ct,[1,2],[1,2]),Lt=new jn(ct,[1,2],[0,2]),Nt=new jn(ct,[1,2],[0,1]),rt=ct.get(0,0),et=ct.get(0,1),it=ct.get(0,2),rt*xn(yt)-et*xn(Lt)+it*xn(Nt)}else return new Fn(ct).determinant}else throw Error("determinant can only be calculated for a square matrix")}function kn(ct,rt){let et=[];for(let it=0;it<ct;it++)it!==rt&&et.push(it);return et}function Pn(ct,rt,et,it=1e-9,ht=1e-9){if(ct>ht)return new Array(rt.rows+1).fill(0);{let yt=rt.addRow(et,[0]);for(let Lt=0;Lt<yt.rows;Lt++)Math.abs(yt.get(Lt,0))<it&&yt.set(Lt,0,0);return yt.to1DArray()}}function tn(ct,rt={}){const{thresholdValue:et=1e-9,thresholdError:it=1e-9}=rt;ct=fn.checkMatrix(ct);let ht=ct.rows,yt=new fn(ht,ht);for(let Lt=0;Lt<ht;Lt++){let Nt=fn.columnVector(ct.getRow(Lt)),Ct=ct.subMatrixRow(kn(ht,Lt)).transpose(),Ht=new Nn(Ct).solve(Nt),rn=fn.sub(Nt,Ct.mmul(Ht)).abs().max();yt.setRow(Lt,Pn(rn,Ht,Lt,et,it))}return yt}function vn(ct,rt=Number.EPSILON){if(ct=fn.checkMatrix(ct),ct.isEmpty())return ct.transpose();let et=new Nn(ct,{autoTranspose:!0}),it=et.leftSingularVectors,ht=et.rightSingularVectors,yt=et.diagonal;for(let Lt=0;Lt<yt.length;Lt++)Math.abs(yt[Lt])>rt?yt[Lt]=1/yt[Lt]:yt[Lt]=0;return ht.mmul(fn.diag(yt).mmul(it.transpose()))}function Pt(ct,rt=ct,et={}){ct=new fn(ct);let it=!1;if(typeof rt=="object"&&!fn.isMatrix(rt)&&!s.isAnyArray(rt)?(et=rt,rt=ct,it=!0):rt=new fn(rt),ct.rows!==rt.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:ht=!0}=et;ht&&(ct=ct.center("column"),it||(rt=rt.center("column")));const yt=ct.transpose().mmul(rt);for(let Lt=0;Lt<yt.rows;Lt++)for(let Nt=0;Nt<yt.columns;Nt++)yt.set(Lt,Nt,yt.get(Lt,Nt)*(1/(ct.rows-1)));return yt}function An(ct,rt=ct,et={}){ct=new fn(ct);let it=!1;if(typeof rt=="object"&&!fn.isMatrix(rt)&&!s.isAnyArray(rt)?(et=rt,rt=ct,it=!0):rt=new fn(rt),ct.rows!==rt.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:ht=!0,scale:yt=!0}=et;ht&&(ct.center("column"),it||rt.center("column")),yt&&(ct.scale("column"),it||rt.scale("column"));const Lt=ct.standardDeviation("column",{unbiased:!0}),Nt=it?Lt:rt.standardDeviation("column",{unbiased:!0}),Ct=ct.transpose().mmul(rt);for(let Ht=0;Ht<Ct.rows;Ht++)for(let rn=0;rn<Ct.columns;rn++)Ct.set(Ht,rn,Ct.get(Ht,rn)*(1/(Lt[Ht]*Nt[rn]))*(1/(ct.rows-1)));return Ct}class sr{constructor(rt,et={}){const{assumeSymmetric:it=!1}=et;if(rt=ar.checkMatrix(rt),!rt.isSquare())throw new Error("Matrix is not a square matrix");if(rt.isEmpty())throw new Error("Matrix must be non-empty");let ht=rt.columns,yt=new fn(ht,ht),Lt=new Float64Array(ht),Nt=new Float64Array(ht),Ct=rt,Ht,rn,jt=!1;if(it?jt=!0:jt=rt.isSymmetric(),jt){for(Ht=0;Ht<ht;Ht++)for(rn=0;rn<ht;rn++)yt.set(Ht,rn,Ct.get(Ht,rn));wt(ht,Nt,Lt,yt),mn(ht,Nt,Lt,yt)}else{let pn=new fn(ht,ht),Mn=new Float64Array(ht);for(rn=0;rn<ht;rn++)for(Ht=0;Ht<ht;Ht++)pn.set(Ht,rn,Ct.get(Ht,rn));yn(ht,pn,Mn,yt),Ft(ht,Nt,Lt,yt,pn)}this.n=ht,this.e=Nt,this.d=Lt,this.V=yt}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let rt=this.n,et=this.e,it=this.d,ht=new fn(rt,rt),yt,Lt;for(yt=0;yt<rt;yt++){for(Lt=0;Lt<rt;Lt++)ht.set(yt,Lt,0);ht.set(yt,yt,it[yt]),et[yt]>0?ht.set(yt,yt+1,et[yt]):et[yt]<0&&ht.set(yt,yt-1,et[yt])}return ht}}function wt(ct,rt,et,it){let ht,yt,Lt,Nt,Ct,Ht,rn,jt;for(Ct=0;Ct<ct;Ct++)et[Ct]=it.get(ct-1,Ct);for(Nt=ct-1;Nt>0;Nt--){for(jt=0,Lt=0,Ht=0;Ht<Nt;Ht++)jt=jt+Math.abs(et[Ht]);if(jt===0)for(rt[Nt]=et[Nt-1],Ct=0;Ct<Nt;Ct++)et[Ct]=it.get(Nt-1,Ct),it.set(Nt,Ct,0),it.set(Ct,Nt,0);else{for(Ht=0;Ht<Nt;Ht++)et[Ht]/=jt,Lt+=et[Ht]*et[Ht];for(ht=et[Nt-1],yt=Math.sqrt(Lt),ht>0&&(yt=-yt),rt[Nt]=jt*yt,Lt=Lt-ht*yt,et[Nt-1]=ht-yt,Ct=0;Ct<Nt;Ct++)rt[Ct]=0;for(Ct=0;Ct<Nt;Ct++){for(ht=et[Ct],it.set(Ct,Nt,ht),yt=rt[Ct]+it.get(Ct,Ct)*ht,Ht=Ct+1;Ht<=Nt-1;Ht++)yt+=it.get(Ht,Ct)*et[Ht],rt[Ht]+=it.get(Ht,Ct)*ht;rt[Ct]=yt}for(ht=0,Ct=0;Ct<Nt;Ct++)rt[Ct]/=Lt,ht+=rt[Ct]*et[Ct];for(rn=ht/(Lt+Lt),Ct=0;Ct<Nt;Ct++)rt[Ct]-=rn*et[Ct];for(Ct=0;Ct<Nt;Ct++){for(ht=et[Ct],yt=rt[Ct],Ht=Ct;Ht<=Nt-1;Ht++)it.set(Ht,Ct,it.get(Ht,Ct)-(ht*rt[Ht]+yt*et[Ht]));et[Ct]=it.get(Nt-1,Ct),it.set(Nt,Ct,0)}}et[Nt]=Lt}for(Nt=0;Nt<ct-1;Nt++){if(it.set(ct-1,Nt,it.get(Nt,Nt)),it.set(Nt,Nt,1),Lt=et[Nt+1],Lt!==0){for(Ht=0;Ht<=Nt;Ht++)et[Ht]=it.get(Ht,Nt+1)/Lt;for(Ct=0;Ct<=Nt;Ct++){for(yt=0,Ht=0;Ht<=Nt;Ht++)yt+=it.get(Ht,Nt+1)*it.get(Ht,Ct);for(Ht=0;Ht<=Nt;Ht++)it.set(Ht,Ct,it.get(Ht,Ct)-yt*et[Ht])}}for(Ht=0;Ht<=Nt;Ht++)it.set(Ht,Nt+1,0)}for(Ct=0;Ct<ct;Ct++)et[Ct]=it.get(ct-1,Ct),it.set(ct-1,Ct,0);it.set(ct-1,ct-1,1),rt[0]=0}function mn(ct,rt,et,it){let ht,yt,Lt,Nt,Ct,Ht,rn,jt,pn,Mn,un,_n,On,_e,Dn,Yn;for(Lt=1;Lt<ct;Lt++)rt[Lt-1]=rt[Lt];rt[ct-1]=0;let hr=0,cr=0,kr=Number.EPSILON;for(Ht=0;Ht<ct;Ht++){for(cr=Math.max(cr,Math.abs(et[Ht])+Math.abs(rt[Ht])),rn=Ht;rn<ct&&!(Math.abs(rt[rn])<=kr*cr);)rn++;if(rn>Ht)do{for(ht=et[Ht],jt=(et[Ht+1]-ht)/(2*rt[Ht]),pn=qn(jt,1),jt<0&&(pn=-pn),et[Ht]=rt[Ht]/(jt+pn),et[Ht+1]=rt[Ht]*(jt+pn),Mn=et[Ht+1],yt=ht-et[Ht],Lt=Ht+2;Lt<ct;Lt++)et[Lt]-=yt;for(hr=hr+yt,jt=et[rn],un=1,_n=un,On=un,_e=rt[Ht+1],Dn=0,Yn=0,Lt=rn-1;Lt>=Ht;Lt--)for(On=_n,_n=un,Yn=Dn,ht=un*rt[Lt],yt=un*jt,pn=qn(jt,rt[Lt]),rt[Lt+1]=Dn*pn,Dn=rt[Lt]/pn,un=jt/pn,jt=un*et[Lt]-Dn*ht,et[Lt+1]=yt+Dn*(un*ht+Dn*et[Lt]),Ct=0;Ct<ct;Ct++)yt=it.get(Ct,Lt+1),it.set(Ct,Lt+1,Dn*it.get(Ct,Lt)+un*yt),it.set(Ct,Lt,un*it.get(Ct,Lt)-Dn*yt);jt=-Dn*Yn*On*_e*rt[Ht]/Mn,rt[Ht]=Dn*jt,et[Ht]=un*jt}while(Math.abs(rt[Ht])>kr*cr);et[Ht]=et[Ht]+hr,rt[Ht]=0}for(Lt=0;Lt<ct-1;Lt++){for(Ct=Lt,jt=et[Lt],Nt=Lt+1;Nt<ct;Nt++)et[Nt]<jt&&(Ct=Nt,jt=et[Nt]);if(Ct!==Lt)for(et[Ct]=et[Lt],et[Lt]=jt,Nt=0;Nt<ct;Nt++)jt=it.get(Nt,Lt),it.set(Nt,Lt,it.get(Nt,Ct)),it.set(Nt,Ct,jt)}}function yn(ct,rt,et,it){let ht=0,yt=ct-1,Lt,Nt,Ct,Ht,rn,jt,pn;for(jt=ht+1;jt<=yt-1;jt++){for(pn=0,Ht=jt;Ht<=yt;Ht++)pn=pn+Math.abs(rt.get(Ht,jt-1));if(pn!==0){for(Ct=0,Ht=yt;Ht>=jt;Ht--)et[Ht]=rt.get(Ht,jt-1)/pn,Ct+=et[Ht]*et[Ht];for(Nt=Math.sqrt(Ct),et[jt]>0&&(Nt=-Nt),Ct=Ct-et[jt]*Nt,et[jt]=et[jt]-Nt,rn=jt;rn<ct;rn++){for(Lt=0,Ht=yt;Ht>=jt;Ht--)Lt+=et[Ht]*rt.get(Ht,rn);for(Lt=Lt/Ct,Ht=jt;Ht<=yt;Ht++)rt.set(Ht,rn,rt.get(Ht,rn)-Lt*et[Ht])}for(Ht=0;Ht<=yt;Ht++){for(Lt=0,rn=yt;rn>=jt;rn--)Lt+=et[rn]*rt.get(Ht,rn);for(Lt=Lt/Ct,rn=jt;rn<=yt;rn++)rt.set(Ht,rn,rt.get(Ht,rn)-Lt*et[rn])}et[jt]=pn*et[jt],rt.set(jt,jt-1,pn*Nt)}}for(Ht=0;Ht<ct;Ht++)for(rn=0;rn<ct;rn++)it.set(Ht,rn,Ht===rn?1:0);for(jt=yt-1;jt>=ht+1;jt--)if(rt.get(jt,jt-1)!==0){for(Ht=jt+1;Ht<=yt;Ht++)et[Ht]=rt.get(Ht,jt-1);for(rn=jt;rn<=yt;rn++){for(Nt=0,Ht=jt;Ht<=yt;Ht++)Nt+=et[Ht]*it.get(Ht,rn);for(Nt=Nt/et[jt]/rt.get(jt,jt-1),Ht=jt;Ht<=yt;Ht++)it.set(Ht,rn,it.get(Ht,rn)+Nt*et[Ht])}}}function Ft(ct,rt,et,it,ht){let yt=ct-1,Lt=0,Nt=ct-1,Ct=Number.EPSILON,Ht=0,rn=0,jt=0,pn=0,Mn=0,un=0,_n=0,On=0,_e,Dn,Yn,hr,cr,kr,rr,lr,Sr,an,Cn,Xn,In,br,vr;for(_e=0;_e<ct;_e++)for((_e<Lt||_e>Nt)&&(et[_e]=ht.get(_e,_e),rt[_e]=0),Dn=Math.max(_e-1,0);Dn<ct;Dn++)rn=rn+Math.abs(ht.get(_e,Dn));for(;yt>=Lt;){for(hr=yt;hr>Lt&&(un=Math.abs(ht.get(hr-1,hr-1))+Math.abs(ht.get(hr,hr)),un===0&&(un=rn),!(Math.abs(ht.get(hr,hr-1))<Ct*un));)hr--;if(hr===yt)ht.set(yt,yt,ht.get(yt,yt)+Ht),et[yt]=ht.get(yt,yt),rt[yt]=0,yt--,On=0;else if(hr===yt-1){if(rr=ht.get(yt,yt-1)*ht.get(yt-1,yt),jt=(ht.get(yt-1,yt-1)-ht.get(yt,yt))/2,pn=jt*jt+rr,_n=Math.sqrt(Math.abs(pn)),ht.set(yt,yt,ht.get(yt,yt)+Ht),ht.set(yt-1,yt-1,ht.get(yt-1,yt-1)+Ht),lr=ht.get(yt,yt),pn>=0){for(_n=jt>=0?jt+_n:jt-_n,et[yt-1]=lr+_n,et[yt]=et[yt-1],_n!==0&&(et[yt]=lr-rr/_n),rt[yt-1]=0,rt[yt]=0,lr=ht.get(yt,yt-1),un=Math.abs(lr)+Math.abs(_n),jt=lr/un,pn=_n/un,Mn=Math.sqrt(jt*jt+pn*pn),jt=jt/Mn,pn=pn/Mn,Dn=yt-1;Dn<ct;Dn++)_n=ht.get(yt-1,Dn),ht.set(yt-1,Dn,pn*_n+jt*ht.get(yt,Dn)),ht.set(yt,Dn,pn*ht.get(yt,Dn)-jt*_n);for(_e=0;_e<=yt;_e++)_n=ht.get(_e,yt-1),ht.set(_e,yt-1,pn*_n+jt*ht.get(_e,yt)),ht.set(_e,yt,pn*ht.get(_e,yt)-jt*_n);for(_e=Lt;_e<=Nt;_e++)_n=it.get(_e,yt-1),it.set(_e,yt-1,pn*_n+jt*it.get(_e,yt)),it.set(_e,yt,pn*it.get(_e,yt)-jt*_n)}else et[yt-1]=lr+jt,et[yt]=lr+jt,rt[yt-1]=_n,rt[yt]=-_n;yt=yt-2,On=0}else{if(lr=ht.get(yt,yt),Sr=0,rr=0,hr<yt&&(Sr=ht.get(yt-1,yt-1),rr=ht.get(yt,yt-1)*ht.get(yt-1,yt)),On===10){for(Ht+=lr,_e=Lt;_e<=yt;_e++)ht.set(_e,_e,ht.get(_e,_e)-lr);un=Math.abs(ht.get(yt,yt-1))+Math.abs(ht.get(yt-1,yt-2)),lr=Sr=.75*un,rr=-.4375*un*un}if(On===30&&(un=(Sr-lr)/2,un=un*un+rr,un>0)){for(un=Math.sqrt(un),Sr<lr&&(un=-un),un=lr-rr/((Sr-lr)/2+un),_e=Lt;_e<=yt;_e++)ht.set(_e,_e,ht.get(_e,_e)-un);Ht+=un,lr=Sr=rr=.964}for(On=On+1,cr=yt-2;cr>=hr&&(_n=ht.get(cr,cr),Mn=lr-_n,un=Sr-_n,jt=(Mn*un-rr)/ht.get(cr+1,cr)+ht.get(cr,cr+1),pn=ht.get(cr+1,cr+1)-_n-Mn-un,Mn=ht.get(cr+2,cr+1),un=Math.abs(jt)+Math.abs(pn)+Math.abs(Mn),jt=jt/un,pn=pn/un,Mn=Mn/un,!(cr===hr||Math.abs(ht.get(cr,cr-1))*(Math.abs(pn)+Math.abs(Mn))<Ct*(Math.abs(jt)*(Math.abs(ht.get(cr-1,cr-1))+Math.abs(_n)+Math.abs(ht.get(cr+1,cr+1))))));)cr--;for(_e=cr+2;_e<=yt;_e++)ht.set(_e,_e-2,0),_e>cr+2&&ht.set(_e,_e-3,0);for(Yn=cr;Yn<=yt-1&&(br=Yn!==yt-1,Yn!==cr&&(jt=ht.get(Yn,Yn-1),pn=ht.get(Yn+1,Yn-1),Mn=br?ht.get(Yn+2,Yn-1):0,lr=Math.abs(jt)+Math.abs(pn)+Math.abs(Mn),lr!==0&&(jt=jt/lr,pn=pn/lr,Mn=Mn/lr)),lr!==0);Yn++)if(un=Math.sqrt(jt*jt+pn*pn+Mn*Mn),jt<0&&(un=-un),un!==0){for(Yn!==cr?ht.set(Yn,Yn-1,-un*lr):hr!==cr&&ht.set(Yn,Yn-1,-ht.get(Yn,Yn-1)),jt=jt+un,lr=jt/un,Sr=pn/un,_n=Mn/un,pn=pn/jt,Mn=Mn/jt,Dn=Yn;Dn<ct;Dn++)jt=ht.get(Yn,Dn)+pn*ht.get(Yn+1,Dn),br&&(jt=jt+Mn*ht.get(Yn+2,Dn),ht.set(Yn+2,Dn,ht.get(Yn+2,Dn)-jt*_n)),ht.set(Yn,Dn,ht.get(Yn,Dn)-jt*lr),ht.set(Yn+1,Dn,ht.get(Yn+1,Dn)-jt*Sr);for(_e=0;_e<=Math.min(yt,Yn+3);_e++)jt=lr*ht.get(_e,Yn)+Sr*ht.get(_e,Yn+1),br&&(jt=jt+_n*ht.get(_e,Yn+2),ht.set(_e,Yn+2,ht.get(_e,Yn+2)-jt*Mn)),ht.set(_e,Yn,ht.get(_e,Yn)-jt),ht.set(_e,Yn+1,ht.get(_e,Yn+1)-jt*pn);for(_e=Lt;_e<=Nt;_e++)jt=lr*it.get(_e,Yn)+Sr*it.get(_e,Yn+1),br&&(jt=jt+_n*it.get(_e,Yn+2),it.set(_e,Yn+2,it.get(_e,Yn+2)-jt*Mn)),it.set(_e,Yn,it.get(_e,Yn)-jt),it.set(_e,Yn+1,it.get(_e,Yn+1)-jt*pn)}}}if(rn!==0){for(yt=ct-1;yt>=0;yt--)if(jt=et[yt],pn=rt[yt],pn===0)for(hr=yt,ht.set(yt,yt,1),_e=yt-1;_e>=0;_e--){for(rr=ht.get(_e,_e)-jt,Mn=0,Dn=hr;Dn<=yt;Dn++)Mn=Mn+ht.get(_e,Dn)*ht.get(Dn,yt);if(rt[_e]<0)_n=rr,un=Mn;else if(hr=_e,rt[_e]===0?ht.set(_e,yt,rr!==0?-Mn/rr:-Mn/(Ct*rn)):(lr=ht.get(_e,_e+1),Sr=ht.get(_e+1,_e),pn=(et[_e]-jt)*(et[_e]-jt)+rt[_e]*rt[_e],kr=(lr*un-_n*Mn)/pn,ht.set(_e,yt,kr),ht.set(_e+1,yt,Math.abs(lr)>Math.abs(_n)?(-Mn-rr*kr)/lr:(-un-Sr*kr)/_n)),kr=Math.abs(ht.get(_e,yt)),Ct*kr*kr>1)for(Dn=_e;Dn<=yt;Dn++)ht.set(Dn,yt,ht.get(Dn,yt)/kr)}else if(pn<0)for(hr=yt-1,Math.abs(ht.get(yt,yt-1))>Math.abs(ht.get(yt-1,yt))?(ht.set(yt-1,yt-1,pn/ht.get(yt,yt-1)),ht.set(yt-1,yt,-(ht.get(yt,yt)-jt)/ht.get(yt,yt-1))):(vr=Qt(0,-ht.get(yt-1,yt),ht.get(yt-1,yt-1)-jt,pn),ht.set(yt-1,yt-1,vr[0]),ht.set(yt-1,yt,vr[1])),ht.set(yt,yt-1,0),ht.set(yt,yt,1),_e=yt-2;_e>=0;_e--){for(an=0,Cn=0,Dn=hr;Dn<=yt;Dn++)an=an+ht.get(_e,Dn)*ht.get(Dn,yt-1),Cn=Cn+ht.get(_e,Dn)*ht.get(Dn,yt);if(rr=ht.get(_e,_e)-jt,rt[_e]<0)_n=rr,Mn=an,un=Cn;else if(hr=_e,rt[_e]===0?(vr=Qt(-an,-Cn,rr,pn),ht.set(_e,yt-1,vr[0]),ht.set(_e,yt,vr[1])):(lr=ht.get(_e,_e+1),Sr=ht.get(_e+1,_e),Xn=(et[_e]-jt)*(et[_e]-jt)+rt[_e]*rt[_e]-pn*pn,In=(et[_e]-jt)*2*pn,Xn===0&&In===0&&(Xn=Ct*rn*(Math.abs(rr)+Math.abs(pn)+Math.abs(lr)+Math.abs(Sr)+Math.abs(_n))),vr=Qt(lr*Mn-_n*an+pn*Cn,lr*un-_n*Cn-pn*an,Xn,In),ht.set(_e,yt-1,vr[0]),ht.set(_e,yt,vr[1]),Math.abs(lr)>Math.abs(_n)+Math.abs(pn)?(ht.set(_e+1,yt-1,(-an-rr*ht.get(_e,yt-1)+pn*ht.get(_e,yt))/lr),ht.set(_e+1,yt,(-Cn-rr*ht.get(_e,yt)-pn*ht.get(_e,yt-1))/lr)):(vr=Qt(-Mn-Sr*ht.get(_e,yt-1),-un-Sr*ht.get(_e,yt),_n,pn),ht.set(_e+1,yt-1,vr[0]),ht.set(_e+1,yt,vr[1]))),kr=Math.max(Math.abs(ht.get(_e,yt-1)),Math.abs(ht.get(_e,yt))),Ct*kr*kr>1)for(Dn=_e;Dn<=yt;Dn++)ht.set(Dn,yt-1,ht.get(Dn,yt-1)/kr),ht.set(Dn,yt,ht.get(Dn,yt)/kr)}for(_e=0;_e<ct;_e++)if(_e<Lt||_e>Nt)for(Dn=_e;Dn<ct;Dn++)it.set(_e,Dn,ht.get(_e,Dn));for(Dn=ct-1;Dn>=Lt;Dn--)for(_e=Lt;_e<=Nt;_e++){for(_n=0,Yn=Lt;Yn<=Math.min(Dn,Nt);Yn++)_n=_n+it.get(_e,Yn)*ht.get(Yn,Dn);it.set(_e,Dn,_n)}}}function Qt(ct,rt,et,it){let ht,yt;return Math.abs(et)>Math.abs(it)?(ht=it/et,yt=et+ht*it,[(ct+ht*rt)/yt,(rt-ht*ct)/yt]):(ht=et/it,yt=it+ht*et,[(ht*ct+rt)/yt,(ht*rt-ct)/yt])}class cn{constructor(rt){if(rt=ar.checkMatrix(rt),!rt.isSymmetric())throw new Error("Matrix is not symmetric");let et=rt,it=et.rows,ht=new fn(it,it),yt=!0,Lt,Nt,Ct;for(Nt=0;Nt<it;Nt++){let Ht=0;for(Ct=0;Ct<Nt;Ct++){let rn=0;for(Lt=0;Lt<Ct;Lt++)rn+=ht.get(Ct,Lt)*ht.get(Nt,Lt);rn=(et.get(Nt,Ct)-rn)/ht.get(Ct,Ct),ht.set(Nt,Ct,rn),Ht=Ht+rn*rn}for(Ht=et.get(Nt,Nt)-Ht,yt&&(yt=Ht>0),ht.set(Nt,Nt,Math.sqrt(Math.max(Ht,0))),Ct=Nt+1;Ct<it;Ct++)ht.set(Nt,Ct,0)}this.L=ht,this.positiveDefinite=yt}isPositiveDefinite(){return this.positiveDefinite}solve(rt){rt=ar.checkMatrix(rt);let et=this.L,it=et.rows;if(rt.rows!==it)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let ht=rt.columns,yt=rt.clone(),Lt,Nt,Ct;for(Ct=0;Ct<it;Ct++)for(Nt=0;Nt<ht;Nt++){for(Lt=0;Lt<Ct;Lt++)yt.set(Ct,Nt,yt.get(Ct,Nt)-yt.get(Lt,Nt)*et.get(Ct,Lt));yt.set(Ct,Nt,yt.get(Ct,Nt)/et.get(Ct,Ct))}for(Ct=it-1;Ct>=0;Ct--)for(Nt=0;Nt<ht;Nt++){for(Lt=Ct+1;Lt<it;Lt++)yt.set(Ct,Nt,yt.get(Ct,Nt)-yt.get(Lt,Nt)*et.get(Lt,Ct));yt.set(Ct,Nt,yt.get(Ct,Nt)/et.get(Ct,Ct))}return yt}get lowerTriangularMatrix(){return this.L}}class tr{constructor(rt,et={}){rt=ar.checkMatrix(rt);let{Y:it}=et;const{scaleScores:ht=!1,maxIterations:yt=1e3,terminationCriteria:Lt=1e-10}=et;let Nt;if(it){if(s.isAnyArray(it)&&typeof it[0]=="number"?it=fn.columnVector(it):it=ar.checkMatrix(it),it.rows!==rt.rows)throw new Error("Y should have the same number of rows as X");Nt=it.getColumnVector(0)}else Nt=rt.getColumnVector(0);let Ct=1,Ht,rn,jt,pn;for(let Mn=0;Mn<yt&&Ct>Lt;Mn++)jt=rt.transpose().mmul(Nt).div(Nt.transpose().mmul(Nt).get(0,0)),jt=jt.div(jt.norm()),Ht=rt.mmul(jt).div(jt.transpose().mmul(jt).get(0,0)),Mn>0&&(Ct=Ht.clone().sub(pn).pow(2).sum()),pn=Ht.clone(),it?(rn=it.transpose().mmul(Ht).div(Ht.transpose().mmul(Ht).get(0,0)),rn=rn.div(rn.norm()),Nt=it.mmul(rn).div(rn.transpose().mmul(rn).get(0,0))):Nt=Ht;if(it){let Mn=rt.transpose().mmul(Ht).div(Ht.transpose().mmul(Ht).get(0,0));Mn=Mn.div(Mn.norm());let un=rt.clone().sub(Ht.clone().mmul(Mn.transpose())),_n=Nt.transpose().mmul(Ht).div(Ht.transpose().mmul(Ht).get(0,0)),On=it.clone().sub(Ht.clone().mulS(_n.get(0,0)).mmul(rn.transpose()));this.t=Ht,this.p=Mn.transpose(),this.w=jt.transpose(),this.q=rn,this.u=Nt,this.s=Ht.transpose().mmul(Ht),this.xResidual=un,this.yResidual=On,this.betas=_n}else this.w=jt.transpose(),this.s=Ht.transpose().mmul(Ht).sqrt(),ht?this.t=Ht.clone().div(this.s.get(0,0)):this.t=Ht,this.xResidual=rt.sub(Ht.mmul(jt.transpose()))}}return matrix$1.AbstractMatrix=qt,matrix$1.CHO=cn,matrix$1.CholeskyDecomposition=cn,matrix$1.DistanceMatrix=Gn,matrix$1.EVD=sr,matrix$1.EigenvalueDecomposition=sr,matrix$1.LU=Fn,matrix$1.LuDecomposition=Fn,matrix$1.Matrix=fn,matrix$1.MatrixColumnSelectionView=or,matrix$1.MatrixColumnView=Bn,matrix$1.MatrixFlipColumnView=Jn,matrix$1.MatrixFlipRowView=Un,matrix$1.MatrixRowSelectionView=wn,matrix$1.MatrixRowView=nr,matrix$1.MatrixSelectionView=jn,matrix$1.MatrixSubView=er,matrix$1.MatrixTransposeView=Vn,matrix$1.NIPALS=tr,matrix$1.Nipals=tr,matrix$1.QR=ir,matrix$1.QrDecomposition=ir,matrix$1.SVD=Nn,matrix$1.SingularValueDecomposition=Nn,matrix$1.SymmetricMatrix=Zn,matrix$1.WrapperMatrix1D=Rn,matrix$1.WrapperMatrix2D=ar,matrix$1.correlation=An,matrix$1.covariance=Pt,matrix$1.default=fn,matrix$1.determinant=xn,matrix$1.inverse=Kn,matrix$1.linearDependencies=tn,matrix$1.pseudoInverse=vn,matrix$1.solve=Ut,matrix$1.wrap=Hn,matrix$1}var matrixExports=requireMatrix();const matrix=getDefaultExportFromCjs(matrixExports),Matrix$1=matrixExports.Matrix,SVD=matrixExports.SVD,SingularValueDecomposition=matrixExports.SingularValueDecomposition;matrix.Matrix?matrix.Matrix:matrixExports.Matrix;const inverse=matrixExports.inverse,solve=matrixExports.solve;function getSeparatedKernel(e){const i=new SVD(e,{autoTranspose:!0});if(i.rank!==1)return null;const a=Math.sqrt(i.s[0]),s=i.U.to2DArray().map(h=>h[0]*a),o=i.V.to2DArray().map(h=>h[0]*a);return[s,o]}function convolution(e,i={}){let{channels:a,bitDepth:s,normalize:o=!1,divisor:h=1,border:g="copy",algorithm:_="auto"}=i,$={};s&&($.bitDepth=s);let b=Image$1.createFrom(this,$);if(a=validateArrayOfChannels(this,a),_!=="separable")({kernel:e}=validateKernel(e));else if(!Array.isArray(e)||e.length!==2)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if(_==="auto"){let mt=getSeparatedKernel(e);mt!==null?(_="separable",e=mt):(e.length>9||e[0].length>9)&&this.width<=4096&&this.height<=4096?_="fft":_="direct"}let tt,st;_==="separable"?(tt=Math.floor(e[0].length/2),st=Math.floor(e[1].length/2)):(tt=Math.floor(e.length/2),st=Math.floor(e[0].length/2));let at=b.isClamped,nt=new Array(this.height*this.width),lt,ft,pt,dt,_t,ut;for(dt=0;dt<a.length;dt++){for(_t=a[dt],pt=0;pt<this.height;pt++)for(ft=0;ft<this.width;ft++)lt=pt*this.width+ft,nt[lt]=this.data[lt*this.channels+_t];if(_==="direct")ut=srcExports$1.direct(nt,e,{rows:this.height,cols:this.width,normalize:o,divisor:h});else if(_==="separable"){if(ut=convolutionSeparable(nt,e,this.width,this.height),o){h=0;for(let mt=0;mt<e[0].length;mt++)for(let kt=0;kt<e[1].length;kt++)h+=e[0][mt]*e[1][kt]}if(h!==1)for(let mt=0;mt<ut.length;mt++)ut[mt]/=h}else ut=srcExports$1.fft(nt,e,{rows:this.height,cols:this.width,normalize:o,divisor:h});for(pt=0;pt<this.height;pt++)for(ft=0;ft<this.width;ft++)lt=pt*this.width+ft,at?b.data[lt*this.channels+_t]=clamp(ut[lt],b):b.data[lt*this.channels+_t]=ut[lt]}if(this.alpha&&!a.includes(this.channels))for(ft=this.components;ft<this.data.length;ft=ft+this.channels)b.data[ft]=this.data[ft];return g!=="periodic"&&b.setBorder({size:[st,tt],algorithm:g}),b}function gradientFilter(e={}){let{direction:i="xy",border:a="copy",kernelX:s,kernelY:o,channels:h,bitDepth:g=this.bitDepth}=e;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),i){case"x":if(!s)throw new Error("kernelX option is missing");return convolution.call(this,s,{channels:h,border:a,bitDepth:g});case"y":if(!o)throw new Error("kernelY option is missing");return convolution.call(this,o,{channels:h,border:a,bitDepth:g});case"xy":{if(!s)throw new Error("kernelX option is missing");if(!o)throw new Error("kernelY option is missing");const _=convolution.call(this,s,{channels:h,border:a,bitDepth:32}),$=convolution.call(this,o,{channels:h,border:a,bitDepth:32});return _.hypotenuse($,{bitDepth:g,channels:h})}default:throw new Error(`Unknown parameter direction: ${i}`)}}function sobelFilter(e){return gradientFilter.call(this,Object.assign({},e,{kernelX:SOBEL_X,kernelY:SOBEL_Y}))}function scharrFilter(e){return gradientFilter.call(this,Object.assign({},e,{kernelX:SCHARR_X,kernelY:SCHARR_Y}))}var newArray_1,hasRequiredNewArray;function requireNewArray(){if(hasRequiredNewArray)return newArray_1;hasRequiredNewArray=1,newArray_1=e;function e(i,a){i=i||0;for(var s=new Array(i),o=0;o<i;o++)s[o]=a;return s}return newArray_1}var newArrayExports=requireNewArray();const newArray=getDefaultExportFromCjs(newArrayExports);function level(e={}){let{algorithm:i="range",channels:a,min:s=this.min,max:o=this.max}=e;switch(this.checkProcessable("level",{bitDepth:[8,16,32]}),a=validateArrayOfChannels(this,{channels:a}),a.length!==this.channel&&(Array.isArray(s)&&s.length===this.channels&&(s=s.filter((h,g)=>a.includes(g))),Array.isArray(o)&&o.length===this.channels&&(o=o.filter((h,g)=>a.includes(g)))),i){case"range":s<0&&(s=0),o>this.maxValue&&(o=this.maxValue),Array.isArray(s)||(s=newArray(a.length,s)),Array.isArray(o)||(o=newArray(a.length,o)),processImage(this,s,o,a);break;default:throw new Error(`level: algorithm not implement: ${i}`)}return this}function processImage(e,i,a,s){let o=1e-5,h=new Array(s.length);for(let g=0;g<s.length;g++)i[g]===0&&a[g]===e.maxValue||a[g]===i[g]?h[g]=0:h[g]=(e.maxValue+1-o)/(a[g]-i[g]),i[g]+=(.5-o/2)/h[g];for(let g=0;g<s.length;g++){let _=s[g];if(h[g]!==0)for(let $=0;$<e.data.length;$+=e.channels)e.data[$+_]=Math.min(Math.max(0,(e.data[$+_]-i[g])*h[g]+.5|0),e.maxValue)}}var isArrayType,hasRequiredIsArrayType;function requireIsArrayType(){if(hasRequiredIsArrayType)return isArrayType;hasRequiredIsArrayType=1;var e=Object.prototype.toString;return isArrayType=function(i){return e.call(i).substr(-6,5)==="Array"},isArrayType}var isArrayTypeExports=requireIsArrayType();const isArray=getDefaultExportFromCjs(isArrayTypeExports);function checkNumberArray(e){if(isNaN(e)){if(e instanceof Image$1)return e.data;if(!isArray(e))throw new Error("checkNumberArray: the value should be either a number, array or Image");return e}else{if(e<=0)throw new Error("checkNumberArray: the value must be greater than 0");return e}}function add(e,i={}){let{channels:a}=i;if(this.checkProcessable("add",{bitDepth:[8,16]}),a=validateArrayOfChannels(this,{channels:a}),e=checkNumberArray(e),isNaN(e)){if(this.data.length!==e.length)throw new Error("add: the data size is different");for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,Math.min(this.maxValue,this.data[h+o]+e[h+o]>>0))}}else for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.min(this.maxValue,this.data[h+o]+e>>0)}return this}function subtract(e,i={}){let{channels:a}=i;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),a=validateArrayOfChannels(this,{channels:a}),e=checkNumberArray(e),isNaN(e)){if(this.data.length!==e.length)throw new Error("subtract: the data size is different");for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,Math.min(this.maxValue,this.data[h+o]-e[h+o]>>0))}}else for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,this.data[h+o]-e>>0)}return this}function subtractImage(e,i={}){let{channels:a,absolute:s=!1}=i;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==e.width||this.height!==e.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==e.alpha||this.bitDepth!==e.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==e.channels)throw new Error("subtractImage: both images must have the same number of channels");let o=this.clone();a=validateArrayOfChannels(this,{channels:a});for(let h=0;h<a.length;h++){let g=a[h];for(let _=g;_<this.data.length;_+=this.channels){let $=this.data[_]-e.data[_];s?o.data[_]=Math.abs($):o.data[_]=Math.max($,0)}}return o}function hypotenuse(e,i={}){let{bitDepth:a=this.bitDepth,channels:s}=i;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==e.width||this.height!==e.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==e.alpha||this.bitDepth!==e.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==e.channels)throw new Error("hypotenuse: both images must have the same number of channels");let o=Image$1.createFrom(this,{bitDepth:a});s=validateArrayOfChannels(this,{channels:s});let h=o.isClamped;for(let g=0;g<s.length;g++){let _=s[g];for(let $=_;$<this.data.length;$+=this.channels){let b=Math.hypot(this.data[$],e.data[$]);h?o.data[$]=Math.min(Math.max(Math.round(b),0),o.maxValue):o.data[$]=b}}return o}function multiply(e,i={}){let{channels:a}=i;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),e<=0)throw new Error("multiply: the value must be greater than 0");if(a=validateArrayOfChannels(this,{channels:a}),e=checkNumberArray(e),isNaN(e)){if(this.data.length!==e.length)throw new Error("multiply: the data size is different");for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,Math.min(this.maxValue,this.data[h+o]*e[h+o]>>0))}}else for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.min(this.maxValue,this.data[h+o]*e>>0)}return this}function divide(e,i={}){let{channels:a}=i;if(this.checkProcessable("divide",{bitDepth:[8,16]}),a=validateArrayOfChannels(this,{channels:a}),e=checkNumberArray(e),isNaN(e)){if(this.data.length!==e.length)throw new Error("divide: the: the data size is different");for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,Math.min(this.maxValue,this.data[h+o]/e[h+o]>>0))}}else for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.min(this.maxValue,this.data[h+o]/e>>0)}return this}class BaseRegression{constructor(){if(new.target===BaseRegression)throw new Error("BaseRegression must be subclassed")}predict(i){if(typeof i=="number")return this._predict(i);if(isAnyArray(i)){const a=[];for(let s=0;s<i.length;s++)a.push(this._predict(i[s]));return a}else throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(i,a){if(!isAnyArray(i)||!isAnyArray(a)||i.length!==a.length)throw new Error("x and y must be arrays of the same length");const s=i.length,o=new Array(s);for(let nt=0;nt<s;nt++)o[nt]=this._predict(i[nt]);let h=0,g=0,_=0,$=0,b=0,tt=0,st=0;for(let nt=0;nt<s;nt++)h+=o[nt],g+=a[nt],b+=o[nt]*o[nt],tt+=a[nt]*a[nt],st+=o[nt]*a[nt],a[nt]!==0&&(_+=(a[nt]-o[nt])*(a[nt]-o[nt])/a[nt]),$+=(a[nt]-o[nt])*(a[nt]-o[nt]);const at=(s*st-h*g)/Math.sqrt((s*b-h*h)*(s*tt-g*g));return{r:at,r2:at*at,chi2:_,rmsd:Math.sqrt($/s)}}}function squaredEuclidean(e,i){let a=0;for(let s=0;s<e.length;s++)a+=(e[s]-i[s])*(e[s]-i[s]);return a}function euclidean(e,i){return Math.sqrt(squaredEuclidean(e,i))}const euclidean$1=Object.freeze(Object.defineProperty({__proto__:null,euclidean,squaredEuclidean},Symbol.toStringTag,{value:"Module"})),require$$0$4=getAugmentedNamespace(euclidean$1);var gaussianKernel,hasRequiredGaussianKernel;function requireGaussianKernel(){if(hasRequiredGaussianKernel)return gaussianKernel;hasRequiredGaussianKernel=1;const{squaredEuclidean:e}=require$$0$4,i={sigma:1};class a{constructor(o){o=Object.assign({},i,o),this.sigma=o.sigma,this.divisor=2*o.sigma*o.sigma}compute(o,h){const g=e(o,h);return Math.exp(-g/this.divisor)}}return gaussianKernel=a,gaussianKernel}var polynomialKernel,hasRequiredPolynomialKernel;function requirePolynomialKernel(){if(hasRequiredPolynomialKernel)return polynomialKernel;hasRequiredPolynomialKernel=1;const e={degree:1,constant:1,scale:1};class i{constructor(s){s=Object.assign({},e,s),this.degree=s.degree,this.constant=s.constant,this.scale=s.scale}compute(s,o){for(var h=0,g=0;g<s.length;g++)h+=s[g]*o[g];return Math.pow(this.scale*h+this.constant,this.degree)}}return polynomialKernel=i,polynomialKernel}var sigmoidKernel,hasRequiredSigmoidKernel;function requireSigmoidKernel(){if(hasRequiredSigmoidKernel)return sigmoidKernel;hasRequiredSigmoidKernel=1;const e={alpha:.01,constant:-Math.E};class i{constructor(s){s=Object.assign({},e,s),this.alpha=s.alpha,this.constant=s.constant}compute(s,o){for(var h=0,g=0;g<s.length;g++)h+=s[g]*o[g];return Math.tanh(this.alpha*h+this.constant)}}return sigmoidKernel=i,sigmoidKernel}var anovaKernel,hasRequiredAnovaKernel;function requireAnovaKernel(){if(hasRequiredAnovaKernel)return anovaKernel;hasRequiredAnovaKernel=1;const e={sigma:1,degree:1};class i{constructor(s){s=Object.assign({},e,s),this.sigma=s.sigma,this.degree=s.degree}compute(s,o){for(var h=0,g=Math.min(s.length,o.length),_=1;_<=g;++_)h+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(s[_-1],_)-Math.pow(o[_-1],_),2)),this.degree);return h}}return anovaKernel=i,anovaKernel}var cauchyKernel,hasRequiredCauchyKernel;function requireCauchyKernel(){if(hasRequiredCauchyKernel)return cauchyKernel;hasRequiredCauchyKernel=1;const{squaredEuclidean:e}=require$$0$4,i={sigma:1};class a{constructor(o){o=Object.assign({},i,o),this.sigma=o.sigma}compute(o,h){return 1/(1+e(o,h)/(this.sigma*this.sigma))}}return cauchyKernel=a,cauchyKernel}var exponentialKernel,hasRequiredExponentialKernel;function requireExponentialKernel(){if(hasRequiredExponentialKernel)return exponentialKernel;hasRequiredExponentialKernel=1;const{euclidean:e}=require$$0$4,i={sigma:1};class a{constructor(o){o=Object.assign({},i,o),this.sigma=o.sigma,this.divisor=2*o.sigma*o.sigma}compute(o,h){const g=e(o,h);return Math.exp(-g/this.divisor)}}return exponentialKernel=a,exponentialKernel}var histogramIntersectionKernel,hasRequiredHistogramIntersectionKernel;function requireHistogramIntersectionKernel(){if(hasRequiredHistogramIntersectionKernel)return histogramIntersectionKernel;hasRequiredHistogramIntersectionKernel=1;class e{compute(a,s){for(var o=Math.min(a.length,s.length),h=0,g=0;g<o;++g)h+=Math.min(a[g],s[g]);return h}}return histogramIntersectionKernel=e,histogramIntersectionKernel}var laplacianKernel,hasRequiredLaplacianKernel;function requireLaplacianKernel(){if(hasRequiredLaplacianKernel)return laplacianKernel;hasRequiredLaplacianKernel=1;const{euclidean:e}=require$$0$4,i={sigma:1};class a{constructor(o){o=Object.assign({},i,o),this.sigma=o.sigma}compute(o,h){const g=e(o,h);return Math.exp(-g/this.sigma)}}return laplacianKernel=a,laplacianKernel}var multiquadraticKernel,hasRequiredMultiquadraticKernel;function requireMultiquadraticKernel(){if(hasRequiredMultiquadraticKernel)return multiquadraticKernel;hasRequiredMultiquadraticKernel=1;const{squaredEuclidean:e}=require$$0$4,i={constant:1};class a{constructor(o){o=Object.assign({},i,o),this.constant=o.constant}compute(o,h){return Math.sqrt(e(o,h)+this.constant*this.constant)}}return multiquadraticKernel=a,multiquadraticKernel}var rationalQuadraticKernel,hasRequiredRationalQuadraticKernel;function requireRationalQuadraticKernel(){if(hasRequiredRationalQuadraticKernel)return rationalQuadraticKernel;hasRequiredRationalQuadraticKernel=1;const{squaredEuclidean:e}=require$$0$4,i={constant:1};class a{constructor(o){o=Object.assign({},i,o),this.constant=o.constant}compute(o,h){const g=e(o,h);return 1-g/(g+this.constant)}}return rationalQuadraticKernel=a,rationalQuadraticKernel}var kernel,hasRequiredKernel;function requireKernel(){if(hasRequiredKernel)return kernel;hasRequiredKernel=1;const{Matrix:e,MatrixTransposeView:i}=requireMatrix(),a=requireGaussianKernel(),s=requirePolynomialKernel(),o=requireSigmoidKernel(),h=requireAnovaKernel(),g=requireCauchyKernel(),_=requireExponentialKernel(),$=requireHistogramIntersectionKernel(),b=requireLaplacianKernel(),tt=requireMultiquadraticKernel(),st=requireRationalQuadraticKernel(),at={gaussian:a,rbf:a,polynomial:s,poly:s,anova:h,cauchy:g,exponential:_,histogram:$,min:$,laplacian:b,multiquadratic:tt,rational:st,sigmoid:o,mlp:o};class nt{constructor(ft,pt){if(this.kernelType=ft,ft!=="linear")if(typeof ft=="string"){ft=ft.toLowerCase();var dt=at[ft];if(dt)this.kernelFunction=new dt(pt);else throw new Error(`unsupported kernel type: ${ft}`)}else if(typeof ft=="object"&&typeof ft.compute=="function")this.kernelFunction=ft;else throw new TypeError("first argument must be a valid kernel type or instance")}compute(ft,pt){if(ft=e.checkMatrix(ft),pt===void 0?pt=ft:pt=e.checkMatrix(pt),this.kernelType==="linear")return ft.mmul(new i(pt));const dt=new e(ft.rows,pt.rows);if(ft===pt)for(let _t=0;_t<ft.rows;_t++)for(let ut=_t;ut<ft.rows;ut++){const mt=this.kernelFunction.compute(ft.getRow(_t),ft.getRow(ut));dt.set(_t,ut,mt),dt.set(ut,_t,mt)}else for(let _t=0;_t<ft.rows;_t++)for(let ut=0;ut<pt.rows;ut++)dt.set(_t,ut,this.kernelFunction.compute(ft.getRow(_t),pt.getRow(ut)));return dt}}return kernel=nt,kernel}var kernelExports=requireKernel();const Kernel=getDefaultExportFromCjs(kernelExports),defaultOptions$2={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class KernelRidgeRegression extends BaseRegression{constructor(i,a,s){if(super(),i===!0)this.alpha=a.alpha,this.inputs=a.inputs,this.kernelType=a.kernelType,this.kernelOptions=a.kernelOptions,this.kernel=new Kernel(a.kernelType,a.kernelOptions);else{i=Matrix$1.checkMatrix(i),s=Object.assign({},defaultOptions$2,s);const o=new Kernel(s.kernelType,s.kernelOptions),h=o.compute(i),g=i.rows;h.add(Matrix$1.eye(g,g).mul(s.lambda)),this.alpha=solve(h,a),this.inputs=i,this.kernelType=s.kernelType,this.kernelOptions=s.kernelOptions,this.kernel=o}}_predict(i){return this.kernel.compute([i],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(i){if(i.name!=="kernelRidgeRegression")throw new TypeError("not a KRR model");return new KernelRidgeRegression(!0,i)}}function background$1(e,i,a){const s=new KernelRidgeRegression(e,i,a),o=new Array(this.size);for(let _=0;_<this.width;_++)for(let $=0;$<this.height;$++)o[$*this.width+_]=[_,$];const h=s.predict(o),g=Image$1.createFrom(this);for(let _=0;_<this.size;_++)g.data[_]=Math.min(this.maxValue,Math.max(0,h[_][0]));return g}function dilate(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let s=!0;t:for(const h of i)for(const g of h)if(g!==1){s=!1;break t}let o=this;for(let h=0;h<a;h++)if(this.bitDepth===1)if(s){const g=o.clone();o=dilateOnceBinaryOnlyOnes(o,g,i.length,i[0].length)}else{const g=Image$1.createFrom(o);o=dilateOnceBinary(o,g,i)}else if(s){const g=Image$1.createFrom(o);o=dilateOnceGreyOnlyOnes(o,g,i.length,i[0].length)}else{const g=Image$1.createFrom(o);o=dilateOnceGrey(o,g,i)}return o}function dilateOnceGrey(e,i,a){const s=a.length,o=a[0].length;let h=(s-1)/2,g=(o-1)/2;for(let _=0;_<e.height;_++)for(let $=0;$<e.width;$++){let b=0;for(let tt=0;tt<o;tt++)for(let st=0;st<s;st++){if(a[st][tt]!==1)continue;let at=st-h+$,nt=tt-g+_;if(at<0||nt<0||at>=e.width||nt>=e.height)continue;const lt=e.getValueXY(at,nt,0);lt>b&&(b=lt)}i.setValueXY($,_,0,b)}return i}function dilateOnceGreyOnlyOnes(e,i,a,s){const o=(a-1)/2,h=(s-1)/2,g=[];for(let _=0;_<e.width;_++)g.push(0);for(let _=0;_<e.height;_++){for(let $=0;$<e.width;$++){let b=0;for(let tt=Math.max(0,_-h);tt<Math.min(e.height,_+h+1);tt++){const st=e.getValueXY($,tt,0);st>b&&(b=st)}g[$]=b}for(let $=0;$<e.width;$++){let b=0;for(let tt=Math.max(0,$-o);tt<Math.min(e.width,$+o+1);tt++)g[tt]>b&&(b=g[tt]);i.setValueXY($,_,0,b)}}return i}function dilateOnceBinary(e,i,a){const s=a.length,o=a[0].length;let h=(s-1)/2,g=(o-1)/2;for(let _=0;_<e.height;_++)for(let $=0;$<e.width;$++){let b=0;t:for(let tt=0;tt<o;tt++)for(let st=0;st<s;st++){if(a[st][tt]!==1)continue;let at=st-h+$,nt=tt-g+_;if(!(nt<0||at<0||at>=e.width||nt>=e.height)&&e.getBitXY(at,nt)===1){b=1;break t}}b===1&&i.setBitXY($,_)}return i}function dilateOnceBinaryOnlyOnes(e,i,a,s){const o=(a-1)/2,h=(s-1)/2,g=[];for(let _=0;_<e.width;_++)g.push(1);for(let _=0;_<e.height;_++){for(let $=0;$<e.width;$++){g[$]=0;for(let b=Math.max(0,_-h);b<Math.min(e.height,_+h+1);b++)if(e.getBitXY($,b)===1){g[$]=1;break}}for(let $=0;$<e.width;$++)if(i.getBitXY($,_)!==1){for(let b=Math.max(0,$-o);b<Math.min(e.width,$+o+1);b++)if(g[b]===1){i.setBitXY($,_);break}}}return i}function erode(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let s=!0;t:for(const h of i)for(const g of h)if(g!==1){s=!1;break t}let o=this;for(let h=0;h<a;h++)if(this.bitDepth===1)if(s){const g=o.clone();o=erodeOnceBinaryOnlyOnes(o,g,i.length,i[0].length)}else{const g=Image$1.createFrom(o);o=erodeOnceBinary(o,g,i)}else if(s){const g=Image$1.createFrom(o);o=erodeOnceGreyOnlyOnes(o,g,i.length,i[0].length)}else{const g=Image$1.createFrom(o);o=erodeOnceGrey(o,g,i)}return o}function erodeOnceGrey(e,i,a){const s=a.length,o=a[0].length;let h=(s-1)/2,g=(o-1)/2;for(let _=0;_<e.height;_++)for(let $=0;$<e.width;$++){let b=e.maxValue;for(let tt=0;tt<o;tt++)for(let st=0;st<s;st++){if(a[st][tt]!==1)continue;let at=st-h+$,nt=tt-g+_;if(at<0||nt<0||at>=e.width||nt>=e.height)continue;const lt=e.getValueXY(at,nt,0);lt<b&&(b=lt)}i.setValueXY($,_,0,b)}return i}function erodeOnceGreyOnlyOnes(e,i,a,s){const o=(a-1)/2,h=(s-1)/2,g=[];for(let _=0;_<e.width;_++)g.push(0);for(let _=0;_<e.height;_++){for(let $=0;$<e.width;$++){let b=e.maxValue;for(let tt=Math.max(0,_-h);tt<Math.min(e.height,_+h+1);tt++){const st=e.getValueXY($,tt,0);st<b&&(b=st)}g[$]=b}for(let $=0;$<e.width;$++){let b=e.maxValue;for(let tt=Math.max(0,$-o);tt<Math.min(e.width,$+o+1);tt++)g[tt]<b&&(b=g[tt]);i.setValueXY($,_,0,b)}}return i}function erodeOnceBinary(e,i,a){const s=a.length,o=a[0].length;let h=(s-1)/2,g=(o-1)/2;for(let _=0;_<e.height;_++)for(let $=0;$<e.width;$++){let b=1;t:for(let tt=0;tt<o;tt++)for(let st=0;st<s;st++){if(a[st][tt]!==1)continue;let at=st-h+$,nt=tt-g+_;if(!(nt<0||at<0||at>=e.width||nt>=e.height)&&e.getBitXY(at,nt)===0){b=0;break t}}b===1&&i.setBitXY($,_)}return i}function erodeOnceBinaryOnlyOnes(e,i,a,s){const o=(a-1)/2,h=(s-1)/2,g=[];for(let _=0;_<e.width;_++)g.push(0);for(let _=0;_<e.height;_++){for(let $=0;$<e.width;$++){g[$]=1;for(let b=Math.max(0,_-h);b<Math.min(e.height,_+h+1);b++)if(e.getBitXY($,b)===0){g[$]=0;break}}for(let $=0;$<e.width;$++)if(i.getBitXY($,_)!==0){for(let b=Math.max(0,$-o);b<Math.min(e.width,$+o+1);b++)if(g[b]===0){i.clearBitXY($,_);break}}}return i}function open(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++)s=s.erode({kernel:i}),s=s.dilate({kernel:i});return s}function close(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++)s=s.dilate({kernel:i}).erode({kernel:i});return s}function topHat(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),i.length%2===0||i[0].length%2===0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++)s=s.open({kernel:i}).subtractImage(s,{absolute:!0});return s}function blackHat(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++)s=s.close({kernel:i}).subtractImage(s,{absolute:!0});return s}function morphologicalGradient(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++){let h=s.dilate({kernel:i}),g=s.erode({kernel:i});s=h.subtractImage(g,{absolute:!0})}return s}function order4Points(e){let i=0,a=0,s=0,o=0,h=e[0][0],g=0;for(let b=1;b<e.length;b++)e[b][0]<h&&(h=e[b][0],g=b);let _=e[(g+1)%e.length][0],$=(g+1)%e.length;for(let b=1;b<e.length;b++)e[b][0]<_&&b!==g&&(_=e[b][0],$=b);return e[$][1]<e[g][1]?(i=e[$],o=e[g],g!==($+1)%4?(a=e[($+1)%4],s=e[($+2)%4]):(a=e[($+2)%4],s=e[($+3)%4])):(o=e[$],i=e[g],$!==(g+1)%4?(a=e[(g+1)%4],s=e[(g+2)%4]):(a=e[(g+2)%4],s=e[(g+3)%4])),[i,a,s,o]}function distance2Points(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function crossVect(e,i){return[e[1]*i[2]-e[2]*i[1],e[2]*i[0]-e[0]*i[2],e[0]*i[1]-e[1]*i[0]]}function dotVect(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]}function computeWidthAndHeigth(e,i,a,s,o,h){let g=Math.max(distance2Points(e,i),distance2Points(s,a)),_=Math.max(distance2Points(e,s),distance2Points(i,a)),$=0,b=0,tt=Math.ceil(o/2),st=Math.ceil(h/2),at=g/_,nt=[e[0],e[1],1],lt=[i[0],i[1],1],ft=[s[0],s[1],1],pt=[a[0],a[1],1],dt=dotVect(crossVect(nt,pt),ft)/dotVect(crossVect(lt,pt),ft),_t=dotVect(crossVect(nt,pt),lt)/dotVect(crossVect(ft,pt),lt),ut=[dt*lt[0]-nt[0],dt*lt[1]-nt[1],dt*lt[2]-nt[2]],mt=[_t*ft[0]-nt[0],_t*ft[1]-nt[1],_t*ft[2]-nt[2]],kt=ut[0],bt=ut[1],vt=ut[2],Et=mt[0],Mt=mt[1],At=mt[2],zt=1/(vt*At)*(kt*Et-(kt*At+vt*Et)*tt+vt*At*tt*tt+(bt*Mt-(bt*At+vt*Mt)*st+vt*At*st*st));zt>=0?zt=Math.sqrt(zt):zt=Math.sqrt(-zt);let Vt=new Matrix$1([[zt,0,tt],[0,zt,st],[0,0,1]]),Gt=Vt.transpose(),Kt=inverse(Gt),Wt=inverse(Vt),sn=Matrix$1.rowVector(ut),on=Matrix$1.rowVector(mt),Xt=Math.sqrt(dotVect(sn.mmul(Kt).mmul(Wt).to1DArray(),ut)/dotVect(on.mmul(Kt).mmul(Wt).to1DArray(),mt));return Xt===0||at===0?($=Math.ceil(g),b=Math.ceil(_)):Xt<at?($=Math.ceil(g),b=Math.ceil($/Xt)):(b=Math.ceil(_),$=Math.ceil(Xt*b)),[$,b]}function projectionPoint(e,i,a,s,o,h,g,_,$,b,tt,st){let[at,nt]=[(a*e+s*i+o)/($*e+b*i+1),(h*e+g*i+_)/($*e+b*i+1)];return tt.getValueXY(Math.floor(at),Math.floor(nt),st)}function warpingFourPoints(e,i={}){let{calculateRatio:a=!0}=i;if(e.length!==4)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${e.length} elements`);let[s,o,h,g]=e,_=[s,o,h,g],[$,b,tt,st]=order4Points(_),at,nt;a?[at,nt]=computeWidthAndHeigth($,b,tt,st,this.width,this.height):(at=Math.ceil(Math.max(distance2Points($,b),distance2Points(st,tt))),nt=Math.ceil(Math.max(distance2Points($,st),distance2Points(b,tt))));let lt=Image$1.createFrom(this,{width:at,height:nt}),[ft,pt]=$,[dt,_t]=b,[ut,mt]=tt,[kt,bt]=st,[vt,Et]=[0,0],[Mt,At]=[0,at-1],[zt,Vt]=[nt-1,at-1],[Gt,Kt]=[nt-1,0],Wt=new Matrix$1([[vt,Et,1,0,0,0,-vt*ft,-Et*ft],[Mt,At,1,0,0,0,-Mt*dt,-At*dt],[zt,Vt,1,0,0,0,-zt*ut,-Et*ut],[Gt,Kt,1,0,0,0,-Gt*kt,-Kt*kt],[0,0,0,vt,Et,1,-vt*pt,-Et*pt],[0,0,0,Mt,At,1,-Mt*_t,-At*_t],[0,0,0,zt,Vt,1,-zt*mt,-Vt*mt],[0,0,0,Gt,Kt,1,-Gt*bt,-Kt*bt]]),sn=Matrix$1.columnVector([ft,dt,ut,kt,pt,_t,mt,bt]),on=new SingularValueDecomposition(Wt).solve(sn),[Xt,ln,nn,gn,dn,$n,En,qt]=on.to1DArray(),en=new Matrix$1(nt,at);for(let Tn=0;Tn<this.channels;Tn++){for(let Sn=0;Sn<nt;Sn++)for(let fn=0;fn<at;fn++)en.set(Sn,fn,projectionPoint(Sn,fn,Xt,ln,nn,gn,dn,$n,En,qt,this,Tn));lt.setMatrix(en,{channel:Tn})}return lt}function crop(e={}){let{x:i=0,y:a=0,width:s=this.width-i,height:o=this.height-a}=e;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),i=Math.round(i),a=Math.round(a),s=Math.round(s),o=Math.round(o),i>this.width-1||a>this.height-1)throw new RangeError(`crop: origin (x:${i}, y:${a}) out of range (${this.width-1}; ${this.height-1})`);if(s<=0||o<=0)throw new RangeError(`crop: width and height (width:${s}; height:${o}) must be positive numbers`);if(i<0||a<0)throw new RangeError(`crop: x and y (x:${i}, y:${a}) must be positive numbers`);if(s>this.width-i||o>this.height-a)throw new RangeError(`crop: (x: ${i}, y:${a}, width:${s}, height:${o}) size is out of range`);let h=this;if(this.bitDepth===1){const g=new Image$1(s,o,{kind:"BINARY",parent:this});h=cropBinary(this,g,i,a,s,o)}else{const g=Image$1.createFrom(this,{width:s,height:o,position:[i,a]});h=cropDefault(this,g,i,a,s,o)}return h}function cropDefault(e,i,a,s,o,h){let g=o*e.channels,_=s+h,$=0,b=a*e.channels;for(let tt=s;tt<_;tt++){let st=tt*e.width*e.channels+b,at=st+g;for(;st<at;st++)i.data[$++]=e.data[st]}return i}function cropBinary(e,i,a,s,o,h){let g=o*e.channels,_=s+h,$=0,b=a*e.channels;for(let tt=s;tt<_;tt++){let st=tt*e.width*e.channels+b,at=st+g;for(;st<at;st++)e.getBit(st)&&i.setBit($),++$}return i}function cropAlpha(e={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:i=this.maxValue}=e;let a=findLeft(this,i,this.components);if(a===-1)throw new Error("Could not find new dimensions. Threshold may be too high.");let s=findTop(this,i,this.components,a),o=findBottom(this,i,this.components,a),h=findRight(this,i,this.components,a,s,o);return this.crop({x:a,y:s,width:h-a+1,height:o-s+1})}function findLeft(e,i,a){for(let s=0;s<e.width;s++)for(let o=0;o<e.height;o++)if(e.getValueXY(s,o,a)>=i)return s;return-1}function findTop(e,i,a,s){for(let o=0;o<e.height;o++)for(let h=s;h<e.width;h++)if(e.getValueXY(h,o,a)>=i)return o;return-1}function findBottom(e,i,a,s){for(let o=e.height-1;o>=0;o--)for(let h=s;h<e.width;h++)if(e.getValueXY(h,o,a)>=i)return o;return-1}function findRight(e,i,a,s,o,h){for(let g=e.width-1;g>=s;g--)for(let _=o;_<=h;_++)if(e.getValueXY(g,_,a)>=i)return g;return-1}function getFactor(e){if(typeof e=="string"){const i=e[e.length-1];e=parseFloat(e),i==="%"&&(e/=100)}return e}function getThreshold$1(e,i){if(!i)throw Error("getThreshold : the maxValue should be specified");if(typeof e=="string"){if(e[e.length-1]!=="%")throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(e)/100*i}else{if(typeof e=="number")return e<1?e*i:e;throw Error("getThreshold : the value is not valid")}}function factorDimensions(e,i,a){e=getFactor(e);let s=Math.round(e*i),o=Math.round(e*a);return s<=0&&(s=1),o<=0&&(o=1),{width:s,height:o}}function checkRow(e,i){if(i<0||i>=e.height)throw new RangeError(`row must be included between 0 and ${e.height-1}. Current value: ${i}`)}function checkColumn(e,i){if(i<0||i>=e.width)throw new RangeError(`column must be included between 0 and ${e.width-1}. Current value: ${i}`)}function checkChannel(e,i){if(i<0||i>=e.channels)throw new RangeError(`channel must be included between 0 and ${e.channels-1}. Current value: ${i}`)}const validInterpolations={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function checkInterpolation(e){if(typeof e!="string")throw new TypeError("interpolation must be a string");if(e=e.toLowerCase(),!validInterpolations[e])throw new RangeError(`invalid interpolation algorithm: ${e}`);return validInterpolations[e]}function nearestNeighbor(e,i,a){const s=this.width/i,o=this.height/a;if(this.bitDepth>1)for(let h=0;h<i;h++){const g=Math.floor((h+.5)*s);for(let _=0;_<a;_++){const $=Math.floor((_+.5)*o);for(let b=0;b<this.channels;b++)e.setValueXY(h,_,b,this.getValueXY(g,$,b))}}else for(let h=0;h<i;h++){const g=Math.floor((h+.5)*s);for(let _=0;_<a;_++){const $=Math.floor((_+.5)*o);this.getBitXY(g,$)&&e.setBitXY(h,_)}}}function resize(e={}){const{factor:i=1,interpolation:a=validInterpolations.nearestneighbor,preserveAspectRatio:s=!0}=e,o=checkInterpolation(a);let h=e.width,g=e.height;if(h||(g&&s?h=Math.round(g*(this.width/this.height)):h=this.width),g||(s?g=Math.round(h*(this.height/this.width)):g=this.height),{width:h,height:g}=factorDimensions(i,h,g),h===this.width&&g===this.height){const tt=this.clone();return tt.position=[0,0],tt}let _=Math.round((this.width-h)/2),$=Math.round((this.height-g)/2);const b=Image$1.createFrom(this,{width:h,height:g,position:[_,$]});switch(o){case validInterpolations.nearestneighbor:nearestNeighbor.call(this,b,h,g);break;default:throw new Error(`unsupported resize interpolation: ${o}`)}return b}function hsv(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let e=Image$1.createFrom(this,{colorModel:HSV}),i=0,a=this.data;for(let s=0;s<a.length;s+=this.channels){let o=a[s],h=a[s+1],g=a[s+2],_=Math.min(o,h,g),$=Math.max(o,h,g),b=$-_,tt=0,st=$===0?0:b/$,at=$;if($!==_){switch($){case o:tt=(h-g)/b+(h<g?6:0);break;case h:tt=(g-o)/b+2;break;case g:tt=(o-h)/b+4;break;default:throw new Error("unreachable")}tt/=6}e.data[i++]=tt*this.maxValue,e.data[i++]=st*this.maxValue,e.data[i++]=at,this.alpha&&(e.data[i++]=a[s+3])}return e}function hsl$1(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let e=Image$1.createFrom(this,{colorModel:HSL}),i=Math.floor(this.maxValue/2),a=0,s=this.data;for(let o=0;o<s.length;o+=this.channels){let h=s[o],g=s[o+1],_=s[o+2],$=Math.max(h,g,_),b=Math.min(h,g,_),tt=0,st=0,at=($+b)/2;if($!==b){let nt=$-b;switch(st=at>i?nt/(2-$-b):nt/($+b),$){case h:tt=(g-_)/nt+(g<_?6:0);break;case g:tt=(_-h)/nt+2;break;case _:tt=(h-g)/nt+4;break;default:throw new Error("unreachable")}tt/=6}e.data[a++]=tt*this.maxValue,e.data[a++]=st*this.maxValue,e.data[a++]=at,this.alpha&&(e.data[a++]=s[o+3])}return e}function cmyk(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let e=Image$1.createFrom(this,{components:4,colorModel:CMYK$1}),i=0,a=this.data;for(let s=0;s<a.length;s+=this.channels){let o=a[s],h=a[s+1],g=a[s+2],_=Math.min(this.maxValue-o,this.maxValue-h,this.maxValue-g),$=(this.maxValue-o-_)/(1-_/this.maxValue),b=(this.maxValue-h-_)/(1-_/this.maxValue),tt=(this.maxValue-g-_)/(1-_/this.maxValue);e.data[i++]=Math.round($),e.data[i++]=Math.round(b),e.data[i++]=Math.round(tt),e.data[i++]=Math.round(_),this.alpha&&(e.data[i++]=a[s+3])}return e}function rgba8(){return new Image$1(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const methods$1={luma709(e,i,a){return e*6966+i*23436+a*2366>>15},luma601(e,i,a){return e*9798+i*19235+a*3735>>15},maximum(e,i,a){return Math.max(e,i,a)},minimum(e,i,a){return Math.min(e,i,a)},average(e,i,a){return(e+i+a)/3>>0},minmax(e,i,a){return(Math.max(e,i,a)+Math.min(e,i,a))/2},red(e){return e},green(e,i){return i},blue(e,i,a){return a},cyan(e,i,a,s){let o=methods$1.black(e,i,a,s);return(s.maxValue-e-o)/(1-o/s.maxValue)>>0},magenta(e,i,a,s){let o=methods$1.black(e,i,a,s);return(s.maxValue-i-o)/(1-o/s.maxValue)>>0},yellow(e,i,a,s){let o=methods$1.black(e,i,a,s);return(s.maxValue-a-o)/(1-o/s.maxValue)>>0},black(e,i,a,s){return Math.min(s.maxValue-e,s.maxValue-i,s.maxValue-a)},hue(e,i,a,s){let o=methods$1.min(e,i,a),h=methods$1.max(e,i,a);if(h===o)return 0;let g=0,_=h-o;switch(h){case e:g=(i-a)/_+(i<a?6:0);break;case i:g=(a-e)/_+2;break;case a:g=(e-i)/_+4;break;default:throw new Error("unreachable")}return g/6*s.maxValue>>0},saturation(e,i,a,s){let o=methods$1.min(e,i,a),h=methods$1.max(e,i,a),g=h-o;return h===0?0:g/h*s.maxValue},lightness(e,i,a){let s=methods$1.min(e,i,a);return(methods$1.max(e,i,a)+s)/2}};Object.defineProperty(methods$1,"luminosity",{enumerable:!1,value:methods$1.lightness});Object.defineProperty(methods$1,"luminance",{enumerable:!1,value:methods$1.lightness});Object.defineProperty(methods$1,"min",{enumerable:!1,value:methods$1.minimum});Object.defineProperty(methods$1,"max",{enumerable:!1,value:methods$1.maximum});Object.defineProperty(methods$1,"brightness",{enumerable:!1,value:methods$1.maximum});Object.keys(methods$1).forEach(e=>{});function grey(e={}){let{algorithm:i="luma709",keepAlpha:a=!1,mergeAlpha:s=!0}=e;if(typeof i!="string"&&typeof i!="function")throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),this.components===1&&(i="red"),a&=this.alpha,s&=this.alpha,a&&(s=!1);let o=getOutputImage(this,e,{components:1,alpha:a,colorModel:GREY$1}),h;if(typeof i=="function")h=i;else if(h=methods$1[i.toLowerCase()],!h)throw new Error(`unsupported grey algorithm: ${i}`);let g=0;for(let _=0;_<this.data.length;_+=this.channels)s?o.data[g++]=clamp(h(this.data[_],this.data[_+1],this.data[_+2],this)*this.data[_+this.components]/this.maxValue,this):(o.data[g++]=clamp(h(this.data[_],this.data[_+1],this.data[_+2],this),this),o.alpha&&(o.data[g++]=this.data[_+this.components]));return o}function huang(e){let i=0;for(let tt=0;tt<e.length;tt++)if(e[tt]!==0){i=tt;break}let a=e.length-1;for(let tt=e.length-1;tt>=i;tt--)if(e[tt]!==0){a=tt;break}let s=1/(a-i),o=new Array(e.length),h=0,g=0;for(let tt=i;tt<e.length;tt++)h+=tt*e[tt],g+=e[tt],o[tt]=h/g;let _=new Array(e.length);h=g=0;for(let tt=a;tt>0;tt--)h+=tt*e[tt],g+=e[tt],_[tt-1]=h/g;let $=-1,b=Number.MAX_VALUE;for(let tt=0;tt<e.length;tt++){let st=0,at;for(let nt=0;nt<=tt;nt++)at=1/(1+s*Math.abs(nt-o[tt])),at<1e-6||at>.999999||(st+=e[nt]*(-at*Math.log(at)-(1-at)*Math.log(1-at)));for(let nt=tt+1;nt<e.length;nt++)at=1/(1+s*Math.abs(nt-_[tt])),at<1e-6||at>.999999||(st+=e[nt]*(-at*Math.log(at)-(1-at)*Math.log(1-at)));st<b&&(b=st,$=tt)}return $}function intermodes(e){let i=e.slice(),a=0;for(;!bimodalTest$1(i);){let o=0,h=0,g=i[0];for(let _=0;_<e.length-1;_++)o=h,h=g,g=i[_+1],i[_]=(o+h+g)/3;if(i[e.length-1]=(h+g)/3,a++,a>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let s=0;for(let o=1;o<e.length-1;o++)i[o-1]<i[o]&&i[o+1]<i[o]&&(s+=o);return Math.floor(s/2)}function bimodalTest$1(e){let i=!1,a=0;for(let s=1;s<e.length-1;s++)if(e[s-1]<e[s]&&e[s+1]<e[s]&&(a++,a>2))return!1;return a===2&&(i=!0),i}function isodata(e){let i,a,s,o,h=0;for(let g=1;g<e.length;g++)if(e[g]>0){h=g+1;break}for(;;){i=0,s=0;for(let g=0;g<h;g++)s=s+e[g],i=i+e[g]*g;o=0,a=0;for(let g=h+1;g<e.length;g++)a+=e[g],o+=e[g]*g;if(s>0&&a>0&&(i/=s,o/=a,h===Math.round((i+o)/2)))break;if(h++,h>e.length-2)throw new Error("Threshold not found")}return h}function li(e,i){let a,s,o,h,g,_,$,b,tt,st,at,nt;at=.5,st=0;for(let lt=0;lt<e.length;lt++)st+=lt*e[lt];st/=i,$=st;do{_=$,a=_+.5|0,s=0,h=0;for(let lt=0;lt<=a;lt++)s+=lt*e[lt],h+=e[lt];b=h===0?0:s/h,o=0,g=0;for(let lt=a+1;lt<e.length;lt++)o+=lt*e[lt],g+=e[lt];tt=g===0?0:o/g,nt=(b-tt)/(Math.log(b)-Math.log(tt)),nt<-Number.EPSILON?$=nt-.5|0:$=nt+.5|0}while(Math.abs($-_)>at);return a}function maxEntropy(e,i){let a=new Array(e.length);for(let at=0;at<e.length;at++)a[at]=e[at]/i;let s=new Array(e.length),o=new Array(e.length);s[0]=a[0],o[0]=1-s[0];for(let at=1;at<e.length;at++)s[at]=s[at-1]+a[at],o[at]=1-s[at];let h=0;for(let at=0;at<e.length;at++)if(Math.abs(s[at])>=Number.EPSILON){h=at;break}let g=e.length-1;for(let at=e.length-1;at>=h;at--)if(Math.abs(o[at])>=Number.EPSILON){g=at;break}let _=-1,$,b=Number.MIN_VALUE,tt,st;for(let at=h;at<=g;at++){tt=0;for(let nt=0;nt<=at;nt++)e[nt]!==0&&(tt-=a[nt]/s[at]*Math.log(a[nt]/s[at]));st=0;for(let nt=at+1;nt<e.length;nt++)e[nt]!==0&&(st-=a[nt]/o[at]*Math.log(a[nt]/o[at]));$=tt+st,b<$&&(b=$,_=at)}return _}function mean$1(e,i){let a=0;for(let s=0;s<e.length;s++)a+=s*e[s];return Math.floor(a/i)}function minError(e,i){let a,s=-2,o,h,g,_,$,b,tt,st,at,nt,lt,ft=0;for(let pt=0;pt<e.length;pt++)ft+=pt*e[pt];for(ft/=i,a=ft;a!==s;){let pt=sumA(e,a),dt=sumA(e,e.length-1),_t=sumB(e,a),ut=sumB(e,e.length-1),mt=sumC(e,a),kt=sumC(e,e.length-1);if(o=_t/pt,h=(ut-_t)/(dt-pt),g=pt/dt,_=(dt-pt)/dt,$=mt/pt-o*o,b=(kt-mt)/(dt-pt)-h*h,tt=1/$-1/b,st=o/$-h/b,at=o*o/$-h*h/b+Math.log10($*(_*_)/(b*(g*g))),nt=st*st-tt*at,nt<0)return a;s=a,lt=(st+Math.sqrt(nt))/tt,isNaN(lt)?a=s:a=Math.floor(lt)}return a}function sumA(e,i){let a=0;for(let s=0;s<=i;s++)a+=e[s];return a}function sumB(e,i){let a=0;for(let s=0;s<=i;s++)a+=s*e[s];return a}function sumC(e,i){let a=0;for(let s=0;s<=i;s++)a+=s*s*e[s];return a}function minimum(e){if(e.length<2)return 0;let i=0,a=-1,s=-1,o=new Array(e.length);for(let h=0;h<e.length;h++)o[h]=e[h],e[h]>0&&(s=h);for(;!bimodalTest(o);)if(o=smoothed(o),i++,i>1e4)return a;return a=minimumBetweenPeeks(o,s),a}function smoothed(e){let i=new Array(e.length);for(let a=1;a<e.length-1;a++)i[a]=(e[a-1]+e[a]+e[a+1])/3;return i[0]=(e[0]+e[1])/3,i[e.length-1]=(e[e.length-2]+e[e.length-1])/3,i}function minimumBetweenPeeks(e,i){let a;for(let s=1;s<i;s++)if(e[s-1]>e[s]&&e[s+1]>=e[s]){a=s;break}return a}function bimodalTest(e){let i=e.length,a=!1,s=0;for(let o=1;o<i-1;o++)if(e[o-1]<e[o]&&e[o+1]<e[o]&&(s++,s>2))return!1;return s===2&&(a=!0),a}function moments(e,i){let a=1,s=0,o=0,h=0,g=0,_,$,b,tt,st,at,nt=-1,lt=e.length,ft=new Array(lt);for(let pt=0;pt<lt;pt++)ft[pt]=e[pt]/i;for(let pt=0;pt<lt;pt++)s+=pt*ft[pt],o+=pt*pt*ft[pt],h+=pt*pt*pt*ft[pt];$=a*o-s*s,b=(-o*o+s*h)/$,tt=(a*-h+o*s)/$,st=.5*(-tt-Math.sqrt(tt*tt-4*b)),at=.5*(-tt+Math.sqrt(tt*tt-4*b)),_=(at-s)/(at-st);for(let pt=0;pt<lt;pt++)if(g+=ft[pt],g>_){nt=pt;break}return nt}function otsu(e,i){let a=0,s=0,o=0,h=0,g=0;for(let _=0;_<e.length;_++)g+=_*e[_];for(let _=0;_<e.length;_++){s=s+e[_];const $=i-s;if(s===0||$===0)continue;a=a+_*e[_];const b=(g-a)/$,tt=s*$*(a/s-b)*(a/s-b);tt>=o&&(h=_,o=tt)}return h}function percentile(e){let i=-1,a=.5,s=new Array(e.length),o=partialSum(e,e.length-1),h=1;for(let g=0;g<e.length;g++)s[g]=Math.abs(partialSum(e,g)/o-a),s[g]<h&&(h=s[g],i=g);return i}function partialSum(e,i){let a=0;for(let s=0;s<=i;s++)a+=e[s];return a}function renyiEntropy(e,i){let a,s,o,h=new Array(e.length),g=new Array(e.length),_=new Array(e.length),$=0,b=0,tt=0,st=0,at=0,nt=0,lt=1/(1-.5),ft=1/-1;for(let ut=0;ut<e.length;ut++)h[ut]=e[ut]/i;g[0]=h[0],_[0]=1-g[0];for(let ut=1;ut<e.length;ut++)g[ut]=g[ut-1]+h[ut],_[ut]=1-g[ut];s=0;for(let ut=0;ut<e.length;ut++)if(Math.abs(g[ut])>=Number.EPSILON){s=ut;break}o=e.length-1;for(let ut=e.length-1;ut>=s;ut--)if(Math.abs(_[ut])>=Number.EPSILON){o=ut;break}for(let ut=s;ut<=o;ut++){let mt=0,kt=0,bt=0;for(let Gt=0;Gt<=ut;Gt++)e[Gt]!==0&&(mt-=h[Gt]/g[ut]*Math.log(h[Gt]/g[ut])),kt+=Math.sqrt(h[Gt]/g[ut]),bt+=h[Gt]*h[Gt]/(g[ut]*g[ut]);let vt=0,Et=0,Mt=0;for(let Gt=ut+1;Gt<e.length;Gt++)e[Gt]!==0&&(vt-=h[Gt]/_[ut]*Math.log(h[Gt]/_[ut])),Et+=Math.sqrt(h[Gt]/_[ut]),Mt+=h[Gt]*h[Gt]/(_[ut]*_[ut]);let At=mt+vt,zt=lt*(kt*Et>0?Math.log(kt*Et):0),Vt=ft*(bt*Mt>0?Math.log(bt*Mt):0);At>st&&(st=At,$=ut),zt>at&&(at=zt,b=ut),Vt>nt&&(nt=Vt,tt=ut)}let pt=[$,b,tt];pt.sort((ut,mt)=>ut-mt);let dt;Math.abs(pt[0]-pt[1])<=5?Math.abs(pt[1]-pt[2])<=5?dt=[1,2,1]:dt=[0,1,3]:Math.abs(pt[1]-pt[2])<=5?dt=[3,1,0]:dt=[1,2,1];let _t=g[pt[2]]-g[pt[0]];return a=Math.round(pt[0]*(g[pt[0]]+.25*_t*dt[0])+.25*pt[1]*_t*dt[1]+pt[2]*(_[pt[2]]+.25*_t*dt[2])),a}function shanbhag(e,i){let a=new Array(e.length);for(let nt=0;nt<e.length;nt++)a[nt]=e[nt]/i;let s=new Array(e.length),o=new Array(e.length);s[0]=a[0],o[0]=1-s[0];for(let nt=1;nt<e.length;nt++)s[nt]=s[nt-1]+a[nt],o[nt]=1-s[nt];let h=0;for(let nt=0;nt<e.length;nt++)if(Math.abs(s[nt])>=Number.EPSILON){h=nt;break}let g=e.length-1;for(let nt=e.length-1;nt>=h;nt--)if(Math.abs(o[nt])>=Number.EPSILON){g=nt;break}let _=-1,$=Number.MAX_VALUE,b,tt,st,at;for(let nt=h;nt<=g;nt++){st=0,b=.5/s[nt];for(let lt=1;lt<=nt;lt++)st-=a[lt]*Math.log(1-b*s[lt-1]);st*=b,at=0,b=.5/o[nt];for(let lt=nt+1;lt<e.length;lt++)at-=a[lt]*Math.log(1-b*o[lt]);at*=b,tt=Math.abs(st-at),tt<$&&($=tt,_=nt)}return _}function triangle$1(e){let i=0,a=0,s=0,o=0;for(let st=0;st<e.length;st++)if(e[st]>0){i=st;break}i>0&&i--;for(let st=e.length-1;st>0;st--)if(e[st]>0){o=st;break}o<e.length-1&&o++;for(let st=0;st<e.length;st++)e[st]>a&&(s=st,a=e[st]);let h=!1;if(s-i<o-s){h=!0;let st=0,at=e.length-1;for(;st<at;){let nt=e[st];e[st]=e[at],e[at]=nt,st++,at--}i=e.length-1-o,s=e.length-1-s}if(i===s)return i;let g,_,$;g=e[s],_=i-s,$=Math.sqrt(g*g+_*_),g/=$,_/=$,$=g*i+_*e[i];let b=i,tt=0;for(let st=i+1;st<=s;st++){let at=g*st+_*e[st]-$;at>tt&&(b=st,tt=at)}if(b--,h){let st=0,at=e.length-1;for(;st<at;){let nt=e[st];e[st]=e[at],e[at]=nt,st++,at--}return e.length-1-b}else return b}function yen(e,i){let a=new Array(e.length);for(let b=0;b<e.length;b++)a[b]=e[b]/i;let s=new Array(e.length);s[0]=a[0];for(let b=1;b<e.length;b++)s[b]=s[b-1]+a[b];let o=new Array(e.length);o[0]=a[0]*a[0];for(let b=1;b<e.length;b++)o[b]=o[b-1]+a[b]*a[b];let h=new Array(e.length);h[e.length-1]=0;for(let b=e.length-2;b>=0;b--)h[b]=h[b+1]+a[b+1]*a[b+1];let g=-1,_=Number.MIN_VALUE,$;for(let b=0;b<e.length;b++)$=-1*(o[b]*h[b]>0?Math.log(o[b]*h[b]):0)+2*(s[b]*(1-s[b])>0?Math.log(s[b]*(1-s[b])):0),$>_&&(_=$,g=b);return g}const methods={huang,intermodes,isodata,li,maxentropy:maxEntropy,mean:mean$1,minerror:minError,minimum,moments,otsu,percentile,renyientropy:renyiEntropy,shanbhag,triangle:triangle$1,yen},names={};Object.keys(methods).forEach(e=>{names[e]=e});function getThreshold(e={}){let{algorithm:i=names.otsu}=e;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let a=methods[i.toLowerCase()];if(a){let s=this.getHistogram();return a(s,this.size)}else throw new Error(`unknown thresholding algorithm: ${i}`)}const THRESHOLD="threshold";function mask(e={}){let{algorithm:i=THRESHOLD,threshold:a=.5,useAlpha:s=!0,invert:o=!1}=e;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),i===THRESHOLD?a=getThreshold$1(a,this.maxValue):a=getThreshold.call(this,e);let h=new Image$1(this.width,this.height,{kind:"BINARY",parent:this}),g=0;if(this.alpha&&s)for(let _=0;_<this.data.length;_+=this.channels){let $=this.data[_]+(this.maxValue-this.data[_])*(this.maxValue-this.data[_+1])/this.maxValue;(o&&$<=a||!o&&$>=a)&&h.setBit(g),g++}else for(let _=0;_<this.data.length;_+=this.channels)(o&&this.data[_]<=a||!o&&this.data[_]>=a)&&h.setBit(g),g++;return h}function copyImage(e,i,a,s){let o=e.width,h=e.height,g=i.width,_=e.channels;for(let $=0;$<o;$++)for(let b=0;b<h;b++)for(let tt=0;tt<_;tt++){let st=(b*o+$)*_+tt,at=((s+b)*g+a+$)*_+tt;i.data[at]=e.data[st]}}function pad(e={}){let{size:i=0,algorithm:a="copy",color:s}=e;if(this.checkProcessable("pad",{bitDepth:[8,16]}),a==="set"){if(s.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let $=0;$<s.length;$++)s[$]===0&&(s[$]=.001)}else s=newArray(this.channels,null);Array.isArray(i)||(i=[i,i]);let o=this.width+i[0]*2,h=this.height+i[1]*2,g=this.channels,_=Image$1.createFrom(this,{width:o,height:h});copyImage(this,_,i[0],i[1]);for(let $=i[0];$<o-i[0];$++)for(let b=0;b<g;b++){let tt=s[b]||_.data[(i[1]*o+$)*g+b];for(let st=0;st<i[1];st++)_.data[(st*o+$)*g+b]=tt;tt=s[b]||_.data[((h-i[1]-1)*o+$)*g+b];for(let st=h-i[1];st<h;st++)_.data[(st*o+$)*g+b]=tt}for(let $=0;$<h;$++)for(let b=0;b<g;b++){let tt=s[b]||_.data[($*o+i[0])*g+b];for(let st=0;st<i[0];st++)_.data[($*o+st)*g+b]=tt;tt=s[b]||_.data[($*o+o-i[0]-1)*g+b];for(let st=o-i[0];st<o;st++)_.data[($*o+st)*g+b]=tt}return _}function colorDepth(e=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(e))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===e)return this.clone();let i=Image$1.createFrom(this,{bitDepth:e});switch(e){case 8:if(this.bitDepth===1)for(let a=0;a<this.size;a++)this.getBit(a)&&(i.data[a]=255);else for(let a=0;a<this.data.length;a++)i.data[a]=this.data[a]>>8;break;case 16:if(this.bitDepth===1)for(let a=0;a<this.size;a++)this.getBit(a)&&(i.data[a]=65535);else for(let a=0;a<this.data.length;a++)i.data[a]=this.data[a]<<8|this.data[a];break;default:throw new Error("colorDepth conversion unexpected case")}return i}function rotateFree(e,i={}){const{interpolation:a=validInterpolations.nearestneighbor,width:s=this.width,height:o=this.height}=i;if(typeof e!="number")throw new TypeError("degrees must be a number");const h=checkInterpolation(a),g=e*Math.PI/180,_=Math.floor(Math.abs(s*Math.cos(g))+Math.abs(o*Math.sin(g))),$=Math.floor(Math.abs(o*Math.cos(g))+Math.abs(s*Math.sin(g))),b=Math.cos(-g),tt=Math.sin(-g);let st=_/2,at=$/2;_%2===0?(st=st-.5,$%2===0?at=at-.5:at=Math.floor(at)):(st=Math.floor(st),$%2===0?at=at-.5:at=Math.floor(at));const nt=Math.floor(s/2-st),lt=Math.floor(o/2-at);if(this.bitDepth===1){const ft=new Image$1(_,$,{kind:"BINARY",parent:this});switch(h){case validInterpolations.nearestneighbor:return rotateBinaryNearestNeighbor(this,ft,nt,lt,st,at,b,tt);case validInterpolations.bilinear:return rotateBinaryBilinear(this,ft,nt,lt,st,at,b,tt);default:throw new Error(`unsupported rotate interpolation: ${h}`)}}else{const ft=Image$1.createFrom(this,{width:_,height:$});switch(h){case validInterpolations.nearestneighbor:return rotateNearestNeighbor(this,ft,nt,lt,st,at,b,tt);case validInterpolations.bilinear:return rotateBilinear(this,ft,nt,lt,st,at,b,tt);default:throw new Error(`unsupported rotate interpolation: ${h}`)}}}function rotateNearestNeighbor(e,i,a,s,o,h,g,_){for(let $=0;$<i.width;$+=1)for(let b=0;b<i.height;b+=1)for(let tt=0;tt<e.channels;tt++){let st=Math.round(($-o)*g-(b-h)*_+o)+a,at=Math.round((b-h)*g+($-o)*_+h)+s;st<0||st>=e.width||at<0||at>=e.height?e.alpha===1&&tt===e.channels-1?i.setValueXY($,b,tt,0):i.setValueXY($,b,tt,e.maxValue):i.setValueXY($,b,tt,e.getValueXY(st,at,tt))}return i}function rotateBinaryNearestNeighbor(e,i,a,s,o,h,g,_){for(let $=0;$<i.width;$+=1)for(let b=0;b<i.height;b+=1){let tt=Math.round(($-o)*g-(b-h)*_+o)+a,st=Math.round((b-h)*g+($-o)*_+h)+s;(tt<0||tt>=e.width||st<0||st>=e.height||e.getBitXY(tt,st))&&i.setBitXY($,b)}return i}function rotateBilinear(e,i,a,s,o,h,g,_){let $=e.width*e.channels;for(let b=0;b<i.height;b++)for(let tt=0;tt<i.width;tt++){let st=(tt-o)*g-(b-h)*_+o+a,at=(b-h)*g+(tt-o)*_+h+s,nt=st|0,lt=at|0,ft=st-nt,pt=at-lt;for(let dt=0;dt<e.channels;dt++)if(st<0||st>=e.width||at<0||at>=e.height)e.alpha===1&&dt===e.channels-1?i.setValueXY(tt,b,dt,0):i.setValueXY(tt,b,dt,e.maxValue);else{let _t=(lt*e.width+nt)*e.channels+dt,ut=e.data[_t],mt=e.data[_t+e.channels],kt=e.data[_t+$],bt=e.data[_t+$+e.channels],vt=ut+ft*(mt-ut)+pt*(kt-ut)+ft*pt*(ut-mt-kt+bt)|0;i.setValueXY(tt,b,dt,vt)}}return i}function rotateBinaryBilinear(e,i,a,s,o,h,g,_){let $=e.width;for(let b=0;b<i.height;b++)for(let tt=0;tt<i.width;tt++){let st=(tt-o)*g-(b-h)*_+o+a,at=(b-h)*g+(tt-o)*_+h+s,nt=st|0,lt=at|0,ft=st-nt,pt=at-lt;if(st<0||st>=e.width||at<0||at>=e.height)i.setBitXY(tt,b);else{let dt=lt*e.width+nt,_t=e.getBit(dt),ut=e.getBit(dt+1),mt=e.getBit(dt+$),kt=e.getBit(dt+1+$);(_t|ft&ut-_t|pt&mt-_t|ft&pt&_t-ut-mt+kt)>0&&i.setBitXY(tt,b)}}return i}function rotate$1(e,i){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),typeof e!="number")throw new TypeError("angle must be a number");switch(e<0&&(e=Math.ceil(-e/360)*360+e),e%360){case 0:return this.clone();case 90:return rotateRight.call(this);case 180:return rotate180.call(this);case 270:return rotateLeft.call(this);default:return rotateFree.call(this,e,i)}}function rotateLeft(){if(this.bitDepth===1){const e=new Image$1(this.height,this.width,{kind:"BINARY",parent:this}),i=e.height-1;for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++)this.getBitXY(s,a)&&e.setBitXY(a,i-s);return e}else{const e=Image$1.createFrom(this,{width:this.height,height:this.width}),i=e.height-1;for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++)for(let o=0;o<this.channels;o++)e.setValueXY(a,i-s,o,this.getValueXY(s,a,o));return e}}function rotateRight(){if(this.bitDepth===1){const e=new Image$1(this.height,this.width,{kind:"BINARY",parent:this}),i=e.width-1;for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++)this.getBitXY(s,a)&&e.setBitXY(i-a,s);return e}else{const e=Image$1.createFrom(this,{width:this.height,height:this.width}),i=e.width-1;for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++)for(let o=0;o<this.channels;o++)e.setValueXY(i-a,s,o,this.getValueXY(s,a,o));return e}}function rotate180(){if(this.bitDepth===1){const e=new Image$1(this.width,this.height,{kind:"BINARY",parent:this}),i=e.width-1,a=e.height-1;for(let s=0;s<this.height;s++)for(let o=0;o<this.width;o++)this.getBitXY(o,s)&&e.setBitXY(i-o,a-s);return e}else{const e=Image$1.createFrom(this),i=e.width-1,a=e.height-1;for(let s=0;s<this.height;s++)for(let o=0;o<this.width;o++)for(let h=0;h<this.channels;h++)e.setValueXY(i-o,a-s,h,this.getValueXY(o,s,h));return e}}function insert(e,i={}){const a=getImageParameters(e);this.checkProcessable("insert",a);let{x:s=0,y:o=0}=i;const h=getOutputImageOrInPlace(this,i,{copy:!0}),g=Math.min(h.height,o+e.height),_=Math.min(h.width,s+e.width);if(h.bitDepth===1)for(let $=o;$<g;$++)for(let b=s;b<_;b++)e.getBitXY(b-s,$-o)?h.setBitXY(b,$):h.clearBitXY(b,$);else for(let $=o;$<g;$++)for(let b=s;b<_;b++)h.setPixelXY(b,$,e.getPixelXY(b-s,$-o));return h}function setBorder(e={}){let{size:i=0,algorithm:a="copy",color:s}=e;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),a==="set"){if(s.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let _=0;_<s.length;_++)s[_]===0&&(s[_]=.001)}else s=newArray(this.channels,null);Array.isArray(i)||(i=[i,i]);let o=i[0],h=i[1],g=this.channels;for(let _=o;_<this.width-o;_++)for(let $=0;$<g;$++){let b=s[$]||this.data[(_+this.width*h)*g+$];for(let tt=0;tt<h;tt++)this.data[(tt*this.width+_)*g+$]=b;b=s[$]||this.data[(_+this.width*(this.height-h-1))*g+$];for(let tt=this.height-h;tt<this.height;tt++)this.data[(tt*this.width+_)*g+$]=b}for(let _=0;_<this.height;_++)for(let $=0;$<g;$++){let b=s[$]||this.data[(_*this.width+o)*g+$];for(let tt=0;tt<o;tt++)this.data[(_*this.width+tt)*g+$]=b;b=s[$]||this.data[(_*this.width+this.width-o-1)*g+$];for(let tt=this.width-o;tt<this.width;tt++)this.data[(_*this.width+tt)*g+$]=b}return this}function split(e={}){let{preserveAlpha:i=!0}=e;if(this.checkProcessable("split",{bitDepth:[8,16]}),this.components===1)return new Stack([this.clone()]);let a=new Stack,s=this.data;if(this.alpha&&i)for(let o=0;o<this.components;o++){let h=Image$1.createFrom(this,{components:1,alpha:!0,colorModel:GREY$1}),g=0;for(let _=0;_<s.length;_+=this.channels)h.data[g++]=s[_+o],h.data[g++]=s[_+this.components];a.push(h)}else for(let o=0;o<this.channels;o++){let h=Image$1.createFrom(this,{components:1,alpha:!1,colorModel:GREY$1}),g=0;for(let _=0;_<s.length;_+=this.channels)h.data[g++]=s[_+o];a.push(h)}return a}function getChannel(e,i={}){let{keepAlpha:a=!1,mergeAlpha:s=!1}=i;a&=this.alpha,s&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),e=validateChannel(this,e);let o=Image$1.createFrom(this,{components:1,alpha:a,colorModel:GREY$1}),h=0;for(let g=0;g<this.data.length;g+=this.channels)s?o.data[h++]=this.data[g+e]*this.data[g+this.components]/this.maxValue:(o.data[h++]=this.data[g+e],a&&(o.data[h++]=this.data[g+this.components]));return o}function combineChannels(e=defaultCombineMethod,i={}){let{mergeAlpha:a=!1,keepAlpha:s=!1}=i;a&=this.alpha,s&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let o=Image$1.createFrom(this,{components:1,alpha:s,colorModel:GREY$1}),h=0;for(let g=0;g<this.size;g++){let _=e(this.getPixel(g));a?o.data[h++]=_*this.data[g*this.channels+this.components]/this.maxValue:(o.data[h++]=_,s&&(o.data[h++]=this.data[g*this.channels+this.components]))}return o}function defaultCombineMethod(e){return(e[0]+e[1]+e[2])/3}function setChannel(e,i){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),i.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),i.width!==this.width||i.height!==this.height)throw new Error("Images must have exactly the same width and height");e=validateChannel(this,e);let a=e;for(let s=0;s<i.data.length;s++)this.data[a]=i.data[s],a+=this.channels;return this}function getSimilarity(e,i={}){let{shift:a=[0,0],average:s,channels:o,defaultAlpha:h,normalize:g,border:_=[0,0]}=i;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(_)||(_=[_,_]),o=validateArrayOfChannels(this,{channels:o,defaultAlpha:h}),this.bitDepth!==e.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==e.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==e.colorModel)throw new Error("Both images must have the same colorModel");typeof s>"u"&&(s=!0);let $=Math.max(_[0],-a[0]),b=Math.min(this.width-_[0],this.width-a[0]),tt=Math.max(_[1],-a[1]),st=Math.min(this.height-_[1],this.height-a[1]),at=newArray(o.length,0);for(let nt=0;nt<o.length;nt++){let lt=o[nt],ft=g?this.sum[lt]:Math.max(this.sum[lt],e.sum[lt]),pt=g?e.sum[lt]:Math.max(this.sum[lt],e.sum[lt]);if(ft!==0&&pt!==0)for(let dt=$;dt<b;dt++)for(let _t=tt;_t<st;_t++){let ut=dt*this.multiplierX+_t*this.multiplierY+lt,mt=ut+a[0]*this.multiplierX+a[1]*this.multiplierY;at[nt]+=Math.min(this.data[ut]/ft,e.data[mt]/pt)}}return s?at.reduce((nt,lt)=>nt+lt)/at.length:at}function getPixelsGrid(e={}){let{sampling:i=[10,10],painted:a=!1,mask:s}=e;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(i)||(i=[i,i]);const o=i[0],h=i[1],g=[],_=[],$=this.width/o,b=this.height/h;let tt=Math.floor($/2);for(let at=0;at<o;at++){let nt=Math.floor(b/2);for(let lt=0;lt<h;lt++){let ft=Math.round(tt),pt=Math.round(nt);(!s||s.getBitXY(ft,pt))&&(g.push([ft,pt]),_.push(this.getPixelXY(ft,pt))),nt+=b}tt+=$}const st={xyS:g,zS:_};return a&&(st.painted=this.rgba8().paintPoints(g)),st}function Matrix(e,i,a){const s=new Array(e);for(let o=0;o<e;o++)s[o]=new Array(i);if(a)for(let o=0;o<e;o++)for(let h=0;h<i;h++)s[o][h]=a;return s.width=e,s.height=i,Object.setPrototypeOf(s,Matrix.prototype),s}Matrix.prototype.localMin=function(e,i){let a=this[e][i],s=[e,i];for(let o=Math.max(0,e-1);o<Math.min(this.length,e+2);o++)for(let h=Math.max(0,i-1);h<Math.min(this[0].length,i+2);h++)this[o][h]<a&&(a=this[o][h],s=[o,h]);return{position:s,value:a}};Matrix.prototype.localMax=function(e,i){let a=this[e][i],s=[e,i];for(let o=Math.max(0,e-1);o<Math.min(this.length,e+2);o++)for(let h=Math.max(0,i-1);h<Math.min(this[0].length,i+2);h++)this[o][h]>a&&(a=this[o][h],s=[o,h]);return{position:s,value:a}};Matrix.prototype.localSearch=function(e,i,a){let s=[];for(let o=Math.max(0,e-1);o<Math.min(this.length,e+2);o++)for(let h=Math.max(0,i-1);h<Math.min(this[0].length,i+2);h++)this[o][h]===a&&s.push([o,h]);return s};function getBestMatch(e,i={}){let{border:a}=i;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==e.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==e.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==e.colorModel)throw new Error("Both images must have the same colorModel");let s=new Matrix(e.width,e.height,-1/0),o=Math.floor(e.width/2),h=Math.floor(e.height/2),g=o,_=h,$=!1;for(;!$;){let b=s.localSearch(o,h,-1/0);for(let st=0;st<b.length;st++){let at=b[st],nt=this.getSimilarity(e,{border:a,shift:[g-at[0],_-at[1]]});s[at[0]][at[1]]=nt}let tt=s.localMax(o,h);tt.position[0]!==o||tt.position[1]!==h?(o=tt.position[0],h=tt.position[1]):$=!0}return[o-g,h-_]}function getRow(e,i=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),checkRow(this,e),checkChannel(this,i);let a=new Array(this.width),s=0,o=e*this.width*this.channels+i,h=o+this.width*this.channels;for(let g=o;g<h;g+=this.channels)a[s++]=this.data[g];return a}function getColumn(e,i=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),checkColumn(this,e),checkChannel(this,i);let a=new Array(this.height),s=0,o=this.width*this.channels;for(let h=i+e*this.channels;h<this.data.length;h+=o)a[s++]=this.data[h];return a}function getMatrix(e={}){let{channel:i}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),i===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");i=0}let a=new Matrix$1(this.height,this.width);for(let s=0;s<this.height;s++)for(let o=0;o<this.width;o++)a.set(s,o,this.getValueXY(o,s,i));return a}function setMatrix(e,i={}){e=new Matrix$1(e);let{channel:a}=i;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),a===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");a=0}if(this.width!==e.columns||this.height!==e.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let s=0;s<this.height;s++)for(let o=0;o<this.width;o++)this.setValueXY(o,s,a,e.get(s,o));return this}function getPixelsArray(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let e=new Array(this.size),i=0;for(let a=0;a<this.data.length;a+=this.channels){let s=new Array(this.components);for(let o=0;o<this.components;o++)s[o]=this.data[a+o];e[i++]=s}return e}function getIntersection(e){let i=this,a=i.getClosestCommonParent(e),s=i.getRelativePosition(a,{defaultFurther:!0}),o=getRelativePositionForAllPixels(i,s),h=e.getRelativePosition(a,{defaultFurther:!0}),g=getRelativePositionForAllPixels(e,h),_=getCommonSurface(o,g),$={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let b=0;b<_.length;b++){let tt=_[b],st=[tt[0]-s[0],tt[1]-s[1]],at=[tt[0]-h[0],tt[1]-h[1]],nt=i.getBitXY(st[0],st[1]),lt=e.getBitXY(at[0],at[1]);nt===1&&lt===1&&$.commonWhitePixels.push(tt)}for(let b=0;b<o.length;b++){let tt,st;b!==0&&(tt=Math.floor(b/i.width),st=b%i.width),i.getBitXY(tt,st)===1&&$.whitePixelsMask1.push(o[b])}for(let b=0;b<g.length;b++){let tt=0,st=0;b!==0&&(tt=Math.floor(b/e.width),st=b%e.width),e.getBitXY(tt,st)===1&&$.whitePixelsMask2.push(g[b])}return $}function getRelativePositionForAllPixels(e,i){let a=[];for(let s=0;s<e.height;s++)for(let o=0;o<e.width;o++){let h=[s,o];a.push([h[0]+i[0],h[1]+i[1]])}return a}function getCommonSurface(e,i){let a=0,s=0,o=[];for(;a<e.length&&s<i.length;)e[a][0]===i[s][0]&&e[a][1]===i[s][1]?(o.push(e[a]),a++,s++):e[a][0]<i[s][0]||e[a][0]===i[s][0]&&e[a][1]<i[s][1]?a++:s++;return o}function getClosestCommonParent(e){let i=getDepth(this),a=getDepth(e),s;if(i>=a?s=getFurthestParent(this,i):s=getFurthestParent(e,a),i===0||a===0)return s;let o=this,h=e;for(;i!==a;)if(i>a){if(o=o.parent,o===null)return s;i=i-1}else{if(h=h.parent,h===null)return s;a=a-1}for(;o!==h&&o!==null&&h!==null;)if(o=o.parent,h=h.parent,o===null||h===null)return s;return o!==h?s:o}function getDepth(e){let i=0,a=e;for(;a.parent!=null;)a=a.parent,i++;return i}function getFurthestParent(e,i){let a=e;for(;i>0;)a=a.parent,i=i-1;return a}const defaultOptions$1={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Gx=[[-1,0,1],[-2,0,2],[-1,0,1]],Gy=[[-1,-2,-1],[0,0,0],[1,2,1]],convOptions={bitDepth:32,mode:"periodic"};function cannyEdgeDetector(e,i){e.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),i=Object.assign({},defaultOptions$1,i);const a=e.width,s=e.height,o=e.maxValue,h={sigma:i.gaussianBlur,radius:3},g=e.gaussianFilter(h),_=g.convolution(Gy,convOptions),$=g.convolution(Gx,convOptions),b=$.hypotenuse(_),tt=e.constructor,st=new tt(a,s,{kind:"GREY",bitDepth:32}),at=new tt(a,s,{kind:"GREY",bitDepth:32}),nt=new tt(a,s,{kind:"GREY"});for(var lt=1;lt<a-1;lt++)for(var ft=1;ft<s-1;ft++){var pt=(Math.round(Math.atan2($.getValueXY(lt,ft,0),_.getValueXY(lt,ft,0))*(5/Math.PI))+5)%5;pt===0&&(b.getValueXY(lt,ft,0)<=b.getValueXY(lt,ft-1,0)||b.getValueXY(lt,ft,0)<=b.getValueXY(lt,ft+1,0))||pt===1&&(b.getValueXY(lt,ft,0)<=b.getValueXY(lt-1,ft+1,0)||b.getValueXY(lt,ft,0)<=b.getValueXY(lt+1,ft-1,0))||pt===2&&(b.getValueXY(lt,ft,0)<=b.getValueXY(lt-1,ft,0)||b.getValueXY(lt,ft,0)<=b.getValueXY(lt+1,ft,0))||pt===3&&(b.getValueXY(lt,ft,0)<=b.getValueXY(lt-1,ft-1,0)||b.getValueXY(lt,ft,0)<=b.getValueXY(lt+1,ft+1,0))||st.setValueXY(lt,ft,0,b.getValueXY(lt,ft,0))}for(lt=0;lt<a*s;++lt){var dt=st.data[lt],_t=0;dt>i.highThreshold&&(_t++,nt.data[lt]=o),dt>i.lowThreshold&&_t++,at.data[lt]=_t}var ut=[];for(lt=1;lt<a-1;++lt)for(ft=1;ft<s-1;++ft)if(at.getValueXY(lt,ft,0)===1){t:for(var mt=lt-1;mt<lt+2;++mt)for(var kt=ft-1;kt<ft+2;++kt)if(at.getValueXY(mt,kt,0)===2){ut.push([lt,ft]),nt.setValueXY(lt,ft,0,o);break t}}for(;ut.length>0;){var bt=[];for(lt=0;lt<ut.length;++lt)for(ft=-1;ft<2;++ft)for(mt=-1;mt<2;++mt)if(!(ft===0&&mt===0)){var vt=ut[lt][0]+ft,Et=ut[lt][1]+mt;at.getValueXY(vt,Et,0)===1&&nt.getValueXY(vt,Et,0)===0&&(bt.push([vt,Et]),nt.setValueXY(vt,Et,0,o))}ut=bt}return nt}function cannyEdge(e){return cannyEdgeDetector(this,e)}function extract(e,i={}){let{position:a}=i;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!a&&(a=e.getRelativePosition(this),!a))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let s=Image$1.createFrom(this,{width:e.width,height:e.height,alpha:1,position:a,parent:this});for(let o=0;o<e.width;o++)for(let h=0;h<e.height;h++){for(let g=0;g<this.channels;g++){let _=this.getValueXY(o+a[0],h+a[1],g);s.setValueXY(o,h,g,_)}e.getBitXY(o,h)||s.setValueXY(o,h,this.components,0)}return s}else{let s=Image$1.createFrom(this,{width:e.width,height:e.height,position:a,parent:this});for(let o=0;o<e.height;o++)for(let h=0;h<e.width;h++)e.getBitXY(h,o)&&this.getBitXY(h+a[0],o+a[1])&&s.setBitXY(h,o);return s}}var fastList={exports:{}},hasRequiredFastList;function requireFastList(){return hasRequiredFastList||(hasRequiredFastList=1,function(e,i){(function(){function a(o,h,g){this.next=g,g&&(g.prev=this),this.prev=h,h&&(h.next=this),this.data=o}function s(){if(!(this instanceof s))return new s;this._head=null,this._tail=null,this.length=0}s.prototype={push:function(o){this._tail=new a(o,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(this.length!==0){var o=this._tail;return this._tail=o.prev,o.prev&&(o.prev=this._tail.next=null),this.length--,this.length===1?this._head=this._tail:this.length===0&&(this._head=this._tail=null),o.data}},unshift:function(o){this._head=new a(o,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(this.length!==0){var o=this._head;return this._head=o.next,o.next&&(o.next=this._head.prev=null),this.length--,this.length===1?this._tail=this._head:this.length===0&&(this._head=this._tail=null),o.data}},item:function(o){o<0&&(o=this.length+o);for(var h=this._head;o-- >0&&h;)h=h.next;return h?h.data:void 0},slice:function(o,h){if(o||(o=0),h||(h=this.length),h<0&&(h=this.length+h),o<0&&(o=this.length+o),h===o)return[];if(h<o)throw new Error("invalid offset: "+o+","+h+" (length="+this.length+")");for(var g=h-o,_=new Array(g),$=0,b=this._head;o-- >0&&b;)b=b.next;for(;$<g&&b;)_[$++]=b.data,b=b.next;return _},drop:function(){s.call(this)},forEach:function(o,h){for(var g=this._head,_=0,$=this.length;_<$&&g;)o.call(h||this,g.data,_,this),g=g.next,_++},map:function(o,h){var g=new s;return this.forEach(function(_,$,b){g.push(o.call(h||b,_,$,b))}),g},filter:function(o,h){var g=new s;return this.forEach(function(_,$,b){o.call(h||b,_,$,b)&&g.push(_)}),g},reduce:function(o,h,g){var _=0,$=this._head,b=this.length;for(h||(_=1,h=$&&$.data,$=$&&$.next);_<b&&$;)h=o.call(g||this,h,$.data,this),_++,$=$.next;return h}},e.exports=s})()}(fastList)),fastList.exports}var fastListExports=requireFastList();const LinkedList=getDefaultExportFromCjs(fastListExports);function floodFill(e={}){const{x:i=0,y:a=0,inPlace:s=!0}=e,o=s?this:Image$1.createFrom(this);if(this.checkProcessable("floodFill",{bitDepth:1}),this.getBitXY(i,a))return o;const h=new LinkedList;for(h.push(new Node(i,a));h.length>0;){const g=h.shift();o.setBitXY(g.x,g.y);for(let _=g.x+1;_<this.width&&!o.getBitXY(_,g.y)&&!this.getBitXY(_,g.y);_++)o.setBitXY(_,g.y),g.y+1<this.height&&!this.getBitXY(_,g.y+1)&&h.push(new Node(_,g.y+1)),g.y-1>=0&&!this.getBitXY(_,g.y-1)&&h.push(new Node(_,g.y-1));for(let _=g.x-1;_>=0&&!o.getBitXY(_,g.y)&&!this.getBitXY(_,g.y);_++)o.setBitXY(_,g.y),g.y+1<this.height&&!this.getBitXY(_,g.y+1)&&h.push(new Node(_,g.y+1)),g.y-1>=0&&!this.getBitXY(_,g.y-1)&&h.push(new Node(_,g.y-1))}return o}function Node(e,i){this.x=e,this.y=i}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},_extends.apply(null,arguments)}function hsv2rgb(e,i,a){i=i/100,a=a/100;var s=[],o=a*i,h=e/60,g=o*(1-Math.abs(h%2-1)),_=a-o;return h>=0&&h<1?s=[o,g,0]:h>=1&&h<2?s=[g,o,0]:h>=2&&h<3?s=[0,o,g]:e>=3&&h<4?s=[0,g,o]:e>=4&&h<5?s=[g,0,o]:e>=5&&h<=6?s=[o,0,g]:s=[0,0,0],{r:Math.round(255*(s[0]+_)),g:Math.round(255*(s[1]+_)),b:Math.round(255*(s[2]+_))}}function hsl2hsv(e,i,a){return i*=(a<50?a:100-a)/100,{h:e,s:2*i/(a+i)*100,v:a+i}}function hsl2rgb$1(e,i,a){var s=hsl2hsv(e,i,a);return hsv2rgb(s.h,s.s,s.v)}var colors={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function parse(e){return named(e)||hex3(e)||hex6(e)||rgb(e)||rgba$1(e)||hsl(e)||hsla(e)}function named(e){var i=colors[e.toLowerCase()];if(i)return{r:i[0],g:i[1],b:i[2],a:100}}function rgb(e){var i=e.match(/rgb\(([^)]+)\)/);if(i){var a=i[1].split(/ *, */).map(Number);return{r:a[0],g:a[1],b:a[2],a:100}}}function rgba$1(e){var i=e.match(/rgba\(([^)]+)\)/);if(i){var a=i[1].split(/ *, */).map(Number);return{r:a[0],g:a[1],b:a[2],a:a[3]*100}}}function hex6(e){if(e[0]==="#"&&e.length===7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:100}}function hex3(e){if(e[0]==="#"&&e.length===4)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:100}}function hsl(e){var i=e.match(/hsl\(([^)]+)\)/);if(i){var a=i[1].split(/ *, */),s=parseInt(a[0],10),o=parseInt(a[1],10),h=parseInt(a[2],10),g=hsl2rgb$1(s,o,h);return _extends({},g,{a:100})}}function hsla(e){var i=e.match(/hsla\(([^)]+)\)/);if(i){var a=i[1].split(/ *, */),s=parseInt(a[0],10),o=parseInt(a[1],10),h=parseInt(a[2],10),g=parseInt(parseFloat(a[3])*100,10),_=hsl2rgb$1(s,o,h);return _extends({},_,{a:g})}}function css2array(e){let i=parse(e);return[i.r,i.g,i.b,Math.round(i.a*255/100)]}function hue2rgb(e,i,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(i-e)*6*a:a<1/2?i:a<2/3?e+(i-e)*(2/3-a)*6:e}function hsl2rgb(e,i,a){let s,o,h,g,_,$;return i/=100,a/=100,i===0?g=_=$=a*255:(a<=.5?o=a*(i+1):o=a+i-a*i,s=a*2-o,h=e/360,g=hue2rgb(s,o,h+1/3),_=hue2rgb(s,o,h),$=hue2rgb(s,o,h-1/3)),{r:g,g:_,b:$}}function getDistinctColors(e){let i=new Array(e),a=0;for(let s=0;s<360;s+=360/e){a++;let o=hsl2rgb(s,100,30+a%4*15);i[a-1]=[Math.round(o.r*255),Math.round(o.g*255),Math.round(o.b*255)]}return i}function getRandomColor(){return[Math.floor(Math.random()*256),Math.floor(Math.random()*256),Math.floor(Math.random()*256)]}function getColors(e){let{color:i,colors:a,randomColors:s,numberColors:o=50}=e;if(i&&!Array.isArray(i)&&(i=css2array(i)),i)return[i];if(a)return a=a.map(function(h){return Array.isArray(h)?h:css2array(h)}),a;if(s){a=new Array(o);for(let h=0;h<o;h++)a[h]=getRandomColor()}return getDistinctColors(o)}function paintLabels(e,i,a={}){let{color:s="blue",colors:o,font:h="12px Helvetica",rotate:g=0}=a;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:RGB$1}),!Array.isArray(e))throw Error("paintLabels: labels must be an array");if(!Array.isArray(i))throw Error("paintLabels: positions must be an array");if(s&&!Array.isArray(s)&&(s=css2array(s)),o?o=o.map(function($){return Array.isArray($)?$:css2array($)}):o=[s],e.length!==i.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(h)||(h=[h]),Array.isArray(g)||(g=[g]);let _=this.getCanvas().getContext("2d");for(let $=0;$<e.length;$++){_.save();let b=o[$%o.length];_.fillStyle=`rgba(${b[0]},${b[1]},${b[2]},${b[3]/this.maxValue})`,_.font=h[$%h.length];let tt=i[$];_.translate(tt[0],tt[1]),_.rotate(g[$%g.length]/180*Math.PI),_.fillText(e[$],0,0),_.restore()}return this.data=Uint8Array.from(_.getImageData(0,0,this.width,this.height).data),this}function paintMasks(e,i={}){let{alpha:a=255,labels:s=[],labelsPosition:o=[],labelColor:h="blue",labelFont:g="12px Helvetica"}=i;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:RGB$1});let _=getColors(Object.assign({},i,{numberColors:e.length}));Array.isArray(e)||(e=[e]);for(let $=0;$<e.length;$++){let b=e[$],tt=_[$%_.length];for(let st=0;st<b.width;st++)for(let at=0;at<b.height;at++)if(b.getBitXY(st,at))for(let nt=0;nt<Math.min(this.components,tt.length);nt++)if(a===255)this.setValueXY(st+b.position[0],at+b.position[1],nt,tt[nt]);else{let lt=this.getValueXY(st+b.position[0],at+b.position[1],nt);lt=Math.round((lt*(255-a)+tt[nt]*a)/255),this.setValueXY(st+b.position[0],at+b.position[1],nt,lt)}}if(Array.isArray(s)&&s.length>0){let $=this.getCanvas().getContext("2d");$.fillStyle=h,$.font=g;for(let b=0;b<Math.min(e.length,s.length);b++){let tt=o[b]?o[b]:e[b].position;$.fillText(s[b],tt[0],tt[1])}this.data=Uint8Array.from($.getImageData(0,0,this.width,this.height).data)}return this}function zerosMatrix(e,i){let a=new Array(e);for(let s=0;s<e;s++)a[s]=new Array(i).fill(0);return a}const cross=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],smallCross=[[0,1,0],[1,1,1],[0,1,0]];class Shape{constructor(i={}){let{kind:a="cross",shape:s,size:o,width:h,height:g,filled:_=!0}=i;if(o&&(h=o,g=o),s)switch(s.toLowerCase()){case"square":case"rectangle":this.matrix=rectangle(h,g,{filled:_});break;case"circle":case"ellipse":this.matrix=ellipse(h,g,{filled:_});break;case"triangle":this.matrix=triangle(h,g,{filled:_});break;default:throw new Error(`Shape: unexpected shape: ${s}`)}else if(a)switch(a.toLowerCase()){case"cross":this.matrix=cross;break;case"smallcross":this.matrix=smallCross;break;default:throw new Error(`Shape: unexpected kind: ${a}`)}else throw new Error("Shape: expected a kind or a shape option");this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){let i=this.matrix,a=[];for(let s=0;s<i.length;s++)for(let o=0;o<i[0].length;o++)i[s][o]&&a.push([o-this.halfWidth,s-this.halfHeight]);return a}getMask(){let i=new Image$1(this.width,this.height,{kind:BINARY});for(let a=0;a<this.matrix.length;a++)for(let s=0;s<this.matrix[0].length;s++)this.matrix[a][s]&&i.setBitXY(s,a);return i}}function rectangle(e,i,a){const s=zerosMatrix(i,e);if(a.filled)for(let o=0;o<i;o++)for(let h=0;h<e;h++)s[o][h]=1;else{for(let o of[0,i-1])for(let h=0;h<e;h++)s[o][h]=1;for(let o=0;o<i;o++)for(let h of[0,e-1])s[o][h]=1}return s}function ellipse(e,i,a){const s=zerosMatrix(i,e);let o=1-i%2,h=1-e%2,g=Math.floor((e-1)/2),_=Math.floor((i-1)/2),$=g*g,b=_*_;if(a.filled)for(let tt=0;tt<=_;tt++){let st=Math.floor(Math.sqrt($-$*tt*tt/b));for(let at=g-st;at<=g;at++)s[_-tt][at]=1,s[_+tt+o][at]=1,s[_-tt][e-at-1]=1,s[_+tt+o][e-at-1]=1}else{for(let tt=0;tt<=_;tt++){let st=Math.floor(Math.sqrt($-$*tt*tt/b)),at=g-st;s[_-tt][at]=1,s[_+tt+o][at]=1,s[_-tt][e-at-1]=1,s[_+tt+o][e-at-1]=1}for(let tt=0;tt<=g;tt++){let st=Math.floor(Math.sqrt(b-b*tt*tt/$)),at=_-st;s[at][g-tt]=1,s[at][g+tt+h]=1,s[i-at-1][g-tt]=1,s[i-at-1][g+tt+h]=1}}return s}function triangle(e,i,a){if(!a.filled)throw new Error("Non filled triangle is not implemented");const s=zerosMatrix(i,e);for(let o=0;o<i;o++){let h=Math.floor((1-o/i)*e/2);for(let g=h;g<e-h;g++)s[o][g]=1}return s}function paintPoints(e,i={}){let{shape:a}=i;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let s=getColors(Object.assign({},i,{numberColors:e.length})),o=new Shape(a).getPoints(),h=Math.min(this.channels,s[0].length);for(let g=0;g<e.length;g++){let _=s[g%s.length],$=e[g][0],b=e[g][1];for(let tt=0;tt<o.length;tt++){let st=o[tt][0],at=o[tt][1];if($+st>=0&&b+at>=0&&$+st<this.width&&b+at<this.height){let nt=($+st+(b+at)*this.width)*this.channels;for(let lt=0;lt<h;lt++)this.data[nt+lt]=_[lt]}}}return this}function paintPolyline(e,i={}){let{color:a=[this.maxValue,0,0],closed:s=!1}=i;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let o=Math.min(this.channels,a.length);for(let h=0;h<e.length-1+s;h++){let g=e[h],_=e[(h+1)%e.length],$=_[0]-g[0],b=_[1]-g[1],tt=Math.max(Math.abs($),Math.abs(b)),st=$/tt,at=b/tt,nt=g[0],lt=g[1];for(let ft=0;ft<=tt;ft++){let pt=Math.round(nt),dt=Math.round(lt);if(pt>=0&&dt>=0&&pt<this.width&&dt<this.height)if(this.bitDepth===1)this.setBitXY(pt,dt);else{let _t=(pt+dt*this.width)*this.channels;for(let ut=0;ut<o;ut++)this.data[_t+ut]=a[ut]}nt=nt+st,lt=lt+at}}return this}function paintPolylines(e,i={}){let a=Object.assign({},i);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let s=getColors(Object.assign({},i,{numberColors:e.length}));for(let o=0;o<e.length;o++)a.color=s[o%s.length],this.paintPolyline(e[o],a);return this}function paintPolygon(e,i={}){let{color:a=[this.maxValue,0,0],filled:s=!1}=i;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),i.closed=!0;let o=deleteDouble(e);if(s===!1)return this.paintPolyline(e,i);{let h=Array(this.height);for(let g=0;g<this.height;g++){h[g]=[];for(let _=0;_<this.width;_++)h[g].push(0)}for(let g=0;g<o.length;g++){const _=lineBetweenTwoPoints(o[g],o[(g+1)%o.length]);for(let $=0;$<this.height;$++)for(let b=0;b<this.width;b++)isAtTheRightOfTheLine(b,$,_,this.height)&&(h[$][b]=h[$][b]===0?1:0)}for(let g=0;g<this.height;g++)for(let _=0;_<this.width;_++)if(h[g][_]===1)if(this.bitDepth===1)this.setBitXY(_,g);else{let $=Math.min(this.channels,a.length),b=(_+g*this.width)*this.channels;for(let tt=0;tt<$;tt++)this.data[b+tt]=a[tt]}return this.paintPolyline(e,i)}}function deleteDouble(e){let i=[];for(let a=0;a<e.length;a++)if(!(e[a][0]===e[(a+1)%e.length][0]&&e[a][1]===e[(a+1)%e.length][1])){if(e[a][0]===e[(a-1+e.length)%e.length][0]&&e[a][1]===e[(a-1+e.length)%e.length][1]||e[(a+1)%e.length][0]===e[(a-1+e.length)%e.length][0]&&e[(a-1+e.length)%e.length][1]===e[(a+1)%e.length][1])continue;i.push(e[a])}return i}function lineBetweenTwoPoints(e,i){if(e[0]===i[0])return{a:0,b:e[0],vertical:!0};{const a=(i[1]-e[1])/(i[0]-e[0]),s=e[1]-a*e[0];return{a,b:s,vertical:!1}}}function isAtTheRightOfTheLine(e,i,a,s){if(a.vertical===!0)return a.b<=e;if(a.a===0)return!1;{const o=(i-a.b)/a.a;return o<e&&o>=0&&o<=s}}function paintPolygons(e,i={}){let a=Object.assign({},i);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let s=getColors(Object.assign({},i,{numberColors:e.length}));for(let o=0;o<e.length;o++)a.color=s[o%s.length],this.paintPolygon(e[o],a);return this}function getHistogram(e={}){let{maxSlots:i=256,channel:a,useAlpha:s=!0}=e;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),a===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");a=0}return getChannelHistogram.call(this,a,{useAlpha:s,maxSlots:i})}function getHistograms(e={}){const{maxSlots:i=256,useAlpha:a=!0}=e;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let s=new Array(a?this.components:this.channels);for(let o=0;o<s.length;o++)s[o]=getChannelHistogram.call(this,o,{useAlpha:a,maxSlots:i});return s}function getChannelHistogram(e,i){let{useAlpha:a,maxSlots:s}=i;if(this.bitDepth===1){let $=[0,0];for(let b=0;b<this.height;b++)for(let tt=0;tt<this.width;tt++){let st=this.getBitXY(b,tt);st===0?$[0]+=1:st===1&&($[1]+=1)}return $}let o=Math.log2(s);if(!isInteger(o))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let h=0;this.bitDepth>o&&(h=this.bitDepth-o);let g=this.data,_=newArray(Math.pow(2,Math.min(this.bitDepth,o)),0);if(a&&this.alpha){let $=this.channels-e-1;for(let b=e;b<g.length;b+=this.channels)_[g[b]>>h]+=g[b+$]/this.maxValue}else for(let $=e;$<g.length;$+=this.channels)_[g[$]>>h]++;return _}function getColorHistogram(e={}){let{useAlpha:i=!0,nbSlots:a=512}=e;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let s=Math.log(a)/Math.log(8);if(s!==Math.floor(s))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let o=this.bitDepth-s,h=this.data,g=newArray(Math.pow(8,s),0),_=Math.pow(2,s*2),$=Math.pow(2,s);for(let b=0;b<h.length;b+=this.channels){let tt=(h[b]>>o)*_+(h[b+1]>>o)*$+(h[b+2]>>o);i&&this.alpha?g[tt]+=h[b+this.channels-1]/this.maxValue:g[tt]++}return g}function min(){this.checkProcessable("min",{bitDepth:[8,16,32]});let e=newArray(this.channels,1/0);for(let i=0;i<this.data.length;i+=this.channels)for(let a=0;a<this.channels;a++)this.data[i+a]<e[a]&&(e[a]=this.data[i+a]);return e}function max(){this.checkProcessable("max",{bitDepth:[8,16,32]});let e=newArray(this.channels,-1/0);for(let i=0;i<this.data.length;i+=this.channels)for(let a=0;a<this.channels;a++)this.data[i+a]>e[a]&&(e[a]=this.data[i+a]);return e}function sum(){this.checkProcessable("sum",{bitDepth:[8,16]});let e=newArray(this.channels,0);for(let i=0;i<this.data.length;i+=this.channels)for(let a=0;a<this.channels;a++)e[a]+=this.data[i+a];return e}function getMoment(e=0,i=0){this.checkProcessable("getMoment",{bitDepth:[1]});let a=0;for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++)this.getBitXY(s,o)===1&&(a+=s**e*o**i);return a}function localMaxima(e={}){let{mask:i,region:a=3,removeClosePoints:s=0,invert:o=!1,maxEquals:h=2}=e,g=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),a*=4;let _=o?0:1,$=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],b=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],tt=a<=8?1:2,st=[];for(let at=tt;at<g.height-tt;at++)for(let nt=tt;nt<g.width-tt;nt++){if(i&&i.getBitXY(nt,at)!==_)continue;let lt=0,ft=0,pt=g.data[nt+at*g.width];for(let dt=0;dt<a;dt++)o?g.data[nt+$[dt]+(at+b[dt])*g.width]>pt&&lt++:g.data[nt+$[dt]+(at+b[dt])*g.width]<pt&&lt++,g.data[nt+$[dt]+(at+b[dt])*g.width]===pt&&ft++;lt+ft===a&&ft<=h&&st.push([nt,at])}if(s>0)for(let at=0;at<st.length;at++)for(let nt=at+1;nt<st.length;nt++)Math.sqrt(Math.pow(st[at][0]-st[nt][0],2)+Math.pow(st[at][1]-st[nt][1],2))<s&&(st[at][0]=st[at][0]+st[nt][0]>>1,st[at][1]=st[at][1]+st[nt][1]>>1,st.splice(nt,1),nt--);return st}function mean(){let e=this.getHistograms({maxSlots:this.maxValue+1}),i=new Array(e.length);for(let a=0;a<e.length;a++){let s=e[a];i[a]=mean$2(s)}return i}function median(){let e=this.getHistograms({maxSlots:this.maxValue+1}),i=new Array(e.length);for(let a=0;a<e.length;a++){let s=e[a];i[a]=median$2(s)}return i}function points(){this.checkProcessable("points",{bitDepth:[1]});const e=[];for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++)this.getBitXY(i,a)===1&&e.push([i,a]);return e}function extendedPoints(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const e=[];for(let i=0;i<this.height;i++)for(let a=0;a<this.width;a++)if(this.getBitXY(a,i)===1)for(e.push([a,i]),this.getBitXY(a+1,i)!==1?(e.push([a+1,i]),e.push([a+1,i+1]),this.getBitXY(a,i+1)!==1&&e.push([a,i+1])):this.getBitXY(a,i+1)!==1&&(e.push([a,i+1]),e.push([a+1,i+1]));a<this.width-2&&this.getBitXY(a+1,i)===1&&this.getBitXY(a+2,i)===1;)a++;return e}function getRelativePosition(e,i={}){if(this===e)return[0,0];let a=[0,0],s=this;for(;s;){if(s===e)return a;s.position&&(a[0]+=s.position[0],a[1]+=s.position[1]),s=s.parent}return i.defaultFurther?a:!1}function countAlphaPixels(e={}){let{alpha:i=1}=e;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let a=0;if(i!==void 0){for(let s=this.components;s<this.data.length;s+=this.channels)this.data[s]===i&&a++;return a}else return this.size}function monotoneChainConvexHull$1(e,i={}){const{sorted:a}=i;a||(e=e.slice().sort(byXThenY));const s=e.length,o=new Array(s*2);let h=0;for(let _=0;_<s;_++){const $=e[_];for(;h>=2&&cw(o[h-2],o[h-1],$)<=0;)h--;o[h++]=$}const g=h+1;for(let _=s-2;_>=0;_--){const $=e[_];for(;h>=g&&cw(o[h-2],o[h-1],$)<=0;)h--;o[h++]=$}return o.slice(0,h-1)}function cw(e,i,a){return(i[1]-e[1])*(a[0]-e[0])-(i[0]-e[0])*(a[1]-e[1])}function byXThenY(e,i){return e[0]===i[0]?e[1]-i[1]:e[0]-i[0]}function monotoneChainConvexHull(){return monotoneChainConvexHull$1(this.extendedPoints,{sorted:!1})}function round(e){for(let i=0;i<e.length;i++)e[i][0]=Math.round(e[i][0]),e[i][1]=Math.round(e[i][1]);return e}function difference(e,i){return[e[0]-i[0],e[1]-i[1]]}function normalize(e){let i=Math.sqrt(e[0]**2+e[1]**2);return[e[0]/i,e[1]/i]}function rotate(e,i,a){a===void 0&&(a=new Array(i.length));let s=Math.cos(e),o=Math.sin(e);for(let h=0;h<a.length;++h)a[h]=[s*i[h][0]-o*i[h][1],o*i[h][0]+s*i[h][1]];return a}function perimeter(e){let i=0;for(let a=0;a<e.length;a++){let s=e[a][0],o=e[a][1],h=e[a===e.length-1?0:a+1][0],g=e[a===e.length-1?0:a+1][1];i+=Math.sqrt((h-s)**2+(g-o)**2)}return i}function surface(e){let i=0;for(let a=0;a<e.length;a++){let s=e[a][0],o=e[a===e.length-1?0:a+1][1],h=e[a===e.length-1?0:a+1][0],g=e[a][1];i+=s*o*.5,i-=h*g*.5}return Math.abs(i)}function minMax(e){let i=1/0,a=1/0,s=-1/0,o=-1/0;for(let h=0;h<e.length;h++)e[h][0]<i&&(i=e[h][0]),e[h][0]>s&&(s=e[h][0]),e[h][1]<a&&(a=e[h][1]),e[h][1]>o&&(o=e[h][1]);return[[i,a],[s,o]]}function moveToZeroZero(e,i){i===void 0&&(i=new Array(e.length).fill(0).map(()=>[]));let a=minMax(e),s=a[0][0],o=a[0][1];for(let h=0;h<e.length;h++)i[h][0]=e[h][0]-s,i[h][1]=e[h][1]-o;return i}function minimalBoundingRectangle(e={}){const{originalPoints:i=monotoneChainConvexHull.call(this)}=e;if(i.length===0)return[];if(i.length===1)return[i[0],i[0],i[0],i[0]];const a=new Array(i.length);let s=1/0,o=0,h;for(let g=0;g<a.length;g++){let _=getAngle$1(i[g],i[(g+1)%a.length]);rotate(-_,i,a);let $=a[g][0],b=a[g][1],tt=a[(g+1)%a.length][0],st=a[(g+1)%a.length][1],at=!0,nt=0,lt=0,ft=0;for(let ut=0;ut<a.length;ut++){let mt=a[ut][0],kt=a[ut][1],bt=(mt-$)/(tt-$);at===!0?(at=!1,nt=bt,lt=bt):(bt<nt&&(nt=bt),bt>lt&&(lt=bt));let vt=(-(tt-$)*kt+tt*b-st*$)/(tt-$);Math.abs(vt)>Math.abs(ft)&&(ft=vt)}let pt=[$+nt*(tt-$),b],dt=[$+lt*(tt-$),b],_t=Math.abs(ft*(nt-lt)*(tt-$));_t<s&&(o=_,s=_t,h=[pt,dt,[dt[0],dt[1]-ft],[pt[0],pt[1]-ft]])}return rotate(o,h,h),h}function getAngle$1(e,i){let a=difference(i,e),s=normalize(a),o=Math.acos(s[0]);return s[1]<0?-o:o}function extend$1(e){let i={inPlace:!0};e.extendMethod("invert",invert),e.extendMethod("abs",abs),e.extendMethod("level",level,i),e.extendMethod("add",add,i),e.extendMethod("subtract",subtract,i),e.extendMethod("subtractImage",subtractImage),e.extendMethod("multiply",multiply,i),e.extendMethod("divide",divide,i),e.extendMethod("hypotenuse",hypotenuse),e.extendMethod("background",background$1),e.extendMethod("flipX",flipX),e.extendMethod("flipY",flipY),e.extendMethod("blurFilter",blurFilter),e.extendMethod("medianFilter",medianFilter),e.extendMethod("gaussianFilter",gaussianFilter),e.extendMethod("sobelFilter",sobelFilter),e.extendMethod("gradientFilter",gradientFilter),e.extendMethod("scharrFilter",scharrFilter),e.extendMethod("dilate",dilate),e.extendMethod("erode",erode),e.extendMethod("open",open),e.extendMethod("close",close),e.extendMethod("topHat",topHat),e.extendMethod("blackHat",blackHat),e.extendMethod("morphologicalGradient",morphologicalGradient),e.extendMethod("warpingFourPoints",warpingFourPoints),e.extendMethod("crop",crop),e.extendMethod("cropAlpha",cropAlpha),e.extendMethod("resize",resize).extendMethod("scale",resize),e.extendMethod("hsv",hsv),e.extendMethod("hsl",hsl$1),e.extendMethod("cmyk",cmyk),e.extendMethod("rgba8",rgba8),e.extendMethod("grey",grey).extendMethod("gray",grey),e.extendMethod("mask",mask),e.extendMethod("pad",pad),e.extendMethod("colorDepth",colorDepth),e.extendMethod("setBorder",setBorder,i),e.extendMethod("rotate",rotate$1),e.extendMethod("rotateLeft",rotateLeft),e.extendMethod("rotateRight",rotateRight),e.extendMethod("insert",insert),e.extendMethod("getRow",getRow),e.extendMethod("getColumn",getColumn),e.extendMethod("getMatrix",getMatrix),e.extendMethod("setMatrix",setMatrix),e.extendMethod("getPixelsArray",getPixelsArray),e.extendMethod("getIntersection",getIntersection),e.extendMethod("getClosestCommonParent",getClosestCommonParent),e.extendMethod("getThreshold",getThreshold),e.extendMethod("split",split),e.extendMethod("getChannel",getChannel),e.extendMethod("combineChannels",combineChannels),e.extendMethod("setChannel",setChannel),e.extendMethod("getSimilarity",getSimilarity),e.extendMethod("getPixelsGrid",getPixelsGrid),e.extendMethod("getBestMatch",getBestMatch),e.extendMethod("cannyEdge",cannyEdge),e.extendMethod("convolution",convolution),e.extendMethod("extract",extract),e.extendMethod("floodFill",floodFill),e.extendMethod("paintLabels",paintLabels,i),e.extendMethod("paintMasks",paintMasks,i),e.extendMethod("paintPoints",paintPoints,i),e.extendMethod("paintPolyline",paintPolyline,i),e.extendMethod("paintPolylines",paintPolylines,i),e.extendMethod("paintPolygon",paintPolygon,i),e.extendMethod("paintPolygons",paintPolygons,i),e.extendMethod("countAlphaPixels",countAlphaPixels),e.extendMethod("monotoneChainConvexHull",monotoneChainConvexHull),e.extendMethod("minimalBoundingRectangle",minimalBoundingRectangle),e.extendMethod("getHistogram",getHistogram).extendProperty("histogram",getHistogram),e.extendMethod("getHistograms",getHistograms).extendProperty("histograms",getHistograms),e.extendMethod("getColorHistogram",getColorHistogram).extendProperty("colorHistogram",getColorHistogram),e.extendMethod("getMin",min).extendProperty("min",min),e.extendMethod("getMax",max).extendProperty("max",max),e.extendMethod("getSum",sum).extendProperty("sum",sum),e.extendMethod("getMoment",getMoment).extendProperty("moment",getMoment),e.extendMethod("getLocalMaxima",localMaxima),e.extendMethod("getMedian",median).extendProperty("median",median),e.extendMethod("getMean",mean).extendProperty("mean",mean),e.extendMethod("getPoints",points).extendProperty("points",points),e.extendMethod("getExtendedPoints",extendedPoints).extendProperty("extendedPoints",extendedPoints),e.extendMethod("getRelativePosition",getRelativePosition)}var quantities$1={exports:{}},quantities=quantities$1.exports,hasRequiredQuantities;function requireQuantities(){return hasRequiredQuantities||(hasRequiredQuantities=1,function(e,i){(function(a,s){e.exports=s()})(quantities,function(){function a(ct){return typeof ct=="string"||ct instanceof String}var s=Number.isFinite||window.isFinite;function o(ct){return s(ct)}function h(ct){return ct}function g(ct){var rt={};return ct.filter(function(et){return rt.hasOwnProperty(et)?!1:rt[et]=!0})}function _(ct,rt){if(rt.length!==ct.length)return!1;for(var et=0;et<ct.length;et++)if(rt[et].compareArray&&!rt[et].compareArray(ct[et])||rt[et]!==ct[et])return!1;return!0}function $(ct,rt){Object.keys(rt).forEach(function(et){ct[et]=rt[et]})}function b(){for(var ct=1,rt=0,et=0;et<arguments.length;et++){var it=arguments[et];rt=rt+at(it),ct*=it}return rt!==0?st(ct,rt):ct}function tt(ct,rt){if(rt===0)throw new Error("Divide by zero");var et=Math.pow(10,at(rt)),it=et/(et*rt);return b(ct,it)}function st(ct,rt){return Math.round(ct*Math.pow(10,rt))/Math.pow(10,rt)}function at(ct){if(!isFinite(ct))return 0;for(var rt=0;ct%1!==0;)ct*=10,rt++;return rt}function nt(){var ct;if(!this)return ct=Object.create(nt.prototype),nt.apply(ct,arguments),ct;ct=Error.apply(this,arguments),this.name="QtyError",this.message=ct.message,this.stack=ct.stack}nt.prototype=Object.create(Error.prototype,{constructor:{value:nt}});function lt(ct,rt){throw new nt("Incompatible units: "+ct+" and "+rt)}var ft={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","μ","µ","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],3600*24,"time",["<second>"]],"<week>":[["wk","week","weeks"],7*3600*24,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","Ω","Ω"],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},pt=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],dt="<1>",_t=[dt];function ut(ct,rt){var et=rt[1],it=rt[3]||[],ht=rt[4]||[];if(!o(et))throw new nt(ct+": Invalid unit definition. 'scalar' must be a number");it.forEach(function(yt){if(ft[yt]===void 0)throw new nt(ct+": Invalid unit definition. Unit "+yt+" in 'numerator' is not recognized")}),ht.forEach(function(yt){if(ft[yt]===void 0)throw new nt(ct+": Invalid unit definition. Unit "+yt+" in 'denominator' is not recognized")})}var mt={},kt={},bt={},vt={},Et={};for(var Mt in ft)if(ft.hasOwnProperty(Mt)){var At=ft[Mt];if(At[2]==="prefix"){mt[Mt]=At[1];for(var zt=0;zt<At[0].length;zt++)kt[At[0][zt]]=Mt}else{ut(Mt,At),bt[Mt]={scalar:At[1],numerator:At[3],denominator:At[4]};for(var Vt=0;Vt<At[0].length;Vt++)vt[At[0][Vt]]=Mt}Et[Mt]=At[0][0]}function Gt(ct){var rt,et=[],it=Object.keys(ft);if(typeof ct>"u")for(rt=0;rt<it.length;rt++)["","prefix"].indexOf(ft[it[rt]][2])===-1&&et.push(it[rt].substr(1,it[rt].length-2));else{if(this.getKinds().indexOf(ct)===-1)throw new nt("Kind not recognized");for(rt=0;rt<it.length;rt++)ft[it[rt]][2]===ct&&et.push(it[rt].substr(1,it[rt].length-2))}return et.sort(function(ht,yt){return ht.toLowerCase()<yt.toLowerCase()?-1:ht.toLowerCase()>yt.toLowerCase()?1:0})}function Kt(ct){if(!vt[ct])throw new nt("Unit not recognized");return ft[vt[ct]][0]}var Wt=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function sn(){if(this.signature)return this.signature;for(var ct=on.call(this),rt=0;rt<ct.length;rt++)ct[rt]*=Math.pow(20,rt);return ct.reduce(function(et,it){return et+it},0)}function on(){if(!this.isBase())return on.call(this.toBase());for(var ct=new Array(Wt.length),rt=0;rt<ct.length;rt++)ct[rt]=0;for(var et,it,ht=0;ht<this.numerator.length;ht++)(et=ft[this.numerator[ht]])&&(it=Wt.indexOf(et[2]),it>=0&&(ct[it]=ct[it]+1));for(var yt=0;yt<this.denominator.length;yt++)(et=ft[this.denominator[yt]])&&(it=Wt.indexOf(et[2]),it>=0&&(ct[it]=ct[it]-1));return ct}var Xt="[+-]",ln="\\d+",nn=Xt+"?"+ln,gn="\\."+ln,dn="(?:"+ln+"(?:"+gn+")?)|(?:"+gn+")",$n="[Ee]"+nn,En="(?:"+dn+")(?:"+$n+")?",qt=Xt+"?\\s*"+En,en="("+qt+")?\\s*([^/]*)(?:/(.+))?",Tn=new RegExp("^"+en+"$"),Sn="\\^|\\*{2}",fn="[01234]",Wn=new RegExp("([^ \\*\\d]+?)(?:"+Sn+")?(-?"+fn+"(?![a-zA-Z]))"),Zn=new RegExp("([^ \\*\\d]+?)(?:"+Sn+")?("+fn+"(?![a-zA-Z]))");function Gn(ct){a(ct)||(ct=ct.toString()),ct=ct.trim();var rt=Tn.exec(ct);if(!rt)throw new nt(ct+": Quantity not recognized");var et=rt[1];et?(et=et.replace(/\s/g,""),this.scalar=parseFloat(et)):this.scalar=1;for(var it=rt[2],ht=rt[3],yt,Lt,Nt;rt=Wn.exec(it);){if(yt=parseFloat(rt[2]),isNaN(yt))throw new nt("Unit exponent is not a number");if(yt===0&&!Un.test(rt[1]))throw new nt("Unit not recognized");Lt=rt[1]+" ",Nt="";for(var Ct=0;Ct<Math.abs(yt);Ct++)Nt+=Lt;yt>=0?it=it.replace(rt[0],Nt):(ht=ht?ht+Nt:Nt,it=it.replace(rt[0],""))}for(;rt=Zn.exec(ht);){if(yt=parseFloat(rt[2]),isNaN(yt))throw new nt("Unit exponent is not a number");if(yt===0&&!Un.test(rt[1]))throw new nt("Unit not recognized");Lt=rt[1]+" ",Nt="";for(var Ht=0;Ht<yt;Ht++)Nt+=Lt;ht=ht.replace(rt[0],Nt)}it&&(this.numerator=jn(it.trim())),ht&&(this.denominator=jn(ht.trim()))}var zn=Object.keys(kt).sort(function(ct,rt){return rt.length-ct.length}).join("|"),Bn=Object.keys(vt).sort(function(ct,rt){return rt.length-ct.length}).join("|"),or="\\b|$",Jn="("+zn+")??("+Bn+")(?:"+or+")",Un=new RegExp("^\\s*("+Jn+"[\\s\\*]*)+$"),nr=new RegExp(Jn,"g"),wn={};function jn(ct){var rt=wn[ct];if(rt)return rt;var et,it=[];if(!Un.test(ct))throw new nt("Unit not recognized");for(;et=nr.exec(ct);)it.push(et.slice(1));return it=it.map(function(ht){return kt[ht[0]]?[kt[ht[0]],vt[ht[1]]]:[vt[ht[1]]]}),it=it.reduce(function(ht,yt){return ht.concat(yt)},[]),it=it.filter(function(ht){return ht}),wn[ct]=it,it}function er(ct){if(!a(ct))throw new nt("Argument should be a string");try{return this(ct)}catch{return null}}function Vn(ct){return ct instanceof Rn}function Rn(ct,rt){if(ar.apply(null,arguments),!Vn(this))return new Rn(ct,rt);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=_t,this.denominator=_t,Hn(ct)?(this.scalar=ct.scalar,this.numerator=ct.numerator&&ct.numerator.length!==0?ct.numerator:_t,this.denominator=ct.denominator&&ct.denominator.length!==0?ct.denominator:_t):rt?(Gn.call(this,rt),this.scalar=ct):Gn.call(this,ct),this.denominator.join("*").indexOf("temp")>=0)throw new nt("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new nt("Cannot multiply by temperatures");if(!_(this.denominator,_t))throw new nt("Cannot divide with temperatures")}if(this.initValue=ct,Fn.call(this),this.isTemperature()&&this.baseScalar<0)throw new nt("Temperatures must not be less than absolute zero")}Rn.prototype={constructor:Rn};function ar(ct,rt){if(rt){if(!(o(ct)&&a(rt)))throw new nt("Only number accepted as initialization value when units are explicitly provided")}else if(!(a(ct)||o(ct)||Vn(ct)||Hn(ct)))throw new nt("Only string, number or quantity accepted as single initialization value")}function Hn(ct){return ct&&typeof ct=="object"&&ct.hasOwnProperty("scalar")}function Fn(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=sn.call(this);else{var ct=this.toBase();this.baseScalar=ct.scalar,this.signature=ct.signature}}var qn={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency","25599999980":"information_rate","25600000000":"information","511999999980":"angular_velocity","512000000000":"angle"};function ir(){return g(Object.keys(qn).map(function(ct){return qn[ct]}))}Rn.prototype.kind=function(){return qn[this.signature.toString()]},$(Rn.prototype,{isDegrees:function(){return(this.signature===null||this.signature===400)&&this.numerator.length===1&&_(this.denominator,_t)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}});function Nn(ct,rt){var et=ct.units(),it=rt.to(et),ht=Rn(xn(et));return Rn({scalar:ct.scalar-it.scalar,numerator:ht.numerator,denominator:ht.denominator})}function Kn(ct,rt){var et=rt.to(xn(ct.units()));return Rn({scalar:ct.scalar-et.scalar,numerator:ct.numerator,denominator:ct.denominator})}function Ut(ct,rt){var et=rt.to(xn(ct.units()));return Rn({scalar:ct.scalar+et.scalar,numerator:ct.numerator,denominator:ct.denominator})}function xn(ct){if(ct==="tempK")return"degK";if(ct==="tempC")return"degC";if(ct==="tempF")return"degF";if(ct==="tempR")return"degR";throw new nt("Unknown type for temp conversion from: "+ct)}function kn(ct,rt){var et=Pn(ct),it=rt.units(),ht;if(it==="degK")ht=et.scalar;else if(it==="degC")ht=et.scalar;else if(it==="degF")ht=et.scalar*9/5;else if(it==="degR")ht=et.scalar*9/5;else throw new nt("Unknown type for degree conversion to: "+it);return Rn({scalar:ht,numerator:rt.numerator,denominator:rt.denominator})}function Pn(ct){var rt=ct.units(),et;if(rt.match(/(deg)[CFRK]/))et=ct.baseScalar;else if(rt==="tempK")et=ct.scalar;else if(rt==="tempC")et=ct.scalar;else if(rt==="tempF")et=ct.scalar*5/9;else if(rt==="tempR")et=ct.scalar*5/9;else throw new nt("Unknown type for temp conversion from: "+rt);return Rn({scalar:et,numerator:["<kelvin>"],denominator:_t})}function tn(ct,rt){var et=rt.units(),it;if(et==="tempK")it=ct.baseScalar;else if(et==="tempC")it=ct.baseScalar-273.15;else if(et==="tempF")it=ct.baseScalar*9/5-459.67;else if(et==="tempR")it=ct.baseScalar*9/5;else throw new nt("Unknown type for temp conversion to: "+et);return Rn({scalar:it,numerator:rt.numerator,denominator:rt.denominator})}function vn(ct){var rt=ct.units(),et;if(rt.match(/(deg)[CFRK]/))et=ct.baseScalar;else if(rt==="tempK")et=ct.scalar;else if(rt==="tempC")et=ct.scalar+273.15;else if(rt==="tempF")et=(ct.scalar+459.67)*5/9;else if(rt==="tempR")et=ct.scalar*5/9;else throw new nt("Unknown type for temp conversion from: "+rt);return Rn({scalar:et,numerator:["<temp-K>"],denominator:_t})}$(Rn.prototype,{to:function(ct){var rt,et;if(ct==null)return this;if(!a(ct))return this.to(ct.units());if(rt=this._conversionCache[ct],rt)return rt;if(et=Rn(ct),et.units()===this.units())return this;if(!this.isCompatible(et))this.isInverse(et)?et=this.inverse().to(ct):lt(this.units(),et.units());else if(et.isTemperature())et=tn(this,et);else if(et.isDegrees())et=kn(this,et);else{var it=tt(this.baseScalar,et.baseScalar);et=Rn({scalar:it,numerator:et.numerator,denominator:et.denominator})}return this._conversionCache[ct]=et,et},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return vn(this);var ct=An[this.units()];return ct||(ct=sr(this.numerator,this.denominator),An[this.units()]=ct),ct.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new nt("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(ct){if(a(ct)&&(ct=Rn(ct)),o(ct)&&(ct=Rn(ct+" "+this.units())),this.isUnitless()?ct.isUnitless()||lt(this.units(),ct.units()):ct=ct.to(this.units()),ct.scalar===0)throw new nt("Divide by zero");var rt=b(Math.round(this.scalar/ct.scalar),ct.scalar);return Rn(rt+this.units())}});function Pt(ct,rt){var et=Rn(ct),it=Rn(rt);if(et.eq(it))return h;var ht;return et.isTemperature()?ht=function(yt){return et.mul(yt).to(it).scalar}:ht=function(yt){return yt*et.baseScalar/it.baseScalar},function(yt){var Lt,Nt,Ct;if(Array.isArray(yt)){for(Nt=yt.length,Ct=[],Lt=0;Lt<Nt;Lt++)Ct.push(ht(yt[Lt]));return Ct}else return ht(yt)}}var An={};function sr(ct,rt){for(var et=[],it=[],ht=1,yt,Lt=0;Lt<ct.length;Lt++)yt=ct[Lt],mt[yt]?ht=b(ht,mt[yt]):bt[yt]&&(ht*=bt[yt].scalar,bt[yt].numerator&&et.push(bt[yt].numerator),bt[yt].denominator&&it.push(bt[yt].denominator));for(var Nt=0;Nt<rt.length;Nt++)yt=rt[Nt],mt[yt]?ht/=mt[yt]:bt[yt]&&(ht/=bt[yt].scalar,bt[yt].numerator&&it.push(bt[yt].numerator),bt[yt].denominator&&et.push(bt[yt].denominator));return et=et.reduce(function(Ct,Ht){return Ct.concat(Ht)},[]),it=it.reduce(function(Ct,Ht){return Ct.concat(Ht)},[]),Rn({scalar:ht,numerator:et,denominator:it})}Rn.parse=er,Rn.getUnits=Gt,Rn.getAliases=Kt,Rn.mulSafe=b,Rn.divSafe=tt,Rn.getKinds=ir,Rn.swiftConverter=Pt,Rn.Error=nt,$(Rn.prototype,{add:function(ct){if(a(ct)&&(ct=Rn(ct)),this.isCompatible(ct)||lt(this.units(),ct.units()),this.isTemperature()&&ct.isTemperature())throw new nt("Cannot add two temperatures");return this.isTemperature()?Ut(this,ct):ct.isTemperature()?Ut(ct,this):Rn({scalar:this.scalar+ct.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(ct){if(a(ct)&&(ct=Rn(ct)),this.isCompatible(ct)||lt(this.units(),ct.units()),this.isTemperature()&&ct.isTemperature())return Nn(this,ct);if(this.isTemperature())return Kn(this,ct);if(ct.isTemperature())throw new nt("Cannot subtract a temperature from a differential degree unit");return Rn({scalar:this.scalar-ct.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(ct){if(o(ct))return Rn({scalar:b(this.scalar,ct),numerator:this.numerator,denominator:this.denominator});if(a(ct)&&(ct=Rn(ct)),(this.isTemperature()||ct.isTemperature())&&!(this.isUnitless()||ct.isUnitless()))throw new nt("Cannot multiply by temperatures");var rt=this,et=ct;rt.isCompatible(et)&&rt.signature!==400&&(et=et.to(rt));var it=wt(rt.numerator,rt.denominator,et.numerator,et.denominator);return Rn({scalar:b(rt.scalar,et.scalar,it[2]),numerator:it[0],denominator:it[1]})},div:function(ct){if(o(ct)){if(ct===0)throw new nt("Divide by zero");return Rn({scalar:this.scalar/ct,numerator:this.numerator,denominator:this.denominator})}else a(ct)&&(ct=Rn(ct));if(ct.scalar===0)throw new nt("Divide by zero");if(ct.isTemperature())throw new nt("Cannot divide with temperatures");if(this.isTemperature()&&!ct.isUnitless())throw new nt("Cannot divide with temperatures");var rt=this,et=ct;rt.isCompatible(et)&&rt.signature!==400&&(et=et.to(rt));var it=wt(rt.numerator,rt.denominator,et.denominator,et.numerator);return Rn({scalar:b(rt.scalar,it[2])/et.scalar,numerator:it[0],denominator:it[1]})},inverse:function(){if(this.isTemperature())throw new nt("Cannot divide with temperatures");if(this.scalar===0)throw new nt("Divide by zero");return Rn({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}});function wt(ct,rt,et,it){function ht(Mn){return Mn!==dt}ct=ct.filter(ht),et=et.filter(ht),rt=rt.filter(ht),it=it.filter(ht);var yt={};function Lt(Mn,un){for(var _n,On,_e,Dn=0;Dn<Mn.length;Dn++)if(mt[Mn[Dn]]?(_n=Mn[Dn+1],On=Mn[Dn],_e=mt[On],Dn++):(_n=Mn[Dn],On=null,_e=1),_n&&_n!==dt)if(yt[_n]){yt[_n][0]+=un;var Yn=yt[_n][2]?mt[yt[_n][2]]:1;yt[_n][un===1?3:4]*=tt(_e,Yn)}else yt[_n]=[un,_n,On,1,1]}Lt(ct,1),Lt(rt,-1),Lt(et,1),Lt(it,-1);var Nt=[],Ct=[],Ht=1;for(var rn in yt)if(yt.hasOwnProperty(rn)){var jt=yt[rn],pn;if(jt[0]>0)for(pn=0;pn<jt[0];pn++)Nt.push(jt[2]===null?jt[1]:[jt[2],jt[1]]);else if(jt[0]<0)for(pn=0;pn<-jt[0];pn++)Ct.push(jt[2]===null?jt[1]:[jt[2],jt[1]]);Ht*=tt(jt[3],jt[4])}return Nt.length===0&&(Nt=_t),Ct.length===0&&(Ct=_t),Nt=Nt.reduce(function(Mn,un){return Mn.concat(un)},[]),Ct=Ct.reduce(function(Mn,un){return Mn.concat(un)},[]),[Nt,Ct,Ht]}$(Rn.prototype,{eq:function(ct){return this.compareTo(ct)===0},lt:function(ct){return this.compareTo(ct)===-1},lte:function(ct){return this.eq(ct)||this.lt(ct)},gt:function(ct){return this.compareTo(ct)===1},gte:function(ct){return this.eq(ct)||this.gt(ct)},compareTo:function(ct){if(a(ct))return this.compareTo(Rn(ct));if(this.isCompatible(ct)||lt(this.units(),ct.units()),this.baseScalar<ct.baseScalar)return-1;if(this.baseScalar===ct.baseScalar)return 0;if(this.baseScalar>ct.baseScalar)return 1},same:function(ct){return this.scalar===ct.scalar&&this.units()===ct.units()}}),$(Rn.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every(function(ct){return _(ct,_t)})},isCompatible:function(ct){return a(ct)?this.isCompatible(Rn(ct)):Vn(ct)&&ct.signature!==void 0?this.signature===ct.signature:!1},isInverse:function(ct){return this.inverse().isCompatible(ct)},isBase:function(){return this._isBase!==void 0?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach(function(ct){ct!==dt&&pt.indexOf(ct)===-1&&(this._isBase=!1)},this),this._isBase===!1?this._isBase:(this._isBase=!0,this._isBase))}});function mn(){}mn.prototype.get=function(ct){return arguments.length>1&&(ct=Array.apply(null,arguments)),ct.reduce(function(rt,et,it){if(rt){var ht=rt[et];return it===ct.length-1?ht?ht.data:void 0:ht}},this)},mn.prototype.set=function(ct,rt){return arguments.length>2&&(ct=Array.prototype.slice.call(arguments,0,-1),rt=arguments[arguments.length-1]),ct.reduce(function(et,it,ht){var yt=et[it];return yt===void 0&&(yt=et[it]={}),ht===ct.length-1?(yt.data=rt,rt):yt},this)};function yn(ct,rt){return(ct+" "+rt).trim()}Rn.formatter=yn,$(Rn.prototype,{units:function(){if(this._units!==void 0)return this._units;var ct=_(this.numerator,_t),rt=_(this.denominator,_t);if(ct&&rt)return this._units="",this._units;var et=Qt(this.numerator),it=Qt(this.denominator);return this._units=et+(rt?"":"/"+it),this._units},toString:function(ct,rt){var et;if(o(ct))et=this.units(),rt=ct;else if(a(ct))et=ct;else if(Vn(ct))return this.toPrec(ct).toString(rt);var it=this.to(et),ht=rt!==void 0?st(it.scalar,rt):it.scalar;return it=(ht+" "+it.units()).trim(),it},format:function(ct,rt){arguments.length===1&&typeof ct=="function"&&(rt=ct,ct=void 0),rt=rt||Rn.formatter;var et=this.to(ct);return rt.call(this,et.scalar,et.units())}});var Ft=new mn;function Qt(ct){var rt=Ft.get(ct);if(rt)return rt;var et=_(ct,_t);return et?rt="1":rt=tr(cn(ct)).join("*"),Ft.set(ct,rt),rt}function cn(ct){for(var rt=[],et,it,ht=0;ht<ct.length;ht++)et=ct[ht],it=ct[ht+1],mt[et]?(rt.push(Et[et]+Et[it]),ht++):rt.push(Et[et]);return rt}function tr(ct){var rt=ct.reduce(function(et,it){var ht=et[it];return ht||et.push(ht=et[it]=[it,0]),ht[1]++,et},[]);return rt.map(function(et){return et[0]+(et[1]>1?et[1]:"")})}return Rn.version="1.8.0",Rn})}(quantities$1)),quantities$1.exports}var quantitiesExports=requireQuantities();const Qty=getDefaultExportFromCjs(quantitiesExports);function deepValue(e,i=""){let a=i.split(".");for(let s of a){if(e[s]===void 0)return;e=e[s]}return e}var orientation$1={exports:{}},twoProduct_1,hasRequiredTwoProduct;function requireTwoProduct(){if(hasRequiredTwoProduct)return twoProduct_1;hasRequiredTwoProduct=1,twoProduct_1=i;var e=+(Math.pow(2,27)+1);function i(a,s,o){var h=a*s,g=e*a,_=g-a,$=g-_,b=a-$,tt=e*s,st=tt-s,at=tt-st,nt=s-at,lt=h-$*at,ft=lt-b*at,pt=ft-$*nt,dt=b*nt-pt;return o?(o[0]=dt,o[1]=h,o):[dt,h]}return twoProduct_1}var robustSum,hasRequiredRobustSum;function requireRobustSum(){if(hasRequiredRobustSum)return robustSum;hasRequiredRobustSum=1,robustSum=i;function e(a,s){var o=a+s,h=o-a,g=o-h,_=s-h,$=a-g,b=$+_;return b?[b,o]:[o]}function i(a,s){var o=a.length|0,h=s.length|0;if(o===1&&h===1)return e(a[0],s[0]);var g=o+h,_=new Array(g),$=0,b=0,tt=0,st=Math.abs,at=a[b],nt=st(at),lt=s[tt],ft=st(lt),pt,dt;nt<ft?(dt=at,b+=1,b<o&&(at=a[b],nt=st(at))):(dt=lt,tt+=1,tt<h&&(lt=s[tt],ft=st(lt))),b<o&&nt<ft||tt>=h?(pt=at,b+=1,b<o&&(at=a[b],nt=st(at))):(pt=lt,tt+=1,tt<h&&(lt=s[tt],ft=st(lt)));for(var _t=pt+dt,ut=_t-pt,mt=dt-ut,kt=mt,bt=_t,vt,Et,Mt,At,zt;b<o&&tt<h;)nt<ft?(pt=at,b+=1,b<o&&(at=a[b],nt=st(at))):(pt=lt,tt+=1,tt<h&&(lt=s[tt],ft=st(lt))),dt=kt,_t=pt+dt,ut=_t-pt,mt=dt-ut,mt&&(_[$++]=mt),vt=bt+_t,Et=vt-bt,Mt=vt-Et,At=_t-Et,zt=bt-Mt,kt=zt+At,bt=vt;for(;b<o;)pt=at,dt=kt,_t=pt+dt,ut=_t-pt,mt=dt-ut,mt&&(_[$++]=mt),vt=bt+_t,Et=vt-bt,Mt=vt-Et,At=_t-Et,zt=bt-Mt,kt=zt+At,bt=vt,b+=1,b<o&&(at=a[b]);for(;tt<h;)pt=lt,dt=kt,_t=pt+dt,ut=_t-pt,mt=dt-ut,mt&&(_[$++]=mt),vt=bt+_t,Et=vt-bt,Mt=vt-Et,At=_t-Et,zt=bt-Mt,kt=zt+At,bt=vt,tt+=1,tt<h&&(lt=s[tt]);return kt&&(_[$++]=kt),bt&&(_[$++]=bt),$||(_[$++]=0),_.length=$,_}return robustSum}var twoSum,hasRequiredTwoSum;function requireTwoSum(){if(hasRequiredTwoSum)return twoSum;hasRequiredTwoSum=1,twoSum=e;function e(i,a,s){var o=i+a,h=o-i,g=o-h,_=a-h,$=i-g;return s?(s[0]=$+_,s[1]=o,s):[$+_,o]}return twoSum}var robustScale,hasRequiredRobustScale;function requireRobustScale(){if(hasRequiredRobustScale)return robustScale;hasRequiredRobustScale=1;var e=requireTwoProduct(),i=requireTwoSum();robustScale=a;function a(s,o){var h=s.length;if(h===1){var g=e(s[0],o);return g[0]?g:[g[1]]}var _=new Array(2*h),$=[.1,.1],b=[.1,.1],tt=0;e(s[0],o,$),$[0]&&(_[tt++]=$[0]);for(var st=1;st<h;++st){e(s[st],o,b);var at=$[1];i(at,b[0],$),$[0]&&(_[tt++]=$[0]);var nt=b[1],lt=$[1],ft=nt+lt,pt=ft-nt,dt=lt-pt;$[1]=ft,dt&&(_[tt++]=dt)}return $[1]&&(_[tt++]=$[1]),tt===0&&(_[tt++]=0),_.length=tt,_}return robustScale}var robustDiff,hasRequiredRobustDiff;function requireRobustDiff(){if(hasRequiredRobustDiff)return robustDiff;hasRequiredRobustDiff=1,robustDiff=i;function e(a,s){var o=a+s,h=o-a,g=o-h,_=s-h,$=a-g,b=$+_;return b?[b,o]:[o]}function i(a,s){var o=a.length|0,h=s.length|0;if(o===1&&h===1)return e(a[0],-s[0]);var g=o+h,_=new Array(g),$=0,b=0,tt=0,st=Math.abs,at=a[b],nt=st(at),lt=-s[tt],ft=st(lt),pt,dt;nt<ft?(dt=at,b+=1,b<o&&(at=a[b],nt=st(at))):(dt=lt,tt+=1,tt<h&&(lt=-s[tt],ft=st(lt))),b<o&&nt<ft||tt>=h?(pt=at,b+=1,b<o&&(at=a[b],nt=st(at))):(pt=lt,tt+=1,tt<h&&(lt=-s[tt],ft=st(lt)));for(var _t=pt+dt,ut=_t-pt,mt=dt-ut,kt=mt,bt=_t,vt,Et,Mt,At,zt;b<o&&tt<h;)nt<ft?(pt=at,b+=1,b<o&&(at=a[b],nt=st(at))):(pt=lt,tt+=1,tt<h&&(lt=-s[tt],ft=st(lt))),dt=kt,_t=pt+dt,ut=_t-pt,mt=dt-ut,mt&&(_[$++]=mt),vt=bt+_t,Et=vt-bt,Mt=vt-Et,At=_t-Et,zt=bt-Mt,kt=zt+At,bt=vt;for(;b<o;)pt=at,dt=kt,_t=pt+dt,ut=_t-pt,mt=dt-ut,mt&&(_[$++]=mt),vt=bt+_t,Et=vt-bt,Mt=vt-Et,At=_t-Et,zt=bt-Mt,kt=zt+At,bt=vt,b+=1,b<o&&(at=a[b]);for(;tt<h;)pt=lt,dt=kt,_t=pt+dt,ut=_t-pt,mt=dt-ut,mt&&(_[$++]=mt),vt=bt+_t,Et=vt-bt,Mt=vt-Et,At=_t-Et,zt=bt-Mt,kt=zt+At,bt=vt,tt+=1,tt<h&&(lt=-s[tt]);return kt&&(_[$++]=kt),bt&&(_[$++]=bt),$||(_[$++]=0),_.length=$,_}return robustDiff}var hasRequiredOrientation;function requireOrientation(){return hasRequiredOrientation||(hasRequiredOrientation=1,function(e){var i=requireTwoProduct(),a=requireRobustSum(),s=requireRobustScale(),o=requireRobustDiff(),h=5,g=11102230246251565e-32,_=(3+16*g)*g,$=(7+56*g)*g;function b(ut,mt,kt,bt){return function(vt,Et,Mt){var At=ut(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0]))),zt=ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),Vt=bt(At,zt);return Vt[Vt.length-1]}}function tt(ut,mt,kt,bt){return function(vt,Et,Mt,At){var zt=ut(ut(kt(ut(mt(Mt[1],At[0]),mt(-At[1],Mt[0])),Et[2]),ut(kt(ut(mt(Et[1],At[0]),mt(-At[1],Et[0])),-Mt[2]),kt(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),At[2]))),ut(kt(ut(mt(Et[1],At[0]),mt(-At[1],Et[0])),vt[2]),ut(kt(ut(mt(vt[1],At[0]),mt(-At[1],vt[0])),-Et[2]),kt(ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0])),At[2])))),Vt=ut(ut(kt(ut(mt(Mt[1],At[0]),mt(-At[1],Mt[0])),vt[2]),ut(kt(ut(mt(vt[1],At[0]),mt(-At[1],vt[0])),-Mt[2]),kt(ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),At[2]))),ut(kt(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),vt[2]),ut(kt(ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),-Et[2]),kt(ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0])),Mt[2])))),Gt=bt(zt,Vt);return Gt[Gt.length-1]}}function st(ut,mt,kt,bt){return function(vt,Et,Mt,At,zt){var Vt=ut(ut(ut(kt(ut(kt(ut(mt(At[1],zt[0]),mt(-zt[1],At[0])),Mt[2]),ut(kt(ut(mt(Mt[1],zt[0]),mt(-zt[1],Mt[0])),-At[2]),kt(ut(mt(Mt[1],At[0]),mt(-At[1],Mt[0])),zt[2]))),Et[3]),ut(kt(ut(kt(ut(mt(At[1],zt[0]),mt(-zt[1],At[0])),Et[2]),ut(kt(ut(mt(Et[1],zt[0]),mt(-zt[1],Et[0])),-At[2]),kt(ut(mt(Et[1],At[0]),mt(-At[1],Et[0])),zt[2]))),-Mt[3]),kt(ut(kt(ut(mt(Mt[1],zt[0]),mt(-zt[1],Mt[0])),Et[2]),ut(kt(ut(mt(Et[1],zt[0]),mt(-zt[1],Et[0])),-Mt[2]),kt(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),zt[2]))),At[3]))),ut(kt(ut(kt(ut(mt(Mt[1],At[0]),mt(-At[1],Mt[0])),Et[2]),ut(kt(ut(mt(Et[1],At[0]),mt(-At[1],Et[0])),-Mt[2]),kt(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),At[2]))),-zt[3]),ut(kt(ut(kt(ut(mt(At[1],zt[0]),mt(-zt[1],At[0])),Et[2]),ut(kt(ut(mt(Et[1],zt[0]),mt(-zt[1],Et[0])),-At[2]),kt(ut(mt(Et[1],At[0]),mt(-At[1],Et[0])),zt[2]))),vt[3]),kt(ut(kt(ut(mt(At[1],zt[0]),mt(-zt[1],At[0])),vt[2]),ut(kt(ut(mt(vt[1],zt[0]),mt(-zt[1],vt[0])),-At[2]),kt(ut(mt(vt[1],At[0]),mt(-At[1],vt[0])),zt[2]))),-Et[3])))),ut(ut(kt(ut(kt(ut(mt(Et[1],zt[0]),mt(-zt[1],Et[0])),vt[2]),ut(kt(ut(mt(vt[1],zt[0]),mt(-zt[1],vt[0])),-Et[2]),kt(ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0])),zt[2]))),At[3]),ut(kt(ut(kt(ut(mt(Et[1],At[0]),mt(-At[1],Et[0])),vt[2]),ut(kt(ut(mt(vt[1],At[0]),mt(-At[1],vt[0])),-Et[2]),kt(ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0])),At[2]))),-zt[3]),kt(ut(kt(ut(mt(Mt[1],At[0]),mt(-At[1],Mt[0])),Et[2]),ut(kt(ut(mt(Et[1],At[0]),mt(-At[1],Et[0])),-Mt[2]),kt(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),At[2]))),vt[3]))),ut(kt(ut(kt(ut(mt(Mt[1],At[0]),mt(-At[1],Mt[0])),vt[2]),ut(kt(ut(mt(vt[1],At[0]),mt(-At[1],vt[0])),-Mt[2]),kt(ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),At[2]))),-Et[3]),ut(kt(ut(kt(ut(mt(Et[1],At[0]),mt(-At[1],Et[0])),vt[2]),ut(kt(ut(mt(vt[1],At[0]),mt(-At[1],vt[0])),-Et[2]),kt(ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0])),At[2]))),Mt[3]),kt(ut(kt(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),vt[2]),ut(kt(ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),-Et[2]),kt(ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0])),Mt[2]))),-At[3]))))),Gt=ut(ut(ut(kt(ut(kt(ut(mt(At[1],zt[0]),mt(-zt[1],At[0])),Mt[2]),ut(kt(ut(mt(Mt[1],zt[0]),mt(-zt[1],Mt[0])),-At[2]),kt(ut(mt(Mt[1],At[0]),mt(-At[1],Mt[0])),zt[2]))),vt[3]),kt(ut(kt(ut(mt(At[1],zt[0]),mt(-zt[1],At[0])),vt[2]),ut(kt(ut(mt(vt[1],zt[0]),mt(-zt[1],vt[0])),-At[2]),kt(ut(mt(vt[1],At[0]),mt(-At[1],vt[0])),zt[2]))),-Mt[3])),ut(kt(ut(kt(ut(mt(Mt[1],zt[0]),mt(-zt[1],Mt[0])),vt[2]),ut(kt(ut(mt(vt[1],zt[0]),mt(-zt[1],vt[0])),-Mt[2]),kt(ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),zt[2]))),At[3]),kt(ut(kt(ut(mt(Mt[1],At[0]),mt(-At[1],Mt[0])),vt[2]),ut(kt(ut(mt(vt[1],At[0]),mt(-At[1],vt[0])),-Mt[2]),kt(ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),At[2]))),-zt[3]))),ut(ut(kt(ut(kt(ut(mt(Mt[1],zt[0]),mt(-zt[1],Mt[0])),Et[2]),ut(kt(ut(mt(Et[1],zt[0]),mt(-zt[1],Et[0])),-Mt[2]),kt(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),zt[2]))),vt[3]),kt(ut(kt(ut(mt(Mt[1],zt[0]),mt(-zt[1],Mt[0])),vt[2]),ut(kt(ut(mt(vt[1],zt[0]),mt(-zt[1],vt[0])),-Mt[2]),kt(ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),zt[2]))),-Et[3])),ut(kt(ut(kt(ut(mt(Et[1],zt[0]),mt(-zt[1],Et[0])),vt[2]),ut(kt(ut(mt(vt[1],zt[0]),mt(-zt[1],vt[0])),-Et[2]),kt(ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0])),zt[2]))),Mt[3]),kt(ut(kt(ut(mt(Et[1],Mt[0]),mt(-Mt[1],Et[0])),vt[2]),ut(kt(ut(mt(vt[1],Mt[0]),mt(-Mt[1],vt[0])),-Et[2]),kt(ut(mt(vt[1],Et[0]),mt(-Et[1],vt[0])),Mt[2]))),-zt[3])))),Kt=bt(Vt,Gt);return Kt[Kt.length-1]}}function at(ut){var mt=ut===3?b:ut===4?tt:st;return mt(a,i,s,o)}var nt=at(3),lt=at(4),ft=[function(){return 0},function(){return 0},function(ut,mt){return mt[0]-ut[0]},function(ut,mt,kt){var bt=(ut[1]-kt[1])*(mt[0]-kt[0]),vt=(ut[0]-kt[0])*(mt[1]-kt[1]),Et=bt-vt,Mt;if(bt>0){if(vt<=0)return Et;Mt=bt+vt}else if(bt<0){if(vt>=0)return Et;Mt=-(bt+vt)}else return Et;var At=_*Mt;return Et>=At||Et<=-At?Et:nt(ut,mt,kt)},function(ut,mt,kt,bt){var vt=ut[0]-bt[0],Et=mt[0]-bt[0],Mt=kt[0]-bt[0],At=ut[1]-bt[1],zt=mt[1]-bt[1],Vt=kt[1]-bt[1],Gt=ut[2]-bt[2],Kt=mt[2]-bt[2],Wt=kt[2]-bt[2],sn=Et*Vt,on=Mt*zt,Xt=Mt*At,ln=vt*Vt,nn=vt*zt,gn=Et*At,dn=Gt*(sn-on)+Kt*(Xt-ln)+Wt*(nn-gn),$n=(Math.abs(sn)+Math.abs(on))*Math.abs(Gt)+(Math.abs(Xt)+Math.abs(ln))*Math.abs(Kt)+(Math.abs(nn)+Math.abs(gn))*Math.abs(Wt),En=$*$n;return dn>En||-dn>En?dn:lt(ut,mt,kt,bt)}];function pt(ut){var mt=ft[ut.length];return mt||(mt=ft[ut.length]=at(ut.length)),mt.apply(void 0,ut)}function dt(ut,mt,kt,bt,vt,Et,Mt){return function(At,zt,Vt,Gt,Kt){switch(arguments.length){case 0:case 1:return 0;case 2:return bt(At,zt);case 3:return vt(At,zt,Vt);case 4:return Et(At,zt,Vt,Gt);case 5:return Mt(At,zt,Vt,Gt,Kt)}for(var Wt=new Array(arguments.length),sn=0;sn<arguments.length;++sn)Wt[sn]=arguments[sn];return ut(Wt)}}function _t(){for(;ft.length<=h;)ft.push(at(ft.length));e.exports=dt.apply(void 0,[pt].concat(ft));for(var ut=0;ut<=h;++ut)e.exports[ut]=ft[ut]}_t()}(orientation$1)),orientation$1.exports}var robustPnp,hasRequiredRobustPnp;function requireRobustPnp(){if(hasRequiredRobustPnp)return robustPnp;hasRequiredRobustPnp=1,robustPnp=i;var e=requireOrientation();function i(a,s){for(var o=s[0],h=s[1],g=a.length,_=1,$=g,b=0,tt=g-1;b<$;tt=b++){var st=a[b],at=a[tt],nt=st[1],lt=at[1];if(lt<nt){if(lt<h&&h<nt){var ft=e(st,at,s);if(ft===0)return 0;_^=0<ft|0}else if(h===nt){var pt=a[(b+1)%g],dt=pt[1];if(nt<dt){var ft=e(st,at,s);if(ft===0)return 0;_^=0<ft|0}}}else if(nt<lt){if(nt<h&&h<lt){var ft=e(st,at,s);if(ft===0)return 0;_^=ft<0|0}else if(h===nt){var pt=a[(b+1)%g],dt=pt[1];if(dt<nt){var ft=e(st,at,s);if(ft===0)return 0;_^=ft<0|0}}}else if(h===nt){var _t=Math.min(st[0],at[0]),ut=Math.max(st[0],at[0]);if(b===0){for(;tt>0;){var mt=(tt+g-1)%g,kt=a[mt];if(kt[1]!==h)break;var bt=kt[0];_t=Math.min(_t,bt),ut=Math.max(ut,bt),tt=mt}if(tt===0)return _t<=o&&o<=ut?0:1;$=tt+1}for(var vt=a[(tt+g-1)%g][1];b+1<$;){var kt=a[b+1];if(kt[1]!==h)break;var bt=kt[0];_t=Math.min(_t,bt),ut=Math.max(ut,bt),b+=1}if(_t<=o&&o<=ut)return 0;var Et=a[(b+1)%g][1];o<_t&&vt<h!=Et<h&&(_^=1)}}return 2*_-1}return robustPnp}var robustPnpExports=requireRobustPnp();const robustPointInPolygon=getDefaultExportFromCjs(robustPnpExports);function feretDiameters(e={}){const{originalPoints:i=monotoneChainConvexHull.call(this)}=e;if(i.length===0)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(i.length===1)return{min:1,max:1,minLine:[i[0],i[0]],maxLine:[i[0],i[0]],aspectRatio:1};const a=new Array(i.length);let s=1/0,o=0,h=[];for(let b=0;b<i.length;b++){let tt=getAngle(i[b],i[(b+1)%i.length]);rotate(-tt,i,a);let st=0,at=[];for(let nt=0;nt<i.length;nt++){let lt=Math.abs(a[b][1]-a[nt][1]);lt>st&&(st=lt,at=[],at.push([a[nt][0],a[b][1]],[a[nt][0],a[nt][1]]))}st<s&&(s=st,o=tt,h=at)}rotate(o,h,h);let g=0,_=[],$=0;for(let b=0;b<i.length-1;b++)for(let tt=b+1;tt<i.length;tt++){let st=(i[b][0]-i[tt][0])**2+(i[b][1]-i[tt][1])**2;st>$&&($=st,g=Math.sqrt(st),_=[i[b],i[tt]])}return{min:s,minLine:h,max:g,maxLine:_,aspectRatio:s/g}}function getAngle(e,i){let a=difference(i,e),s=normalize(a),o=Math.acos(s[0]);return s[1]<0?-o:o}class Roi{constructor(i,a){this.map=i,this.id=a,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(i={}){const{scale:a=1,kind:s=""}=i;let o;switch(s){case"contour":o=this.contourMask;break;case"box":o=this.boxMask;break;case"filled":o=this.filledMask;break;case"center":o=this.centerMask;break;case"mbr":o=this.mbrFilledMask;break;case"hull":o=this.convexHullFilledMask;break;case"hullContour":o=this.convexHullMask;break;case"mbrContour":o=this.mbrMask;break;case"feret":o=this.feretMask;break;default:o=this.mask}return a<1&&(o=o.resize({factor:a}),o.parent=this.mask.parent,o.position[0]+=this.minX,o.position[1]+=this.minY),o}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let i=this.borderIDs,a=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let s=this.internalIDs;for(let o=0;o<i.length;o++)s.includes(i[o])||(this.computed.externalIDs.push(i[o]),this.computed.externalLengths.push(a[o]))}get externalIDs(){return this.computed.externalIDs?this.computed.externalIDs:(this._computExternalIDs(),this.computed.externalIDs)}get externalLengths(){return this.computed.externalLengths?this.computed.externalLengths:(this._computExternalIDs(),this.computed.externalLengths)}_computeBorderIDs(){let i=getBorders(this);this.computed.borderIDs=i.ids,this.computed.borderLengths=i.lengths}get borderIDs(){return this.computed.borderIDs?this.computed.borderIDs:(this._computeBorderIDs(),this.computed.borderIDs)}get borderLengths(){return this.computed.borderLengths?this.computed.borderLengths:(this._computeBorderIDs(),this.computed.borderLengths)}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=getBoxIDs(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=getInternalIDs(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=getBox(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=getExternal(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=getHolesInfo(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=getBorder(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let i=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let a=0;a<this.width;a++)for(let s=0;s<this.height;s++)this.map.data[a+this.minX+(s+this.minY)*this.map.width]===this.id&&(a>0&&a<this.width-1&&s>0&&s<this.height-1?(this.map.data[a-1+this.minX+(s+this.minY)*this.map.width]!==this.id||this.map.data[a+1+this.minX+(s+this.minY)*this.map.width]!==this.id||this.map.data[a+this.minX+(s-1+this.minY)*this.map.width]!==this.id||this.map.data[a+this.minX+(s+1+this.minY)*this.map.width]!==this.id)&&i.setBitXY(a,s):i.setBitXY(a,s));this.computed.contourMask=i}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let i=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let a=0;a<this.width;a++)i.setBitXY(a,0),i.setBitXY(a,this.height-1);for(let a=0;a<this.height;a++)i.setBitXY(0,a),i.setBitXY(this.width-1,a);this.computed.boxMask=i}return this.computed.boxMask}get mask(){if(!this.computed.mask){let i=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let a=0;a<this.width;a++)for(let s=0;s<this.height;s++)this.map.data[a+this.minX+(s+this.minY)*this.map.width]===this.id&&i.setBitXY(a,s);this.computed.mask=i}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let i=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let a=0;a<this.width;a++)for(let s=0;s<this.height;s++){let o=a+this.minX+(s+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[o])&&i.setBitXY(a,s)}this.computed.filledMask=i}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let i=new Shape({kind:"smallCross"}).getMask();i.parent=this.map.parent,i.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=i}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const i=[];for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++)this.map.data[s+this.minX+(o+this.minY)*this.map.width]===this.id&&(s>0&&s<this.width-1&&o>0&&o<this.height-1?(this.map.data[s-1+this.minX+(o+this.minY)*this.map.width]!==this.id||this.map.data[s+1+this.minX+(o+this.minY)*this.map.width]!==this.id||this.map.data[s+this.minX+(o-1+this.minY)*this.map.width]!==this.id||this.map.data[s+this.minX+(o+1+this.minY)*this.map.width]!==this.id)&&(i.push([s,o]),i.push([s+1,o]),i.push([s,o+1]),i.push([s+1,o+1])):(i.push([s,o]),i.push([s+1,o]),i.push([s,o+1]),i.push([s+1,o+1])));const a=monotoneChainConvexHull$1(i);this.computed.convexHull={polyline:a,surface:surface(a),perimeter:perimeter(a)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const i=this.convexHull,a=new Image$1(this.width+1,this.height+1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});a.paintPolyline(i.polyline,{closed:!0}),this.computed.convexHullMask=a}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const i=this.convexHull,a=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++)robustPointInPolygon(i.polyline,[s,o])!==1&&a.setBitXY(s,o);this.computed.convexHullFilledMask=a}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let i=minimalBoundingRectangle({originalPoints:this.convexHull.polyline});if(i.length===0)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:i};else{let a=i[0],s=i[1],o=i[2],h=Math.sqrt((a[0]-s[0])**2+(a[1]-s[1])**2),g=Math.sqrt((o[0]-s[0])**2+(o[1]-s[1])**2);this.computed.mbr={width:h,height:g,elongation:1-h/g,aspectRatio:h/g,surface:h*g,perimeter:(h+g)*2,rectangle:i}}}return this.computed.mbr}get filledSurface(){return this.surface+this.holesInfo.surface}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=feretDiameters({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=getPerimeterInfo(this)),this.computed.perimeterInfo}get perimeter(){let i=this.perimeterInfo,a=2-Math.sqrt(2);return i.one+i.two*2+i.three*3+i.four*4-a*(i.two+i.three*2+i.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const i=new Image$1(this.width+1,this.height+1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});i.paintPolyline(this.feretDiameters.minLine),i.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=i}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let i=round(this.mbr.rectangle);if(i.length>0){const a=minMax(i),s=new Image$1(a[1][0]-a[0][0]+1,a[1][1]-a[0][1]+1,{kind:BINARY,position:[this.minX+a[0][0],this.minY+a[0][1]],parent:this.map.parent});i=moveToZeroZero(i),s.paintPolyline(i,{closed:!0}),this.computed.mbrMask=s}else this.computed.mbrMask=new Image$1(1,1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const i=new Image$1(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent}),a=this.mask.minimalBoundingRectangle();for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++)robustPointInPolygon(a,[s,o])!==1&&i.setBitXY(s,o);this.computed.mbrFilledMask=i}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let i=[];for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++){let o=(a+this.minY)*this.map.width+s+this.minX;this.map.data[o]===this.id&&i.push([s,a])}this.computed.points=i}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let i=0,a;const s=this.points;for(let o=0;o<s.length;o++)for(let h=o+1;h<s.length;h++){let g=Math.pow(s[o][0]-s[h][0],2)+Math.pow(s[o][1]-s[h][1],2);g>=i&&(i=g,a=[s[o],s[h]])}this.computed.maxLengthPoints=a}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let i=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=i}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let i=this.maxLengthPoints,a=-Math.atan2(i[0][1]-i[1][1],i[0][0]-i[1][0])*180/Math.PI;this.computed.angle=a}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,filledSurface:this.filledSurface,surface:this.surface,hullSurface:this.convexHull.surface,hullPerimeter:this.convexHull.perimeter,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}function getBorders(e){let i=e.map,a=i.data,s=new Set,o=new Map,h=new Set,g=[1,0,-1,0],_=[0,1,0,-1];for(let tt=e.minX;tt<=e.maxX;tt++)for(let st=e.minY;st<=e.maxY;st++){let at=tt+st*i.width;if(a[at]===e.id)for(let nt=0;nt<4;nt++){let lt=tt+g[nt],ft=st+_[nt];if(lt>=0&&ft>=0&&lt<i.width&&ft<i.height){let pt=lt+ft*i.width;if(a[pt]!==e.id&&!h.has(pt)){h.add(pt),s.add(a[pt]);let dt=o.get(a[pt]);dt?o.set(a[pt],++dt):o.set(a[pt],1)}}}}let $=Array.from(s),b=$.map(function(tt){return o.get(tt)});return{ids:$,lengths:b}}function getBoxIDs(e){let i=new Set,a=e.map,s=a.data;for(let o of[0,e.height-1])for(let h=0;h<e.width;h++){let g=(o+e.minY)*a.width+h+e.minX;if(h-e.minX>0&&s[g]===e.id&&s[g-1]!==e.id){let _=s[g-1];i.add(_)}if(a.width-h-e.minX>1&&s[g]===e.id&&s[g+1]!==e.id){let _=s[g+1];i.add(_)}}for(let o of[0,e.width-1])for(let h=0;h<e.height;h++){let g=(h+e.minY)*a.width+o+e.minX;if(h-e.minY>0&&s[g]===e.id&&s[g-a.width]!==e.id){let _=s[g-a.width];i.add(_)}if(a.height-h-e.minY>1&&s[g]===e.id&&s[g+a.width]!==e.id){let _=s[g+a.width];i.add(_)}}return Array.from(i)}function getBox(e){let i=0,a=e.map,s=a.data,o=[0];e.height>1&&(o[1]=e.height-1);for(let g of o)for(let _=1;_<e.width-1;_++){let $=(g+e.minY)*a.width+_+e.minX;s[$]===e.id&&i++}let h=[0];e.width>1&&(h[1]=e.width-1);for(let g of h)for(let _=0;_<e.height;_++){let $=(_+e.minY)*a.width+g+e.minX;s[$]===e.id&&i++}return i}function getBorder(e){let i=0,a=e.map,s=a.data;for(let o=1;o<e.width-1;o++)for(let h=1;h<e.height-1;h++){let g=(h+e.minY)*a.width+o+e.minX;s[g]===e.id&&(s[g-1]!==e.id||s[g+1]!==e.id||s[g-a.width]!==e.id||s[g+a.width]!==e.id)&&i++}return i+e.box}function getPerimeterInfo(e){let i=e.map,a=i.data,s=0,o=0,h=0,g=0;for(let _=0;_<e.width;_++)for(let $=0;$<e.height;$++){let b=($+e.minY)*i.width+_+e.minX;if(a[b]===e.id){let tt=0;switch((_===0||e.externalIDs.includes(a[b-1]))&&tt++,(_===e.width-1||e.externalIDs.includes(a[b+1]))&&tt++,($===0||e.externalIDs.includes(a[b-i.width]))&&tt++,($===e.height-1||e.externalIDs.includes(a[b+i.width]))&&tt++,tt){case 1:s++;break;case 2:o++;break;case 3:h++;break;case 4:g++;break}}}return{one:s,two:o,three:h,four:g}}function getExternal(e){let i=0,a=e.map,s=a.data;for(let o=1;o<e.width-1;o++)for(let h=1;h<e.height-1;h++){let g=(h+e.minY)*a.width+o+e.minX;s[g]===e.id&&(e.externalIDs.includes(s[g-1])||e.externalIDs.includes(s[g+1])||e.externalIDs.includes(s[g-a.width])||e.externalIDs.includes(s[g+a.width]))&&i++}return i+e.box}function getHolesInfo(e){let i=0,a=e.map.width,s=e.map.data;for(let o=1;o<e.width-1;o++)for(let h=1;h<e.height-1;h++){let g=(h+e.minY)*a+o+e.minX;e.internalIDs.includes(s[g])&&s[g]!==e.id&&i++}return{number:e.internalIDs.length-1,surface:i}}function getInternalIDs(e){let i=[e.id],a=e.map,s=a.data;if(e.height>2)for(let h=0;h<e.width;h++){let g=e.minY*a.width+h+e.minX;if(i.includes(s[g])){let _=s[g+a.width];!i.includes(_)&&!e.boxIDs.includes(_)&&i.push(_)}}let o=new Array(4);for(let h=1;h<e.width-1;h++)for(let g=1;g<e.height-1;g++){let _=(g+e.minY)*a.width+h+e.minX;if(i.includes(s[_])){o[0]=s[_-1],o[1]=s[_+1],o[2]=s[_-a.width],o[3]=s[_+a.width];for(let $=0;$<4;$++){let b=o[$];!i.includes(b)&&!e.boxIDs.includes(b)&&i.push(b)}}}return i}class RoiLayer{constructor(i,a){this.roiMap=i,this.options=a,this.roi=this.createRoi()}createRoi(){let i=this.roiMap.data,a={};this.roiMap.positive=0,this.roiMap.negative=0;for(let _=0;_<i.length;_++)i[_]&&!a[i[_]]&&(a[i[_]]=!0,i[_]>0?this.roiMap.positive++:this.roiMap.negative++);let s={};for(let _ in a)s[_]=new Roi(this.roiMap,_*1);let o=this.roiMap.width,h=this.roiMap.height;for(let _=0;_<h;_++)for(let $=0;$<o;$++){let b=_*o+$;if(i[b]!==0){const tt=i[b],st=s[tt];$<st.minX&&(st.minX=$),$>st.maxX&&(st.maxX=$),_<st.minY&&(st.minY=_),_>st.maxY&&(st.maxY=_),st.meanX+=$,st.meanY+=_,st.surface++}}let g=[];for(let _ in a)s[_].meanX/=s[_].surface,s[_].meanY/=s[_].surface,g.push(s[_]);return g}}function commonBorderLength(e){let i=e.data,a=[1,0,-1,0],s=[0,1,0,-1],o=e.minMax,h=-o.min,g=o.max+h,_=[];for(let b=0;b<=g;b++)_.push(Object.create(null));for(let b=0;b<e.width;b++)for(let tt=0;tt<e.height;tt++){let st=b+tt*e.width,at=i[st];if(at!==0){let nt=Object.create(null),lt=!1;for(let ft=0;ft<4;ft++){let pt=b+a[ft],dt=tt+s[ft];if(pt>=0&&dt>=0&&pt<e.width&&dt<e.height){let _t=i[pt+dt*e.width];at!==_t&&(lt=!0,_t!==0&&nt[_t]===void 0&&(nt[_t]=!0,_[_t+h][at]?_[_t+h][at]++:_[_t+h][at]=1))}else lt=!0}lt&&(_[at+h][at]?_[at+h][at]++:_[at+h][at]=1)}}let $={};for(let b=0;b<_.length;b++)Object.keys(_[b]).length>0&&($[b-h]=_[b]);return $}function mergeRoi(e={}){const{algorithm:i="commonBorderLength",minCommonBorderLength:a=5,maxCommonBorderLength:s=100,minCommonBorderRatio:o=.3,maxCommonBorderRatio:h=1}=e;let g=function(pt,dt,_t){return pt[_t]>=a&&pt[_t]<=s};typeof i=="function"&&(g=i),i.toLowerCase()==="commonborderratio"&&(g=function(pt,dt,_t){let ut=Math.min(pt[_t]/pt[dt],1);return ut>=o&&ut<=h});const _=this,$=_.commonBorderLength;let b={},tt={};for(let pt of Object.keys($)){let dt=$[pt],_t=Object.keys(dt);for(let ut of _t)if(ut!==pt&&g(dt,pt,ut)){let mt=ut;tt[ut]&&(mt=tt[ut]);let kt=pt;if(tt[pt]&&(kt=tt[pt]),Number(mt)!==kt){let bt=Math.min(mt,kt),vt=Math.max(mt,kt);if(b[bt]||(b[bt]={}),b[bt][vt]=!0,tt[vt]=bt,b[vt]){for(let Et of Object.keys(b[vt]))b[bt][Et]=!0,tt[Et]=bt;delete b[vt]}}}}let st=_.minMax,at=-st.min,nt=st.max+at,lt=new Array(nt+1).fill(0);for(let pt of Object.keys(tt))lt[Number(pt)+at]=tt[pt];let ft=_.data;for(let pt=0;pt<ft.length;pt++){let dt=ft[pt];if(dt!==0){let _t=lt[dt+at];_t!==0&&(ft[pt]=_t)}}return _.computed={},_}class RoiMap{constructor(i,a){this.parent=i,this.width=i.width,this.height=i.height,this.data=a,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let i=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(let s=0;s<this.data.length;s++)this.data[s]<i&&(i=this.data[s]),this.data[s]>a&&(a=this.data[s]);return{min:i,max:a}}get commonBorderLength(){return commonBorderLength(this)}mergeRoi(i={}){return mergeRoi.call(this,i)}mergeRois(i){const a=i[0],s=i.slice(1);for(let o=0;o<this.data.length;o++)s.includes(this.data[o])&&(this.data[o]=a)}rowsInfo(){let i=new Array(this.height),a=0;for(let s=0;s<this.data.length;s+=this.width){let o={row:a,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};i[a++]=o;let h={},g={},_=[],$=this.data[s],b=0;for(let tt=s;tt<s+this.width;tt++){let st=this.data[tt];$!==st&&($=st,_.push(b),b=0),b++,st>0?(o.positivePixel++,h[st]||(h[st]=!0)):st<0?(o.negativePixel++,g[st]||(g[st]=!0)):o.zeroPixel++}_.push(b),o.medianChange=_.sort((tt,st)=>tt-st)[Math.floor(_.length/2)],o.positiveRoiIDs=Object.keys(h),o.negativeRoiIDs=Object.keys(g),o.positiveRoi=o.positiveRoiIDs.length,o.negativeRoi=o.negativeRoiIDs.length}return i}colsInfo(){let i=new Array(this.width),a=0;for(let s=0;s<this.width;s++){let o={col:a,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};i[a++]=o;let h={},g={},_=[],$=this.data[s],b=0;for(let tt=s;tt<s+this.data.length;tt+=this.width){let st=this.data[tt];$!==st&&($=st,_.push(b),b=0),b++,st>0?(o.positivePixel++,h[st]||(h[st]=!0)):st<0?(o.negativePixel++,g[st]||(g[st]=!0)):o.zeroPixel++}_.push(b),o.medianChange=_.sort((tt,st)=>tt-st)[Math.floor(_.length/2)],o.positiveRoiIDs=Object.keys(h),o.negativeRoiIDs=Object.keys(g),o.positiveRoi=o.positiveRoiIDs.length,o.negativeRoi=o.negativeRoiIDs.length}return i}}function fromMask(e,i={}){const{allowCorners:a=!1}=i,s=65535;let o=new Int16Array(e.size),h=0,g=0,_=new Uint16Array(s+1),$=new Uint16Array(s+1);for(let tt=0;tt<e.width;tt++)for(let st=0;st<e.height;st++)o[st*e.width+tt]===0&&b(tt,st);function b(tt,st){let at=0,nt=0,lt=e.getBitXY(tt,st),ft=lt?++h:--g;if(h>32767||g<-32768)throw new Error("Too many regions of interest");for(_[0]=tt,$[0]=st;at<=nt;){let pt=_[at&s],dt=$[at&s];if(o[dt*e.width+pt]=ft,pt>0&&o[dt*e.width+pt-1]===0&&e.getBitXY(pt-1,dt)===lt&&(nt++,_[nt&s]=pt-1,$[nt&s]=dt,o[dt*e.width+pt-1]=-32768),dt>0&&o[(dt-1)*e.width+pt]===0&&e.getBitXY(pt,dt-1)===lt&&(nt++,_[nt&s]=pt,$[nt&s]=dt-1,o[(dt-1)*e.width+pt]=-32768),pt<e.width-1&&o[dt*e.width+pt+1]===0&&e.getBitXY(pt+1,dt)===lt&&(nt++,_[nt&s]=pt+1,$[nt&s]=dt,o[dt*e.width+pt+1]=-32768),dt<e.height-1&&o[(dt+1)*e.width+pt]===0&&e.getBitXY(pt,dt+1)===lt&&(nt++,_[nt&s]=pt,$[nt&s]=dt+1,o[(dt+1)*e.width+pt]=-32768),a&&(pt>0&&dt>0&&o[(dt-1)*e.width+pt-1]===0&&e.getBitXY(pt-1,dt-1)===lt&&(nt++,_[nt&s]=pt-1,$[nt&s]=dt-1,o[(dt-1)*e.width+pt-1]=-32768),pt<e.width-1&&dt>0&&o[(dt-1)*e.width+pt+1]===0&&e.getBitXY(pt+1,dt-1)===lt&&(nt++,_[nt&s]=pt+1,$[nt&s]=dt-1,o[(dt-1)*e.width+pt+1]=-32768),pt>0&&dt<e.height-1&&o[(dt+1)*e.width+pt-1]===0&&e.getBitXY(pt-1,dt+1)===lt&&(nt++,_[nt&s]=pt-1,$[nt&s]=dt+1,o[(dt+1)*e.width+pt-1]=-32768),pt<e.width-1&&dt<e.height-1&&o[(dt+1)*e.width+pt+1]===0&&e.getBitXY(pt+1,dt+1)===lt&&(nt++,_[nt&s]=pt+1,$[nt&s]=dt+1,o[(dt+1)*e.width+pt+1]=-32768)),at++,nt-at>s)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new RoiMap(e,o)}var DisjointSet_1,hasRequiredDisjointSet;function requireDisjointSet(){if(hasRequiredDisjointSet)return DisjointSet_1;hasRequiredDisjointSet=1;class e{constructor(){this.nodes=new Map}add(s){var o=this.nodes.get(s);return o||(o=new i(s),this.nodes.set(s,o)),o}union(s,o){const h=this.find(s),g=this.find(o);h!==g&&(h.rank<g.rank?h.parent=g:h.rank>g.rank?g.parent=h:(g.parent=h,h.rank++))}find(s){for(var o=s;o.parent!==null;)o=o.parent;for(var h=s;h.parent!==null;){var g=h;h=h.parent,g.parent=o}return o}connected(s,o){return this.find(s)===this.find(o)}}DisjointSet_1=e;function i(a){this.value=a,this.parent=null,this.rank=0}return DisjointSet_1}var DisjointSetExports=requireDisjointSet();const DisjointSet=getDefaultExportFromCjs(DisjointSetExports),direction4X=[-1,0],direction4Y=[0,-1],neighbours4=[null,null],direction8X=[-1,-1,0,1],direction8Y=[0,-1,-1,-1],neighbours8=[null,null,null,null];function fromMaskConnectedComponentLabelingAlgorithm(e,i={}){const{allowCorners:a=!1}=i;let s=4;a&&(s=8);let o,h,g;if(s===8)o=direction8X,h=direction8Y,g=neighbours8;else if(s===4)o=direction4X,h=direction4Y,g=neighbours4;else throw new RangeError(`unsupported neighbours count: ${s}`);const _=e.size,$=e.width,b=e.height,tt=new Array(_),st=new Uint32Array(_),at=new DisjointSet;let nt=1;for(let lt=0;lt<b;lt++)for(let ft=0;ft<$;ft++){const pt=ft+lt*$;if(e.getBit(pt)){let dt=null;for(let _t=0;_t<g.length;_t++){const ut=ft+o[_t],mt=lt+h[_t];if(ut>=0&&mt>=0&&ut<$&&mt<b){const kt=ut+mt*$;let bt=tt[kt];bt?(g[_t]=bt,(!dt||g[_t].value<dt.value)&&(dt=g[_t])):g[_t]=null}}if(!dt)tt[pt]=at.add(nt++);else{tt[pt]=dt;for(let _t=0;_t<g.length;_t++)g[_t]&&g[_t]!==dt&&at.union(dt,g[_t])}}}for(let lt=0;lt<b;lt++)for(let ft=0;ft<$;ft++){const pt=ft+lt*$;e.getBit(pt)&&(st[pt]=at.find(tt[pt]).value)}return new RoiMap(e,st)}function fromMaxima(e={}){let{allowCorner:i=!0,onlyTop:a=!1,invert:s=!1}=e,o=this;o.checkProcessable("fromMaxima",{components:[1]});const h=1,g=2;let _=0,$=0,b=new Int16Array(o.size),tt=new Int8Array(o.size),st=new Float32Array(o.size),at=1048575,nt=new Uint16Array(at+1),lt=new Uint16Array(at+1),ft=0,pt=0,dt=new Uint16Array(at+1),_t=new Uint16Array(at+1),ut=0,mt=0;for(kt(o);ft<pt;){let Et=nt[ft&at],Mt=lt[ft&at];vt(Et,Mt,g),ft++}return new RoiMap(o,b);function kt({maxima:Et=!0}){for(let Mt=1;Mt<o.height-1;Mt++)for(let At=1;At<o.width-1;At++){let zt=At+Mt*o.width;if(tt[zt]===0){let Vt=Et?o.data[zt]:-o.data[At+Mt*o.width];if(o.data[Mt*o.width+At-1]>Vt||o.data[Mt*o.width+At+1]>Vt||o.data[(Mt-1)*o.width+At]>Vt||o.data[(Mt+1)*o.width+At]>Vt||i&&(o.data[(Mt-1)*o.width+At-1]>Vt||o.data[(Mt-1)*o.width+At+1]>Vt||o.data[(Mt+1)*o.width+At-1]>Vt||o.data[(Mt+1)*o.width+At+1]>Vt))continue;b[zt]=Et?++_:--$,bt(At,Mt)||(Et?--_:++$)}}}function bt(Et,Mt){let At=pt;ut=0,mt=1,dt[0]=Et,_t[0]=Mt;let zt=!0;for(;ut<mt;){let Vt=dt[ut&at],Gt=_t[ut&at];zt&=vt(Vt,Gt,h),ut++}if(!zt){for(let Vt=0;Vt<mt;Vt++){let Gt=dt[Vt&at],Kt=_t[Vt&at]*o.width+Gt;b[Kt]=0}pt=At}return zt}function vt(Et,Mt,At){let zt=b[Mt*o.width+Et],Vt=o.data[Mt*o.width+Et];for(let Gt=Mt-1;Gt<=Mt+1;Gt++)for(let Kt=Et-1;Kt<=Et+1;Kt++){let Wt=Gt*o.width+Kt;if(tt[Wt]===0)switch(tt[Wt]=1,st[Wt]=o.data[Wt]-Vt,At){case h:if(st[Wt]===0){if(Kt===0||Gt===0||Kt===o.width-1||Gt===o.height-1)return!1;b[Wt]=zt,dt[mt&at]=Kt,_t[mt&at]=Gt,mt++}else{if(st[Wt]>0)return!1;a||(b[Wt]=zt,nt[pt&at]=Kt,lt[pt&at]=Gt,pt++)}break;case g:st[Wt]<=0&&(b[Wt]=zt,nt[pt&at]=Kt,lt[pt&at]=Gt,pt++);break;default:throw new Error("unreachable")}}return!0}}function fromPoints(e,i={}){let a=new Shape(i),s=new Int16Array(this.size),o=0,h=a.getPoints();for(let g=0;g<e.length;g++){o++;let _=e[g][0],$=e[g][1];for(let b=0;b<h.length;b++){let tt=h[b][0],st=h[b][1];_+tt>=0&&$+st>=0&&_+tt<this.width&&$+st<this.height&&(s[_+tt+($+st)*this.width]=o)}}return new RoiMap(this,s)}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var priorityQueue={exports:{}},hasRequiredPriorityQueue;function requirePriorityQueue(){return hasRequiredPriorityQueue||(hasRequiredPriorityQueue=1,function(e,i){(function(a){e.exports=a()})(function(){return function a(s,o,h){function g(b,tt){if(!o[b]){if(!s[b]){var st=typeof commonjsRequire=="function"&&commonjsRequire;if(!tt&&st)return st(b,!0);if(_)return _(b,!0);var at=new Error("Cannot find module '"+b+"'");throw at.code="MODULE_NOT_FOUND",at}var nt=o[b]={exports:{}};s[b][0].call(nt.exports,function(lt){var ft=s[b][1][lt];return g(ft||lt)},nt,nt.exports,a,s,o,h)}return o[b].exports}for(var _=typeof commonjsRequire=="function"&&commonjsRequire,$=0;$<h.length;$++)g(h[$]);return g}({1:[function(a,s,o){var h,g,_,$,b,tt=function(at,nt){for(var lt in nt)st.call(nt,lt)&&(at[lt]=nt[lt]);function ft(){this.constructor=at}return ft.prototype=nt.prototype,at.prototype=new ft,at.__super__=nt.prototype,at},st={}.hasOwnProperty;h=a("./PriorityQueue/AbstractPriorityQueue"),g=a("./PriorityQueue/ArrayStrategy"),$=a("./PriorityQueue/BinaryHeapStrategy"),_=a("./PriorityQueue/BHeapStrategy"),b=function(at){tt(nt,at);function nt(lt){lt||(lt={}),lt.strategy||(lt.strategy=$),lt.comparator||(lt.comparator=function(ft,pt){return(ft||0)-(pt||0)}),nt.__super__.constructor.call(this,lt)}return nt}(h),b.ArrayStrategy=g,b.BinaryHeapStrategy=$,b.BHeapStrategy=_,s.exports=b},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(a,s,o){s.exports=function(){function h(g){var _;if((g!=null?g.strategy:void 0)==null)throw"Must pass options.strategy, a strategy";if((g!=null?g.comparator:void 0)==null)throw"Must pass options.comparator, a comparator";this.priv=new g.strategy(g),this.length=(g!=null&&(_=g.initialValues)!=null?_.length:void 0)||0}return h.prototype.queue=function(g){this.length++,this.priv.queue(g)},h.prototype.dequeue=function(g){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},h.prototype.peek=function(g){if(!this.length)throw"Empty queue";return this.priv.peek()},h.prototype.clear=function(){return this.length=0,this.priv.clear()},h}()},{}],3:[function(a,s,o){var h;h=function(g,_,$){var b,tt,st;for(tt=0,b=g.length;tt<b;)st=tt+b>>>1,$(g[st],_)>=0?tt=st+1:b=st;return tt},s.exports=function(){function g(_){var $;this.options=_,this.comparator=this.options.comparator,this.data=(($=this.options.initialValues)!=null?$.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return g.prototype.queue=function(_){var $;$=h(this.data,_,this.comparator),this.data.splice($,0,_)},g.prototype.dequeue=function(){return this.data.pop()},g.prototype.peek=function(){return this.data[this.data.length-1]},g.prototype.clear=function(){this.data.length=0},g}()},{}],4:[function(a,s,o){s.exports=function(){function h(g){var _,$,b,tt,st,at,nt,lt;for(this.comparator=(g!=null?g.comparator:void 0)||function(ft,pt){return ft-pt},this.pageSize=(g!=null?g.pageSize:void 0)||512,this.length=0,nt=0;1<<nt<this.pageSize;)nt+=1;if(1<<nt!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=nt,this._emptyMemoryPageTemplate=_=[],$=0,st=this.pageSize;0<=st?$<st:$>st;0<=st?++$:--$)_.push(null);if(this._memory=[],this._mask=this.pageSize-1,g.initialValues)for(at=g.initialValues,b=0,tt=at.length;b<tt;b++)lt=at[b],this.queue(lt)}return h.prototype.queue=function(g){this.length+=1,this._write(this.length,g),this._bubbleUp(this.length,g)},h.prototype.dequeue=function(){var g,_;return g=this._read(1),_=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,_),this._bubbleDown(1,_)),g},h.prototype.peek=function(){return this._read(1)},h.prototype.clear=function(){this.length=0,this._memory.length=0},h.prototype._write=function(g,_){var $;for($=g>>this._shift;$>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[$][g&this._mask]=_},h.prototype._read=function(g){return this._memory[g>>this._shift][g&this._mask]},h.prototype._bubbleUp=function(g,_){var $,b,tt,st;for($=this.comparator;g>1&&(b=g&this._mask,g<this.pageSize||b>3?tt=g&~this._mask|b>>1:b<2?(tt=g-this.pageSize>>this._shift,tt+=tt&~(this._mask>>1),tt|=this.pageSize>>1):tt=g-2,st=this._read(tt),!($(st,_)<0));)this._write(tt,_),this._write(g,st),g=tt},h.prototype._bubbleDown=function(g,_){var $,b,tt,st,at;for(at=this.comparator;g<this.length;)if(g>this._mask&&!(g&this._mask-1)?$=b=g+2:g&this.pageSize>>1?($=(g&~this._mask)>>1,$|=g&this._mask>>1,$=$+1<<this._shift,b=$+1):($=g+(g&this._mask),b=$+1),$!==b&&b<=this.length)if(tt=this._read($),st=this._read(b),at(tt,_)<0&&at(tt,st)<=0)this._write($,_),this._write(g,tt),g=$;else if(at(st,_)<0)this._write(b,_),this._write(g,st),g=b;else break;else if($<=this.length)if(tt=this._read($),at(tt,_)<0)this._write($,_),this._write(g,tt),g=$;else break;else break},h}()},{}],5:[function(a,s,o){s.exports=function(){function h(g){var _;this.comparator=(g!=null?g.comparator:void 0)||function($,b){return $-b},this.length=0,this.data=((_=g.initialValues)!=null?_.slice(0):void 0)||[],this._heapify()}return h.prototype._heapify=function(){var g,_,$;if(this.data.length>0)for(g=_=1,$=this.data.length;1<=$?_<$:_>$;g=1<=$?++_:--_)this._bubbleUp(g)},h.prototype.queue=function(g){this.data.push(g),this._bubbleUp(this.data.length-1)},h.prototype.dequeue=function(){var g,_;return _=this.data[0],g=this.data.pop(),this.data.length>0&&(this.data[0]=g,this._bubbleDown(0)),_},h.prototype.peek=function(){return this.data[0]},h.prototype.clear=function(){this.length=0,this.data.length=0},h.prototype._bubbleUp=function(g){for(var _,$;g>0&&(_=g-1>>>1,this.comparator(this.data[g],this.data[_])<0);)$=this.data[_],this.data[_]=this.data[g],this.data[g]=$,g=_},h.prototype._bubbleDown=function(g){var _,$,b,tt,st;for(_=this.data.length-1;$=(g<<1)+1,tt=$+1,b=g,$<=_&&this.comparator(this.data[$],this.data[b])<0&&(b=$),tt<=_&&this.comparator(this.data[tt],this.data[b])<0&&(b=tt),b!==g;)st=this.data[b],this.data[b]=this.data[g],this.data[g]=st,g=b},h}()},{}]},{},[1])(1)})}(priorityQueue)),priorityQueue.exports}var priorityQueueExports=requirePriorityQueue();const PriorityQueue=getDefaultExportFromCjs(priorityQueueExports),dxs=[1,0,-1,0,1,1,-1,-1],dys=[0,1,0,-1,1,-1,1,-1];function fromWaterShed(e={}){let{points:i,mask:a,image:s,fillMaxValue:o=this.maxValue,invert:h=!1}=e,g=s||this;g.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),h=!h,i||(i=g.getLocalMaxima({invert:h,mask:a}));let _=h?0:1,$=new Int16Array(g.size),b=g.width,tt=g.height,st=new PriorityQueue({comparator:(at,nt)=>at[2]-nt[2],strategy:PriorityQueue.BinaryHeapStrategy});for(let at=0;at<i.length;at++){let nt=i[at][0]+i[at][1]*b;$[nt]=at+1;let lt=g.data[nt];(h&&lt<=o||!h&&lt>=o)&&st.queue([i[at][0],i[at][1],lt])}for(;st.length>0;){let at=st.dequeue(),nt=at[0]+at[1]*b;for(let lt=0;lt<4;lt++){let ft=at[0]+dxs[lt],pt=at[1]+dys[lt];if(ft>=0&&pt>=0&&ft<b&&pt<tt){let dt=ft+pt*b;if(!a||a.getBit(dt)===_){let _t=g.data[dt];(h&&_t<=o||!h&&_t>=o)&&$[dt]===0&&($[dt]=$[nt],st.queue([at[0]+dxs[lt],at[1]+dys[lt],_t]))}}}}return new RoiMap(g,$)}class RoiManager{constructor(i,a={}){this._image=i,this._options=a,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(i={}){let a=Object.assign({},this._options,i),s=fromMaxima.call(this._image,i);this._layers[a.label]=new RoiLayer(s,a)}fromPoints(i,a={}){let s=Object.assign({},this._options,a),o=fromPoints.call(this._image,i,a);return this._layers[s.label]=new RoiLayer(o,s),this}putMap(i,a={}){let s=new RoiMap(this._image,i),o=Object.assign({},this._options,a);return this._layers[o.label]=new RoiLayer(s,o),this}fromWaterShed(i={}){let a=Object.assign({},this._options,i),s=fromWaterShed.call(this._image,i);this._layers[a.label]=new RoiLayer(s,a)}fromMask(i,a={}){let s=Object.assign({},this._options,a),o=fromMask.call(this._image,i,a);return this._layers[s.label]=new RoiLayer(o,s),this}fromMaskConnectedComponentLabelingAlgorithm(i,a={}){let s=Object.assign({},this._options,a),o=fromMaskConnectedComponentLabelingAlgorithm.call(this._image,i,a);return this._layers[s.label]=new RoiLayer(o,s),this}getMap(i={}){let a=Object.assign({},this._options,i);return this._assertLayerWithLabel(a.label),this._layers[a.label].roiMap}rowsInfo(i={}){return this.getMap(i).rowsInfo()}colsInfo(i={}){return this.getMap(i).rowsInfo()}getRoiIds(i={}){let a=this.getRois(i);if(a){let s=new Array(a.length);for(let o=0;o<a.length;o++)s[o]=a[o].id;return s}throw new Error("ROIs not found")}getRois(i={}){let{label:a=this._options.label,positive:s=!0,negative:o=!0,minSurface:h=0,maxSurface:g=Number.POSITIVE_INFINITY,minWidth:_=0,maxWidth:$=Number.POSITIVE_INFINITY,minHeight:b=0,maxHeight:tt=Number.POSITIVE_INFINITY,minRatio:st=0,maxRatio:at=Number.POSITIVE_INFINITY}=i;if(!this._layers[a])throw new Error(`this Roi layer (${a}) does not exist`);const nt=this._layers[a].roi,lt=[];for(const ft of nt)(ft.id<0&&o||ft.id>0&&s)&&ft.surface>=h&&ft.surface<=g&&ft.width>=_&&ft.width<=$&&ft.height>=b&&ft.height<=tt&&ft.ratio>=st&&ft.ratio<=at&&lt.push(ft);return lt}getRoi(i,a={}){const{label:s=this._options.label}=a;if(!this._layers[s])throw new Error(`this Roi layer (${s}) does not exist`);const o=this._layers[s].roi.find(h=>h.id===i);if(!o)throw new Error(`found no Roi with id ${i}`);return o}getMasks(i={}){let a=this.getRois(i),s=new Array(a.length);for(let o=0;o<a.length;o++)s[o]=a[o].getMask(i);return s}getAnalysisMasks(i={}){const{analysisProperty:a}=i;let s=`${a}Mask`,o=this.getRois(i);return o.length===0||!o[0][s]?[]:o.map(h=>h[s])}getData(i={}){let a=Object.assign({},this._options,i);return this._assertLayerWithLabel(a.label),this._layers[a.label].roiMap.data}paint(i={}){let{labelProperty:a,analysisProperty:s}=i;this._painted||(this._painted=this._image.rgba8());let o=this.getMasks(i);if(a){const h=this.getRois(i);i.labels=h.map(b=>deepValue(b,a));const g=Math.max(...i.labels);let _=!1,$=!1;if(a.includes("surface")?_=!0:/(?:perimeter|min|max|external|width|height|length)/.test(a)&&($=!0),isFinite(g)){let b="";if(i.unit!=="pixel"&&i.pixelSize&&($||_)){b=_?`${i.unit}^2`:i.unit;let tt=_?"m^2":"m",st=_?i.pixelSize**2:i.pixelSize;const at=Qty.swiftConverter(tt,b);i.labels=i.labels.map(nt=>at(st*nt))}g>50?i.labels=i.labels.map(tt=>Math.round(tt)+b):g>10?i.labels=i.labels.map(tt=>tt.toFixed(1)+b):i.labels=i.labels.map(tt=>tt.toFixed(2)+b)}i.labelsPosition=h.map(b=>[b.meanX,b.meanY])}if(this._painted.paintMasks(o,i),s){let h=this.getAnalysisMasks(i);this._painted.paintMasks(h,{color:i.analysisColor,alpha:i.analysisAlpha})}return this._painted}getMask(i={}){let a=new Image$1(this._image.width,this._image.height,{kind:"BINARY"}),s=this.getMasks(i);for(let o=0;o<s.length;o++){let h=s[o];for(let g=0;g<h.width;g++)for(let _=0;_<h.height;_++)h.getBitXY(g,_)&&a.setBitXY(g+h.position[0],_+h.position[1])}return a}resetPainted(i={}){const{image:a}=i;a?this._painted=this.image.rgba8():this._painted=this._image.rgba8()}mergeRoi(i={}){const a=this.getMap(i);return a.mergeRoi(i),this.putMap(a.data,i),this}mergeRois(i,a={}){if(!Array.isArray(i)||i.some(o=>!Number.isInteger(o)))throw new Error("Roi ids must be an array of integers");if(i.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(i).size!==i.length)throw new Error("Roi ids must be all different");i.forEach(o=>this.getRoi(o));const s=this.getMap(a);return s.mergeRois(i),this.putMap(s.data,a),this}findCorrespondingRoi(i,a={}){let s=this.getRois(a),o=[];for(let h=0;h<s.length;h++){let g=s[h],_=g.minX,$=g.minY,b=g.points,tt=Math.sign(g.id),st=correspondingRoisInformation(_,$,b,i,tt);o.push(st)}return o}_assertLayerWithLabel(i){if(!this._layers[i])throw new Error(`no layer with label ${i}`)}}function correspondingRoisInformation(e,i,a,s,o){let h={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let g=0;g<a.length;g++){let _=a[g],$=_[0],b=_[1],tt=$+e+(b+i)*s.width,st=s.data[tt];(st>0||st<0)&&(h.id.includes(st)?h.surface[h.id.indexOf(st)]+=1:(h.id.push(st),h.surface.push(1)))}for(let g=0;g<h.id.length;g++)Math.sign(h.id[g])===o?h.same+=h.surface[g]:h.opposite+=h.surface[g],h.roiSurfaceCovered[g]=h.surface[g]/a.length;return h.total=h.opposite+h.same,h}const objectToString=Object.prototype.toString;let Image$1=class Rs{constructor(i,a,s,o){if(arguments.length===1?(o=i,{width:i,height:a,data:s}=o):s&&!s.length&&(o=s,{data:s}=o),i===void 0&&(i=1),a===void 0&&(a=1),o===void 0&&(o={}),typeof o!="object"||o===null)throw new TypeError("options must be an object");if(!Number.isInteger(i)||i<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(a)||a<=0)throw new RangeError("height must be a positive integer");const{kind:h=RGBA}=o;if(typeof h!="string")throw new TypeError("kind must be a string");const g=getKind(h),_=Object.assign({},o);for(const ft in g)_[ft]===void 0&&(_[ft]=g[ft]);verifyKindDefinition(_);const{components:$,bitDepth:b,colorModel:tt}=_,st=_.alpha+0,at=i*a,nt=$+st,lt=b===32?Number.MAX_VALUE:2**b-1;if(s===void 0)s=createPixelArray(at,$,st,nt,b,lt);else{const ft=getTheoreticalPixelArraySize(at,nt,b);if(s.length!==ft)throw new RangeError(`incorrect data size: ${s.length}. Should be ${ft}`)}this.width=i,this.height=a,this.data=s,this.size=at,this.components=$,this.alpha=st,this.bitDepth=b,this.maxValue=lt,this.colorModel=tt,this.channels=nt,this.meta=o.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:o.parent||null}),this.position=o.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(i){return objectToString.call(i)==="[object IJSImage]"}static fromCanvas(i){const a=i.getContext("2d").getImageData(0,0,i.width,i.height);return new Rs(a.width,a.height,a.data)}static createFrom(i,a){const s=getImageParameters(i);return Object.assign(s,{parent:i,position:[0,0]},a),new Rs(s)}getRoiManager(i){return new RoiManager(this,i)}clone(){const i=this.data.slice();return new Rs(this.width,this.height,i,this)}apply(i){for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++){let o=(a*this.width+s)*this.channels;i.call(this,o)}}};setValueMethods(Image$1);setBitMethods(Image$1);setExportMethods(Image$1);Image$1.prototype.checkProcessable=checkProcessable;Image$1.prototype.getRGBAData=getRGBAData;Image$1.load=load;Image$1.extendMethod=extendMethod;Image$1.extendProperty=extendProperty;extend$1(Image$1);var workerTemplate={},hasRequiredWorkerTemplate;function requireWorkerTemplate(){if(hasRequiredWorkerTemplate)return workerTemplate;hasRequiredWorkerTemplate=1;var e=function(){self.window=self;function a(){this._listeners={}}a.prototype.on=function(o,h){if(this._listeners[o])throw new RangeError("there is already a listener for "+o);if(typeof h!="function")throw new TypeError("callback argument must be a function");this._listeners[o]=h},a.prototype._send=function(o,h,g){g===void 0?g=[]:Array.isArray(g)||(g=[g]),self.postMessage({id:o,data:h},g)},a.prototype._trigger=function(o,h){if(!this._listeners[o])throw new Error("event "+o+" is not defined");this._listeners[o].apply(null,h)};var s=new a;self.onmessage=function(o){switch(o.data.action){case"exec":o.data.args.unshift(function(h,g){s._send(o.data.id,h,g)}),s._trigger(o.data.event,o.data.args);break;case"ping":s._send(o.data.id,"pong");break;default:throw new Error("unexpected action: "+o.data.action)}}},i=e.toString().split('"CODE";');return workerTemplate.newWorkerURL=function(a,s){var o=new Blob(["(",i[0],"importScripts.apply(self, "+JSON.stringify(s)+`);
`,"(",a,")();",i[1],")();"],{type:"application/javascript"});return URL.createObjectURL(o)},workerTemplate}var src,hasRequiredSrc;function requireSrc(){if(hasRequiredSrc)return src;hasRequiredSrc=1;var e=requireWorkerTemplate(),i=navigator.hardwareConcurrency||1;function a(s,o){if(typeof s!="string"&&typeof s!="function")throw new TypeError("func argument must be a function");if(o===void 0&&(o={}),typeof o!="object"||o===null)throw new TypeError("options argument must be an object");this._workerCode=s.toString(),o.maxWorkers===void 0||o.maxWorkers==="auto"?this._numWorkers=Math.min(i-1,1):o.maxWorkers>0?this._numWorkers=Math.min(o.maxWorkers,i):this._numWorkers=i,this._workers=new Map,this._timeout=o.timeout||0,this._terminateOnError=!!o.terminateOnError;var h=o.deps;typeof h=="string"&&(h=[h]),Array.isArray(h)||(h=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(h)}return a.prototype._init=function(s){for(var o=e.newWorkerURL(this._workerCode,s),h=0;h<this._numWorkers;h++){var g=new Worker(o);g.onmessage=this._onmessage.bind(this,g),g.onerror=this._onerror.bind(this,g),g.running=!1,g.id=h,this._workers.set(g,null)}URL.revokeObjectURL(o)},a.prototype._onerror=function(s,o){if(!this._terminated){this._working--,s.running=!1;var h=this._workers.get(s);h&&h[1](o.message),this._workers.set(s,null),this._terminateOnError?this.terminate():this._exec()}},a.prototype._onmessage=function(s,o){if(!this._terminated){this._working--,s.running=!1;var h=this._workers.get(s);h&&h[0](o.data.data),this._workers.set(s,null),this._exec()}},a.prototype._exec=function(){for(var s of this._workers.keys()){if(this._working===this._numWorkers||this._waiting.length===0)return;if(!s.running)for(var o=0;o<this._waiting.length;o++){var h=this._waiting[o];if(!(typeof h[4]=="number"&&h[4]!==s.id)){this._waiting.splice(o,1),s.postMessage({action:"exec",event:h[0],args:h[1]},h[2]),s.running=!0,s.time=Date.now(),this._workers.set(s,h[3]),this._working++;break}}}},a.prototype.terminate=function(){if(!this._terminated){for(var s of this._workers)s[0].terminate(),s[1]&&s[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},a.prototype.postAll=function(s,o){if(this._terminated)throw new Error("Cannot post (terminated)");var h=[];for(var g of this._workers.keys())h.push(this.post(s,o,[],g.id));return Promise.all(h)},a.prototype.post=function(s,o,h,g){o===void 0&&(o=[]),h===void 0&&(h=[]),Array.isArray(o)||(o=[o]),Array.isArray(h)||(h=[h]);var _=this;return new Promise(function($,b){if(_._terminated)throw new Error("Cannot post (terminated)");_._waiting.push([s,o,h,[$,b],g]),_._exec()})},src=a,src}var srcExports=requireSrc();const WorkerManager=getDefaultExportFromCjs(srcExports),defaultOptions={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function run(e,i,a){i=Object.assign({},defaultOptions,i);const s=this.manager;return Array.isArray(e)?Promise.all(e.map(function(o){const h=runOnce(s,o,i);return typeof a=="function"&&h.then(a),h})):runOnce(s,e,i)}function runOnce(e,i,a){return e.post("data",[i,a]).then(function(s){for(let o in s)s[o]=new Image$1(s[o]);return s})}function work(){worker.on("data",function(e,i,a){i=new IJS(i);const s={},o=[],h=i.grey(),g=h.sobelFilter();nt("sobel",g);const _=g.level().mask({threshold:a.threshold});nt("mask",_);const $=g.getRoiManager();$.fromMask(_);const b=$.getMask(a.roi);nt("realMask",b);const tt=h.getPixelsGrid({sampling:a.sampling,mask:b}),st=i.getBackground(tt.xyS,tt.zS,a.regression);nt("background",st);const at=i.subtract(st);s.result=at,o.push(at.data.buffer),e(s,o);function nt(lt,ft){a.include.includes(lt)&&(s[lt]=ft,o.push(ft.data.buffer))}})}const background={run,work};function extend(e){e.extendMethod("background",background)}let Worker$1=class Uo{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(this._url===null)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(i){if(typeof i!="string")throw new TypeError("worker URL must be a string");this._url=i,this._deps[0]=i}static extendMethod(i,a){let s,o,h={};function g(..._){return s||(this.checkUrl(),o=this.url,s=new WorkerManager(a.work,{deps:o}),h.manager=s),a.run.call(h,..._)}g.reset=function(){s&&(s.terminate(),s=new WorkerManager(a.work,{deps:o}),h.manager=s)},Uo.prototype[i]=g}};extend(Worker$1);var lz4$1={},xxh32={},util={},hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,util.hashU32=function(e){return e=e|0,e=e+2127912214+(e<<12)|0,e=e^-949894596^e>>>19,e=e+374761393+(e<<5)|0,e=e+-744332180^e<<9,e=e+-42973499+(e<<3)|0,e^-1252372727^e>>>16|0},util.readU64=function(e,i){var a=0;return a|=e[i++]<<0,a|=e[i++]<<8,a|=e[i++]<<16,a|=e[i++]<<24,a|=e[i++]<<32,a|=e[i++]<<40,a|=e[i++]<<48,a|=e[i++]<<56,a},util.readU32=function(e,i){var a=0;return a|=e[i++]<<0,a|=e[i++]<<8,a|=e[i++]<<16,a|=e[i++]<<24,a},util.writeU32=function(e,i,a){e[i++]=a>>0&255,e[i++]=a>>8&255,e[i++]=a>>16&255,e[i++]=a>>24&255},util.imul=function(e,i){var a=e>>>16,s=e&65535,o=i>>>16,h=i&65535;return s*h+(a*h+s*o<<16)|0}),util}var hasRequiredXxh32;function requireXxh32(){if(hasRequiredXxh32)return xxh32;hasRequiredXxh32=1;var e=requireUtil(),i=2654435761,a=2246822519,s=3266489917,o=668265263,h=374761393;function g(lt,ft){return lt=lt|0,ft=ft|0,lt>>>(32-ft|0)|lt<<ft|0}function _(lt,ft,pt){return lt=lt|0,ft=ft|0,pt=pt|0,e.imul(lt>>>(32-ft|0)|lt<<ft,pt)|0}function $(lt,ft){return lt=lt|0,ft=ft|0,lt>>>ft^lt|0}function b(lt,ft,pt,dt,_t){return _(e.imul(ft,pt)+lt,dt,_t)}function tt(lt,ft,pt){return _(lt+e.imul(ft[pt],h),11,i)}function st(lt,ft,pt){return b(lt,e.readU32(ft,pt),s,17,o)}function at(lt,ft,pt){return[b(lt[0],e.readU32(ft,pt+0),a,13,i),b(lt[1],e.readU32(ft,pt+4),a,13,i),b(lt[2],e.readU32(ft,pt+8),a,13,i),b(lt[3],e.readU32(ft,pt+12),a,13,i)]}function nt(lt,ft,pt,dt){var _t,ut;if(ut=dt,dt>=16){for(_t=[lt+i+a,lt+a,lt,lt-i];dt>=16;)_t=at(_t,ft,pt),pt+=16,dt-=16;_t=g(_t[0],1)+g(_t[1],7)+g(_t[2],12)+g(_t[3],18)+ut}else _t=lt+h+dt>>>0;for(;dt>=4;)_t=st(_t,ft,pt),pt+=4,dt-=4;for(;dt>0;)_t=tt(_t,ft,pt),pt++,dt--;return _t=$(e.imul($(e.imul($(_t,15),a),13),s),16),_t>>>0}return xxh32.hash=nt,xxh32}var hasRequiredLz4;function requireLz4(){return hasRequiredLz4||(hasRequiredLz4=1,function(e){var i=requireXxh32(),a=requireUtil(),s=4,o=13,h=5,g=6,_=65536,$=4,b=(1<<$)-1,tt=4,st=(1<<tt)-1,at=zt(5<<20),nt=Mt(),lt=407708164,ft=4,pt=8,dt=16,_t=64,ut=192,mt=2147483648,kt=7,bt=4,vt=7,Et={4:65536,5:262144,6:1048576,7:4194304};function Mt(){try{return new Uint32Array(_)}catch{for(var Gt=new Array(_),Kt=0;Kt<_;Kt++)Gt[Kt]=0;return Gt}}function At(Gt){for(var Kt=0;Kt<_;Kt++)nt[Kt]=0}function zt(Gt){try{return new Uint8Array(Gt)}catch{for(var Kt=new Array(Gt),Wt=0;Wt<Gt;Wt++)Kt[Wt]=0;return Kt}}function Vt(Gt,Kt,Wt){if(typeof Gt.buffer!==void 0){if(Uint8Array.prototype.slice)return Gt.slice(Kt,Wt);var sn=Gt.length;Kt=Kt|0,Kt=Kt<0?Math.max(sn+Kt,0):Math.min(Kt,sn),Wt=Wt===void 0?sn:Wt|0,Wt=Wt<0?Math.max(sn+Wt,0):Math.min(Wt,sn);for(var on=new Uint8Array(Wt-Kt),Xt=Kt,ln=0;Xt<Wt;)on[ln++]=Gt[Xt++];return on}else return Gt.slice(Kt,Wt)}e.compressBound=function(Gt){return Gt+Gt/255+16|0},e.decompressBound=function(Gt){var Kt=0;if(a.readU32(Gt,Kt)!==lt)throw new Error("invalid magic number");Kt+=4;var Wt=Gt[Kt++];if((Wt&ut)!==_t)throw new Error("incompatible descriptor version "+(Wt&ut));var sn=(Wt&dt)!==0,on=(Wt&pt)!==0,Xt=Gt[Kt++]>>bt&vt;if(Et[Xt]===void 0)throw new Error("invalid block size "+Xt);var ln=Et[Xt];if(on)return a.readU64(Gt,Kt);Kt++;for(var nn=0;;){var gn=a.readU32(Gt,Kt);if(Kt+=4,gn&mt?(gn&=2147483647,nn+=gn):nn+=ln,gn===0)return nn;sn&&(Kt+=4),Kt+=gn}},e.makeBuffer=zt,e.decompressBlock=function(Gt,Kt,Wt,sn,on){var Xt,ln,nn,gn,dn;for(nn=Wt+sn;Wt<nn;){var $n=Gt[Wt++],En=$n>>4;if(En>0){if(En===15)for(;En+=Gt[Wt],Gt[Wt++]===255;);for(gn=Wt+En;Wt<gn;)Kt[on++]=Gt[Wt++]}if(Wt>=nn)break;if(Xt=$n&15,ln=Gt[Wt++]|Gt[Wt++]<<8,Xt===15)for(;Xt+=Gt[Wt],Gt[Wt++]===255;);for(Xt+=s,dn=on-ln,gn=dn+Xt;dn<gn;)Kt[on++]=Kt[dn++]|0}return on},e.compressBlock=function(Gt,Kt,Wt,sn,on){var Xt,ln,nn,gn,dn,$n,En,qt,en;if(En=0,qt=sn+Wt,ln=Wt,sn>=o)for(var Tn=(1<<g)+3;Wt+s<qt-h;){var Sn=a.readU32(Gt,Wt),fn=a.hashU32(Sn)>>>0;if(fn=(fn>>16^fn)>>>0&65535,Xt=on[fn]-1,on[fn]=Wt+1,Xt<0||Wt-Xt>>>16>0||a.readU32(Gt,Xt)!==Sn){dn=Tn++>>g,Wt+=dn;continue}for(Tn=(1<<g)+3,$n=Wt-ln,gn=Wt-Xt,Wt+=s,Xt+=s,nn=Wt;Wt<qt-h&&Gt[Wt]===Gt[Xt];)Wt++,Xt++;nn=Wt-nn;var Wn=nn<b?nn:b;if($n>=st){for(Kt[En++]=(st<<$)+Wn,en=$n-st;en>=255;en-=255)Kt[En++]=255;Kt[En++]=en}else Kt[En++]=($n<<$)+Wn;for(var Zn=0;Zn<$n;Zn++)Kt[En++]=Gt[ln+Zn];if(Kt[En++]=gn,Kt[En++]=gn>>8,nn>=b){for(en=nn-b;en>=255;en-=255)Kt[En++]=255;Kt[En++]=en}ln=Wt}if(ln===0)return 0;if($n=qt-ln,$n>=st){for(Kt[En++]=st<<$,en=$n-st;en>=255;en-=255)Kt[En++]=255;Kt[En++]=en}else Kt[En++]=$n<<$;for(Wt=ln;Wt<qt;)Kt[En++]=Gt[Wt++];return En},e.decompressFrame=function(Gt,Kt){var Wt,sn,on,Xt,ln=0,nn=0;if(a.readU32(Gt,ln)!==lt)throw new Error("invalid magic number");if(ln+=4,Xt=Gt[ln++],(Xt&ut)!==_t)throw new Error("incompatible descriptor version");Wt=(Xt&dt)!==0,sn=(Xt&ft)!==0,on=(Xt&pt)!==0;var gn=Gt[ln++]>>bt&vt;if(Et[gn]===void 0)throw new Error("invalid block size");for(on&&(ln+=8),ln++;;){var dn;if(dn=a.readU32(Gt,ln),ln+=4,dn===0)break;if(Wt&&(ln+=4),(dn&mt)!==0){dn&=2147483647;for(var $n=0;$n<dn;$n++)Kt[nn++]=Gt[ln++]}else nn=e.decompressBlock(Gt,Kt,ln,dn,nn),ln+=dn}return sn&&(ln+=4),nn},e.compressFrame=function(Gt,Kt){var Wt=0;a.writeU32(Kt,Wt,lt),Wt+=4,Kt[Wt++]=_t,Kt[Wt++]=kt<<bt,Kt[Wt]=i.hash(0,Kt,4,Wt-4)>>8,Wt++;var sn=Et[kt],on=Gt.length,Xt=0;for(At();on>0;){var ln=0,nn=on>sn?sn:on;if(ln=e.compressBlock(Gt,at,Xt,nn,nt),ln>nn||ln===0){a.writeU32(Kt,Wt,2147483648|nn),Wt+=4;for(var gn=Xt+nn;Xt<gn;)Kt[Wt++]=Gt[Xt++];on-=nn}else{a.writeU32(Kt,Wt,ln),Wt+=4;for(var dn=0;dn<ln;)Kt[Wt++]=at[dn++];Xt+=nn,on-=nn}}return a.writeU32(Kt,Wt,0),Wt+=4,Wt},e.decompress=function(Gt,Kt){var Wt,sn;return Kt===void 0&&(Kt=e.decompressBound(Gt)),Wt=e.makeBuffer(Kt),sn=e.decompressFrame(Gt,Wt),sn!==Kt&&(Wt=Vt(Wt,0,sn)),Wt},e.compress=function(Gt,Kt){var Wt,sn;return Kt===void 0&&(Kt=e.compressBound(Gt.length)),Wt=e.makeBuffer(Kt),sn=e.compressFrame(Gt,Wt),sn!==Kt&&(Wt=Vt(Wt,0,sn)),Wt}}(lz4$1)),lz4$1}var lz4Exports=requireLz4();const lz4=getDefaultExportFromCjs(lz4Exports);var __defProp=Object.defineProperty,__defNormalProp=(e,i,a)=>i in e?__defProp(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,__export=(e,i)=>{for(var a in i)__defProp(e,a,{get:i[a],enumerable:!0})},__publicField=(e,i,a)=>(__defNormalProp(e,typeof i!="symbol"?i+"":i,a),a),constants_exports={};__export(constants_exports,{bt709:()=>bt709_exports});var bt709_exports={};__export(bt709_exports,{Y:()=>Y,x:()=>x,y:()=>y});var Y=(e=>(e[e.RED=.2126]="RED",e[e.GREEN=.7152]="GREEN",e[e.BLUE=.0722]="BLUE",e[e.WHITE=1]="WHITE",e))(Y||{}),x=(e=>(e[e.RED=.64]="RED",e[e.GREEN=.3]="GREEN",e[e.BLUE=.15]="BLUE",e[e.WHITE=.3127]="WHITE",e))(x||{}),y=(e=>(e[e.RED=.33]="RED",e[e.GREEN=.6]="GREEN",e[e.BLUE=.06]="BLUE",e[e.WHITE=.329]="WHITE",e))(y||{}),conversion_exports={};__export(conversion_exports,{lab2rgb:()=>lab2rgb,lab2xyz:()=>lab2xyz,rgb2hsl:()=>rgb2hsl,rgb2lab:()=>rgb2lab,rgb2xyz:()=>rgb2xyz,xyz2lab:()=>xyz2lab,xyz2rgb:()=>xyz2rgb});function correctGamma(e){return e>.04045?((e+.055)/1.055)**2.4:e/12.92}function rgb2xyz(e,i,a){return e=correctGamma(e/255),i=correctGamma(i/255),a=correctGamma(a/255),{x:e*.4124+i*.3576+a*.1805,y:e*.2126+i*.7152+a*.0722,z:e*.0193+i*.1192+a*.9505}}var arithmetic_exports={};__export(arithmetic_exports,{degrees2radians:()=>degrees2radians,inRange0to255:()=>inRange0to255,inRange0to255Rounded:()=>inRange0to255Rounded,intInRange:()=>intInRange,max3:()=>max3,min3:()=>min3,stableSort:()=>stableSort});function degrees2radians(e){return e*(Math.PI/180)}function max3(e,i,a){let s=e;return s<i&&(s=i),s<a&&(s=a),s}function min3(e,i,a){let s=e;return s>i&&(s=i),s>a&&(s=a),s}function intInRange(e,i,a){return e>a&&(e=a),e<i&&(e=i),e|0}function inRange0to255Rounded(e){return e=Math.round(e),e>255?e=255:e<0&&(e=0),e}function inRange0to255(e){return e>255?e=255:e<0&&(e=0),e}function stableSort(e,i){const a=typeof e[0];let s;if(a==="number"||a==="string"){const o=Object.create(null);for(let h=0,g=e.length;h<g;h++){const _=e[h];o[_]||o[_]===0||(o[_]=h)}s=e.sort((h,g)=>i(h,g)||o[h]-o[g])}else{const o=e.slice(0);s=e.sort((h,g)=>i(h,g)||o.indexOf(h)-o.indexOf(g))}return s}function rgb2hsl(e,i,a){const s=min3(e,i,a),o=max3(e,i,a),h=o-s,g=(s+o)/510;let _=0;g>0&&g<1&&(_=h/(g<.5?o+s:510-o-s));let $=0;return h>0&&(o===e?$=(i-a)/h:o===i?$=2+(a-e)/h:$=4+(e-i)/h,$*=60,$<0&&($+=360)),{h:$,s:_,l:g}}var refX=.95047,refY=1,refZ=1.08883;function pivot(e){return e>.008856?e**(1/3):7.787*e+16/116}function xyz2lab(e,i,a){if(e=pivot(e/refX),i=pivot(i/refY),a=pivot(a/refZ),116*i-16<0)throw new Error("xxx");return{L:Math.max(0,116*i-16),a:500*(e-i),b:200*(i-a)}}function rgb2lab(e,i,a){const s=rgb2xyz(e,i,a);return xyz2lab(s.x,s.y,s.z)}var refX2=.95047,refY2=1,refZ2=1.08883;function pivot2(e){return e>.206893034?e**3:(e-16/116)/7.787}function lab2xyz(e,i,a){const s=(e+16)/116,o=i/500+s,h=s-a/200;return{x:refX2*pivot2(o),y:refY2*pivot2(s),z:refZ2*pivot2(h)}}function correctGamma2(e){return e>.0031308?1.055*e**(1/2.4)-.055:12.92*e}function xyz2rgb(e,i,a){const s=correctGamma2(e*3.2406+i*-1.5372+a*-.4986),o=correctGamma2(e*-.9689+i*1.8758+a*.0415),h=correctGamma2(e*.0557+i*-.204+a*1.057);return{r:inRange0to255Rounded(s*255),g:inRange0to255Rounded(o*255),b:inRange0to255Rounded(h*255)}}function lab2rgb(e,i,a){const s=lab2xyz(e,i,a);return xyz2rgb(s.x,s.y,s.z)}var distance_exports={};__export(distance_exports,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator,AbstractEuclidean:()=>AbstractEuclidean,AbstractManhattan:()=>AbstractManhattan,CIE94GraphicArts:()=>CIE94GraphicArts,CIE94Textiles:()=>CIE94Textiles,CIEDE2000:()=>CIEDE2000,CMetric:()=>CMetric,Euclidean:()=>Euclidean,EuclideanBT709:()=>EuclideanBT709,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha,Manhattan:()=>Manhattan,ManhattanBT709:()=>ManhattanBT709,ManhattanNommyde:()=>ManhattanNommyde,PNGQuant:()=>PNGQuant});var AbstractDistanceCalculator=class{constructor(){__publicField(this,"_maxDistance"),__publicField(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(e,i,a,s){this._whitePoint={r:e>0?255/e:0,g:i>0?255/i:0,b:a>0?255/a:0,a:s>0?255/s:0},this._maxDistance=this.calculateRaw(e,i,a,s,0,0,0,0)}calculateNormalized(e,i){return this.calculateRaw(e.r,e.g,e.b,e.a,i.r,i.g,i.b,i.a)/this._maxDistance}},AbstractCIE94=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,g,_){const $=rgb2lab(inRange0to255(e*this._whitePoint.r),inRange0to255(i*this._whitePoint.g),inRange0to255(a*this._whitePoint.b)),b=rgb2lab(inRange0to255(o*this._whitePoint.r),inRange0to255(h*this._whitePoint.g),inRange0to255(g*this._whitePoint.b)),tt=$.L-b.L,st=$.a-b.a,at=$.b-b.b,nt=Math.sqrt($.a*$.a+$.b*$.b),lt=Math.sqrt(b.a*b.a+b.b*b.b),ft=nt-lt;let pt=st*st+at*at-ft*ft;pt=pt<0?0:Math.sqrt(pt);const dt=(_-s)*this._whitePoint.a*this._kA;return Math.sqrt((tt/this._Kl)**2+(ft/(1+this._K1*nt))**2+(pt/(1+this._K2*nt))**2+dt**2)}},CIE94Textiles=class extends AbstractCIE94{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=.25*50/255}},CIE94GraphicArts=class extends AbstractCIE94{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=.25*100/255}},_CIEDE2000=class extends AbstractDistanceCalculator{_setDefaults(){}static _calculatehp(e,i){const a=Math.atan2(e,i);return a>=0?a:a+_CIEDE2000._deg360InRad}static _calculateRT(e,i){const a=i**7,s=2*Math.sqrt(a/(a+_CIEDE2000._pow25to7)),o=_CIEDE2000._deg30InRad*Math.exp(-(((e-_CIEDE2000._deg275InRad)/_CIEDE2000._deg25InRad)**2));return-Math.sin(2*o)*s}static _calculateT(e){return 1-.17*Math.cos(e-_CIEDE2000._deg30InRad)+.24*Math.cos(e*2)+.32*Math.cos(e*3+_CIEDE2000._deg6InRad)-.2*Math.cos(e*4-_CIEDE2000._deg63InRad)}static _calculate_ahp(e,i,a,s){const o=a+s;return e===0?o:i<=_CIEDE2000._deg180InRad?o/2:o<_CIEDE2000._deg360InRad?(o+_CIEDE2000._deg360InRad)/2:(o-_CIEDE2000._deg360InRad)/2}static _calculate_dHp(e,i,a,s){let o;return e===0?o=0:i<=_CIEDE2000._deg180InRad?o=a-s:a<=s?o=a-s+_CIEDE2000._deg360InRad:o=a-s-_CIEDE2000._deg360InRad,2*Math.sqrt(e)*Math.sin(o/2)}calculateRaw(e,i,a,s,o,h,g,_){const $=rgb2lab(inRange0to255(e*this._whitePoint.r),inRange0to255(i*this._whitePoint.g),inRange0to255(a*this._whitePoint.b)),b=rgb2lab(inRange0to255(o*this._whitePoint.r),inRange0to255(h*this._whitePoint.g),inRange0to255(g*this._whitePoint.b)),tt=(_-s)*this._whitePoint.a*_CIEDE2000._kA,st=this.calculateRawInLab($,b);return Math.sqrt(st+tt*tt)}calculateRawInLab(e,i){const a=e.L,s=e.a,o=e.b,h=i.L,g=i.a,_=i.b,$=Math.sqrt(s*s+o*o),b=Math.sqrt(g*g+_*_),tt=(($+b)/2)**7,st=.5*(1-Math.sqrt(tt/(tt+_CIEDE2000._pow25to7))),at=(1+st)*s,nt=(1+st)*g,lt=Math.sqrt(at*at+o*o),ft=Math.sqrt(nt*nt+_*_),pt=lt*ft,dt=_CIEDE2000._calculatehp(o,at),_t=_CIEDE2000._calculatehp(_,nt),ut=Math.abs(dt-_t),mt=h-a,kt=ft-lt,bt=_CIEDE2000._calculate_dHp(pt,ut,_t,dt),vt=_CIEDE2000._calculate_ahp(pt,ut,dt,_t),Et=_CIEDE2000._calculateT(vt),Mt=(lt+ft)/2,At=((a+h)/2-50)**2,zt=1+.015*At/Math.sqrt(20+At),Vt=1+.045*Mt,Gt=1+.015*Et*Mt,Kt=_CIEDE2000._calculateRT(vt,Mt),Wt=mt/zt,sn=kt/Vt,on=bt/Gt;return Wt**2+sn**2+on**2+Kt*sn*on}},CIEDE2000=_CIEDE2000;__publicField(CIEDE2000,"_kA",.25*100/255);__publicField(CIEDE2000,"_pow25to7",25**7);__publicField(CIEDE2000,"_deg360InRad",degrees2radians(360));__publicField(CIEDE2000,"_deg180InRad",degrees2radians(180));__publicField(CIEDE2000,"_deg30InRad",degrees2radians(30));__publicField(CIEDE2000,"_deg6InRad",degrees2radians(6));__publicField(CIEDE2000,"_deg63InRad",degrees2radians(63));__publicField(CIEDE2000,"_deg275InRad",degrees2radians(275));__publicField(CIEDE2000,"_deg25InRad",degrees2radians(25));var CMetric=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,g,_){const $=(e+o)/2*this._whitePoint.r,b=(e-o)*this._whitePoint.r,tt=(i-h)*this._whitePoint.g,st=(a-g)*this._whitePoint.b,at=((512+$)*b*b>>8)+4*tt*tt+((767-$)*st*st>>8),nt=(_-s)*this._whitePoint.a;return Math.sqrt(at+nt*nt)}_setDefaults(){}},AbstractEuclidean=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,g,_){const $=o-e,b=h-i,tt=g-a,st=_-s;return Math.sqrt(this._kR*$*$+this._kG*b*b+this._kB*tt*tt+this._kA*st*st)}},Euclidean=class extends AbstractEuclidean{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,g,_){let $=o-e,b=h-i,tt=g-a,st=_-s;return $<0&&($=0-$),b<0&&(b=0-b),tt<0&&(tt=0-tt),st<0&&(st=0-st),this._kR*$+this._kG*b+this._kB*tt+this._kA*st}},Manhattan=class extends AbstractManhattan{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde=class extends AbstractManhattan{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709=class extends AbstractManhattan{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,g,_){const $=(_-s)*this._whitePoint.a;return this._colordifferenceCh(e*this._whitePoint.r,o*this._whitePoint.r,$)+this._colordifferenceCh(i*this._whitePoint.g,h*this._whitePoint.g,$)+this._colordifferenceCh(a*this._whitePoint.b,g*this._whitePoint.b,$)}_colordifferenceCh(e,i,a){const s=e-i,o=s+a;return s*s+o*o}_setDefaults(){}},palette_exports={};__export(palette_exports,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer,ColorHistogram:()=>ColorHistogram,NeuQuant:()=>NeuQuant,NeuQuantFloat:()=>NeuQuantFloat,RGBQuant:()=>RGBQuant,WuColorCube:()=>WuColorCube,WuQuant:()=>WuQuant});var AbstractPaletteQuantizer=class{quantizeSync(){for(const e of this.quantize())if(e.palette)return e.palette;throw new Error("unreachable")}},Point=class{constructor(){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),__publicField(this,"uint32"),__publicField(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(e){const i=new Point;return i.r=e[0]|0,i.g=e[1]|0,i.b=e[2]|0,i.a=e[3]|0,i._loadUINT32(),i._loadQuadruplet(),i}static createByRGBA(e,i,a,s){const o=new Point;return o.r=e|0,o.g=i|0,o.b=a|0,o.a=s|0,o._loadUINT32(),o._loadQuadruplet(),o}static createByUint32(e){const i=new Point;return i.uint32=e>>>0,i._loadRGBA(),i._loadQuadruplet(),i}from(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this.uint32=e.uint32,this.rgba[0]=e.r,this.rgba[1]=e.g,this.rgba[2]=e.b,this.rgba[3]=e.a}getLuminosity(e){let i=this.r,a=this.g,s=this.b;return e&&(i=Math.min(255,255-this.a+this.a*i/255),a=Math.min(255,255-this.a+this.a*a/255),s=Math.min(255,255-this.a+this.a*s/255)),i*.2126+a*.7152+s*.0722}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=this.uint32&255,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer=class{constructor(){__publicField(this,"_pointArray"),__publicField(this,"_width"),__publicField(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(e){this._width=e}setHeight(e){this._height=e}getPointArray(){return this._pointArray}clone(){const e=new PointContainer;e._width=this._width,e._height=this._height;for(let i=0,a=this._pointArray.length;i<a;i++)e._pointArray[i]=Point.createByUint32(this._pointArray[i].uint32|0);return e}toUint32Array(){const e=this._pointArray.length,i=new Uint32Array(e);for(let a=0;a<e;a++)i[a]=this._pointArray[a].uint32;return i}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(e){const i=e.naturalWidth,a=e.naturalHeight,s=document.createElement("canvas");return s.width=i,s.height=a,s.getContext("2d").drawImage(e,0,0,i,a,0,0,i,a),PointContainer.fromHTMLCanvasElement(s)}static fromHTMLCanvasElement(e){const i=e.width,a=e.height,s=e.getContext("2d").getImageData(0,0,i,a);return PointContainer.fromImageData(s)}static fromImageData(e){const i=e.width,a=e.height;return PointContainer.fromUint8Array(e.data,i,a)}static fromUint8Array(e,i,a){switch(Object.prototype.toString.call(e)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:e=new Uint8Array(e)}const s=new Uint32Array(e.buffer);return PointContainer.fromUint32Array(s,i,a)}static fromUint32Array(e,i,a){const s=new PointContainer;s._width=i,s._height=a;for(let o=0,h=e.length;o<h;o++)s._pointArray[o]=Point.createByUint32(e[o]|0);return s}static fromBuffer(e,i,a){const s=new Uint32Array(e.buffer,e.byteOffset,e.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer.fromUint32Array(s,i,a)}},hueGroups=10;function hueGroup(e,i){const a=360/i,s=a/2;for(let o=1,h=a-s;o<i;o++,h+=a)if(e>=h&&e<h+a)return o;return 0}var Palette=class{constructor(){__publicField(this,"_pointContainer"),__publicField(this,"_pointArray",[]),__publicField(this,"_i32idx",{}),this._pointContainer=new PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(e){this._pointArray.push(e),this._pointContainer.setWidth(this._pointArray.length)}has(e){for(let i=this._pointArray.length-1;i>=0;i--)if(e.uint32===this._pointArray[i].uint32)return!0;return!1}getNearestColor(e,i){return this._pointArray[this._getNearestIndex(e,i)|0]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(e){return typeof this._i32idx[e]=="number"?this._i32idx[e]:-1}_getNearestIndex(e,i){let a=this._nearestPointFromCache(""+i.uint32);if(a>=0)return a;let s=Number.MAX_VALUE;a=0;for(let o=0,h=this._pointArray.length;o<h;o++){const g=this._pointArray[o],_=e.calculateRaw(i.r,i.g,i.b,i.a,g.r,g.g,g.b,g.a);_<s&&(s=_,a=o)}return this._i32idx[i.uint32]=a,a}sort(){this._i32idx={},this._pointArray.sort((e,i)=>{const a=rgb2hsl(e.r,e.g,e.b),s=rgb2hsl(i.r,i.g,i.b),o=e.r===e.g&&e.g===e.b?0:1+hueGroup(a.h,hueGroups),h=(i.r===i.g&&i.g===i.b?0:1+hueGroup(s.h,hueGroups))-o;if(h)return-h;const g=e.getLuminosity(!0),_=i.getLuminosity(!0);if(_-g!==0)return _-g;const $=(s.s*100|0)-(a.s*100|0);return $?-$:0})}},utils_exports={};__export(utils_exports,{HueStatistics:()=>HueStatistics,Palette:()=>Palette,Point:()=>Point,PointContainer:()=>PointContainer,ProgressTracker:()=>ProgressTracker,arithmetic:()=>arithmetic_exports});var HueGroup=class{constructor(){__publicField(this,"num",0),__publicField(this,"cols",[])}},HueStatistics=class{constructor(e,i){__publicField(this,"_numGroups"),__publicField(this,"_minCols"),__publicField(this,"_stats"),__publicField(this,"_groupsFull"),this._numGroups=e,this._minCols=i,this._stats=[];for(let a=0;a<=e;a++)this._stats[a]=new HueGroup;this._groupsFull=0}check(e){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const i=e&255,a=e>>>8&255,s=e>>>16&255,o=i===a&&a===s?0:1+hueGroup(rgb2hsl(i,a,s).h,this._numGroups),h=this._stats[o],g=this._minCols;h.num++,!(h.num>g)&&(h.num===g&&this._groupsFull++,h.num<=g&&this._stats[o].cols.push(e))}injectIntoDictionary(e){for(let i=0;i<=this._numGroups;i++)this._stats[i].num<=this._minCols&&this._stats[i].cols.forEach(a=>{e[a]?e[a]++:e[a]=1})}injectIntoArray(e){for(let i=0;i<=this._numGroups;i++)this._stats[i].num<=this._minCols&&this._stats[i].cols.forEach(a=>{e.indexOf(a)===-1&&e.push(a)})}},_ProgressTracker=class{constructor(e,i){__publicField(this,"progress"),__publicField(this,"_step"),__publicField(this,"_range"),__publicField(this,"_last"),__publicField(this,"_progressRange"),this._range=e,this._progressRange=i,this._step=Math.max(1,this._range/(_ProgressTracker.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(e){return e-this._last>=this._step?(this._last=e,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0):!1}},ProgressTracker=_ProgressTracker;__publicField(ProgressTracker,"steps",100);var networkBiasShift=3,Neuron=class{constructor(e){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=e}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift,this.g>>networkBiasShift,this.b>>networkBiasShift,this.a>>networkBiasShift)}subtract(e,i,a,s){this.r-=e|0,this.g-=i|0,this.b-=a|0,this.a-=s|0}},_NeuQuant=class extends AbstractPaletteQuantizer{constructor(e,i=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=e,this._pointArray=[],this._sampleFactor=1,this._networkSize=i,this._distance.setWhitePoint(255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift)}sample(e){this._pointArray=this._pointArray.concat(e.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let e=0;e<this._networkSize;e++)this._network[e]=new Neuron((e<<networkBiasShift+8)/this._networkSize|0),this._freq[e]=_NeuQuant._initialBias/this._networkSize|0,this._bias[e]=0}*_learn(){let e=this._sampleFactor;const i=this._pointArray.length;i<_NeuQuant._minpicturebytes&&(e=1);const a=30+(e-1)/3|0,s=i/e|0;let o=s/_NeuQuant._nCycles|0,h=_NeuQuant._initAlpha,g=(this._networkSize>>3)*_NeuQuant._radiusBias,_=g>>_NeuQuant._radiusBiasShift;_<=1&&(_=0);for(let tt=0;tt<_;tt++)this._radPower[tt]=h*((_*_-tt*tt)*_NeuQuant._radBias/(_*_))>>>0;let $;i<_NeuQuant._minpicturebytes?$=1:i%_NeuQuant._prime1!==0?$=_NeuQuant._prime1:i%_NeuQuant._prime2!==0?$=_NeuQuant._prime2:i%_NeuQuant._prime3!==0?$=_NeuQuant._prime3:$=_NeuQuant._prime4;const b=new ProgressTracker(s,99);for(let tt=0,st=0;tt<s;){b.shouldNotify(tt)&&(yield{progress:b.progress});const at=this._pointArray[st],nt=at.b<<networkBiasShift,lt=at.g<<networkBiasShift,ft=at.r<<networkBiasShift,pt=at.a<<networkBiasShift,dt=this._contest(nt,lt,ft,pt);if(this._alterSingle(h,dt,nt,lt,ft,pt),_!==0&&this._alterNeighbour(_,dt,nt,lt,ft,pt),st+=$,st>=i&&(st-=i),tt++,o===0&&(o=1),tt%o===0){h-=h/a|0,g-=g/_NeuQuant._radiusDecrease|0,_=g>>_NeuQuant._radiusBiasShift,_<=1&&(_=0);for(let _t=0;_t<_;_t++)this._radPower[_t]=h*((_*_-_t*_t)*_NeuQuant._radBias/(_*_))>>>0}}}_buildPalette(){const e=new Palette;return this._network.forEach(i=>{e.add(i.toPoint())}),e.sort(),e}_alterNeighbour(e,i,a,s,o,h){let g=i-e;g<-1&&(g=-1);let _=i+e;_>this._networkSize&&(_=this._networkSize);let $=i+1,b=i-1,tt=1;for(;$<_||b>g;){const st=this._radPower[tt++]/_NeuQuant._alphaRadBias;if($<_){const at=this._network[$++];at.subtract(st*(at.r-o),st*(at.g-s),st*(at.b-a),st*(at.a-h))}if(b>g){const at=this._network[b--];at.subtract(st*(at.r-o),st*(at.g-s),st*(at.b-a),st*(at.a-h))}}}_alterSingle(e,i,a,s,o,h){e/=_NeuQuant._initAlpha;const g=this._network[i];g.subtract(e*(g.r-o),e*(g.g-s),e*(g.b-a),e*(g.a-h))}_contest(e,i,a,s){const o=1020<<networkBiasShift;let h=2147483647,g=h,_=-1,$=_;for(let b=0;b<this._networkSize;b++){const tt=this._network[b],st=this._distance.calculateNormalized(tt,{r:a,g:i,b:e,a:s})*o|0;st<h&&(h=st,_=b);const at=st-(this._bias[b]>>_NeuQuant._initialBiasShift-networkBiasShift);at<g&&(g=at,$=b);const nt=this._freq[b]>>_NeuQuant._betaShift;this._freq[b]-=nt,this._bias[b]+=nt<<_NeuQuant._gammaShift}return this._freq[_]+=_NeuQuant._beta,this._bias[_]-=_NeuQuant._betaGamma,$}},NeuQuant=_NeuQuant;__publicField(NeuQuant,"_prime1",499);__publicField(NeuQuant,"_prime2",491);__publicField(NeuQuant,"_prime3",487);__publicField(NeuQuant,"_prime4",503);__publicField(NeuQuant,"_minpicturebytes",_NeuQuant._prime4);__publicField(NeuQuant,"_nCycles",100);__publicField(NeuQuant,"_initialBiasShift",16);__publicField(NeuQuant,"_initialBias",1<<_NeuQuant._initialBiasShift);__publicField(NeuQuant,"_gammaShift",10);__publicField(NeuQuant,"_betaShift",10);__publicField(NeuQuant,"_beta",_NeuQuant._initialBias>>_NeuQuant._betaShift);__publicField(NeuQuant,"_betaGamma",_NeuQuant._initialBias<<_NeuQuant._gammaShift-_NeuQuant._betaShift);__publicField(NeuQuant,"_radiusBiasShift",6);__publicField(NeuQuant,"_radiusBias",1<<_NeuQuant._radiusBiasShift);__publicField(NeuQuant,"_radiusDecrease",30);__publicField(NeuQuant,"_alphaBiasShift",10);__publicField(NeuQuant,"_initAlpha",1<<_NeuQuant._alphaBiasShift);__publicField(NeuQuant,"_radBiasShift",8);__publicField(NeuQuant,"_radBias",1<<_NeuQuant._radBiasShift);__publicField(NeuQuant,"_alphaRadBiasShift",_NeuQuant._alphaBiasShift+_NeuQuant._radBiasShift);__publicField(NeuQuant,"_alphaRadBias",1<<_NeuQuant._alphaRadBiasShift);var networkBiasShift2=3,NeuronFloat=class{constructor(e){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=e}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift2,this.g>>networkBiasShift2,this.b>>networkBiasShift2,this.a>>networkBiasShift2)}subtract(e,i,a,s){this.r-=e,this.g-=i,this.b-=a,this.a-=s}},_NeuQuantFloat=class extends AbstractPaletteQuantizer{constructor(e,i=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=e,this._pointArray=[],this._sampleFactor=1,this._networkSize=i,this._distance.setWhitePoint(255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2)}sample(e){this._pointArray=this._pointArray.concat(e.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let e=0;e<this._networkSize;e++)this._network[e]=new NeuronFloat((e<<networkBiasShift2+8)/this._networkSize),this._freq[e]=_NeuQuantFloat._initialBias/this._networkSize,this._bias[e]=0}*_learn(){let e=this._sampleFactor;const i=this._pointArray.length;i<_NeuQuantFloat._minpicturebytes&&(e=1);const a=30+(e-1)/3,s=i/e;let o=s/_NeuQuantFloat._nCycles|0,h=_NeuQuantFloat._initAlpha,g=(this._networkSize>>3)*_NeuQuantFloat._radiusBias,_=g>>_NeuQuantFloat._radiusBiasShift;_<=1&&(_=0);for(let tt=0;tt<_;tt++)this._radPower[tt]=h*((_*_-tt*tt)*_NeuQuantFloat._radBias/(_*_));let $;i<_NeuQuantFloat._minpicturebytes?$=1:i%_NeuQuantFloat._prime1!==0?$=_NeuQuantFloat._prime1:i%_NeuQuantFloat._prime2!==0?$=_NeuQuantFloat._prime2:i%_NeuQuantFloat._prime3!==0?$=_NeuQuantFloat._prime3:$=_NeuQuantFloat._prime4;const b=new ProgressTracker(s,99);for(let tt=0,st=0;tt<s;){b.shouldNotify(tt)&&(yield{progress:b.progress});const at=this._pointArray[st],nt=at.b<<networkBiasShift2,lt=at.g<<networkBiasShift2,ft=at.r<<networkBiasShift2,pt=at.a<<networkBiasShift2,dt=this._contest(nt,lt,ft,pt);if(this._alterSingle(h,dt,nt,lt,ft,pt),_!==0&&this._alterNeighbour(_,dt,nt,lt,ft,pt),st+=$,st>=i&&(st-=i),tt++,o===0&&(o=1),tt%o===0){h-=h/a,g-=g/_NeuQuantFloat._radiusDecrease,_=g>>_NeuQuantFloat._radiusBiasShift,_<=1&&(_=0);for(let _t=0;_t<_;_t++)this._radPower[_t]=h*((_*_-_t*_t)*_NeuQuantFloat._radBias/(_*_))}}}_buildPalette(){const e=new Palette;return this._network.forEach(i=>{e.add(i.toPoint())}),e.sort(),e}_alterNeighbour(e,i,a,s,o,h){let g=i-e;g<-1&&(g=-1);let _=i+e;_>this._networkSize&&(_=this._networkSize);let $=i+1,b=i-1,tt=1;for(;$<_||b>g;){const st=this._radPower[tt++]/_NeuQuantFloat._alphaRadBias;if($<_){const at=this._network[$++];at.subtract(st*(at.r-o),st*(at.g-s),st*(at.b-a),st*(at.a-h))}if(b>g){const at=this._network[b--];at.subtract(st*(at.r-o),st*(at.g-s),st*(at.b-a),st*(at.a-h))}}}_alterSingle(e,i,a,s,o,h){e/=_NeuQuantFloat._initAlpha;const g=this._network[i];g.subtract(e*(g.r-o),e*(g.g-s),e*(g.b-a),e*(g.a-h))}_contest(e,i,a,s){const o=1020<<networkBiasShift2;let h=2147483647,g=h,_=-1,$=_;for(let b=0;b<this._networkSize;b++){const tt=this._network[b],st=this._distance.calculateNormalized(tt,{r:a,g:i,b:e,a:s})*o;st<h&&(h=st,_=b);const at=st-(this._bias[b]>>_NeuQuantFloat._initialBiasShift-networkBiasShift2);at<g&&(g=at,$=b);const nt=this._freq[b]>>_NeuQuantFloat._betaShift;this._freq[b]-=nt,this._bias[b]+=nt<<_NeuQuantFloat._gammaShift}return this._freq[_]+=_NeuQuantFloat._beta,this._bias[_]-=_NeuQuantFloat._betaGamma,$}},NeuQuantFloat=_NeuQuantFloat;__publicField(NeuQuantFloat,"_prime1",499);__publicField(NeuQuantFloat,"_prime2",491);__publicField(NeuQuantFloat,"_prime3",487);__publicField(NeuQuantFloat,"_prime4",503);__publicField(NeuQuantFloat,"_minpicturebytes",_NeuQuantFloat._prime4);__publicField(NeuQuantFloat,"_nCycles",100);__publicField(NeuQuantFloat,"_initialBiasShift",16);__publicField(NeuQuantFloat,"_initialBias",1<<_NeuQuantFloat._initialBiasShift);__publicField(NeuQuantFloat,"_gammaShift",10);__publicField(NeuQuantFloat,"_betaShift",10);__publicField(NeuQuantFloat,"_beta",_NeuQuantFloat._initialBias>>_NeuQuantFloat._betaShift);__publicField(NeuQuantFloat,"_betaGamma",_NeuQuantFloat._initialBias<<_NeuQuantFloat._gammaShift-_NeuQuantFloat._betaShift);__publicField(NeuQuantFloat,"_radiusBiasShift",6);__publicField(NeuQuantFloat,"_radiusBias",1<<_NeuQuantFloat._radiusBiasShift);__publicField(NeuQuantFloat,"_radiusDecrease",30);__publicField(NeuQuantFloat,"_alphaBiasShift",10);__publicField(NeuQuantFloat,"_initAlpha",1<<_NeuQuantFloat._alphaBiasShift);__publicField(NeuQuantFloat,"_radBiasShift",8);__publicField(NeuQuantFloat,"_radBias",1<<_NeuQuantFloat._radBiasShift);__publicField(NeuQuantFloat,"_alphaRadBiasShift",_NeuQuantFloat._alphaBiasShift+_NeuQuantFloat._radBiasShift);__publicField(NeuQuantFloat,"_alphaRadBias",1<<_NeuQuantFloat._alphaRadBiasShift);var _ColorHistogram=class{constructor(e,i){__publicField(this,"_method"),__publicField(this,"_hueStats"),__publicField(this,"_histogram"),__publicField(this,"_initColors"),__publicField(this,"_minHueCols"),this._method=e,this._minHueCols=i<<2,this._initColors=i<<2,this._hueStats=new HueStatistics(_ColorHistogram._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(e){switch(this._method){case 1:this._colorStats1D(e);break;case 2:this._colorStats2D(e);break}}getImportanceSortedColorsIDXI32(){const e=stableSort(Object.keys(this._histogram),(a,s)=>this._histogram[s]-this._histogram[a]);if(e.length===0)return[];let i;switch(this._method){case 1:const a=Math.min(e.length,this._initColors),s=e[a-1],o=this._histogram[s];i=e.slice(0,a);let h=a;const g=e.length;for(;h<g&&this._histogram[e[h]]===o;)i.push(e[h++]);this._hueStats.injectIntoArray(i);break;case 2:i=e;break;default:throw new Error("Incorrect method")}return i.map(a=>+a)}_colorStats1D(e){const i=this._histogram,a=e.getPointArray(),s=a.length;for(let o=0;o<s;o++){const h=a[o].uint32;this._hueStats.check(h),h in i?i[h]++:i[h]=1}}_colorStats2D(e){const i=e.getWidth(),a=e.getHeight(),s=e.getPointArray(),o=_ColorHistogram._boxSize[0],h=_ColorHistogram._boxSize[1],g=o*h,_=this._makeBoxes(i,a,o,h),$=this._histogram;_.forEach(b=>{let tt=Math.round(b.w*b.h/g)*_ColorHistogram._boxPixels;tt<2&&(tt=2);const st={};this._iterateBox(b,i,at=>{const nt=s[at].uint32;this._hueStats.check(nt),nt in $?$[nt]++:nt in st?++st[nt]>=tt&&($[nt]=st[nt]):st[nt]=1})}),this._hueStats.injectIntoDictionary($)}_iterateBox(e,i,a){const s=e,o=s.y*i+s.x,h=(s.y+s.h-1)*i+(s.x+s.w-1),g=i-s.w+1;let _=0,$=o;do a.call(this,$),$+=++_%s.w===0?g:1;while($<=h)}_makeBoxes(e,i,a,s){const o=e%a,h=i%s,g=e-o,_=i-h,$=[];for(let b=0;b<i;b+=s)for(let tt=0;tt<e;tt+=a)$.push({x:tt,y:b,w:tt===g?o:a,h:b===_?h:s});return $}},ColorHistogram=_ColorHistogram;__publicField(ColorHistogram,"_boxSize",[64,64]);__publicField(ColorHistogram,"_boxPixels",2);__publicField(ColorHistogram,"_hueGroups",10);var RemovedColor=class{constructor(e,i,a){__publicField(this,"index"),__publicField(this,"color"),__publicField(this,"distance"),this.index=e,this.color=i,this.distance=a}},RGBQuant=class extends AbstractPaletteQuantizer{constructor(e,i=256,a=2){super(),__publicField(this,"_colors"),__publicField(this,"_initialDistance"),__publicField(this,"_distanceIncrement"),__publicField(this,"_histogram"),__publicField(this,"_distance"),this._distance=e,this._colors=i,this._histogram=new ColorHistogram(a,i),this._initialDistance=.01,this._distanceIncrement=.005}sample(e){this._histogram.sample(e)}*quantize(){const e=this._histogram.getImportanceSortedColorsIDXI32();if(e.length===0)throw new Error("No colors in image");yield*this._buildPalette(e)}*_buildPalette(e){const i=new Palette,a=i.getPointContainer().getPointArray(),s=new Array(e.length);for(let tt=0;tt<e.length;tt++)a.push(Point.createByUint32(e[tt])),s[tt]=1;const o=a.length,h=[];let g=o,_=this._initialDistance;const $=new ProgressTracker(g-this._colors,99);for(;g>this._colors;){h.length=0;for(let tt=0;tt<o;tt++){if($.shouldNotify(o-g)&&(yield{progress:$.progress}),s[tt]===0)continue;const st=a[tt];for(let at=tt+1;at<o;at++){if(s[at]===0)continue;const nt=a[at],lt=this._distance.calculateNormalized(st,nt);lt<_&&(h.push(new RemovedColor(at,nt,lt)),s[at]=0,g--)}}_+=g>this._colors*3?this._initialDistance:this._distanceIncrement}if(g<this._colors){stableSort(h,(st,at)=>at.distance-st.distance);let tt=0;for(;g<this._colors&&tt<h.length;){const st=h[tt];s[st.index]=1,g++,tt++}}let b=a.length;for(let tt=b-1;tt>=0;tt--)s[tt]===0&&(tt!==b-1&&(a[tt]=a[b-1]),--b);a.length=b,i.sort(),yield{palette:i,progress:100}}};function createArray1D(e){const i=[];for(let a=0;a<e;a++)i[a]=0;return i}function createArray4D(e,i,a,s){const o=new Array(e);for(let h=0;h<e;h++){o[h]=new Array(i);for(let g=0;g<i;g++){o[h][g]=new Array(a);for(let _=0;_<a;_++){o[h][g][_]=new Array(s);for(let $=0;$<s;$++)o[h][g][_][$]=0}}}return o}function createArray3D(e,i,a){const s=new Array(e);for(let o=0;o<e;o++){s[o]=new Array(i);for(let h=0;h<i;h++){s[o][h]=new Array(a);for(let g=0;g<a;g++)s[o][h][g]=0}}return s}function fillArray3D(e,i,a,s,o){for(let h=0;h<i;h++){e[h]=[];for(let g=0;g<a;g++){e[h][g]=[];for(let _=0;_<s;_++)e[h][g][_]=o}}}function fillArray1D(e,i,a){for(let s=0;s<i;s++)e[s]=a}var WuColorCube=class{constructor(){__publicField(this,"redMinimum"),__publicField(this,"redMaximum"),__publicField(this,"greenMinimum"),__publicField(this,"greenMaximum"),__publicField(this,"blueMinimum"),__publicField(this,"blueMaximum"),__publicField(this,"volume"),__publicField(this,"alphaMinimum"),__publicField(this,"alphaMaximum")}},_WuQuant=class extends AbstractPaletteQuantizer{constructor(e,i=256,a=5){super(),__publicField(this,"_reds"),__publicField(this,"_greens"),__publicField(this,"_blues"),__publicField(this,"_alphas"),__publicField(this,"_sums"),__publicField(this,"_weights"),__publicField(this,"_momentsRed"),__publicField(this,"_momentsGreen"),__publicField(this,"_momentsBlue"),__publicField(this,"_momentsAlpha"),__publicField(this,"_moments"),__publicField(this,"_table"),__publicField(this,"_pixels"),__publicField(this,"_cubes"),__publicField(this,"_colors"),__publicField(this,"_significantBitsPerChannel"),__publicField(this,"_maxSideIndex"),__publicField(this,"_alphaMaxSideIndex"),__publicField(this,"_sideSize"),__publicField(this,"_alphaSideSize"),__publicField(this,"_distance"),this._distance=e,this._setQuality(a),this._initialize(i)}sample(e){const i=e.getPointArray();for(let a=0,s=i.length;a<s;a++)this._addColor(i[a]);this._pixels=this._pixels.concat(i)}*quantize(){yield*this._preparePalette();const e=new Palette;for(let i=0;i<this._colors;i++)if(this._sums[i]>0){const a=this._sums[i],s=this._reds[i]/a,o=this._greens[i]/a,h=this._blues[i]/a,g=this._alphas[i]/a,_=Point.createByRGBA(s|0,o|0,h|0,g|0);e.add(_)}e.sort(),yield{palette:e,progress:100}}*_preparePalette(){yield*this._calculateMoments();let e=0;const i=createArray1D(this._colors);for(let g=1;g<this._colors;++g){this._cut(this._cubes[e],this._cubes[g])?(i[e]=this._cubes[e].volume>1?this._calculateVariance(this._cubes[e]):0,i[g]=this._cubes[g].volume>1?this._calculateVariance(this._cubes[g]):0):(i[e]=0,g--),e=0;let _=i[0];for(let $=1;$<=g;++$)i[$]>_&&(_=i[$],e=$);if(_<=0){this._colors=g+1;break}}const a=[],s=[],o=[],h=[];for(let g=0;g<this._colors;++g){const _=_WuQuant._volume(this._cubes[g],this._weights);_>0?(a[g]=_WuQuant._volume(this._cubes[g],this._momentsRed)/_|0,s[g]=_WuQuant._volume(this._cubes[g],this._momentsGreen)/_|0,o[g]=_WuQuant._volume(this._cubes[g],this._momentsBlue)/_|0,h[g]=_WuQuant._volume(this._cubes[g],this._momentsAlpha)/_|0):(a[g]=0,s[g]=0,o[g]=0,h[g]=0)}this._reds=createArray1D(this._colors+1),this._greens=createArray1D(this._colors+1),this._blues=createArray1D(this._colors+1),this._alphas=createArray1D(this._colors+1),this._sums=createArray1D(this._colors+1);for(let g=0,_=this._pixels.length;g<_;g++){const $=this._pixels[g];let b=-1,tt=Number.MAX_VALUE;for(let st=0;st<this._colors;st++){const at=a[st],nt=s[st],lt=o[st],ft=h[st],pt=this._distance.calculateRaw(at,nt,lt,ft,$.r,$.g,$.b,$.a);pt<tt&&(tt=pt,b=st)}this._reds[b]+=$.r,this._greens[b]+=$.g,this._blues[b]+=$.b,this._alphas[b]+=$.a,this._sums[b]++}}_addColor(e){const i=8-this._significantBitsPerChannel,a=(e.r>>i)+1,s=(e.g>>i)+1,o=(e.b>>i)+1,h=(e.a>>i)+1;this._weights[h][a][s][o]++,this._momentsRed[h][a][s][o]+=e.r,this._momentsGreen[h][a][s][o]+=e.g,this._momentsBlue[h][a][s][o]+=e.b,this._momentsAlpha[h][a][s][o]+=e.a,this._moments[h][a][s][o]+=this._table[e.r]+this._table[e.g]+this._table[e.b]+this._table[e.a]}*_calculateMoments(){const e=[],i=[],a=[],s=[],o=[],h=[],g=createArray3D(this._sideSize,this._sideSize,this._sideSize),_=createArray3D(this._sideSize,this._sideSize,this._sideSize),$=createArray3D(this._sideSize,this._sideSize,this._sideSize),b=createArray3D(this._sideSize,this._sideSize,this._sideSize),tt=createArray3D(this._sideSize,this._sideSize,this._sideSize),st=createArray3D(this._sideSize,this._sideSize,this._sideSize);let at=0;const nt=new ProgressTracker(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let lt=1;lt<=this._alphaMaxSideIndex;++lt){fillArray3D(g,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(_,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D($,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(b,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(tt,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(st,this._sideSize,this._sideSize,this._sideSize,0);for(let ft=1;ft<=this._maxSideIndex;++ft,++at){nt.shouldNotify(at)&&(yield{progress:nt.progress}),fillArray1D(e,this._sideSize,0),fillArray1D(i,this._sideSize,0),fillArray1D(a,this._sideSize,0),fillArray1D(s,this._sideSize,0),fillArray1D(o,this._sideSize,0),fillArray1D(h,this._sideSize,0);for(let pt=1;pt<=this._maxSideIndex;++pt){let dt=0,_t=0,ut=0,mt=0,kt=0,bt=0;for(let vt=1;vt<=this._maxSideIndex;++vt)dt+=this._weights[lt][ft][pt][vt],_t+=this._momentsRed[lt][ft][pt][vt],ut+=this._momentsGreen[lt][ft][pt][vt],mt+=this._momentsBlue[lt][ft][pt][vt],kt+=this._momentsAlpha[lt][ft][pt][vt],bt+=this._moments[lt][ft][pt][vt],e[vt]+=dt,i[vt]+=_t,a[vt]+=ut,s[vt]+=mt,o[vt]+=kt,h[vt]+=bt,g[ft][pt][vt]=g[ft-1][pt][vt]+e[vt],_[ft][pt][vt]=_[ft-1][pt][vt]+i[vt],$[ft][pt][vt]=$[ft-1][pt][vt]+a[vt],b[ft][pt][vt]=b[ft-1][pt][vt]+s[vt],tt[ft][pt][vt]=tt[ft-1][pt][vt]+o[vt],st[ft][pt][vt]=st[ft-1][pt][vt]+h[vt],this._weights[lt][ft][pt][vt]=this._weights[lt-1][ft][pt][vt]+g[ft][pt][vt],this._momentsRed[lt][ft][pt][vt]=this._momentsRed[lt-1][ft][pt][vt]+_[ft][pt][vt],this._momentsGreen[lt][ft][pt][vt]=this._momentsGreen[lt-1][ft][pt][vt]+$[ft][pt][vt],this._momentsBlue[lt][ft][pt][vt]=this._momentsBlue[lt-1][ft][pt][vt]+b[ft][pt][vt],this._momentsAlpha[lt][ft][pt][vt]=this._momentsAlpha[lt-1][ft][pt][vt]+tt[ft][pt][vt],this._moments[lt][ft][pt][vt]=this._moments[lt-1][ft][pt][vt]+st[ft][pt][vt]}}}}static _volumeFloat(e,i){return i[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMaximum]-i[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMaximum]-i[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMaximum]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]-i[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMaximum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(i[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMinimum]-i[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]-i[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]-i[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum])}static _volume(e,i){return _WuQuant._volumeFloat(e,i)|0}static _top(e,i,a,s){let o;switch(i){case _WuQuant._alpha:o=s[a][e.redMaximum][e.greenMaximum][e.blueMaximum]-s[a][e.redMaximum][e.greenMinimum][e.blueMaximum]-s[a][e.redMinimum][e.greenMaximum][e.blueMaximum]+s[a][e.redMinimum][e.greenMinimum][e.blueMaximum]-(s[a][e.redMaximum][e.greenMaximum][e.blueMinimum]-s[a][e.redMaximum][e.greenMinimum][e.blueMinimum]-s[a][e.redMinimum][e.greenMaximum][e.blueMinimum]+s[a][e.redMinimum][e.greenMinimum][e.blueMinimum]);break;case _WuQuant._red:o=s[e.alphaMaximum][a][e.greenMaximum][e.blueMaximum]-s[e.alphaMaximum][a][e.greenMinimum][e.blueMaximum]-s[e.alphaMinimum][a][e.greenMaximum][e.blueMaximum]+s[e.alphaMinimum][a][e.greenMinimum][e.blueMaximum]-(s[e.alphaMaximum][a][e.greenMaximum][e.blueMinimum]-s[e.alphaMaximum][a][e.greenMinimum][e.blueMinimum]-s[e.alphaMinimum][a][e.greenMaximum][e.blueMinimum]+s[e.alphaMinimum][a][e.greenMinimum][e.blueMinimum]);break;case _WuQuant._green:o=s[e.alphaMaximum][e.redMaximum][a][e.blueMaximum]-s[e.alphaMaximum][e.redMinimum][a][e.blueMaximum]-s[e.alphaMinimum][e.redMaximum][a][e.blueMaximum]+s[e.alphaMinimum][e.redMinimum][a][e.blueMaximum]-(s[e.alphaMaximum][e.redMaximum][a][e.blueMinimum]-s[e.alphaMaximum][e.redMinimum][a][e.blueMinimum]-s[e.alphaMinimum][e.redMaximum][a][e.blueMinimum]+s[e.alphaMinimum][e.redMinimum][a][e.blueMinimum]);break;case _WuQuant._blue:o=s[e.alphaMaximum][e.redMaximum][e.greenMaximum][a]-s[e.alphaMaximum][e.redMaximum][e.greenMinimum][a]-s[e.alphaMaximum][e.redMinimum][e.greenMaximum][a]+s[e.alphaMaximum][e.redMinimum][e.greenMinimum][a]-(s[e.alphaMinimum][e.redMaximum][e.greenMaximum][a]-s[e.alphaMinimum][e.redMaximum][e.greenMinimum][a]-s[e.alphaMinimum][e.redMinimum][e.greenMaximum][a]+s[e.alphaMinimum][e.redMinimum][e.greenMinimum][a]);break;default:throw new Error("impossible")}return o|0}static _bottom(e,i,a){switch(i){case _WuQuant._alpha:return-a[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMaximum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-a[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _WuQuant._red:return-a[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMaximum]+a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-a[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]+a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _WuQuant._green:return-a[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMaximum]+a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-a[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _WuQuant._blue:return-a[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMinimum]+a[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+a[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]-a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]-(-a[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);default:return 0}}_calculateVariance(e){const i=_WuQuant._volume(e,this._momentsRed),a=_WuQuant._volume(e,this._momentsGreen),s=_WuQuant._volume(e,this._momentsBlue),o=_WuQuant._volume(e,this._momentsAlpha),h=_WuQuant._volumeFloat(e,this._moments),g=_WuQuant._volume(e,this._weights),_=i*i+a*a+s*s+o*o;return h-_/g}_maximize(e,i,a,s,o,h,g,_,$){const b=_WuQuant._bottom(e,i,this._momentsRed)|0,tt=_WuQuant._bottom(e,i,this._momentsGreen)|0,st=_WuQuant._bottom(e,i,this._momentsBlue)|0,at=_WuQuant._bottom(e,i,this._momentsAlpha)|0,nt=_WuQuant._bottom(e,i,this._weights)|0;let lt=0,ft=-1;for(let pt=a;pt<s;++pt){let dt=b+_WuQuant._top(e,i,pt,this._momentsRed),_t=tt+_WuQuant._top(e,i,pt,this._momentsGreen),ut=st+_WuQuant._top(e,i,pt,this._momentsBlue),mt=at+_WuQuant._top(e,i,pt,this._momentsAlpha),kt=nt+_WuQuant._top(e,i,pt,this._weights);if(kt!==0){let bt=dt*dt+_t*_t+ut*ut+mt*mt,vt=bt/kt;dt=o-dt,_t=h-_t,ut=g-ut,mt=_-mt,kt=$-kt,kt!==0&&(bt=dt*dt+_t*_t+ut*ut+mt*mt,vt+=bt/kt,vt>lt&&(lt=vt,ft=pt))}}return{max:lt,position:ft}}_cut(e,i){let a;const s=_WuQuant._volume(e,this._momentsRed),o=_WuQuant._volume(e,this._momentsGreen),h=_WuQuant._volume(e,this._momentsBlue),g=_WuQuant._volume(e,this._momentsAlpha),_=_WuQuant._volume(e,this._weights),$=this._maximize(e,_WuQuant._red,e.redMinimum+1,e.redMaximum,s,o,h,g,_),b=this._maximize(e,_WuQuant._green,e.greenMinimum+1,e.greenMaximum,s,o,h,g,_),tt=this._maximize(e,_WuQuant._blue,e.blueMinimum+1,e.blueMaximum,s,o,h,g,_),st=this._maximize(e,_WuQuant._alpha,e.alphaMinimum+1,e.alphaMaximum,s,o,h,g,_);if(st.max>=$.max&&st.max>=b.max&&st.max>=tt.max){if(a=_WuQuant._alpha,st.position<0)return!1}else $.max>=st.max&&$.max>=b.max&&$.max>=tt.max?a=_WuQuant._red:b.max>=st.max&&b.max>=$.max&&b.max>=tt.max?a=_WuQuant._green:a=_WuQuant._blue;switch(i.redMaximum=e.redMaximum,i.greenMaximum=e.greenMaximum,i.blueMaximum=e.blueMaximum,i.alphaMaximum=e.alphaMaximum,a){case _WuQuant._red:i.redMinimum=e.redMaximum=$.position,i.greenMinimum=e.greenMinimum,i.blueMinimum=e.blueMinimum,i.alphaMinimum=e.alphaMinimum;break;case _WuQuant._green:i.greenMinimum=e.greenMaximum=b.position,i.redMinimum=e.redMinimum,i.blueMinimum=e.blueMinimum,i.alphaMinimum=e.alphaMinimum;break;case _WuQuant._blue:i.blueMinimum=e.blueMaximum=tt.position,i.redMinimum=e.redMinimum,i.greenMinimum=e.greenMinimum,i.alphaMinimum=e.alphaMinimum;break;case _WuQuant._alpha:i.alphaMinimum=e.alphaMaximum=st.position,i.blueMinimum=e.blueMinimum,i.redMinimum=e.redMinimum,i.greenMinimum=e.greenMinimum;break}return e.volume=(e.redMaximum-e.redMinimum)*(e.greenMaximum-e.greenMinimum)*(e.blueMaximum-e.blueMinimum)*(e.alphaMaximum-e.alphaMinimum),i.volume=(i.redMaximum-i.redMinimum)*(i.greenMaximum-i.greenMinimum)*(i.blueMaximum-i.blueMinimum)*(i.alphaMaximum-i.alphaMinimum),!0}_initialize(e){this._colors=e,this._cubes=[];for(let i=0;i<e;i++)this._cubes[i]=new WuColorCube;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let i=0;i<256;++i)this._table[i]=i*i;this._pixels=[]}_setQuality(e=5){this._significantBitsPerChannel=e,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant=_WuQuant;__publicField(WuQuant,"_alpha",3);__publicField(WuQuant,"_red",2);__publicField(WuQuant,"_green",1);__publicField(WuQuant,"_blue",0);var image_exports={};__export(image_exports,{AbstractImageQuantizer:()=>AbstractImageQuantizer,ErrorDiffusionArray:()=>ErrorDiffusionArray,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma,NearestColor:()=>NearestColor});var AbstractImageQuantizer=class{quantizeSync(e,i){for(const a of this.quantize(e,i))if(a.pointContainer)return a.pointContainer;throw new Error("unreachable")}},NearestColor=class extends AbstractImageQuantizer{constructor(e){super(),__publicField(this,"_distance"),this._distance=e}*quantize(e,i){const a=e.getPointArray(),s=e.getWidth(),o=e.getHeight(),h=new ProgressTracker(o,99);for(let g=0;g<o;g++){h.shouldNotify(g)&&(yield{progress:h.progress});for(let _=0,$=g*s;_<s;_++,$++){const b=a[$];b.from(i.getNearestColor(this._distance,b))}}yield{pointContainer:e,progress:100}}},ErrorDiffusionArrayKernel=(e=>(e[e.FloydSteinberg=0]="FloydSteinberg",e[e.FalseFloydSteinberg=1]="FalseFloydSteinberg",e[e.Stucki=2]="Stucki",e[e.Atkinson=3]="Atkinson",e[e.Jarvis=4]="Jarvis",e[e.Burkes=5]="Burkes",e[e.Sierra=6]="Sierra",e[e.TwoSierra=7]="TwoSierra",e[e.SierraLite=8]="SierraLite",e))(ErrorDiffusionArrayKernel||{}),ErrorDiffusionArray=class extends AbstractImageQuantizer{constructor(e,i,a=!0,s=0,o=!1){super(),__publicField(this,"_minColorDistance"),__publicField(this,"_serpentine"),__publicField(this,"_kernel"),__publicField(this,"_calculateErrorLikeGIMP"),__publicField(this,"_distance"),this._setKernel(i),this._distance=e,this._minColorDistance=s,this._serpentine=a,this._calculateErrorLikeGIMP=o}*quantize(e,i){const a=e.getPointArray(),s=new Point,o=e.getWidth(),h=e.getHeight(),g=[];let _=1,$=1;for(const tt of this._kernel){const st=tt[2]+1;$<st&&($=st)}for(let tt=0;tt<$;tt++)this._fillErrorLine(g[tt]=[],o);const b=new ProgressTracker(h,99);for(let tt=0;tt<h;tt++){b.shouldNotify(tt)&&(yield{progress:b.progress}),this._serpentine&&(_*=-1);const st=tt*o,at=_===1?0:o-1,nt=_===1?o:-1;this._fillErrorLine(g[0],o),g.push(g.shift());const lt=g[0];for(let ft=at,pt=st+at;ft!==nt;ft+=_,pt+=_){const dt=a[pt],_t=lt[ft];s.from(dt);const ut=Point.createByRGBA(inRange0to255Rounded(dt.r+_t[0]),inRange0to255Rounded(dt.g+_t[1]),inRange0to255Rounded(dt.b+_t[2]),inRange0to255Rounded(dt.a+_t[3])),mt=i.getNearestColor(this._distance,ut);if(dt.from(mt),this._minColorDistance&&this._distance.calculateNormalized(s,mt)<this._minColorDistance)continue;let kt,bt,vt,Et;this._calculateErrorLikeGIMP?(kt=ut.r-mt.r,bt=ut.g-mt.g,vt=ut.b-mt.b,Et=ut.a-mt.a):(kt=s.r-mt.r,bt=s.g-mt.g,vt=s.b-mt.b,Et=s.a-mt.a);const Mt=_===1?0:this._kernel.length-1,At=_===1?this._kernel.length:-1;for(let zt=Mt;zt!==At;zt+=_){const Vt=this._kernel[zt][1]*_,Gt=this._kernel[zt][2];if(Vt+ft>=0&&Vt+ft<o&&Gt+tt>=0&&Gt+tt<h){const Kt=this._kernel[zt][0],Wt=g[Gt][Vt+ft];Wt[0]+=kt*Kt,Wt[1]+=bt*Kt,Wt[2]+=vt*Kt,Wt[3]+=Et*Kt}}}}yield{pointContainer:e,progress:100}}_fillErrorLine(e,i){e.length>i&&(e.length=i);const a=e.length;for(let s=0;s<a;s++){const o=e[s];o[0]=o[1]=o[2]=o[3]=0}for(let s=a;s<i;s++)e[s]=[0,0,0,0]}_setKernel(e){switch(e){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[8/32,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[8/32,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[4/16,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[2/4,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${e}`)}}};function*hilbertCurve(e,i,a){const s=Math.max(e,i),o=Math.floor(Math.log(s)/Math.log(2)+1),h=new ProgressTracker(e*i,99),g={width:e,height:i,level:o,callback:a,tracker:h,index:0,x:0,y:0};yield*walkHilbert(g,1),visit(g,0)}function*walkHilbert(e,i){if(!(e.level<1)){switch(e.tracker.shouldNotify(e.index)&&(yield{progress:e.tracker.progress}),e.level--,i){case 2:yield*walkHilbert(e,1),visit(e,3),yield*walkHilbert(e,2),visit(e,4),yield*walkHilbert(e,2),visit(e,2),yield*walkHilbert(e,4);break;case 3:yield*walkHilbert(e,4),visit(e,2),yield*walkHilbert(e,3),visit(e,1),yield*walkHilbert(e,3),visit(e,3),yield*walkHilbert(e,1);break;case 1:yield*walkHilbert(e,2),visit(e,4),yield*walkHilbert(e,1),visit(e,3),yield*walkHilbert(e,1),visit(e,1),yield*walkHilbert(e,3);break;case 4:yield*walkHilbert(e,3),visit(e,1),yield*walkHilbert(e,4),visit(e,2),yield*walkHilbert(e,4),visit(e,4),yield*walkHilbert(e,2);break}e.level++}}function visit(e,i){switch(e.x>=0&&e.x<e.width&&e.y>=0&&e.y<e.height&&(e.callback(e.x,e.y),e.index++),i){case 2:e.x--;break;case 3:e.x++;break;case 1:e.y--;break;case 4:e.y++;break}}var ErrorDiffusionRiemersma=class extends AbstractImageQuantizer{constructor(e,i=16,a=1){super(),__publicField(this,"_distance"),__publicField(this,"_weights"),__publicField(this,"_errorQueueSize"),this._distance=e,this._errorQueueSize=i,this._weights=ErrorDiffusionRiemersma._createWeights(a,i)}*quantize(e,i){const a=e.getPointArray(),s=e.getWidth(),o=e.getHeight(),h=[];let g=0;for(let _=0;_<this._errorQueueSize;_++)h[_]={r:0,g:0,b:0,a:0};yield*hilbertCurve(s,o,(_,$)=>{const b=a[_+$*s];let{r:tt,g:st,b:at,a:nt}=b;for(let dt=0;dt<this._errorQueueSize;dt++){const _t=this._weights[dt],ut=h[(dt+g)%this._errorQueueSize];tt+=ut.r*_t,st+=ut.g*_t,at+=ut.b*_t,nt+=ut.a*_t}const lt=Point.createByRGBA(inRange0to255Rounded(tt),inRange0to255Rounded(st),inRange0to255Rounded(at),inRange0to255Rounded(nt)),ft=i.getNearestColor(this._distance,lt);g=(g+1)%this._errorQueueSize;const pt=(g+this._errorQueueSize-1)%this._errorQueueSize;h[pt].r=b.r-ft.r,h[pt].g=b.g-ft.g,h[pt].b=b.b-ft.b,h[pt].a=b.a-ft.a,b.from(ft)}),yield{pointContainer:e,progress:100}}static _createWeights(e,i){const a=[],s=Math.exp(Math.log(i)/(i-1));for(let o=0,h=1;o<i;o++)a[o]=(h+.5|0)/i*e,h*=s;return a}},quality_exports={};__export(quality_exports,{ssim:()=>ssim});var K1=.01,K2=.03;function ssim(e,i){if(e.getHeight()!==i.getHeight()||e.getWidth()!==i.getWidth())throw new Error("Images have different sizes!");const a=255,s=(K1*a)**2,o=(K2*a)**2;let h=0,g=0;return iterate(e,i,(_,$,b,tt)=>{let st=0,at=0,nt=0;for(let _t=0;_t<_.length;_t++)at+=(_[_t]-b)**2,nt+=($[_t]-tt)**2,st+=(_[_t]-b)*($[_t]-tt);const lt=_.length-1;at/=lt,nt/=lt,st/=lt;const ft=(2*b*tt+s)*(2*st+o),pt=(b**2+tt**2+s)*(at+nt+o),dt=ft/pt;g+=dt,h++}),g/h}function iterate(e,i,a){const s=e.getWidth(),o=e.getHeight();for(let h=0;h<o;h+=8)for(let g=0;g<s;g+=8){const _=Math.min(8,s-g),$=Math.min(8,o-h),b=calculateLumaValuesForWindow(e,g,h,_,$),tt=calculateLumaValuesForWindow(i,g,h,_,$),st=calculateAverageLuma(b),at=calculateAverageLuma(tt);a(b,tt,st,at)}}function calculateLumaValuesForWindow(e,i,a,s,o){const h=e.getPointArray(),g=[];let _=0;for(let $=a;$<a+o;$++){const b=$*e.getWidth();for(let tt=i;tt<i+s;tt++){const st=h[b+tt];g[_]=st.r*.2126+st.g*.7152+st.b*.0722,_++}}return g}function calculateAverageLuma(e){let i=0;for(const a of e)i+=a;return i/e.length}typeof setImmediate=="function"?setImmediate:typeof process<"u"&&(process==null||process.nextTick);function buildPaletteSync(e,{colorDistanceFormula:i,paletteQuantization:a,colors:s}={}){const o=colorDistanceFormulaToColorDistance(i),h=paletteQuantizationToPaletteQuantizer(o,a,s);return e.forEach(g=>h.sample(g)),h.quantizeSync()}function applyPaletteSync(e,i,{colorDistanceFormula:a,imageQuantization:s}={}){const o=colorDistanceFormulaToColorDistance(a);return imageQuantizationToImageQuantizer(o,s).quantizeSync(e,i)}function colorDistanceFormulaToColorDistance(e="euclidean-bt709"){switch(e){case"cie94-graphic-arts":return new CIE94GraphicArts;case"cie94-textiles":return new CIE94Textiles;case"ciede2000":return new CIEDE2000;case"color-metric":return new CMetric;case"euclidean":return new Euclidean;case"euclidean-bt709":return new EuclideanBT709;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha;case"manhattan":return new Manhattan;case"manhattan-bt709":return new ManhattanBT709;case"manhattan-nommyde":return new ManhattanNommyde;case"pngquant":return new PNGQuant;default:throw new Error(`Unknown colorDistanceFormula ${e}`)}}function imageQuantizationToImageQuantizer(e,i="floyd-steinberg"){switch(i){case"nearest":return new NearestColor(e);case"riemersma":return new ErrorDiffusionRiemersma(e);case"floyd-steinberg":return new ErrorDiffusionArray(e,0);case"false-floyd-steinberg":return new ErrorDiffusionArray(e,1);case"stucki":return new ErrorDiffusionArray(e,2);case"atkinson":return new ErrorDiffusionArray(e,3);case"jarvis":return new ErrorDiffusionArray(e,4);case"burkes":return new ErrorDiffusionArray(e,5);case"sierra":return new ErrorDiffusionArray(e,6);case"two-sierra":return new ErrorDiffusionArray(e,7);case"sierra-lite":return new ErrorDiffusionArray(e,8);default:throw new Error(`Unknown imageQuantization ${i}`)}}function paletteQuantizationToPaletteQuantizer(e,i="wuquant",a=256){switch(i){case"neuquant":return new NeuQuant(e,a);case"rgbquant":return new RGBQuant(e,a);case"wuquant":return new WuQuant(e,a);case"neuquant-float":return new NeuQuantFloat(e,a);default:throw new Error(`Unknown paletteQuantization ${i}`)}}/**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cie94.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ciede2000.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cmetric.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * common.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * constants.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ditherErrorDiffusionArray.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * euclidean.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * helper.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * hueStatistics.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2rgb.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2xyz.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * manhattanNeuQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * nearestColor.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * palette.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pngQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * point.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pointContainer.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2hsl.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2lab.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2xyz.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * wuQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2lab.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2rgb.ts - part of Image Quantization Library
 *//**
 * @preserve
 * MIT License
 *
 * Copyright 2015-2018 Igor Bezkrovnyi
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * riemersma.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * colorHistogram.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * neuquant.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgbquant.ts - part of Image Quantization Library
 */var common={},hasRequiredCommon;function requireCommon(){return hasRequiredCommon||(hasRequiredCommon=1,function(e){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function a(h,g){return Object.prototype.hasOwnProperty.call(h,g)}e.assign=function(h){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var _=g.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var $ in _)a(_,$)&&(h[$]=_[$])}}return h},e.shrinkBuf=function(h,g){return h.length===g?h:h.subarray?h.subarray(0,g):(h.length=g,h)};var s={arraySet:function(h,g,_,$,b){if(g.subarray&&h.subarray){h.set(g.subarray(_,_+$),b);return}for(var tt=0;tt<$;tt++)h[b+tt]=g[_+tt]},flattenChunks:function(h){var g,_,$,b,tt,st;for($=0,g=0,_=h.length;g<_;g++)$+=h[g].length;for(st=new Uint8Array($),b=0,g=0,_=h.length;g<_;g++)tt=h[g],st.set(tt,b),b+=tt.length;return st}},o={arraySet:function(h,g,_,$,b){for(var tt=0;tt<$;tt++)h[b+tt]=g[_+tt]},flattenChunks:function(h){return[].concat.apply([],h)}};e.setTyped=function(h){h?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,s)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,o))},e.setTyped(i)}(common)),common}var deflate$1={},deflate={},trees={},hasRequiredTrees;function requireTrees(){if(hasRequiredTrees)return trees;hasRequiredTrees=1;var e=requireCommon(),i=4,a=0,s=1,o=2;function h(Ut){for(var xn=Ut.length;--xn>=0;)Ut[xn]=0}var g=0,_=1,$=2,b=3,tt=258,st=29,at=256,nt=at+1+st,lt=30,ft=19,pt=2*nt+1,dt=15,_t=16,ut=7,mt=256,kt=16,bt=17,vt=18,Et=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Mt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],At=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],zt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Vt=512,Gt=new Array((nt+2)*2);h(Gt);var Kt=new Array(lt*2);h(Kt);var Wt=new Array(Vt);h(Wt);var sn=new Array(tt-b+1);h(sn);var on=new Array(st);h(on);var Xt=new Array(lt);h(Xt);function ln(Ut,xn,kn,Pn,tn){this.static_tree=Ut,this.extra_bits=xn,this.extra_base=kn,this.elems=Pn,this.max_length=tn,this.has_stree=Ut&&Ut.length}var nn,gn,dn;function $n(Ut,xn){this.dyn_tree=Ut,this.max_code=0,this.stat_desc=xn}function En(Ut){return Ut<256?Wt[Ut]:Wt[256+(Ut>>>7)]}function qt(Ut,xn){Ut.pending_buf[Ut.pending++]=xn&255,Ut.pending_buf[Ut.pending++]=xn>>>8&255}function en(Ut,xn,kn){Ut.bi_valid>_t-kn?(Ut.bi_buf|=xn<<Ut.bi_valid&65535,qt(Ut,Ut.bi_buf),Ut.bi_buf=xn>>_t-Ut.bi_valid,Ut.bi_valid+=kn-_t):(Ut.bi_buf|=xn<<Ut.bi_valid&65535,Ut.bi_valid+=kn)}function Tn(Ut,xn,kn){en(Ut,kn[xn*2],kn[xn*2+1])}function Sn(Ut,xn){var kn=0;do kn|=Ut&1,Ut>>>=1,kn<<=1;while(--xn>0);return kn>>>1}function fn(Ut){Ut.bi_valid===16?(qt(Ut,Ut.bi_buf),Ut.bi_buf=0,Ut.bi_valid=0):Ut.bi_valid>=8&&(Ut.pending_buf[Ut.pending++]=Ut.bi_buf&255,Ut.bi_buf>>=8,Ut.bi_valid-=8)}function Wn(Ut,xn){var kn=xn.dyn_tree,Pn=xn.max_code,tn=xn.stat_desc.static_tree,vn=xn.stat_desc.has_stree,Pt=xn.stat_desc.extra_bits,An=xn.stat_desc.extra_base,sr=xn.stat_desc.max_length,wt,mn,yn,Ft,Qt,cn,tr=0;for(Ft=0;Ft<=dt;Ft++)Ut.bl_count[Ft]=0;for(kn[Ut.heap[Ut.heap_max]*2+1]=0,wt=Ut.heap_max+1;wt<pt;wt++)mn=Ut.heap[wt],Ft=kn[kn[mn*2+1]*2+1]+1,Ft>sr&&(Ft=sr,tr++),kn[mn*2+1]=Ft,!(mn>Pn)&&(Ut.bl_count[Ft]++,Qt=0,mn>=An&&(Qt=Pt[mn-An]),cn=kn[mn*2],Ut.opt_len+=cn*(Ft+Qt),vn&&(Ut.static_len+=cn*(tn[mn*2+1]+Qt)));if(tr!==0){do{for(Ft=sr-1;Ut.bl_count[Ft]===0;)Ft--;Ut.bl_count[Ft]--,Ut.bl_count[Ft+1]+=2,Ut.bl_count[sr]--,tr-=2}while(tr>0);for(Ft=sr;Ft!==0;Ft--)for(mn=Ut.bl_count[Ft];mn!==0;)yn=Ut.heap[--wt],!(yn>Pn)&&(kn[yn*2+1]!==Ft&&(Ut.opt_len+=(Ft-kn[yn*2+1])*kn[yn*2],kn[yn*2+1]=Ft),mn--)}}function Zn(Ut,xn,kn){var Pn=new Array(dt+1),tn=0,vn,Pt;for(vn=1;vn<=dt;vn++)Pn[vn]=tn=tn+kn[vn-1]<<1;for(Pt=0;Pt<=xn;Pt++){var An=Ut[Pt*2+1];An!==0&&(Ut[Pt*2]=Sn(Pn[An]++,An))}}function Gn(){var Ut,xn,kn,Pn,tn,vn=new Array(dt+1);for(kn=0,Pn=0;Pn<st-1;Pn++)for(on[Pn]=kn,Ut=0;Ut<1<<Et[Pn];Ut++)sn[kn++]=Pn;for(sn[kn-1]=Pn,tn=0,Pn=0;Pn<16;Pn++)for(Xt[Pn]=tn,Ut=0;Ut<1<<Mt[Pn];Ut++)Wt[tn++]=Pn;for(tn>>=7;Pn<lt;Pn++)for(Xt[Pn]=tn<<7,Ut=0;Ut<1<<Mt[Pn]-7;Ut++)Wt[256+tn++]=Pn;for(xn=0;xn<=dt;xn++)vn[xn]=0;for(Ut=0;Ut<=143;)Gt[Ut*2+1]=8,Ut++,vn[8]++;for(;Ut<=255;)Gt[Ut*2+1]=9,Ut++,vn[9]++;for(;Ut<=279;)Gt[Ut*2+1]=7,Ut++,vn[7]++;for(;Ut<=287;)Gt[Ut*2+1]=8,Ut++,vn[8]++;for(Zn(Gt,nt+1,vn),Ut=0;Ut<lt;Ut++)Kt[Ut*2+1]=5,Kt[Ut*2]=Sn(Ut,5);nn=new ln(Gt,Et,at+1,nt,dt),gn=new ln(Kt,Mt,0,lt,dt),dn=new ln(new Array(0),At,0,ft,ut)}function zn(Ut){var xn;for(xn=0;xn<nt;xn++)Ut.dyn_ltree[xn*2]=0;for(xn=0;xn<lt;xn++)Ut.dyn_dtree[xn*2]=0;for(xn=0;xn<ft;xn++)Ut.bl_tree[xn*2]=0;Ut.dyn_ltree[mt*2]=1,Ut.opt_len=Ut.static_len=0,Ut.last_lit=Ut.matches=0}function Bn(Ut){Ut.bi_valid>8?qt(Ut,Ut.bi_buf):Ut.bi_valid>0&&(Ut.pending_buf[Ut.pending++]=Ut.bi_buf),Ut.bi_buf=0,Ut.bi_valid=0}function or(Ut,xn,kn,Pn){Bn(Ut),qt(Ut,kn),qt(Ut,~kn),e.arraySet(Ut.pending_buf,Ut.window,xn,kn,Ut.pending),Ut.pending+=kn}function Jn(Ut,xn,kn,Pn){var tn=xn*2,vn=kn*2;return Ut[tn]<Ut[vn]||Ut[tn]===Ut[vn]&&Pn[xn]<=Pn[kn]}function Un(Ut,xn,kn){for(var Pn=Ut.heap[kn],tn=kn<<1;tn<=Ut.heap_len&&(tn<Ut.heap_len&&Jn(xn,Ut.heap[tn+1],Ut.heap[tn],Ut.depth)&&tn++,!Jn(xn,Pn,Ut.heap[tn],Ut.depth));)Ut.heap[kn]=Ut.heap[tn],kn=tn,tn<<=1;Ut.heap[kn]=Pn}function nr(Ut,xn,kn){var Pn,tn,vn=0,Pt,An;if(Ut.last_lit!==0)do Pn=Ut.pending_buf[Ut.d_buf+vn*2]<<8|Ut.pending_buf[Ut.d_buf+vn*2+1],tn=Ut.pending_buf[Ut.l_buf+vn],vn++,Pn===0?Tn(Ut,tn,xn):(Pt=sn[tn],Tn(Ut,Pt+at+1,xn),An=Et[Pt],An!==0&&(tn-=on[Pt],en(Ut,tn,An)),Pn--,Pt=En(Pn),Tn(Ut,Pt,kn),An=Mt[Pt],An!==0&&(Pn-=Xt[Pt],en(Ut,Pn,An)));while(vn<Ut.last_lit);Tn(Ut,mt,xn)}function wn(Ut,xn){var kn=xn.dyn_tree,Pn=xn.stat_desc.static_tree,tn=xn.stat_desc.has_stree,vn=xn.stat_desc.elems,Pt,An,sr=-1,wt;for(Ut.heap_len=0,Ut.heap_max=pt,Pt=0;Pt<vn;Pt++)kn[Pt*2]!==0?(Ut.heap[++Ut.heap_len]=sr=Pt,Ut.depth[Pt]=0):kn[Pt*2+1]=0;for(;Ut.heap_len<2;)wt=Ut.heap[++Ut.heap_len]=sr<2?++sr:0,kn[wt*2]=1,Ut.depth[wt]=0,Ut.opt_len--,tn&&(Ut.static_len-=Pn[wt*2+1]);for(xn.max_code=sr,Pt=Ut.heap_len>>1;Pt>=1;Pt--)Un(Ut,kn,Pt);wt=vn;do Pt=Ut.heap[1],Ut.heap[1]=Ut.heap[Ut.heap_len--],Un(Ut,kn,1),An=Ut.heap[1],Ut.heap[--Ut.heap_max]=Pt,Ut.heap[--Ut.heap_max]=An,kn[wt*2]=kn[Pt*2]+kn[An*2],Ut.depth[wt]=(Ut.depth[Pt]>=Ut.depth[An]?Ut.depth[Pt]:Ut.depth[An])+1,kn[Pt*2+1]=kn[An*2+1]=wt,Ut.heap[1]=wt++,Un(Ut,kn,1);while(Ut.heap_len>=2);Ut.heap[--Ut.heap_max]=Ut.heap[1],Wn(Ut,xn),Zn(kn,sr,Ut.bl_count)}function jn(Ut,xn,kn){var Pn,tn=-1,vn,Pt=xn[0*2+1],An=0,sr=7,wt=4;for(Pt===0&&(sr=138,wt=3),xn[(kn+1)*2+1]=65535,Pn=0;Pn<=kn;Pn++)vn=Pt,Pt=xn[(Pn+1)*2+1],!(++An<sr&&vn===Pt)&&(An<wt?Ut.bl_tree[vn*2]+=An:vn!==0?(vn!==tn&&Ut.bl_tree[vn*2]++,Ut.bl_tree[kt*2]++):An<=10?Ut.bl_tree[bt*2]++:Ut.bl_tree[vt*2]++,An=0,tn=vn,Pt===0?(sr=138,wt=3):vn===Pt?(sr=6,wt=3):(sr=7,wt=4))}function er(Ut,xn,kn){var Pn,tn=-1,vn,Pt=xn[0*2+1],An=0,sr=7,wt=4;for(Pt===0&&(sr=138,wt=3),Pn=0;Pn<=kn;Pn++)if(vn=Pt,Pt=xn[(Pn+1)*2+1],!(++An<sr&&vn===Pt)){if(An<wt)do Tn(Ut,vn,Ut.bl_tree);while(--An!==0);else vn!==0?(vn!==tn&&(Tn(Ut,vn,Ut.bl_tree),An--),Tn(Ut,kt,Ut.bl_tree),en(Ut,An-3,2)):An<=10?(Tn(Ut,bt,Ut.bl_tree),en(Ut,An-3,3)):(Tn(Ut,vt,Ut.bl_tree),en(Ut,An-11,7));An=0,tn=vn,Pt===0?(sr=138,wt=3):vn===Pt?(sr=6,wt=3):(sr=7,wt=4)}}function Vn(Ut){var xn;for(jn(Ut,Ut.dyn_ltree,Ut.l_desc.max_code),jn(Ut,Ut.dyn_dtree,Ut.d_desc.max_code),wn(Ut,Ut.bl_desc),xn=ft-1;xn>=3&&Ut.bl_tree[zt[xn]*2+1]===0;xn--);return Ut.opt_len+=3*(xn+1)+5+5+4,xn}function Rn(Ut,xn,kn,Pn){var tn;for(en(Ut,xn-257,5),en(Ut,kn-1,5),en(Ut,Pn-4,4),tn=0;tn<Pn;tn++)en(Ut,Ut.bl_tree[zt[tn]*2+1],3);er(Ut,Ut.dyn_ltree,xn-1),er(Ut,Ut.dyn_dtree,kn-1)}function ar(Ut){var xn=4093624447,kn;for(kn=0;kn<=31;kn++,xn>>>=1)if(xn&1&&Ut.dyn_ltree[kn*2]!==0)return a;if(Ut.dyn_ltree[9*2]!==0||Ut.dyn_ltree[10*2]!==0||Ut.dyn_ltree[13*2]!==0)return s;for(kn=32;kn<at;kn++)if(Ut.dyn_ltree[kn*2]!==0)return s;return a}var Hn=!1;function Fn(Ut){Hn||(Gn(),Hn=!0),Ut.l_desc=new $n(Ut.dyn_ltree,nn),Ut.d_desc=new $n(Ut.dyn_dtree,gn),Ut.bl_desc=new $n(Ut.bl_tree,dn),Ut.bi_buf=0,Ut.bi_valid=0,zn(Ut)}function qn(Ut,xn,kn,Pn){en(Ut,(g<<1)+(Pn?1:0),3),or(Ut,xn,kn)}function ir(Ut){en(Ut,_<<1,3),Tn(Ut,mt,Gt),fn(Ut)}function Nn(Ut,xn,kn,Pn){var tn,vn,Pt=0;Ut.level>0?(Ut.strm.data_type===o&&(Ut.strm.data_type=ar(Ut)),wn(Ut,Ut.l_desc),wn(Ut,Ut.d_desc),Pt=Vn(Ut),tn=Ut.opt_len+3+7>>>3,vn=Ut.static_len+3+7>>>3,vn<=tn&&(tn=vn)):tn=vn=kn+5,kn+4<=tn&&xn!==-1?qn(Ut,xn,kn,Pn):Ut.strategy===i||vn===tn?(en(Ut,(_<<1)+(Pn?1:0),3),nr(Ut,Gt,Kt)):(en(Ut,($<<1)+(Pn?1:0),3),Rn(Ut,Ut.l_desc.max_code+1,Ut.d_desc.max_code+1,Pt+1),nr(Ut,Ut.dyn_ltree,Ut.dyn_dtree)),zn(Ut),Pn&&Bn(Ut)}function Kn(Ut,xn,kn){return Ut.pending_buf[Ut.d_buf+Ut.last_lit*2]=xn>>>8&255,Ut.pending_buf[Ut.d_buf+Ut.last_lit*2+1]=xn&255,Ut.pending_buf[Ut.l_buf+Ut.last_lit]=kn&255,Ut.last_lit++,xn===0?Ut.dyn_ltree[kn*2]++:(Ut.matches++,xn--,Ut.dyn_ltree[(sn[kn]+at+1)*2]++,Ut.dyn_dtree[En(xn)*2]++),Ut.last_lit===Ut.lit_bufsize-1}return trees._tr_init=Fn,trees._tr_stored_block=qn,trees._tr_flush_block=Nn,trees._tr_tally=Kn,trees._tr_align=ir,trees}var adler32_1,hasRequiredAdler32;function requireAdler32(){if(hasRequiredAdler32)return adler32_1;hasRequiredAdler32=1;function e(i,a,s,o){for(var h=i&65535|0,g=i>>>16&65535|0,_=0;s!==0;){_=s>2e3?2e3:s,s-=_;do h=h+a[o++]|0,g=g+h|0;while(--_);h%=65521,g%=65521}return h|g<<16|0}return adler32_1=e,adler32_1}var crc32_1,hasRequiredCrc32;function requireCrc32(){if(hasRequiredCrc32)return crc32_1;hasRequiredCrc32=1;function e(){for(var s,o=[],h=0;h<256;h++){s=h;for(var g=0;g<8;g++)s=s&1?3988292384^s>>>1:s>>>1;o[h]=s}return o}var i=e();function a(s,o,h,g){var _=i,$=g+h;s^=-1;for(var b=g;b<$;b++)s=s>>>8^_[(s^o[b])&255];return s^-1}return crc32_1=a,crc32_1}var messages,hasRequiredMessages;function requireMessages(){return hasRequiredMessages||(hasRequiredMessages=1,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),messages}var hasRequiredDeflate$1;function requireDeflate$1(){if(hasRequiredDeflate$1)return deflate;hasRequiredDeflate$1=1;var e=requireCommon(),i=requireTrees(),a=requireAdler32(),s=requireCrc32(),o=requireMessages(),h=0,g=1,_=3,$=4,b=5,tt=0,st=1,at=-2,nt=-3,lt=-5,ft=-1,pt=1,dt=2,_t=3,ut=4,mt=0,kt=2,bt=8,vt=9,Et=15,Mt=8,At=29,zt=256,Vt=zt+1+At,Gt=30,Kt=19,Wt=2*Vt+1,sn=15,on=3,Xt=258,ln=Xt+on+1,nn=32,gn=42,dn=69,$n=73,En=91,qt=103,en=113,Tn=666,Sn=1,fn=2,Wn=3,Zn=4,Gn=3;function zn(wt,mn){return wt.msg=o[mn],mn}function Bn(wt){return(wt<<1)-(wt>4?9:0)}function or(wt){for(var mn=wt.length;--mn>=0;)wt[mn]=0}function Jn(wt){var mn=wt.state,yn=mn.pending;yn>wt.avail_out&&(yn=wt.avail_out),yn!==0&&(e.arraySet(wt.output,mn.pending_buf,mn.pending_out,yn,wt.next_out),wt.next_out+=yn,mn.pending_out+=yn,wt.total_out+=yn,wt.avail_out-=yn,mn.pending-=yn,mn.pending===0&&(mn.pending_out=0))}function Un(wt,mn){i._tr_flush_block(wt,wt.block_start>=0?wt.block_start:-1,wt.strstart-wt.block_start,mn),wt.block_start=wt.strstart,Jn(wt.strm)}function nr(wt,mn){wt.pending_buf[wt.pending++]=mn}function wn(wt,mn){wt.pending_buf[wt.pending++]=mn>>>8&255,wt.pending_buf[wt.pending++]=mn&255}function jn(wt,mn,yn,Ft){var Qt=wt.avail_in;return Qt>Ft&&(Qt=Ft),Qt===0?0:(wt.avail_in-=Qt,e.arraySet(mn,wt.input,wt.next_in,Qt,yn),wt.state.wrap===1?wt.adler=a(wt.adler,mn,Qt,yn):wt.state.wrap===2&&(wt.adler=s(wt.adler,mn,Qt,yn)),wt.next_in+=Qt,wt.total_in+=Qt,Qt)}function er(wt,mn){var yn=wt.max_chain_length,Ft=wt.strstart,Qt,cn,tr=wt.prev_length,ct=wt.nice_match,rt=wt.strstart>wt.w_size-ln?wt.strstart-(wt.w_size-ln):0,et=wt.window,it=wt.w_mask,ht=wt.prev,yt=wt.strstart+Xt,Lt=et[Ft+tr-1],Nt=et[Ft+tr];wt.prev_length>=wt.good_match&&(yn>>=2),ct>wt.lookahead&&(ct=wt.lookahead);do if(Qt=mn,!(et[Qt+tr]!==Nt||et[Qt+tr-1]!==Lt||et[Qt]!==et[Ft]||et[++Qt]!==et[Ft+1])){Ft+=2,Qt++;do;while(et[++Ft]===et[++Qt]&&et[++Ft]===et[++Qt]&&et[++Ft]===et[++Qt]&&et[++Ft]===et[++Qt]&&et[++Ft]===et[++Qt]&&et[++Ft]===et[++Qt]&&et[++Ft]===et[++Qt]&&et[++Ft]===et[++Qt]&&Ft<yt);if(cn=Xt-(yt-Ft),Ft=yt-Xt,cn>tr){if(wt.match_start=mn,tr=cn,cn>=ct)break;Lt=et[Ft+tr-1],Nt=et[Ft+tr]}}while((mn=ht[mn&it])>rt&&--yn!==0);return tr<=wt.lookahead?tr:wt.lookahead}function Vn(wt){var mn=wt.w_size,yn,Ft,Qt,cn,tr;do{if(cn=wt.window_size-wt.lookahead-wt.strstart,wt.strstart>=mn+(mn-ln)){e.arraySet(wt.window,wt.window,mn,mn,0),wt.match_start-=mn,wt.strstart-=mn,wt.block_start-=mn,Ft=wt.hash_size,yn=Ft;do Qt=wt.head[--yn],wt.head[yn]=Qt>=mn?Qt-mn:0;while(--Ft);Ft=mn,yn=Ft;do Qt=wt.prev[--yn],wt.prev[yn]=Qt>=mn?Qt-mn:0;while(--Ft);cn+=mn}if(wt.strm.avail_in===0)break;if(Ft=jn(wt.strm,wt.window,wt.strstart+wt.lookahead,cn),wt.lookahead+=Ft,wt.lookahead+wt.insert>=on)for(tr=wt.strstart-wt.insert,wt.ins_h=wt.window[tr],wt.ins_h=(wt.ins_h<<wt.hash_shift^wt.window[tr+1])&wt.hash_mask;wt.insert&&(wt.ins_h=(wt.ins_h<<wt.hash_shift^wt.window[tr+on-1])&wt.hash_mask,wt.prev[tr&wt.w_mask]=wt.head[wt.ins_h],wt.head[wt.ins_h]=tr,tr++,wt.insert--,!(wt.lookahead+wt.insert<on)););}while(wt.lookahead<ln&&wt.strm.avail_in!==0)}function Rn(wt,mn){var yn=65535;for(yn>wt.pending_buf_size-5&&(yn=wt.pending_buf_size-5);;){if(wt.lookahead<=1){if(Vn(wt),wt.lookahead===0&&mn===h)return Sn;if(wt.lookahead===0)break}wt.strstart+=wt.lookahead,wt.lookahead=0;var Ft=wt.block_start+yn;if((wt.strstart===0||wt.strstart>=Ft)&&(wt.lookahead=wt.strstart-Ft,wt.strstart=Ft,Un(wt,!1),wt.strm.avail_out===0)||wt.strstart-wt.block_start>=wt.w_size-ln&&(Un(wt,!1),wt.strm.avail_out===0))return Sn}return wt.insert=0,mn===$?(Un(wt,!0),wt.strm.avail_out===0?Wn:Zn):(wt.strstart>wt.block_start&&(Un(wt,!1),wt.strm.avail_out),Sn)}function ar(wt,mn){for(var yn,Ft;;){if(wt.lookahead<ln){if(Vn(wt),wt.lookahead<ln&&mn===h)return Sn;if(wt.lookahead===0)break}if(yn=0,wt.lookahead>=on&&(wt.ins_h=(wt.ins_h<<wt.hash_shift^wt.window[wt.strstart+on-1])&wt.hash_mask,yn=wt.prev[wt.strstart&wt.w_mask]=wt.head[wt.ins_h],wt.head[wt.ins_h]=wt.strstart),yn!==0&&wt.strstart-yn<=wt.w_size-ln&&(wt.match_length=er(wt,yn)),wt.match_length>=on)if(Ft=i._tr_tally(wt,wt.strstart-wt.match_start,wt.match_length-on),wt.lookahead-=wt.match_length,wt.match_length<=wt.max_lazy_match&&wt.lookahead>=on){wt.match_length--;do wt.strstart++,wt.ins_h=(wt.ins_h<<wt.hash_shift^wt.window[wt.strstart+on-1])&wt.hash_mask,yn=wt.prev[wt.strstart&wt.w_mask]=wt.head[wt.ins_h],wt.head[wt.ins_h]=wt.strstart;while(--wt.match_length!==0);wt.strstart++}else wt.strstart+=wt.match_length,wt.match_length=0,wt.ins_h=wt.window[wt.strstart],wt.ins_h=(wt.ins_h<<wt.hash_shift^wt.window[wt.strstart+1])&wt.hash_mask;else Ft=i._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++;if(Ft&&(Un(wt,!1),wt.strm.avail_out===0))return Sn}return wt.insert=wt.strstart<on-1?wt.strstart:on-1,mn===$?(Un(wt,!0),wt.strm.avail_out===0?Wn:Zn):wt.last_lit&&(Un(wt,!1),wt.strm.avail_out===0)?Sn:fn}function Hn(wt,mn){for(var yn,Ft,Qt;;){if(wt.lookahead<ln){if(Vn(wt),wt.lookahead<ln&&mn===h)return Sn;if(wt.lookahead===0)break}if(yn=0,wt.lookahead>=on&&(wt.ins_h=(wt.ins_h<<wt.hash_shift^wt.window[wt.strstart+on-1])&wt.hash_mask,yn=wt.prev[wt.strstart&wt.w_mask]=wt.head[wt.ins_h],wt.head[wt.ins_h]=wt.strstart),wt.prev_length=wt.match_length,wt.prev_match=wt.match_start,wt.match_length=on-1,yn!==0&&wt.prev_length<wt.max_lazy_match&&wt.strstart-yn<=wt.w_size-ln&&(wt.match_length=er(wt,yn),wt.match_length<=5&&(wt.strategy===pt||wt.match_length===on&&wt.strstart-wt.match_start>4096)&&(wt.match_length=on-1)),wt.prev_length>=on&&wt.match_length<=wt.prev_length){Qt=wt.strstart+wt.lookahead-on,Ft=i._tr_tally(wt,wt.strstart-1-wt.prev_match,wt.prev_length-on),wt.lookahead-=wt.prev_length-1,wt.prev_length-=2;do++wt.strstart<=Qt&&(wt.ins_h=(wt.ins_h<<wt.hash_shift^wt.window[wt.strstart+on-1])&wt.hash_mask,yn=wt.prev[wt.strstart&wt.w_mask]=wt.head[wt.ins_h],wt.head[wt.ins_h]=wt.strstart);while(--wt.prev_length!==0);if(wt.match_available=0,wt.match_length=on-1,wt.strstart++,Ft&&(Un(wt,!1),wt.strm.avail_out===0))return Sn}else if(wt.match_available){if(Ft=i._tr_tally(wt,0,wt.window[wt.strstart-1]),Ft&&Un(wt,!1),wt.strstart++,wt.lookahead--,wt.strm.avail_out===0)return Sn}else wt.match_available=1,wt.strstart++,wt.lookahead--}return wt.match_available&&(Ft=i._tr_tally(wt,0,wt.window[wt.strstart-1]),wt.match_available=0),wt.insert=wt.strstart<on-1?wt.strstart:on-1,mn===$?(Un(wt,!0),wt.strm.avail_out===0?Wn:Zn):wt.last_lit&&(Un(wt,!1),wt.strm.avail_out===0)?Sn:fn}function Fn(wt,mn){for(var yn,Ft,Qt,cn,tr=wt.window;;){if(wt.lookahead<=Xt){if(Vn(wt),wt.lookahead<=Xt&&mn===h)return Sn;if(wt.lookahead===0)break}if(wt.match_length=0,wt.lookahead>=on&&wt.strstart>0&&(Qt=wt.strstart-1,Ft=tr[Qt],Ft===tr[++Qt]&&Ft===tr[++Qt]&&Ft===tr[++Qt])){cn=wt.strstart+Xt;do;while(Ft===tr[++Qt]&&Ft===tr[++Qt]&&Ft===tr[++Qt]&&Ft===tr[++Qt]&&Ft===tr[++Qt]&&Ft===tr[++Qt]&&Ft===tr[++Qt]&&Ft===tr[++Qt]&&Qt<cn);wt.match_length=Xt-(cn-Qt),wt.match_length>wt.lookahead&&(wt.match_length=wt.lookahead)}if(wt.match_length>=on?(yn=i._tr_tally(wt,1,wt.match_length-on),wt.lookahead-=wt.match_length,wt.strstart+=wt.match_length,wt.match_length=0):(yn=i._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++),yn&&(Un(wt,!1),wt.strm.avail_out===0))return Sn}return wt.insert=0,mn===$?(Un(wt,!0),wt.strm.avail_out===0?Wn:Zn):wt.last_lit&&(Un(wt,!1),wt.strm.avail_out===0)?Sn:fn}function qn(wt,mn){for(var yn;;){if(wt.lookahead===0&&(Vn(wt),wt.lookahead===0)){if(mn===h)return Sn;break}if(wt.match_length=0,yn=i._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++,yn&&(Un(wt,!1),wt.strm.avail_out===0))return Sn}return wt.insert=0,mn===$?(Un(wt,!0),wt.strm.avail_out===0?Wn:Zn):wt.last_lit&&(Un(wt,!1),wt.strm.avail_out===0)?Sn:fn}function ir(wt,mn,yn,Ft,Qt){this.good_length=wt,this.max_lazy=mn,this.nice_length=yn,this.max_chain=Ft,this.func=Qt}var Nn;Nn=[new ir(0,0,0,0,Rn),new ir(4,4,8,4,ar),new ir(4,5,16,8,ar),new ir(4,6,32,32,ar),new ir(4,4,16,16,Hn),new ir(8,16,32,32,Hn),new ir(8,16,128,128,Hn),new ir(8,32,128,256,Hn),new ir(32,128,258,1024,Hn),new ir(32,258,258,4096,Hn)];function Kn(wt){wt.window_size=2*wt.w_size,or(wt.head),wt.max_lazy_match=Nn[wt.level].max_lazy,wt.good_match=Nn[wt.level].good_length,wt.nice_match=Nn[wt.level].nice_length,wt.max_chain_length=Nn[wt.level].max_chain,wt.strstart=0,wt.block_start=0,wt.lookahead=0,wt.insert=0,wt.match_length=wt.prev_length=on-1,wt.match_available=0,wt.ins_h=0}function Ut(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=bt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(Wt*2),this.dyn_dtree=new e.Buf16((2*Gt+1)*2),this.bl_tree=new e.Buf16((2*Kt+1)*2),or(this.dyn_ltree),or(this.dyn_dtree),or(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(sn+1),this.heap=new e.Buf16(2*Vt+1),or(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*Vt+1),or(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function xn(wt){var mn;return!wt||!wt.state?zn(wt,at):(wt.total_in=wt.total_out=0,wt.data_type=kt,mn=wt.state,mn.pending=0,mn.pending_out=0,mn.wrap<0&&(mn.wrap=-mn.wrap),mn.status=mn.wrap?gn:en,wt.adler=mn.wrap===2?0:1,mn.last_flush=h,i._tr_init(mn),tt)}function kn(wt){var mn=xn(wt);return mn===tt&&Kn(wt.state),mn}function Pn(wt,mn){return!wt||!wt.state||wt.state.wrap!==2?at:(wt.state.gzhead=mn,tt)}function tn(wt,mn,yn,Ft,Qt,cn){if(!wt)return at;var tr=1;if(mn===ft&&(mn=6),Ft<0?(tr=0,Ft=-Ft):Ft>15&&(tr=2,Ft-=16),Qt<1||Qt>vt||yn!==bt||Ft<8||Ft>15||mn<0||mn>9||cn<0||cn>ut)return zn(wt,at);Ft===8&&(Ft=9);var ct=new Ut;return wt.state=ct,ct.strm=wt,ct.wrap=tr,ct.gzhead=null,ct.w_bits=Ft,ct.w_size=1<<ct.w_bits,ct.w_mask=ct.w_size-1,ct.hash_bits=Qt+7,ct.hash_size=1<<ct.hash_bits,ct.hash_mask=ct.hash_size-1,ct.hash_shift=~~((ct.hash_bits+on-1)/on),ct.window=new e.Buf8(ct.w_size*2),ct.head=new e.Buf16(ct.hash_size),ct.prev=new e.Buf16(ct.w_size),ct.lit_bufsize=1<<Qt+6,ct.pending_buf_size=ct.lit_bufsize*4,ct.pending_buf=new e.Buf8(ct.pending_buf_size),ct.d_buf=1*ct.lit_bufsize,ct.l_buf=3*ct.lit_bufsize,ct.level=mn,ct.strategy=cn,ct.method=yn,kn(wt)}function vn(wt,mn){return tn(wt,mn,bt,Et,Mt,mt)}function Pt(wt,mn){var yn,Ft,Qt,cn;if(!wt||!wt.state||mn>b||mn<0)return wt?zn(wt,at):at;if(Ft=wt.state,!wt.output||!wt.input&&wt.avail_in!==0||Ft.status===Tn&&mn!==$)return zn(wt,wt.avail_out===0?lt:at);if(Ft.strm=wt,yn=Ft.last_flush,Ft.last_flush=mn,Ft.status===gn)if(Ft.wrap===2)wt.adler=0,nr(Ft,31),nr(Ft,139),nr(Ft,8),Ft.gzhead?(nr(Ft,(Ft.gzhead.text?1:0)+(Ft.gzhead.hcrc?2:0)+(Ft.gzhead.extra?4:0)+(Ft.gzhead.name?8:0)+(Ft.gzhead.comment?16:0)),nr(Ft,Ft.gzhead.time&255),nr(Ft,Ft.gzhead.time>>8&255),nr(Ft,Ft.gzhead.time>>16&255),nr(Ft,Ft.gzhead.time>>24&255),nr(Ft,Ft.level===9?2:Ft.strategy>=dt||Ft.level<2?4:0),nr(Ft,Ft.gzhead.os&255),Ft.gzhead.extra&&Ft.gzhead.extra.length&&(nr(Ft,Ft.gzhead.extra.length&255),nr(Ft,Ft.gzhead.extra.length>>8&255)),Ft.gzhead.hcrc&&(wt.adler=s(wt.adler,Ft.pending_buf,Ft.pending,0)),Ft.gzindex=0,Ft.status=dn):(nr(Ft,0),nr(Ft,0),nr(Ft,0),nr(Ft,0),nr(Ft,0),nr(Ft,Ft.level===9?2:Ft.strategy>=dt||Ft.level<2?4:0),nr(Ft,Gn),Ft.status=en);else{var tr=bt+(Ft.w_bits-8<<4)<<8,ct=-1;Ft.strategy>=dt||Ft.level<2?ct=0:Ft.level<6?ct=1:Ft.level===6?ct=2:ct=3,tr|=ct<<6,Ft.strstart!==0&&(tr|=nn),tr+=31-tr%31,Ft.status=en,wn(Ft,tr),Ft.strstart!==0&&(wn(Ft,wt.adler>>>16),wn(Ft,wt.adler&65535)),wt.adler=1}if(Ft.status===dn)if(Ft.gzhead.extra){for(Qt=Ft.pending;Ft.gzindex<(Ft.gzhead.extra.length&65535)&&!(Ft.pending===Ft.pending_buf_size&&(Ft.gzhead.hcrc&&Ft.pending>Qt&&(wt.adler=s(wt.adler,Ft.pending_buf,Ft.pending-Qt,Qt)),Jn(wt),Qt=Ft.pending,Ft.pending===Ft.pending_buf_size));)nr(Ft,Ft.gzhead.extra[Ft.gzindex]&255),Ft.gzindex++;Ft.gzhead.hcrc&&Ft.pending>Qt&&(wt.adler=s(wt.adler,Ft.pending_buf,Ft.pending-Qt,Qt)),Ft.gzindex===Ft.gzhead.extra.length&&(Ft.gzindex=0,Ft.status=$n)}else Ft.status=$n;if(Ft.status===$n)if(Ft.gzhead.name){Qt=Ft.pending;do{if(Ft.pending===Ft.pending_buf_size&&(Ft.gzhead.hcrc&&Ft.pending>Qt&&(wt.adler=s(wt.adler,Ft.pending_buf,Ft.pending-Qt,Qt)),Jn(wt),Qt=Ft.pending,Ft.pending===Ft.pending_buf_size)){cn=1;break}Ft.gzindex<Ft.gzhead.name.length?cn=Ft.gzhead.name.charCodeAt(Ft.gzindex++)&255:cn=0,nr(Ft,cn)}while(cn!==0);Ft.gzhead.hcrc&&Ft.pending>Qt&&(wt.adler=s(wt.adler,Ft.pending_buf,Ft.pending-Qt,Qt)),cn===0&&(Ft.gzindex=0,Ft.status=En)}else Ft.status=En;if(Ft.status===En)if(Ft.gzhead.comment){Qt=Ft.pending;do{if(Ft.pending===Ft.pending_buf_size&&(Ft.gzhead.hcrc&&Ft.pending>Qt&&(wt.adler=s(wt.adler,Ft.pending_buf,Ft.pending-Qt,Qt)),Jn(wt),Qt=Ft.pending,Ft.pending===Ft.pending_buf_size)){cn=1;break}Ft.gzindex<Ft.gzhead.comment.length?cn=Ft.gzhead.comment.charCodeAt(Ft.gzindex++)&255:cn=0,nr(Ft,cn)}while(cn!==0);Ft.gzhead.hcrc&&Ft.pending>Qt&&(wt.adler=s(wt.adler,Ft.pending_buf,Ft.pending-Qt,Qt)),cn===0&&(Ft.status=qt)}else Ft.status=qt;if(Ft.status===qt&&(Ft.gzhead.hcrc?(Ft.pending+2>Ft.pending_buf_size&&Jn(wt),Ft.pending+2<=Ft.pending_buf_size&&(nr(Ft,wt.adler&255),nr(Ft,wt.adler>>8&255),wt.adler=0,Ft.status=en)):Ft.status=en),Ft.pending!==0){if(Jn(wt),wt.avail_out===0)return Ft.last_flush=-1,tt}else if(wt.avail_in===0&&Bn(mn)<=Bn(yn)&&mn!==$)return zn(wt,lt);if(Ft.status===Tn&&wt.avail_in!==0)return zn(wt,lt);if(wt.avail_in!==0||Ft.lookahead!==0||mn!==h&&Ft.status!==Tn){var rt=Ft.strategy===dt?qn(Ft,mn):Ft.strategy===_t?Fn(Ft,mn):Nn[Ft.level].func(Ft,mn);if((rt===Wn||rt===Zn)&&(Ft.status=Tn),rt===Sn||rt===Wn)return wt.avail_out===0&&(Ft.last_flush=-1),tt;if(rt===fn&&(mn===g?i._tr_align(Ft):mn!==b&&(i._tr_stored_block(Ft,0,0,!1),mn===_&&(or(Ft.head),Ft.lookahead===0&&(Ft.strstart=0,Ft.block_start=0,Ft.insert=0))),Jn(wt),wt.avail_out===0))return Ft.last_flush=-1,tt}return mn!==$?tt:Ft.wrap<=0?st:(Ft.wrap===2?(nr(Ft,wt.adler&255),nr(Ft,wt.adler>>8&255),nr(Ft,wt.adler>>16&255),nr(Ft,wt.adler>>24&255),nr(Ft,wt.total_in&255),nr(Ft,wt.total_in>>8&255),nr(Ft,wt.total_in>>16&255),nr(Ft,wt.total_in>>24&255)):(wn(Ft,wt.adler>>>16),wn(Ft,wt.adler&65535)),Jn(wt),Ft.wrap>0&&(Ft.wrap=-Ft.wrap),Ft.pending!==0?tt:st)}function An(wt){var mn;return!wt||!wt.state?at:(mn=wt.state.status,mn!==gn&&mn!==dn&&mn!==$n&&mn!==En&&mn!==qt&&mn!==en&&mn!==Tn?zn(wt,at):(wt.state=null,mn===en?zn(wt,nt):tt))}function sr(wt,mn){var yn=mn.length,Ft,Qt,cn,tr,ct,rt,et,it;if(!wt||!wt.state||(Ft=wt.state,tr=Ft.wrap,tr===2||tr===1&&Ft.status!==gn||Ft.lookahead))return at;for(tr===1&&(wt.adler=a(wt.adler,mn,yn,0)),Ft.wrap=0,yn>=Ft.w_size&&(tr===0&&(or(Ft.head),Ft.strstart=0,Ft.block_start=0,Ft.insert=0),it=new e.Buf8(Ft.w_size),e.arraySet(it,mn,yn-Ft.w_size,Ft.w_size,0),mn=it,yn=Ft.w_size),ct=wt.avail_in,rt=wt.next_in,et=wt.input,wt.avail_in=yn,wt.next_in=0,wt.input=mn,Vn(Ft);Ft.lookahead>=on;){Qt=Ft.strstart,cn=Ft.lookahead-(on-1);do Ft.ins_h=(Ft.ins_h<<Ft.hash_shift^Ft.window[Qt+on-1])&Ft.hash_mask,Ft.prev[Qt&Ft.w_mask]=Ft.head[Ft.ins_h],Ft.head[Ft.ins_h]=Qt,Qt++;while(--cn);Ft.strstart=Qt,Ft.lookahead=on-1,Vn(Ft)}return Ft.strstart+=Ft.lookahead,Ft.block_start=Ft.strstart,Ft.insert=Ft.lookahead,Ft.lookahead=0,Ft.match_length=Ft.prev_length=on-1,Ft.match_available=0,wt.next_in=rt,wt.input=et,wt.avail_in=ct,Ft.wrap=tr,tt}return deflate.deflateInit=vn,deflate.deflateInit2=tn,deflate.deflateReset=kn,deflate.deflateResetKeep=xn,deflate.deflateSetHeader=Pn,deflate.deflate=Pt,deflate.deflateEnd=An,deflate.deflateSetDictionary=sr,deflate.deflateInfo="pako deflate (from Nodeca project)",deflate}var strings={},hasRequiredStrings;function requireStrings(){if(hasRequiredStrings)return strings;hasRequiredStrings=1;var e=requireCommon(),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var s=new e.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;s[254]=s[254]=1,strings.string2buf=function(g){var _,$,b,tt,st,at=g.length,nt=0;for(tt=0;tt<at;tt++)$=g.charCodeAt(tt),($&64512)===55296&&tt+1<at&&(b=g.charCodeAt(tt+1),(b&64512)===56320&&($=65536+($-55296<<10)+(b-56320),tt++)),nt+=$<128?1:$<2048?2:$<65536?3:4;for(_=new e.Buf8(nt),st=0,tt=0;st<nt;tt++)$=g.charCodeAt(tt),($&64512)===55296&&tt+1<at&&(b=g.charCodeAt(tt+1),(b&64512)===56320&&($=65536+($-55296<<10)+(b-56320),tt++)),$<128?_[st++]=$:$<2048?(_[st++]=192|$>>>6,_[st++]=128|$&63):$<65536?(_[st++]=224|$>>>12,_[st++]=128|$>>>6&63,_[st++]=128|$&63):(_[st++]=240|$>>>18,_[st++]=128|$>>>12&63,_[st++]=128|$>>>6&63,_[st++]=128|$&63);return _};function h(g,_){if(_<65534&&(g.subarray&&a||!g.subarray&&i))return String.fromCharCode.apply(null,e.shrinkBuf(g,_));for(var $="",b=0;b<_;b++)$+=String.fromCharCode(g[b]);return $}return strings.buf2binstring=function(g){return h(g,g.length)},strings.binstring2buf=function(g){for(var _=new e.Buf8(g.length),$=0,b=_.length;$<b;$++)_[$]=g.charCodeAt($);return _},strings.buf2string=function(g,_){var $,b,tt,st,at=_||g.length,nt=new Array(at*2);for(b=0,$=0;$<at;){if(tt=g[$++],tt<128){nt[b++]=tt;continue}if(st=s[tt],st>4){nt[b++]=65533,$+=st-1;continue}for(tt&=st===2?31:st===3?15:7;st>1&&$<at;)tt=tt<<6|g[$++]&63,st--;if(st>1){nt[b++]=65533;continue}tt<65536?nt[b++]=tt:(tt-=65536,nt[b++]=55296|tt>>10&1023,nt[b++]=56320|tt&1023)}return h(nt,b)},strings.utf8border=function(g,_){var $;for(_=_||g.length,_>g.length&&(_=g.length),$=_-1;$>=0&&(g[$]&192)===128;)$--;return $<0||$===0?_:$+s[g[$]]>_?$:_},strings}var zstream,hasRequiredZstream;function requireZstream(){if(hasRequiredZstream)return zstream;hasRequiredZstream=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return zstream=e,zstream}var hasRequiredDeflate;function requireDeflate(){if(hasRequiredDeflate)return deflate$1;hasRequiredDeflate=1;var e=requireDeflate$1(),i=requireCommon(),a=requireStrings(),s=requireMessages(),o=requireZstream(),h=Object.prototype.toString,g=0,_=4,$=0,b=1,tt=2,st=-1,at=0,nt=8;function lt(_t){if(!(this instanceof lt))return new lt(_t);this.options=i.assign({level:st,method:nt,chunkSize:16384,windowBits:15,memLevel:8,strategy:at,to:""},_t||{});var ut=this.options;ut.raw&&ut.windowBits>0?ut.windowBits=-ut.windowBits:ut.gzip&&ut.windowBits>0&&ut.windowBits<16&&(ut.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var mt=e.deflateInit2(this.strm,ut.level,ut.method,ut.windowBits,ut.memLevel,ut.strategy);if(mt!==$)throw new Error(s[mt]);if(ut.header&&e.deflateSetHeader(this.strm,ut.header),ut.dictionary){var kt;if(typeof ut.dictionary=="string"?kt=a.string2buf(ut.dictionary):h.call(ut.dictionary)==="[object ArrayBuffer]"?kt=new Uint8Array(ut.dictionary):kt=ut.dictionary,mt=e.deflateSetDictionary(this.strm,kt),mt!==$)throw new Error(s[mt]);this._dict_set=!0}}lt.prototype.push=function(_t,ut){var mt=this.strm,kt=this.options.chunkSize,bt,vt;if(this.ended)return!1;vt=ut===~~ut?ut:ut===!0?_:g,typeof _t=="string"?mt.input=a.string2buf(_t):h.call(_t)==="[object ArrayBuffer]"?mt.input=new Uint8Array(_t):mt.input=_t,mt.next_in=0,mt.avail_in=mt.input.length;do{if(mt.avail_out===0&&(mt.output=new i.Buf8(kt),mt.next_out=0,mt.avail_out=kt),bt=e.deflate(mt,vt),bt!==b&&bt!==$)return this.onEnd(bt),this.ended=!0,!1;(mt.avail_out===0||mt.avail_in===0&&(vt===_||vt===tt))&&(this.options.to==="string"?this.onData(a.buf2binstring(i.shrinkBuf(mt.output,mt.next_out))):this.onData(i.shrinkBuf(mt.output,mt.next_out)))}while((mt.avail_in>0||mt.avail_out===0)&&bt!==b);return vt===_?(bt=e.deflateEnd(this.strm),this.onEnd(bt),this.ended=!0,bt===$):(vt===tt&&(this.onEnd($),mt.avail_out=0),!0)},lt.prototype.onData=function(_t){this.chunks.push(_t)},lt.prototype.onEnd=function(_t){_t===$&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=_t,this.msg=this.strm.msg};function ft(_t,ut){var mt=new lt(ut);if(mt.push(_t,!0),mt.err)throw mt.msg||s[mt.err];return mt.result}function pt(_t,ut){return ut=ut||{},ut.raw=!0,ft(_t,ut)}function dt(_t,ut){return ut=ut||{},ut.gzip=!0,ft(_t,ut)}return deflate$1.Deflate=lt,deflate$1.deflate=ft,deflate$1.deflateRaw=pt,deflate$1.gzip=dt,deflate$1}var inflate$1={},inflate={},inffast,hasRequiredInffast;function requireInffast(){if(hasRequiredInffast)return inffast;hasRequiredInffast=1;var e=30,i=12;return inffast=function(a,s){var o,h,g,_,$,b,tt,st,at,nt,lt,ft,pt,dt,_t,ut,mt,kt,bt,vt,Et,Mt,At,zt,Vt;o=a.state,h=a.next_in,zt=a.input,g=h+(a.avail_in-5),_=a.next_out,Vt=a.output,$=_-(s-a.avail_out),b=_+(a.avail_out-257),tt=o.dmax,st=o.wsize,at=o.whave,nt=o.wnext,lt=o.window,ft=o.hold,pt=o.bits,dt=o.lencode,_t=o.distcode,ut=(1<<o.lenbits)-1,mt=(1<<o.distbits)-1;t:do{pt<15&&(ft+=zt[h++]<<pt,pt+=8,ft+=zt[h++]<<pt,pt+=8),kt=dt[ft&ut];e:for(;;){if(bt=kt>>>24,ft>>>=bt,pt-=bt,bt=kt>>>16&255,bt===0)Vt[_++]=kt&65535;else if(bt&16){vt=kt&65535,bt&=15,bt&&(pt<bt&&(ft+=zt[h++]<<pt,pt+=8),vt+=ft&(1<<bt)-1,ft>>>=bt,pt-=bt),pt<15&&(ft+=zt[h++]<<pt,pt+=8,ft+=zt[h++]<<pt,pt+=8),kt=_t[ft&mt];n:for(;;){if(bt=kt>>>24,ft>>>=bt,pt-=bt,bt=kt>>>16&255,bt&16){if(Et=kt&65535,bt&=15,pt<bt&&(ft+=zt[h++]<<pt,pt+=8,pt<bt&&(ft+=zt[h++]<<pt,pt+=8)),Et+=ft&(1<<bt)-1,Et>tt){a.msg="invalid distance too far back",o.mode=e;break t}if(ft>>>=bt,pt-=bt,bt=_-$,Et>bt){if(bt=Et-bt,bt>at&&o.sane){a.msg="invalid distance too far back",o.mode=e;break t}if(Mt=0,At=lt,nt===0){if(Mt+=st-bt,bt<vt){vt-=bt;do Vt[_++]=lt[Mt++];while(--bt);Mt=_-Et,At=Vt}}else if(nt<bt){if(Mt+=st+nt-bt,bt-=nt,bt<vt){vt-=bt;do Vt[_++]=lt[Mt++];while(--bt);if(Mt=0,nt<vt){bt=nt,vt-=bt;do Vt[_++]=lt[Mt++];while(--bt);Mt=_-Et,At=Vt}}}else if(Mt+=nt-bt,bt<vt){vt-=bt;do Vt[_++]=lt[Mt++];while(--bt);Mt=_-Et,At=Vt}for(;vt>2;)Vt[_++]=At[Mt++],Vt[_++]=At[Mt++],Vt[_++]=At[Mt++],vt-=3;vt&&(Vt[_++]=At[Mt++],vt>1&&(Vt[_++]=At[Mt++]))}else{Mt=_-Et;do Vt[_++]=Vt[Mt++],Vt[_++]=Vt[Mt++],Vt[_++]=Vt[Mt++],vt-=3;while(vt>2);vt&&(Vt[_++]=Vt[Mt++],vt>1&&(Vt[_++]=Vt[Mt++]))}}else if(bt&64){a.msg="invalid distance code",o.mode=e;break t}else{kt=_t[(kt&65535)+(ft&(1<<bt)-1)];continue n}break}}else if(bt&64)if(bt&32){o.mode=i;break t}else{a.msg="invalid literal/length code",o.mode=e;break t}else{kt=dt[(kt&65535)+(ft&(1<<bt)-1)];continue e}break}}while(h<g&&_<b);vt=pt>>3,h-=vt,pt-=vt<<3,ft&=(1<<pt)-1,a.next_in=h,a.next_out=_,a.avail_in=h<g?5+(g-h):5-(h-g),a.avail_out=_<b?257+(b-_):257-(_-b),o.hold=ft,o.bits=pt},inffast}var inftrees,hasRequiredInftrees;function requireInftrees(){if(hasRequiredInftrees)return inftrees;hasRequiredInftrees=1;var e=requireCommon(),i=15,a=852,s=592,o=0,h=1,g=2,_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],$=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],b=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],tt=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return inftrees=function(st,at,nt,lt,ft,pt,dt,_t){var ut=_t.bits,mt=0,kt=0,bt=0,vt=0,Et=0,Mt=0,At=0,zt=0,Vt=0,Gt=0,Kt,Wt,sn,on,Xt,ln=null,nn=0,gn,dn=new e.Buf16(i+1),$n=new e.Buf16(i+1),En=null,qt=0,en,Tn,Sn;for(mt=0;mt<=i;mt++)dn[mt]=0;for(kt=0;kt<lt;kt++)dn[at[nt+kt]]++;for(Et=ut,vt=i;vt>=1&&dn[vt]===0;vt--);if(Et>vt&&(Et=vt),vt===0)return ft[pt++]=1<<24|64<<16|0,ft[pt++]=1<<24|64<<16|0,_t.bits=1,0;for(bt=1;bt<vt&&dn[bt]===0;bt++);for(Et<bt&&(Et=bt),zt=1,mt=1;mt<=i;mt++)if(zt<<=1,zt-=dn[mt],zt<0)return-1;if(zt>0&&(st===o||vt!==1))return-1;for($n[1]=0,mt=1;mt<i;mt++)$n[mt+1]=$n[mt]+dn[mt];for(kt=0;kt<lt;kt++)at[nt+kt]!==0&&(dt[$n[at[nt+kt]]++]=kt);if(st===o?(ln=En=dt,gn=19):st===h?(ln=_,nn-=257,En=$,qt-=257,gn=256):(ln=b,En=tt,gn=-1),Gt=0,kt=0,mt=bt,Xt=pt,Mt=Et,At=0,sn=-1,Vt=1<<Et,on=Vt-1,st===h&&Vt>a||st===g&&Vt>s)return 1;for(;;){en=mt-At,dt[kt]<gn?(Tn=0,Sn=dt[kt]):dt[kt]>gn?(Tn=En[qt+dt[kt]],Sn=ln[nn+dt[kt]]):(Tn=96,Sn=0),Kt=1<<mt-At,Wt=1<<Mt,bt=Wt;do Wt-=Kt,ft[Xt+(Gt>>At)+Wt]=en<<24|Tn<<16|Sn|0;while(Wt!==0);for(Kt=1<<mt-1;Gt&Kt;)Kt>>=1;if(Kt!==0?(Gt&=Kt-1,Gt+=Kt):Gt=0,kt++,--dn[mt]===0){if(mt===vt)break;mt=at[nt+dt[kt]]}if(mt>Et&&(Gt&on)!==sn){for(At===0&&(At=Et),Xt+=bt,Mt=mt-At,zt=1<<Mt;Mt+At<vt&&(zt-=dn[Mt+At],!(zt<=0));)Mt++,zt<<=1;if(Vt+=1<<Mt,st===h&&Vt>a||st===g&&Vt>s)return 1;sn=Gt&on,ft[sn]=Et<<24|Mt<<16|Xt-pt|0}}return Gt!==0&&(ft[Xt+Gt]=mt-At<<24|64<<16|0),_t.bits=Et,0},inftrees}var hasRequiredInflate$1;function requireInflate$1(){if(hasRequiredInflate$1)return inflate;hasRequiredInflate$1=1;var e=requireCommon(),i=requireAdler32(),a=requireCrc32(),s=requireInffast(),o=requireInftrees(),h=0,g=1,_=2,$=4,b=5,tt=6,st=0,at=1,nt=2,lt=-2,ft=-3,pt=-4,dt=-5,_t=8,ut=1,mt=2,kt=3,bt=4,vt=5,Et=6,Mt=7,At=8,zt=9,Vt=10,Gt=11,Kt=12,Wt=13,sn=14,on=15,Xt=16,ln=17,nn=18,gn=19,dn=20,$n=21,En=22,qt=23,en=24,Tn=25,Sn=26,fn=27,Wn=28,Zn=29,Gn=30,zn=31,Bn=32,or=852,Jn=592,Un=15,nr=Un;function wn(tn){return(tn>>>24&255)+(tn>>>8&65280)+((tn&65280)<<8)+((tn&255)<<24)}function jn(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function er(tn){var vn;return!tn||!tn.state?lt:(vn=tn.state,tn.total_in=tn.total_out=vn.total=0,tn.msg="",vn.wrap&&(tn.adler=vn.wrap&1),vn.mode=ut,vn.last=0,vn.havedict=0,vn.dmax=32768,vn.head=null,vn.hold=0,vn.bits=0,vn.lencode=vn.lendyn=new e.Buf32(or),vn.distcode=vn.distdyn=new e.Buf32(Jn),vn.sane=1,vn.back=-1,st)}function Vn(tn){var vn;return!tn||!tn.state?lt:(vn=tn.state,vn.wsize=0,vn.whave=0,vn.wnext=0,er(tn))}function Rn(tn,vn){var Pt,An;return!tn||!tn.state||(An=tn.state,vn<0?(Pt=0,vn=-vn):(Pt=(vn>>4)+1,vn<48&&(vn&=15)),vn&&(vn<8||vn>15))?lt:(An.window!==null&&An.wbits!==vn&&(An.window=null),An.wrap=Pt,An.wbits=vn,Vn(tn))}function ar(tn,vn){var Pt,An;return tn?(An=new jn,tn.state=An,An.window=null,Pt=Rn(tn,vn),Pt!==st&&(tn.state=null),Pt):lt}function Hn(tn){return ar(tn,nr)}var Fn=!0,qn,ir;function Nn(tn){if(Fn){var vn;for(qn=new e.Buf32(512),ir=new e.Buf32(32),vn=0;vn<144;)tn.lens[vn++]=8;for(;vn<256;)tn.lens[vn++]=9;for(;vn<280;)tn.lens[vn++]=7;for(;vn<288;)tn.lens[vn++]=8;for(o(g,tn.lens,0,288,qn,0,tn.work,{bits:9}),vn=0;vn<32;)tn.lens[vn++]=5;o(_,tn.lens,0,32,ir,0,tn.work,{bits:5}),Fn=!1}tn.lencode=qn,tn.lenbits=9,tn.distcode=ir,tn.distbits=5}function Kn(tn,vn,Pt,An){var sr,wt=tn.state;return wt.window===null&&(wt.wsize=1<<wt.wbits,wt.wnext=0,wt.whave=0,wt.window=new e.Buf8(wt.wsize)),An>=wt.wsize?(e.arraySet(wt.window,vn,Pt-wt.wsize,wt.wsize,0),wt.wnext=0,wt.whave=wt.wsize):(sr=wt.wsize-wt.wnext,sr>An&&(sr=An),e.arraySet(wt.window,vn,Pt-An,sr,wt.wnext),An-=sr,An?(e.arraySet(wt.window,vn,Pt-An,An,0),wt.wnext=An,wt.whave=wt.wsize):(wt.wnext+=sr,wt.wnext===wt.wsize&&(wt.wnext=0),wt.whave<wt.wsize&&(wt.whave+=sr))),0}function Ut(tn,vn){var Pt,An,sr,wt,mn,yn,Ft,Qt,cn,tr,ct,rt,et,it,ht=0,yt,Lt,Nt,Ct,Ht,rn,jt,pn,Mn=new e.Buf8(4),un,_n,On=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!tn||!tn.state||!tn.output||!tn.input&&tn.avail_in!==0)return lt;Pt=tn.state,Pt.mode===Kt&&(Pt.mode=Wt),mn=tn.next_out,sr=tn.output,Ft=tn.avail_out,wt=tn.next_in,An=tn.input,yn=tn.avail_in,Qt=Pt.hold,cn=Pt.bits,tr=yn,ct=Ft,pn=st;t:for(;;)switch(Pt.mode){case ut:if(Pt.wrap===0){Pt.mode=Wt;break}for(;cn<16;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(Pt.wrap&2&&Qt===35615){Pt.check=0,Mn[0]=Qt&255,Mn[1]=Qt>>>8&255,Pt.check=a(Pt.check,Mn,2,0),Qt=0,cn=0,Pt.mode=mt;break}if(Pt.flags=0,Pt.head&&(Pt.head.done=!1),!(Pt.wrap&1)||(((Qt&255)<<8)+(Qt>>8))%31){tn.msg="incorrect header check",Pt.mode=Gn;break}if((Qt&15)!==_t){tn.msg="unknown compression method",Pt.mode=Gn;break}if(Qt>>>=4,cn-=4,jt=(Qt&15)+8,Pt.wbits===0)Pt.wbits=jt;else if(jt>Pt.wbits){tn.msg="invalid window size",Pt.mode=Gn;break}Pt.dmax=1<<jt,tn.adler=Pt.check=1,Pt.mode=Qt&512?Vt:Kt,Qt=0,cn=0;break;case mt:for(;cn<16;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(Pt.flags=Qt,(Pt.flags&255)!==_t){tn.msg="unknown compression method",Pt.mode=Gn;break}if(Pt.flags&57344){tn.msg="unknown header flags set",Pt.mode=Gn;break}Pt.head&&(Pt.head.text=Qt>>8&1),Pt.flags&512&&(Mn[0]=Qt&255,Mn[1]=Qt>>>8&255,Pt.check=a(Pt.check,Mn,2,0)),Qt=0,cn=0,Pt.mode=kt;case kt:for(;cn<32;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Pt.head&&(Pt.head.time=Qt),Pt.flags&512&&(Mn[0]=Qt&255,Mn[1]=Qt>>>8&255,Mn[2]=Qt>>>16&255,Mn[3]=Qt>>>24&255,Pt.check=a(Pt.check,Mn,4,0)),Qt=0,cn=0,Pt.mode=bt;case bt:for(;cn<16;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Pt.head&&(Pt.head.xflags=Qt&255,Pt.head.os=Qt>>8),Pt.flags&512&&(Mn[0]=Qt&255,Mn[1]=Qt>>>8&255,Pt.check=a(Pt.check,Mn,2,0)),Qt=0,cn=0,Pt.mode=vt;case vt:if(Pt.flags&1024){for(;cn<16;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Pt.length=Qt,Pt.head&&(Pt.head.extra_len=Qt),Pt.flags&512&&(Mn[0]=Qt&255,Mn[1]=Qt>>>8&255,Pt.check=a(Pt.check,Mn,2,0)),Qt=0,cn=0}else Pt.head&&(Pt.head.extra=null);Pt.mode=Et;case Et:if(Pt.flags&1024&&(rt=Pt.length,rt>yn&&(rt=yn),rt&&(Pt.head&&(jt=Pt.head.extra_len-Pt.length,Pt.head.extra||(Pt.head.extra=new Array(Pt.head.extra_len)),e.arraySet(Pt.head.extra,An,wt,rt,jt)),Pt.flags&512&&(Pt.check=a(Pt.check,An,rt,wt)),yn-=rt,wt+=rt,Pt.length-=rt),Pt.length))break t;Pt.length=0,Pt.mode=Mt;case Mt:if(Pt.flags&2048){if(yn===0)break t;rt=0;do jt=An[wt+rt++],Pt.head&&jt&&Pt.length<65536&&(Pt.head.name+=String.fromCharCode(jt));while(jt&&rt<yn);if(Pt.flags&512&&(Pt.check=a(Pt.check,An,rt,wt)),yn-=rt,wt+=rt,jt)break t}else Pt.head&&(Pt.head.name=null);Pt.length=0,Pt.mode=At;case At:if(Pt.flags&4096){if(yn===0)break t;rt=0;do jt=An[wt+rt++],Pt.head&&jt&&Pt.length<65536&&(Pt.head.comment+=String.fromCharCode(jt));while(jt&&rt<yn);if(Pt.flags&512&&(Pt.check=a(Pt.check,An,rt,wt)),yn-=rt,wt+=rt,jt)break t}else Pt.head&&(Pt.head.comment=null);Pt.mode=zt;case zt:if(Pt.flags&512){for(;cn<16;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(Qt!==(Pt.check&65535)){tn.msg="header crc mismatch",Pt.mode=Gn;break}Qt=0,cn=0}Pt.head&&(Pt.head.hcrc=Pt.flags>>9&1,Pt.head.done=!0),tn.adler=Pt.check=0,Pt.mode=Kt;break;case Vt:for(;cn<32;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}tn.adler=Pt.check=wn(Qt),Qt=0,cn=0,Pt.mode=Gt;case Gt:if(Pt.havedict===0)return tn.next_out=mn,tn.avail_out=Ft,tn.next_in=wt,tn.avail_in=yn,Pt.hold=Qt,Pt.bits=cn,nt;tn.adler=Pt.check=1,Pt.mode=Kt;case Kt:if(vn===b||vn===tt)break t;case Wt:if(Pt.last){Qt>>>=cn&7,cn-=cn&7,Pt.mode=fn;break}for(;cn<3;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}switch(Pt.last=Qt&1,Qt>>>=1,cn-=1,Qt&3){case 0:Pt.mode=sn;break;case 1:if(Nn(Pt),Pt.mode=dn,vn===tt){Qt>>>=2,cn-=2;break t}break;case 2:Pt.mode=ln;break;case 3:tn.msg="invalid block type",Pt.mode=Gn}Qt>>>=2,cn-=2;break;case sn:for(Qt>>>=cn&7,cn-=cn&7;cn<32;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if((Qt&65535)!==(Qt>>>16^65535)){tn.msg="invalid stored block lengths",Pt.mode=Gn;break}if(Pt.length=Qt&65535,Qt=0,cn=0,Pt.mode=on,vn===tt)break t;case on:Pt.mode=Xt;case Xt:if(rt=Pt.length,rt){if(rt>yn&&(rt=yn),rt>Ft&&(rt=Ft),rt===0)break t;e.arraySet(sr,An,wt,rt,mn),yn-=rt,wt+=rt,Ft-=rt,mn+=rt,Pt.length-=rt;break}Pt.mode=Kt;break;case ln:for(;cn<14;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(Pt.nlen=(Qt&31)+257,Qt>>>=5,cn-=5,Pt.ndist=(Qt&31)+1,Qt>>>=5,cn-=5,Pt.ncode=(Qt&15)+4,Qt>>>=4,cn-=4,Pt.nlen>286||Pt.ndist>30){tn.msg="too many length or distance symbols",Pt.mode=Gn;break}Pt.have=0,Pt.mode=nn;case nn:for(;Pt.have<Pt.ncode;){for(;cn<3;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Pt.lens[On[Pt.have++]]=Qt&7,Qt>>>=3,cn-=3}for(;Pt.have<19;)Pt.lens[On[Pt.have++]]=0;if(Pt.lencode=Pt.lendyn,Pt.lenbits=7,un={bits:Pt.lenbits},pn=o(h,Pt.lens,0,19,Pt.lencode,0,Pt.work,un),Pt.lenbits=un.bits,pn){tn.msg="invalid code lengths set",Pt.mode=Gn;break}Pt.have=0,Pt.mode=gn;case gn:for(;Pt.have<Pt.nlen+Pt.ndist;){for(;ht=Pt.lencode[Qt&(1<<Pt.lenbits)-1],yt=ht>>>24,Lt=ht>>>16&255,Nt=ht&65535,!(yt<=cn);){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(Nt<16)Qt>>>=yt,cn-=yt,Pt.lens[Pt.have++]=Nt;else{if(Nt===16){for(_n=yt+2;cn<_n;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(Qt>>>=yt,cn-=yt,Pt.have===0){tn.msg="invalid bit length repeat",Pt.mode=Gn;break}jt=Pt.lens[Pt.have-1],rt=3+(Qt&3),Qt>>>=2,cn-=2}else if(Nt===17){for(_n=yt+3;cn<_n;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Qt>>>=yt,cn-=yt,jt=0,rt=3+(Qt&7),Qt>>>=3,cn-=3}else{for(_n=yt+7;cn<_n;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Qt>>>=yt,cn-=yt,jt=0,rt=11+(Qt&127),Qt>>>=7,cn-=7}if(Pt.have+rt>Pt.nlen+Pt.ndist){tn.msg="invalid bit length repeat",Pt.mode=Gn;break}for(;rt--;)Pt.lens[Pt.have++]=jt}}if(Pt.mode===Gn)break;if(Pt.lens[256]===0){tn.msg="invalid code -- missing end-of-block",Pt.mode=Gn;break}if(Pt.lenbits=9,un={bits:Pt.lenbits},pn=o(g,Pt.lens,0,Pt.nlen,Pt.lencode,0,Pt.work,un),Pt.lenbits=un.bits,pn){tn.msg="invalid literal/lengths set",Pt.mode=Gn;break}if(Pt.distbits=6,Pt.distcode=Pt.distdyn,un={bits:Pt.distbits},pn=o(_,Pt.lens,Pt.nlen,Pt.ndist,Pt.distcode,0,Pt.work,un),Pt.distbits=un.bits,pn){tn.msg="invalid distances set",Pt.mode=Gn;break}if(Pt.mode=dn,vn===tt)break t;case dn:Pt.mode=$n;case $n:if(yn>=6&&Ft>=258){tn.next_out=mn,tn.avail_out=Ft,tn.next_in=wt,tn.avail_in=yn,Pt.hold=Qt,Pt.bits=cn,s(tn,ct),mn=tn.next_out,sr=tn.output,Ft=tn.avail_out,wt=tn.next_in,An=tn.input,yn=tn.avail_in,Qt=Pt.hold,cn=Pt.bits,Pt.mode===Kt&&(Pt.back=-1);break}for(Pt.back=0;ht=Pt.lencode[Qt&(1<<Pt.lenbits)-1],yt=ht>>>24,Lt=ht>>>16&255,Nt=ht&65535,!(yt<=cn);){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(Lt&&!(Lt&240)){for(Ct=yt,Ht=Lt,rn=Nt;ht=Pt.lencode[rn+((Qt&(1<<Ct+Ht)-1)>>Ct)],yt=ht>>>24,Lt=ht>>>16&255,Nt=ht&65535,!(Ct+yt<=cn);){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Qt>>>=Ct,cn-=Ct,Pt.back+=Ct}if(Qt>>>=yt,cn-=yt,Pt.back+=yt,Pt.length=Nt,Lt===0){Pt.mode=Sn;break}if(Lt&32){Pt.back=-1,Pt.mode=Kt;break}if(Lt&64){tn.msg="invalid literal/length code",Pt.mode=Gn;break}Pt.extra=Lt&15,Pt.mode=En;case En:if(Pt.extra){for(_n=Pt.extra;cn<_n;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Pt.length+=Qt&(1<<Pt.extra)-1,Qt>>>=Pt.extra,cn-=Pt.extra,Pt.back+=Pt.extra}Pt.was=Pt.length,Pt.mode=qt;case qt:for(;ht=Pt.distcode[Qt&(1<<Pt.distbits)-1],yt=ht>>>24,Lt=ht>>>16&255,Nt=ht&65535,!(yt<=cn);){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(!(Lt&240)){for(Ct=yt,Ht=Lt,rn=Nt;ht=Pt.distcode[rn+((Qt&(1<<Ct+Ht)-1)>>Ct)],yt=ht>>>24,Lt=ht>>>16&255,Nt=ht&65535,!(Ct+yt<=cn);){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Qt>>>=Ct,cn-=Ct,Pt.back+=Ct}if(Qt>>>=yt,cn-=yt,Pt.back+=yt,Lt&64){tn.msg="invalid distance code",Pt.mode=Gn;break}Pt.offset=Nt,Pt.extra=Lt&15,Pt.mode=en;case en:if(Pt.extra){for(_n=Pt.extra;cn<_n;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}Pt.offset+=Qt&(1<<Pt.extra)-1,Qt>>>=Pt.extra,cn-=Pt.extra,Pt.back+=Pt.extra}if(Pt.offset>Pt.dmax){tn.msg="invalid distance too far back",Pt.mode=Gn;break}Pt.mode=Tn;case Tn:if(Ft===0)break t;if(rt=ct-Ft,Pt.offset>rt){if(rt=Pt.offset-rt,rt>Pt.whave&&Pt.sane){tn.msg="invalid distance too far back",Pt.mode=Gn;break}rt>Pt.wnext?(rt-=Pt.wnext,et=Pt.wsize-rt):et=Pt.wnext-rt,rt>Pt.length&&(rt=Pt.length),it=Pt.window}else it=sr,et=mn-Pt.offset,rt=Pt.length;rt>Ft&&(rt=Ft),Ft-=rt,Pt.length-=rt;do sr[mn++]=it[et++];while(--rt);Pt.length===0&&(Pt.mode=$n);break;case Sn:if(Ft===0)break t;sr[mn++]=Pt.length,Ft--,Pt.mode=$n;break;case fn:if(Pt.wrap){for(;cn<32;){if(yn===0)break t;yn--,Qt|=An[wt++]<<cn,cn+=8}if(ct-=Ft,tn.total_out+=ct,Pt.total+=ct,ct&&(tn.adler=Pt.check=Pt.flags?a(Pt.check,sr,ct,mn-ct):i(Pt.check,sr,ct,mn-ct)),ct=Ft,(Pt.flags?Qt:wn(Qt))!==Pt.check){tn.msg="incorrect data check",Pt.mode=Gn;break}Qt=0,cn=0}Pt.mode=Wn;case Wn:if(Pt.wrap&&Pt.flags){for(;cn<32;){if(yn===0)break t;yn--,Qt+=An[wt++]<<cn,cn+=8}if(Qt!==(Pt.total&4294967295)){tn.msg="incorrect length check",Pt.mode=Gn;break}Qt=0,cn=0}Pt.mode=Zn;case Zn:pn=at;break t;case Gn:pn=ft;break t;case zn:return pt;case Bn:default:return lt}return tn.next_out=mn,tn.avail_out=Ft,tn.next_in=wt,tn.avail_in=yn,Pt.hold=Qt,Pt.bits=cn,(Pt.wsize||ct!==tn.avail_out&&Pt.mode<Gn&&(Pt.mode<fn||vn!==$))&&Kn(tn,tn.output,tn.next_out,ct-tn.avail_out),tr-=tn.avail_in,ct-=tn.avail_out,tn.total_in+=tr,tn.total_out+=ct,Pt.total+=ct,Pt.wrap&&ct&&(tn.adler=Pt.check=Pt.flags?a(Pt.check,sr,ct,tn.next_out-ct):i(Pt.check,sr,ct,tn.next_out-ct)),tn.data_type=Pt.bits+(Pt.last?64:0)+(Pt.mode===Kt?128:0)+(Pt.mode===dn||Pt.mode===on?256:0),(tr===0&&ct===0||vn===$)&&pn===st&&(pn=dt),pn}function xn(tn){if(!tn||!tn.state)return lt;var vn=tn.state;return vn.window&&(vn.window=null),tn.state=null,st}function kn(tn,vn){var Pt;return!tn||!tn.state||(Pt=tn.state,(Pt.wrap&2)===0)?lt:(Pt.head=vn,vn.done=!1,st)}function Pn(tn,vn){var Pt=vn.length,An,sr,wt;return!tn||!tn.state||(An=tn.state,An.wrap!==0&&An.mode!==Gt)?lt:An.mode===Gt&&(sr=1,sr=i(sr,vn,Pt,0),sr!==An.check)?ft:(wt=Kn(tn,vn,Pt,Pt),wt?(An.mode=zn,pt):(An.havedict=1,st))}return inflate.inflateReset=Vn,inflate.inflateReset2=Rn,inflate.inflateResetKeep=er,inflate.inflateInit=Hn,inflate.inflateInit2=ar,inflate.inflate=Ut,inflate.inflateEnd=xn,inflate.inflateGetHeader=kn,inflate.inflateSetDictionary=Pn,inflate.inflateInfo="pako inflate (from Nodeca project)",inflate}var constants,hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),constants}var gzheader,hasRequiredGzheader;function requireGzheader(){if(hasRequiredGzheader)return gzheader;hasRequiredGzheader=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return gzheader=e,gzheader}var hasRequiredInflate;function requireInflate(){if(hasRequiredInflate)return inflate$1;hasRequiredInflate=1;var e=requireInflate$1(),i=requireCommon(),a=requireStrings(),s=requireConstants(),o=requireMessages(),h=requireZstream(),g=requireGzheader(),_=Object.prototype.toString;function $(st){if(!(this instanceof $))return new $(st);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},st||{});var at=this.options;at.raw&&at.windowBits>=0&&at.windowBits<16&&(at.windowBits=-at.windowBits,at.windowBits===0&&(at.windowBits=-15)),at.windowBits>=0&&at.windowBits<16&&!(st&&st.windowBits)&&(at.windowBits+=32),at.windowBits>15&&at.windowBits<48&&!(at.windowBits&15)&&(at.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var nt=e.inflateInit2(this.strm,at.windowBits);if(nt!==s.Z_OK)throw new Error(o[nt]);if(this.header=new g,e.inflateGetHeader(this.strm,this.header),at.dictionary&&(typeof at.dictionary=="string"?at.dictionary=a.string2buf(at.dictionary):_.call(at.dictionary)==="[object ArrayBuffer]"&&(at.dictionary=new Uint8Array(at.dictionary)),at.raw&&(nt=e.inflateSetDictionary(this.strm,at.dictionary),nt!==s.Z_OK)))throw new Error(o[nt])}$.prototype.push=function(st,at){var nt=this.strm,lt=this.options.chunkSize,ft=this.options.dictionary,pt,dt,_t,ut,mt,kt=!1;if(this.ended)return!1;dt=at===~~at?at:at===!0?s.Z_FINISH:s.Z_NO_FLUSH,typeof st=="string"?nt.input=a.binstring2buf(st):_.call(st)==="[object ArrayBuffer]"?nt.input=new Uint8Array(st):nt.input=st,nt.next_in=0,nt.avail_in=nt.input.length;do{if(nt.avail_out===0&&(nt.output=new i.Buf8(lt),nt.next_out=0,nt.avail_out=lt),pt=e.inflate(nt,s.Z_NO_FLUSH),pt===s.Z_NEED_DICT&&ft&&(pt=e.inflateSetDictionary(this.strm,ft)),pt===s.Z_BUF_ERROR&&kt===!0&&(pt=s.Z_OK,kt=!1),pt!==s.Z_STREAM_END&&pt!==s.Z_OK)return this.onEnd(pt),this.ended=!0,!1;nt.next_out&&(nt.avail_out===0||pt===s.Z_STREAM_END||nt.avail_in===0&&(dt===s.Z_FINISH||dt===s.Z_SYNC_FLUSH))&&(this.options.to==="string"?(_t=a.utf8border(nt.output,nt.next_out),ut=nt.next_out-_t,mt=a.buf2string(nt.output,_t),nt.next_out=ut,nt.avail_out=lt-ut,ut&&i.arraySet(nt.output,nt.output,_t,ut,0),this.onData(mt)):this.onData(i.shrinkBuf(nt.output,nt.next_out))),nt.avail_in===0&&nt.avail_out===0&&(kt=!0)}while((nt.avail_in>0||nt.avail_out===0)&&pt!==s.Z_STREAM_END);return pt===s.Z_STREAM_END&&(dt=s.Z_FINISH),dt===s.Z_FINISH?(pt=e.inflateEnd(this.strm),this.onEnd(pt),this.ended=!0,pt===s.Z_OK):(dt===s.Z_SYNC_FLUSH&&(this.onEnd(s.Z_OK),nt.avail_out=0),!0)},$.prototype.onData=function(st){this.chunks.push(st)},$.prototype.onEnd=function(st){st===s.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=st,this.msg=this.strm.msg};function b(st,at){var nt=new $(at);if(nt.push(st,!0),nt.err)throw nt.msg||o[nt.err];return nt.result}function tt(st,at){return at=at||{},at.raw=!0,b(st,at)}return inflate$1.Inflate=$,inflate$1.inflate=b,inflate$1.inflateRaw=tt,inflate$1.ungzip=b,inflate$1}var pako_1,hasRequiredPako;function requirePako(){if(hasRequiredPako)return pako_1;hasRequiredPako=1;var e=requireCommon().assign,i=requireDeflate(),a=requireInflate(),s=requireConstants(),o={};return e(o,i,a,s),pako_1=o,pako_1}var pakoExports=requirePako();const pako=getDefaultExportFromCjs(pakoExports);var UPNG={};UPNG.toRGBA8=function(e){var i=e.width,a=e.height;if(e.tabs.acTL==null)return[UPNG.toRGBA8.decodeImage(e.data,i,a,e).buffer];var s=[];e.frames[0].data==null&&(e.frames[0].data=e.data);for(var o=i*a*4,h=new Uint8Array(o),g=new Uint8Array(o),_=new Uint8Array(o),$=0;$<e.frames.length;$++){var b=e.frames[$],tt=b.rect.x,st=b.rect.y,at=b.rect.width,nt=b.rect.height,lt=UPNG.toRGBA8.decodeImage(b.data,at,nt,e);if($!=0)for(var ft=0;ft<o;ft++)_[ft]=h[ft];if(b.blend==0?UPNG._copyTile(lt,at,nt,h,i,a,tt,st,0):b.blend==1&&UPNG._copyTile(lt,at,nt,h,i,a,tt,st,1),s.push(h.buffer.slice(0)),b.dispose!=0){if(b.dispose==1)UPNG._copyTile(g,at,nt,h,i,a,tt,st,0);else if(b.dispose==2)for(var ft=0;ft<o;ft++)h[ft]=_[ft]}}return s};UPNG.toRGBA8.decodeImage=function(e,i,a,s){var o=i*a,h=UPNG.decode._getBPP(s),g=Math.ceil(i*h/8),_=new Uint8Array(o*4),$=new Uint32Array(_.buffer),b=s.ctype,tt=s.depth,st=UPNG._bin.readUshort;if(b==6){var at=o<<2;if(tt==8)for(var nt=0;nt<at;nt+=4)_[nt]=e[nt],_[nt+1]=e[nt+1],_[nt+2]=e[nt+2],_[nt+3]=e[nt+3];if(tt==16)for(var nt=0;nt<at;nt++)_[nt]=e[nt<<1]}else if(b==2){var lt=s.tabs.tRNS;if(lt==null){if(tt==8)for(var nt=0;nt<o;nt++){var ft=nt*3;$[nt]=255<<24|e[ft+2]<<16|e[ft+1]<<8|e[ft]}if(tt==16)for(var nt=0;nt<o;nt++){var ft=nt*6;$[nt]=255<<24|e[ft+4]<<16|e[ft+2]<<8|e[ft]}}else{var pt=lt[0],dt=lt[1],_t=lt[2];if(tt==8)for(var nt=0;nt<o;nt++){var ut=nt<<2,ft=nt*3;$[nt]=255<<24|e[ft+2]<<16|e[ft+1]<<8|e[ft],e[ft]==pt&&e[ft+1]==dt&&e[ft+2]==_t&&(_[ut+3]=0)}if(tt==16)for(var nt=0;nt<o;nt++){var ut=nt<<2,ft=nt*6;$[nt]=255<<24|e[ft+4]<<16|e[ft+2]<<8|e[ft],st(e,ft)==pt&&st(e,ft+2)==dt&&st(e,ft+4)==_t&&(_[ut+3]=0)}}}else if(b==3){var mt=s.tabs.PLTE,kt=s.tabs.tRNS,bt=kt?kt.length:0;if(tt==1)for(var vt=0;vt<a;vt++)for(var Et=vt*g,Mt=vt*i,nt=0;nt<i;nt++){var ut=Mt+nt<<2,At=e[Et+(nt>>3)]>>7-((nt&7)<<0)&1,zt=3*At;_[ut]=mt[zt],_[ut+1]=mt[zt+1],_[ut+2]=mt[zt+2],_[ut+3]=At<bt?kt[At]:255}if(tt==2)for(var vt=0;vt<a;vt++)for(var Et=vt*g,Mt=vt*i,nt=0;nt<i;nt++){var ut=Mt+nt<<2,At=e[Et+(nt>>2)]>>6-((nt&3)<<1)&3,zt=3*At;_[ut]=mt[zt],_[ut+1]=mt[zt+1],_[ut+2]=mt[zt+2],_[ut+3]=At<bt?kt[At]:255}if(tt==4)for(var vt=0;vt<a;vt++)for(var Et=vt*g,Mt=vt*i,nt=0;nt<i;nt++){var ut=Mt+nt<<2,At=e[Et+(nt>>1)]>>4-((nt&1)<<2)&15,zt=3*At;_[ut]=mt[zt],_[ut+1]=mt[zt+1],_[ut+2]=mt[zt+2],_[ut+3]=At<bt?kt[At]:255}if(tt==8)for(var nt=0;nt<o;nt++){var ut=nt<<2,At=e[nt],zt=3*At;_[ut]=mt[zt],_[ut+1]=mt[zt+1],_[ut+2]=mt[zt+2],_[ut+3]=At<bt?kt[At]:255}}else if(b==4){if(tt==8)for(var nt=0;nt<o;nt++){var ut=nt<<2,Vt=nt<<1,Gt=e[Vt];_[ut]=Gt,_[ut+1]=Gt,_[ut+2]=Gt,_[ut+3]=e[Vt+1]}if(tt==16)for(var nt=0;nt<o;nt++){var ut=nt<<2,Vt=nt<<2,Gt=e[Vt];_[ut]=Gt,_[ut+1]=Gt,_[ut+2]=Gt,_[ut+3]=e[Vt+2]}}else if(b==0)for(var pt=s.tabs.tRNS?s.tabs.tRNS:-1,vt=0;vt<a;vt++){var Kt=vt*g,Wt=vt*i;if(tt==1)for(var sn=0;sn<i;sn++){var Gt=255*(e[Kt+(sn>>>3)]>>>7-(sn&7)&1),on=Gt==pt*255?0:255;$[Wt+sn]=on<<24|Gt<<16|Gt<<8|Gt}else if(tt==2)for(var sn=0;sn<i;sn++){var Gt=85*(e[Kt+(sn>>>2)]>>>6-((sn&3)<<1)&3),on=Gt==pt*85?0:255;$[Wt+sn]=on<<24|Gt<<16|Gt<<8|Gt}else if(tt==4)for(var sn=0;sn<i;sn++){var Gt=17*(e[Kt+(sn>>>1)]>>>4-((sn&1)<<2)&15),on=Gt==pt*17?0:255;$[Wt+sn]=on<<24|Gt<<16|Gt<<8|Gt}else if(tt==8)for(var sn=0;sn<i;sn++){var Gt=e[Kt+sn],on=Gt==pt?0:255;$[Wt+sn]=on<<24|Gt<<16|Gt<<8|Gt}else if(tt==16)for(var sn=0;sn<i;sn++){var Gt=e[Kt+(sn<<1)],on=st(e,Kt+(sn<<nt))==pt?0:255;$[Wt+sn]=on<<24|Gt<<16|Gt<<8|Gt}}return _};UPNG.decode=function(e){for(var i=new Uint8Array(e),a=8,s=UPNG._bin,o=s.readUshort,h=s.readUint,g={tabs:{},frames:[]},_=new Uint8Array(i.length),$=0,b,tt=0,st=[137,80,78,71,13,10,26,10],at=0;at<8;at++)if(i[at]!=st[at])throw"The input is not a PNG file!";for(;a<i.length;){var nt=s.readUint(i,a);a+=4;var lt=s.readASCII(i,a,4);if(a+=4,lt=="IHDR")UPNG.decode._IHDR(i,a,g);else if(lt=="IDAT"){for(var at=0;at<nt;at++)_[$+at]=i[a+at];$+=nt}else if(lt=="acTL")g.tabs[lt]={num_frames:h(i,a),num_plays:h(i,a+4)},b=new Uint8Array(i.length);else if(lt=="fcTL"){if(tt!=0){var ft=g.frames[g.frames.length-1];ft.data=UPNG.decode._decompress(g,b.slice(0,tt),ft.rect.width,ft.rect.height),tt=0}var pt={x:h(i,a+12),y:h(i,a+16),width:h(i,a+4),height:h(i,a+8)},dt=o(i,a+22);dt=o(i,a+20)/(dt==0?100:dt);var _t={rect:pt,delay:Math.round(dt*1e3),dispose:i[a+24],blend:i[a+25]};g.frames.push(_t)}else if(lt=="fdAT"){for(var at=0;at<nt-4;at++)b[tt+at]=i[a+at+4];tt+=nt-4}else if(lt=="pHYs")g.tabs[lt]=[s.readUint(i,a),s.readUint(i,a+4),i[a+8]];else if(lt=="cHRM"){g.tabs[lt]=[];for(var at=0;at<8;at++)g.tabs[lt].push(s.readUint(i,a+at*4))}else if(lt=="tEXt"){g.tabs[lt]==null&&(g.tabs[lt]={});var ut=s.nextZero(i,a),mt=s.readASCII(i,a,ut-a),kt=s.readASCII(i,ut+1,a+nt-ut-1);g.tabs[lt][mt]=kt}else if(lt=="iTXt"){g.tabs[lt]==null&&(g.tabs[lt]={});var ut=0,bt=a;ut=s.nextZero(i,bt);var mt=s.readASCII(i,bt,ut-bt);bt=ut+1,i[bt],i[bt+1],bt+=2,ut=s.nextZero(i,bt),s.readASCII(i,bt,ut-bt),bt=ut+1,ut=s.nextZero(i,bt),s.readUTF8(i,bt,ut-bt),bt=ut+1;var kt=s.readUTF8(i,bt,nt-(bt-a));g.tabs[lt][mt]=kt}else if(lt=="PLTE")g.tabs[lt]=s.readBytes(i,a,nt);else if(lt=="hIST"){var vt=g.tabs.PLTE.length/3;g.tabs[lt]=[];for(var at=0;at<vt;at++)g.tabs[lt].push(o(i,a+at*2))}else if(lt=="tRNS")g.ctype==3?g.tabs[lt]=s.readBytes(i,a,nt):g.ctype==0?g.tabs[lt]=o(i,a):g.ctype==2&&(g.tabs[lt]=[o(i,a),o(i,a+2),o(i,a+4)]);else if(lt=="gAMA")g.tabs[lt]=s.readUint(i,a)/1e5;else if(lt=="sRGB")g.tabs[lt]=i[a];else if(lt=="bKGD")g.ctype==0||g.ctype==4?g.tabs[lt]=[o(i,a)]:g.ctype==2||g.ctype==6?g.tabs[lt]=[o(i,a),o(i,a+2),o(i,a+4)]:g.ctype==3&&(g.tabs[lt]=i[a]);else if(lt=="IEND")break;a+=nt,s.readUint(i,a),a+=4}if(tt!=0){var ft=g.frames[g.frames.length-1];ft.data=UPNG.decode._decompress(g,b.slice(0,tt),ft.rect.width,ft.rect.height),tt=0}return g.data=UPNG.decode._decompress(g,_,g.width,g.height),delete g.compress,delete g.interlace,delete g.filter,g};UPNG.decode._decompress=function(e,i,a,s){var o=UPNG.decode._getBPP(e),h=Math.ceil(a*o/8),g=new Uint8Array((h+1+e.interlace)*s);return i=UPNG.decode._inflate(i,g),e.interlace==0?i=UPNG.decode._filterZero(i,e,0,a,s):e.interlace==1&&(i=UPNG.decode._readInterlace(i,e)),i};UPNG.decode._inflate=function(e,i){var a=UPNG.inflateRaw(new Uint8Array(e.buffer,2,e.length-6),i);return a};UPNG.inflateRaw=function(){var e={};return e.H={},e.H.N=function(i,a){var s=Uint8Array,o=0,h=0,g=0,_=0,$=0,b=0,tt=0,st=0,at=0,nt,lt;if(i[0]==3&&i[1]==0)return a||new s(0);var ft=e.H,pt=ft.b,dt=ft.e,_t=ft.R,ut=ft.n,mt=ft.A,kt=ft.Z,bt=ft.m,vt=a==null;for(vt&&(a=new s(i.length>>>2<<3));o==0;){if(o=pt(i,at,1),h=pt(i,at+1,2),at+=3,h==0){at&7&&(at+=8-(at&7));var Et=(at>>>3)+4,Mt=i[Et-4]|i[Et-3]<<8;vt&&(a=e.H.W(a,st+Mt)),a.set(new s(i.buffer,i.byteOffset+Et,Mt),st),at=Et+Mt<<3,st+=Mt;continue}if(vt&&(a=e.H.W(a,st+(1<<17))),h==1&&(nt=bt.J,lt=bt.h,b=511,tt=31),h==2){g=dt(i,at,5)+257,_=dt(i,at+5,5)+1,$=dt(i,at+10,4)+4,at+=14;for(var At=1,zt=0;zt<38;zt+=2)bt.Q[zt]=0,bt.Q[zt+1]=0;for(var zt=0;zt<$;zt++){var Vt=dt(i,at+zt*3,3);bt.Q[(bt.X[zt]<<1)+1]=Vt,Vt>At&&(At=Vt)}at+=3*$,ut(bt.Q,At),mt(bt.Q,At,bt.u),nt=bt.w,lt=bt.d,at=_t(bt.u,(1<<At)-1,g+_,i,at,bt.v);var Gt=ft.V(bt.v,0,g,bt.C);b=(1<<Gt)-1;var Kt=ft.V(bt.v,g,_,bt.D);tt=(1<<Kt)-1,ut(bt.C,Gt),mt(bt.C,Gt,nt),ut(bt.D,Kt),mt(bt.D,Kt,lt)}for(;;){var Wt=nt[kt(i,at)&b];at+=Wt&15;var sn=Wt>>>4;if(!(sn>>>8))a[st++]=sn;else{if(sn==256)break;var on=st+sn-254;if(sn>264){var Xt=bt.q[sn-257];on=st+(Xt>>>3)+dt(i,at,Xt&7),at+=Xt&7}var ln=lt[kt(i,at)&tt];at+=ln&15;var nn=ln>>>4,gn=bt.c[nn],dn=(gn>>>4)+pt(i,at,gn&15);for(at+=gn&15;st<on;)a[st]=a[st++-dn],a[st]=a[st++-dn],a[st]=a[st++-dn],a[st]=a[st++-dn];st=on}}}return a.length==st?a:a.slice(0,st)},e.H.W=function(i,a){var s=i.length;if(a<=s)return i;var o=new Uint8Array(s<<1);return o.set(i,0),o},e.H.R=function(i,a,s,o,h,g){for(var _=e.H.e,$=e.H.Z,b=0;b<s;){var tt=i[$(o,h)&a];h+=tt&15;var st=tt>>>4;if(st<=15)g[b]=st,b++;else{var at=0,nt=0;st==16?(nt=3+_(o,h,2),h+=2,at=g[b-1]):st==17?(nt=3+_(o,h,3),h+=3):st==18&&(nt=11+_(o,h,7),h+=7);for(var lt=b+nt;b<lt;)g[b]=at,b++}}return h},e.H.V=function(i,a,s,o){for(var h=0,g=0,_=o.length>>>1;g<s;){var $=i[g+a];o[g<<1]=0,o[(g<<1)+1]=$,$>h&&(h=$),g++}for(;g<_;)o[g<<1]=0,o[(g<<1)+1]=0,g++;return h},e.H.n=function(i,a){for(var s=e.H.m,o=i.length,h,g,_,tt,$,b=s.j,tt=0;tt<=a;tt++)b[tt]=0;for(tt=1;tt<o;tt+=2)b[i[tt]]++;var st=s.K;for(h=0,b[0]=0,g=1;g<=a;g++)h=h+b[g-1]<<1,st[g]=h;for(_=0;_<o;_+=2)$=i[_+1],$!=0&&(i[_]=st[$],st[$]++)},e.H.A=function(i,a,s){for(var o=i.length,h=e.H.m,g=h.r,_=0;_<o;_+=2)if(i[_+1]!=0)for(var $=_>>1,b=i[_+1],tt=$<<4|b,st=a-b,at=i[_]<<st,nt=at+(1<<st);at!=nt;){var lt=g[at]>>>15-a;s[lt]=tt,at++}},e.H.l=function(i,a){for(var s=e.H.m.r,o=15-a,h=0;h<i.length;h+=2){var g=i[h]<<a-i[h+1];i[h]=s[g]>>>o}},e.H.M=function(i,a,s){s=s<<(a&7);var o=a>>>3;i[o]|=s,i[o+1]|=s>>>8},e.H.I=function(i,a,s){s=s<<(a&7);var o=a>>>3;i[o]|=s,i[o+1]|=s>>>8,i[o+2]|=s>>>16},e.H.e=function(i,a,s){return(i[a>>>3]|i[(a>>>3)+1]<<8)>>>(a&7)&(1<<s)-1},e.H.b=function(i,a,s){return(i[a>>>3]|i[(a>>>3)+1]<<8|i[(a>>>3)+2]<<16)>>>(a&7)&(1<<s)-1},e.H.Z=function(i,a){return(i[a>>>3]|i[(a>>>3)+1]<<8|i[(a>>>3)+2]<<16)>>>(a&7)},e.H.i=function(i,a){return(i[a>>>3]|i[(a>>>3)+1]<<8|i[(a>>>3)+2]<<16|i[(a>>>3)+3]<<24)>>>(a&7)},e.H.m=function(){var i=Uint16Array,a=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new a(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new a(286),Y:new a(30),a:new a(19),t:new a(15e3),k:new i(65536),g:new i(32768)}}(),function(){for(var i=e.H.m,a=32768,s=0;s<a;s++){var o=s;o=(o&2863311530)>>>1|(o&1431655765)<<1,o=(o&3435973836)>>>2|(o&858993459)<<2,o=(o&4042322160)>>>4|(o&252645135)<<4,o=(o&4278255360)>>>8|(o&16711935)<<8,i.r[s]=(o>>>16|o<<16)>>>17}function h(g,_,$){for(;_--!=0;)g.push(0,$)}for(var s=0;s<32;s++)i.q[s]=i.S[s]<<3|i.T[s],i.c[s]=i.p[s]<<4|i.z[s];h(i._,144,8),h(i._,112,9),h(i._,24,7),h(i._,8,8),e.H.n(i._,9),e.H.A(i._,9,i.J),e.H.l(i._,9),h(i.$,32,5),e.H.n(i.$,5),e.H.A(i.$,5,i.h),e.H.l(i.$,5),h(i.Q,19,0),h(i.C,286,0),h(i.D,30,0),h(i.v,320,0)}(),e.H.N}();UPNG.decode._readInterlace=function(e,i){for(var a=i.width,s=i.height,o=UPNG.decode._getBPP(i),h=o>>3,g=Math.ceil(a*o/8),_=new Uint8Array(s*g),$=0,b=[0,0,4,0,2,0,1],tt=[0,4,0,2,0,1,0],st=[8,8,8,4,4,2,2],at=[8,8,4,4,2,2,1],nt=0;nt<7;){for(var lt=st[nt],ft=at[nt],pt=0,dt=0,_t=b[nt];_t<s;)_t+=lt,dt++;for(var ut=tt[nt];ut<a;)ut+=ft,pt++;var mt=Math.ceil(pt*o/8);UPNG.decode._filterZero(e,i,$,pt,dt);for(var kt=0,bt=b[nt];bt<s;){for(var vt=tt[nt],Et=$+kt*mt<<3;vt<a;){if(o==1){var Mt=e[Et>>3];Mt=Mt>>7-(Et&7)&1,_[bt*g+(vt>>3)]|=Mt<<7-((vt&7)<<0)}if(o==2){var Mt=e[Et>>3];Mt=Mt>>6-(Et&7)&3,_[bt*g+(vt>>2)]|=Mt<<6-((vt&3)<<1)}if(o==4){var Mt=e[Et>>3];Mt=Mt>>4-(Et&7)&15,_[bt*g+(vt>>1)]|=Mt<<4-((vt&1)<<2)}if(o>=8)for(var At=bt*g+vt*h,zt=0;zt<h;zt++)_[At+zt]=e[(Et>>3)+zt];Et+=o,vt+=ft}kt++,bt+=lt}pt*dt!=0&&($+=dt*(1+mt)),nt=nt+1}return _};UPNG.decode._getBPP=function(e){var i=[1,null,3,1,2,null,4][e.ctype];return i*e.depth};UPNG.decode._filterZero=function(e,i,a,s,o){var h=UPNG.decode._getBPP(i),g=Math.ceil(s*h/8),_=UPNG.decode._paeth;h=Math.ceil(h/8);var $=0,b=1,tt=e[a],st=0;if(tt>1&&(e[a]=[0,0,1][tt-2]),tt==3)for(st=h;st<g;st++)e[st+1]=e[st+1]+(e[st+1-h]>>>1)&255;for(var at=0;at<o;at++)if($=a+at*g,b=$+at+1,tt=e[b-1],st=0,tt==0)for(;st<g;st++)e[$+st]=e[b+st];else if(tt==1){for(;st<h;st++)e[$+st]=e[b+st];for(;st<g;st++)e[$+st]=e[b+st]+e[$+st-h]}else if(tt==2)for(;st<g;st++)e[$+st]=e[b+st]+e[$+st-g];else if(tt==3){for(;st<h;st++)e[$+st]=e[b+st]+(e[$+st-g]>>>1);for(;st<g;st++)e[$+st]=e[b+st]+(e[$+st-g]+e[$+st-h]>>>1)}else{for(;st<h;st++)e[$+st]=e[b+st]+_(0,e[$+st-g],0);for(;st<g;st++)e[$+st]=e[b+st]+_(e[$+st-h],e[$+st-g],e[$+st-h-g])}return e};UPNG.decode._paeth=function(e,i,a){var s=e+i-a,o=s-e,h=s-i,g=s-a;return o*o<=h*h&&o*o<=g*g?e:h*h<=g*g?i:a};UPNG.decode._IHDR=function(e,i,a){var s=UPNG._bin;a.width=s.readUint(e,i),i+=4,a.height=s.readUint(e,i),i+=4,a.depth=e[i],i++,a.ctype=e[i],i++,a.compress=e[i],i++,a.filter=e[i],i++,a.interlace=e[i],i++};UPNG._bin={nextZero:function(e,i){for(;e[i]!=0;)i++;return i},readUshort:function(e,i){return e[i]<<8|e[i+1]},writeUshort:function(e,i,a){e[i]=a>>8&255,e[i+1]=a&255},readUint:function(e,i){return e[i]*(256*256*256)+(e[i+1]<<16|e[i+2]<<8|e[i+3])},writeUint:function(e,i,a){e[i]=a>>24&255,e[i+1]=a>>16&255,e[i+2]=a>>8&255,e[i+3]=a&255},readASCII:function(e,i,a){for(var s="",o=0;o<a;o++)s+=String.fromCharCode(e[i+o]);return s},writeASCII:function(e,i,a){for(var s=0;s<a.length;s++)e[i+s]=a.charCodeAt(s)},readBytes:function(e,i,a){for(var s=[],o=0;o<a;o++)s.push(e[i+o]);return s},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,i,a){for(var s="",o,h=0;h<a;h++)s+="%"+UPNG._bin.pad(e[i+h].toString(16));try{o=decodeURIComponent(s)}catch{return UPNG._bin.readASCII(e,i,a)}return o}};UPNG._copyTile=function(e,i,a,s,o,h,g,_,$){for(var b=Math.min(i,o),tt=Math.min(a,h),st=0,at=0,nt=0;nt<tt;nt++)for(var lt=0;lt<b;lt++)if(g>=0&&_>=0?(st=nt*i+lt<<2,at=(_+nt)*o+g+lt<<2):(st=(-_+nt)*i-g+lt<<2,at=nt*o+lt<<2),$==0)s[at]=e[st],s[at+1]=e[st+1],s[at+2]=e[st+2],s[at+3]=e[st+3];else if($==1){var ft=e[st+3]*.00392156862745098,pt=e[st]*ft,dt=e[st+1]*ft,_t=e[st+2]*ft,ut=s[at+3]*(1/255),mt=s[at]*ut,kt=s[at+1]*ut,bt=s[at+2]*ut,vt=1-ft,Et=ft+ut*vt,Mt=Et==0?0:1/Et;s[at+3]=255*Et,s[at+0]=(pt+mt*vt)*Mt,s[at+1]=(dt+kt*vt)*Mt,s[at+2]=(_t+bt*vt)*Mt}else if($==2){var ft=e[st+3],pt=e[st],dt=e[st+1],_t=e[st+2],ut=s[at+3],mt=s[at],kt=s[at+1],bt=s[at+2];ft==ut&&pt==mt&&dt==kt&&_t==bt?(s[at]=0,s[at+1]=0,s[at+2]=0,s[at+3]=0):(s[at]=pt,s[at+1]=dt,s[at+2]=_t,s[at+3]=ft)}else if($==3){var ft=e[st+3],pt=e[st],dt=e[st+1],_t=e[st+2],ut=s[at+3],mt=s[at],kt=s[at+1],bt=s[at+2];if(ft==ut&&pt==mt&&dt==kt&&_t==bt)continue;if(ft<220&&ut>20)return!1}return!0};UPNG.encode=function(e,i,a,s,o,h,g){s==null&&(s=0),g==null&&(g=!1);var _=UPNG.encode.compress(e,i,a,s,[!1,!1,!1,0,g]);return UPNG.encode.compressPNG(_,-1),UPNG.encode._main(_,i,a,o,h)};UPNG.encodeLL=function(e,i,a,s,o,h,g,_){for(var $={ctype:0+(s==1?0:2)+(o==0?0:4),depth:h,frames:[]},b=(s+o)*h,tt=b*i,st=0;st<e.length;st++)$.frames.push({rect:{x:0,y:0,width:i,height:a},img:new Uint8Array(e[st]),blend:0,dispose:1,bpp:Math.ceil(b/8),bpl:Math.ceil(tt/8)});UPNG.encode.compressPNG($,0,!0);var at=UPNG.encode._main($,i,a,g,_);return at};UPNG.encode._main=function(e,i,a,s,o){o==null&&(o={});var h=UPNG.crc.crc,g=UPNG._bin.writeUint,_=UPNG._bin.writeUshort,$=UPNG._bin.writeASCII,b=8,tt=e.frames.length>1,st=!1,at=33+(tt?20:0);if(o.sRGB!=null&&(at+=13),o.pHYs!=null&&(at+=21),e.ctype==3){for(var nt=e.plte.length,lt=0;lt<nt;lt++)e.plte[lt]>>>24!=255&&(st=!0);at+=8+nt*3+4+(st?8+nt*1+4:0)}for(var ft=0;ft<e.frames.length;ft++){var pt=e.frames[ft];tt&&(at+=38),at+=pt.cimg.length+12,ft!=0&&(at+=4)}at+=12;for(var dt=new Uint8Array(at),_t=[137,80,78,71,13,10,26,10],lt=0;lt<8;lt++)dt[lt]=_t[lt];if(g(dt,b,13),b+=4,$(dt,b,"IHDR"),b+=4,g(dt,b,i),b+=4,g(dt,b,a),b+=4,dt[b]=e.depth,b++,dt[b]=e.ctype,b++,dt[b]=0,b++,dt[b]=0,b++,dt[b]=0,b++,g(dt,b,h(dt,b-17,17)),b+=4,o.sRGB!=null&&(g(dt,b,1),b+=4,$(dt,b,"sRGB"),b+=4,dt[b]=o.sRGB,b++,g(dt,b,h(dt,b-5,5)),b+=4),o.pHYs!=null&&(g(dt,b,9),b+=4,$(dt,b,"pHYs"),b+=4,g(dt,b,o.pHYs[0]),b+=4,g(dt,b,o.pHYs[1]),b+=4,dt[b]=o.pHYs[2],b++,g(dt,b,h(dt,b-13,13)),b+=4),tt&&(g(dt,b,8),b+=4,$(dt,b,"acTL"),b+=4,g(dt,b,e.frames.length),b+=4,g(dt,b,o.loop!=null?o.loop:0),b+=4,g(dt,b,h(dt,b-12,12)),b+=4),e.ctype==3){var nt=e.plte.length;g(dt,b,nt*3),b+=4,$(dt,b,"PLTE"),b+=4;for(var lt=0;lt<nt;lt++){var ut=lt*3,mt=e.plte[lt],kt=mt&255,bt=mt>>>8&255,vt=mt>>>16&255;dt[b+ut+0]=kt,dt[b+ut+1]=bt,dt[b+ut+2]=vt}if(b+=nt*3,g(dt,b,h(dt,b-nt*3-4,nt*3+4)),b+=4,st){g(dt,b,nt),b+=4,$(dt,b,"tRNS"),b+=4;for(var lt=0;lt<nt;lt++)dt[b+lt]=e.plte[lt]>>>24&255;b+=nt,g(dt,b,h(dt,b-nt-4,nt+4)),b+=4}}for(var Et=0,ft=0;ft<e.frames.length;ft++){var pt=e.frames[ft];tt&&(g(dt,b,26),b+=4,$(dt,b,"fcTL"),b+=4,g(dt,b,Et++),b+=4,g(dt,b,pt.rect.width),b+=4,g(dt,b,pt.rect.height),b+=4,g(dt,b,pt.rect.x),b+=4,g(dt,b,pt.rect.y),b+=4,_(dt,b,s[ft]),b+=2,_(dt,b,1e3),b+=2,dt[b]=pt.dispose,b++,dt[b]=pt.blend,b++,g(dt,b,h(dt,b-30,30)),b+=4);var Mt=pt.cimg,nt=Mt.length;g(dt,b,nt+(ft==0?0:4)),b+=4;var At=b;$(dt,b,ft==0?"IDAT":"fdAT"),b+=4,ft!=0&&(g(dt,b,Et++),b+=4),dt.set(Mt,b),b+=nt,g(dt,b,h(dt,At,b-At)),b+=4}return g(dt,b,0),b+=4,$(dt,b,"IEND"),b+=4,g(dt,b,h(dt,b-4,4)),b+=4,dt.buffer};UPNG.encode.compressPNG=function(e,i,a){for(var s=0;s<e.frames.length;s++){var o=e.frames[s];o.rect.width;var h=o.rect.height,g=new Uint8Array(h*o.bpl+h);o.cimg=UPNG.encode._filterZero(o.img,h,o.bpp,o.bpl,g,i,a)}};UPNG.encode.compress=function(e,i,a,s,o){for(var h=o[0],g=o[1],_=o[2],$=o[3],b=o[4],tt=6,st=8,at=255,nt=0;nt<e.length;nt++)for(var lt=new Uint8Array(e[nt]),ft=lt.length,pt=0;pt<ft;pt+=4)at&=lt[pt+3];var dt=at!=255,_t=UPNG.encode.framize(e,i,a,h,g,_),ut={},mt=[],kt=[];if(s!=0){for(var bt=[],pt=0;pt<_t.length;pt++)bt.push(_t[pt].img.buffer);for(var vt=UPNG.encode.concatRGBA(bt),Et=UPNG.quantize(vt,s),Mt=0,At=new Uint8Array(Et.abuf),pt=0;pt<_t.length;pt++){var zt=_t[pt].img,Vt=zt.length;kt.push(new Uint8Array(Et.inds.buffer,Mt>>2,Vt>>2));for(var nt=0;nt<Vt;nt+=4)zt[nt]=At[Mt+nt],zt[nt+1]=At[Mt+nt+1],zt[nt+2]=At[Mt+nt+2],zt[nt+3]=At[Mt+nt+3];Mt+=Vt}for(var pt=0;pt<Et.plte.length;pt++)mt.push(Et.plte[pt].est.rgba)}else for(var nt=0;nt<_t.length;nt++){var Gt=_t[nt],Kt=new Uint32Array(Gt.img.buffer),Wt=Gt.rect.width,ft=Kt.length,sn=new Uint8Array(ft);kt.push(sn);for(var pt=0;pt<ft;pt++){var on=Kt[pt];if(pt!=0&&on==Kt[pt-1])sn[pt]=sn[pt-1];else if(pt>Wt&&on==Kt[pt-Wt])sn[pt]=sn[pt-Wt];else{var Xt=ut[on];if(Xt==null&&(ut[on]=Xt=mt.length,mt.push(on),mt.length>=300))break;sn[pt]=Xt}}}var ln=mt.length;ln<=256&&b==!1&&(ln<=2?st=1:ln<=4?st=2:ln<=16?st=4:st=8,st=Math.max(st,$));for(var nt=0;nt<_t.length;nt++){var Gt=_t[nt];Gt.rect.x,Gt.rect.y;var Wt=Gt.rect.width,nn=Gt.rect.height,gn=Gt.img;new Uint32Array(gn.buffer);var dn=4*Wt,$n=4;if(ln<=256&&b==!1){dn=Math.ceil(st*Wt/8);for(var En=new Uint8Array(dn*nn),qt=kt[nt],en=0;en<nn;en++){var pt=en*dn,Tn=en*Wt;if(st==8)for(var Sn=0;Sn<Wt;Sn++)En[pt+Sn]=qt[Tn+Sn];else if(st==4)for(var Sn=0;Sn<Wt;Sn++)En[pt+(Sn>>1)]|=qt[Tn+Sn]<<4-(Sn&1)*4;else if(st==2)for(var Sn=0;Sn<Wt;Sn++)En[pt+(Sn>>2)]|=qt[Tn+Sn]<<6-(Sn&3)*2;else if(st==1)for(var Sn=0;Sn<Wt;Sn++)En[pt+(Sn>>3)]|=qt[Tn+Sn]<<7-(Sn&7)*1}gn=En,tt=3,$n=1}else if(dt==!1&&_t.length==1){for(var En=new Uint8Array(Wt*nn*3),fn=Wt*nn,pt=0;pt<fn;pt++){var zt=pt*3,Wn=pt*4;En[zt]=gn[Wn],En[zt+1]=gn[Wn+1],En[zt+2]=gn[Wn+2]}gn=En,tt=2,$n=3,dn=3*Wt}Gt.img=gn,Gt.bpl=dn,Gt.bpp=$n}return{ctype:tt,depth:st,plte:mt,frames:_t}};UPNG.encode.framize=function(e,i,a,s,o,h){for(var g=[],_=0;_<e.length;_++){var $=new Uint8Array(e[_]),b=new Uint32Array($.buffer),tt,st=0,at=0,nt=i,lt=a,ft=s?1:0;if(_!=0){for(var pt=h||s||_==1||g[_-2].dispose!=0?1:2,dt=0,_t=1e9,ut=0;ut<pt;ut++){for(var Gt=new Uint8Array(e[_-1-ut]),mt=new Uint32Array(e[_-1-ut]),kt=i,bt=a,vt=-1,Et=-1,Mt=0;Mt<a;Mt++)for(var At=0;At<i;At++){var zt=Mt*i+At;b[zt]!=mt[zt]&&(At<kt&&(kt=At),At>vt&&(vt=At),Mt<bt&&(bt=Mt),Mt>Et&&(Et=Mt))}vt==-1&&(kt=bt=vt=Et=0),o&&((kt&1)==1&&kt--,(bt&1)==1&&bt--);var Vt=(vt-kt+1)*(Et-bt+1);Vt<_t&&(_t=Vt,dt=ut,st=kt,at=bt,nt=vt-kt+1,lt=Et-bt+1)}var Gt=new Uint8Array(e[_-1-dt]);dt==1&&(g[_-1].dispose=2),tt=new Uint8Array(nt*lt*4),UPNG._copyTile(Gt,i,a,tt,nt,lt,-st,-at,0),ft=UPNG._copyTile($,i,a,tt,nt,lt,-st,-at,3)?1:0,ft==1?UPNG.encode._prepareDiff($,i,a,tt,{x:st,y:at,width:nt,height:lt}):UPNG._copyTile($,i,a,tt,nt,lt,-st,-at,0)}else tt=$.slice(0);g.push({rect:{x:st,y:at,width:nt,height:lt},img:tt,blend:ft,dispose:0})}if(s)for(var _=0;_<g.length;_++){var Kt=g[_];if(Kt.blend!=1){var Wt=Kt.rect,sn=g[_-1].rect,on=Math.min(Wt.x,sn.x),Xt=Math.min(Wt.y,sn.y),ln=Math.max(Wt.x+Wt.width,sn.x+sn.width),nn=Math.max(Wt.y+Wt.height,sn.y+sn.height),gn={x:on,y:Xt,width:ln-on,height:nn-Xt};g[_-1].dispose=1,_-1!=0&&UPNG.encode._updateFrame(e,i,a,g,_-1,gn,o),UPNG.encode._updateFrame(e,i,a,g,_,gn,o)}}var dn=0;if(e.length!=1)for(var zt=0;zt<g.length;zt++){var Kt=g[zt];dn+=Kt.rect.width*Kt.rect.height}return g};UPNG.encode._updateFrame=function(e,i,a,s,o,h,g){for(var _=Uint8Array,$=Uint32Array,b=new _(e[o-1]),tt=new $(e[o-1]),st=o+1<e.length?new _(e[o+1]):null,at=new _(e[o]),nt=new $(at.buffer),lt=i,ft=a,pt=-1,dt=-1,_t=0;_t<h.height;_t++)for(var ut=0;ut<h.width;ut++){var mt=h.x+ut,kt=h.y+_t,bt=kt*i+mt,vt=nt[bt];vt==0||s[o-1].dispose==0&&tt[bt]==vt&&(st==null||st[bt*4+3]!=0)||(mt<lt&&(lt=mt),mt>pt&&(pt=mt),kt<ft&&(ft=kt),kt>dt&&(dt=kt))}pt==-1&&(lt=ft=pt=dt=0),g&&((lt&1)==1&&lt--,(ft&1)==1&&ft--),h={x:lt,y:ft,width:pt-lt+1,height:dt-ft+1};var Et=s[o];Et.rect=h,Et.blend=1,Et.img=new Uint8Array(h.width*h.height*4),s[o-1].dispose==0?(UPNG._copyTile(b,i,a,Et.img,h.width,h.height,-h.x,-h.y,0),UPNG.encode._prepareDiff(at,i,a,Et.img,h)):UPNG._copyTile(at,i,a,Et.img,h.width,h.height,-h.x,-h.y,0)};UPNG.encode._prepareDiff=function(e,i,a,s,o){UPNG._copyTile(e,i,a,s,o.width,o.height,-o.x,-o.y,2)};UPNG.encode._filterZero=function(e,i,a,s,o,h,g){var _=[],$=[0,1,2,3,4];h!=-1?$=[h]:(i*s>5e5||a==1)&&($=[0]);var b;g&&(b={level:0});for(var tt=g&&UZIP!=null?UZIP:pako,st=0;st<$.length;st++){for(var at=0;at<i;at++)UPNG.encode._filterLine(o,e,at,s,a,$[st]);_.push(tt.deflate(o,b))}for(var nt,lt=1e9,st=0;st<_.length;st++)_[st].length<lt&&(nt=st,lt=_[st].length);return _[nt]};UPNG.encode._filterLine=function(e,i,a,s,o,h){var g=a*s,_=g+a,$=UPNG.decode._paeth;if(e[_]=h,_++,h==0)if(s<500)for(var b=0;b<s;b++)e[_+b]=i[g+b];else e.set(new Uint8Array(i.buffer,g,s),_);else if(h==1){for(var b=0;b<o;b++)e[_+b]=i[g+b];for(var b=o;b<s;b++)e[_+b]=i[g+b]-i[g+b-o]+256&255}else if(a==0){for(var b=0;b<o;b++)e[_+b]=i[g+b];if(h==2)for(var b=o;b<s;b++)e[_+b]=i[g+b];if(h==3)for(var b=o;b<s;b++)e[_+b]=i[g+b]-(i[g+b-o]>>1)+256&255;if(h==4)for(var b=o;b<s;b++)e[_+b]=i[g+b]-$(i[g+b-o],0,0)+256&255}else{if(h==2)for(var b=0;b<s;b++)e[_+b]=i[g+b]+256-i[g+b-s]&255;if(h==3){for(var b=0;b<o;b++)e[_+b]=i[g+b]+256-(i[g+b-s]>>1)&255;for(var b=o;b<s;b++)e[_+b]=i[g+b]+256-(i[g+b-s]+i[g+b-o]>>1)&255}if(h==4){for(var b=0;b<o;b++)e[_+b]=i[g+b]+256-$(0,i[g+b-s],0)&255;for(var b=o;b<s;b++)e[_+b]=i[g+b]+256-$(i[g+b-o],i[g+b-s],i[g+b-o-s])&255}}};UPNG.crc={table:function(){for(var e=new Uint32Array(256),i=0;i<256;i++){for(var a=i,s=0;s<8;s++)a&1?a=3988292384^a>>>1:a=a>>>1;e[i]=a}return e}(),update:function(e,i,a,s){for(var o=0;o<s;o++)e=UPNG.crc.table[(e^i[a+o])&255]^e>>>8;return e},crc:function(e,i,a){return UPNG.crc.update(4294967295,e,i,a)^4294967295}};UPNG.quantize=function(e,i){var a=new Uint8Array(e),s=a.slice(0),o=new Uint32Array(s.buffer),h=UPNG.quantize.getKDtree(s,i),g=h[0],_=h[1];UPNG.quantize.planeDst;for(var $=a,b=o,tt=$.length,st=new Uint8Array(a.length>>2),at=0;at<tt;at+=4){var nt=$[at]*.00392156862745098,lt=$[at+1]*(1/255),ft=$[at+2]*(1/255),pt=$[at+3]*(1/255),dt=UPNG.quantize.getNearest(g,nt,lt,ft,pt);st[at>>2]=dt.ind,b[at>>2]=dt.est.rgba}return{abuf:s.buffer,inds:st,plte:_}};UPNG.quantize.getKDtree=function(e,i,a){a==null&&(a=1e-4);var s=new Uint32Array(e.buffer),o={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};o.bst=UPNG.quantize.stats(e,o.i0,o.i1),o.est=UPNG.quantize.estats(o.bst);for(var h=[o];h.length<i;){for(var g=0,_=0,$=0;$<h.length;$++)h[$].est.L>g&&(g=h[$].est.L,_=$);if(g<a)break;var b=h[_],tt=UPNG.quantize.splitPixels(e,s,b.i0,b.i1,b.est.e,b.est.eMq255),st=b.i0>=tt||b.i1<=tt;if(st){b.est.L=0;continue}var at={i0:b.i0,i1:tt,bst:null,est:null,tdst:0,left:null,right:null};at.bst=UPNG.quantize.stats(e,at.i0,at.i1),at.est=UPNG.quantize.estats(at.bst);var nt={i0:tt,i1:b.i1,bst:null,est:null,tdst:0,left:null,right:null};nt.bst={R:[],m:[],N:b.bst.N-at.bst.N};for(var $=0;$<16;$++)nt.bst.R[$]=b.bst.R[$]-at.bst.R[$];for(var $=0;$<4;$++)nt.bst.m[$]=b.bst.m[$]-at.bst.m[$];nt.est=UPNG.quantize.estats(nt.bst),b.left=at,b.right=nt,h[_]=at,h.push(nt)}h.sort(function(lt,ft){return ft.bst.N-lt.bst.N});for(var $=0;$<h.length;$++)h[$].ind=$;return[o,h]};UPNG.quantize.getNearest=function(e,i,a,s,o){if(e.left==null)return e.tdst=UPNG.quantize.dist(e.est.q,i,a,s,o),e;var h=UPNG.quantize.planeDst(e.est,i,a,s,o),g=e.left,_=e.right;h>0&&(g=e.right,_=e.left);var $=UPNG.quantize.getNearest(g,i,a,s,o);if($.tdst<=h*h)return $;var b=UPNG.quantize.getNearest(_,i,a,s,o);return b.tdst<$.tdst?b:$};UPNG.quantize.planeDst=function(e,i,a,s,o){var h=e.e;return h[0]*i+h[1]*a+h[2]*s+h[3]*o-e.eMq};UPNG.quantize.dist=function(e,i,a,s,o){var h=i-e[0],g=a-e[1],_=s-e[2],$=o-e[3];return h*h+g*g+_*_+$*$};UPNG.quantize.splitPixels=function(e,i,a,s,o,h){var g=UPNG.quantize.vecDot;for(s-=4;a<s;){for(;g(e,a,o)<=h;)a+=4;for(;g(e,s,o)>h;)s-=4;if(a>=s)break;var _=i[a>>2];i[a>>2]=i[s>>2],i[s>>2]=_,a+=4,s-=4}for(;g(e,a,o)>h;)a-=4;return a+4};UPNG.quantize.vecDot=function(e,i,a){return e[i]*a[0]+e[i+1]*a[1]+e[i+2]*a[2]+e[i+3]*a[3]};UPNG.quantize.stats=function(e,i,a){for(var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=[0,0,0,0],h=a-i>>2,g=i;g<a;g+=4){var _=e[g]*.00392156862745098,$=e[g+1]*(1/255),b=e[g+2]*(1/255),tt=e[g+3]*(1/255);o[0]+=_,o[1]+=$,o[2]+=b,o[3]+=tt,s[0]+=_*_,s[1]+=_*$,s[2]+=_*b,s[3]+=_*tt,s[5]+=$*$,s[6]+=$*b,s[7]+=$*tt,s[10]+=b*b,s[11]+=b*tt,s[15]+=tt*tt}return s[4]=s[1],s[8]=s[2],s[9]=s[6],s[12]=s[3],s[13]=s[7],s[14]=s[11],{R:s,m:o,N:h}};UPNG.quantize.estats=function(e){var i=e.R,a=e.m,s=e.N,o=a[0],h=a[1],g=a[2],_=a[3],$=s==0?0:1/s,b=[i[0]-o*o*$,i[1]-o*h*$,i[2]-o*g*$,i[3]-o*_*$,i[4]-h*o*$,i[5]-h*h*$,i[6]-h*g*$,i[7]-h*_*$,i[8]-g*o*$,i[9]-g*h*$,i[10]-g*g*$,i[11]-g*_*$,i[12]-_*o*$,i[13]-_*h*$,i[14]-_*g*$,i[15]-_*_*$],tt=b,st=UPNG.M4,at=[.5,.5,.5,.5],nt=0,lt=0;if(s!=0)for(var ft=0;ft<10&&(at=st.multVec(tt,at),lt=Math.sqrt(st.dot(at,at)),at=st.sml(1/lt,at),!(Math.abs(lt-nt)<1e-9));ft++)nt=lt;var pt=[o*$,h*$,g*$,_*$],dt=st.dot(st.sml(255,pt),at);return{Cov:b,q:pt,e:at,L:nt,eMq255:dt,eMq:st.dot(at,pt),rgba:(Math.round(255*pt[3])<<24|Math.round(255*pt[2])<<16|Math.round(255*pt[1])<<8|Math.round(255*pt[0])<<0)>>>0}};UPNG.M4={multVec:function(e,i){return[e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3],e[4]*i[0]+e[5]*i[1]+e[6]*i[2]+e[7]*i[3],e[8]*i[0]+e[9]*i[1]+e[10]*i[2]+e[11]*i[3],e[12]*i[0]+e[13]*i[1]+e[14]*i[2]+e[15]*i[3]]},dot:function(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3]},sml:function(e,i){return[e*i[0],e*i[1],e*i[2],e*i[3]]}};UPNG.encode.concatRGBA=function(e){for(var i=0,a=0;a<e.length;a++)i+=e[a].byteLength;for(var s=new Uint8Array(i),o=0,a=0;a<e.length;a++){for(var h=new Uint8Array(e[a]),g=h.length,_=0;_<g;_+=4){var $=h[_],b=h[_+1],tt=h[_+2],st=h[_+3];st==0&&($=b=tt=0),s[o+_]=$,s[o+_+1]=b,s[o+_+2]=tt,s[o+_+3]=st}o+=g}return s.buffer};class TxSprite{constructor(i,a,s,o,h,g=!1){$e(this,"width"),$e(this,"height"),$e(this,"numColors"),$e(this,"paletteData"),$e(this,"pixelData"),$e(this,"compress"),this.width=i,this.height=a,this.numColors=s,this.paletteData=o,this.pixelData=h,this.compress=g,o.length/3!==s&&s>0&&console.warn(`TxSprite constructor: numColors (${s}) does not match paletteData length (${o.length/3} colors).`),h.length!==i*a&&i*a>0&&console.warn(`TxSprite constructor: pixelData length (${h.length}) does not match width*height (${i*a}).`)}static async fromIndexedPngBytes(i,a=!1){const s=UPNG.decode(i),{width:o,height:h,data:g,ctype:_,tabs:$}=s;return console.log(`PNG dimensions: ${o}x${h}, data length: ${g.byteLength}, ctype: ${_}, PLTE: ${$.PLTE}`),new TxSprite(o,h,$.PLTE?$.PLTE.length/3:0,$.PLTE?new Uint8Array($.PLTE):new Uint8Array,new Uint8Array(g.slice(0,o*h)),a)}static async fromImageBytes(i,a=48e3,s=!1){let o=await Image$1.load(i),h=o.width*o.height;if(h>a){const at=Math.sqrt(a/h);o=o.resize({factor:at})}(o.width>640||o.height>400)&&(o=o.resize({width:640,height:400,preserveAspectRatio:!0,interpolation:"nearestNeighbor"})),console.log(`Resized image to ${o.width}x${o.height}`);const g=utils_exports.PointContainer.fromUint8Array(o.getRGBAData(),o.width,o.height);console.log(`PointContainer created with ${g.getPointArray().length} points.`);const _=buildPaletteSync([g],{colors:15});console.log(`Palette built: ${_.getPointContainer().getPointArray().length} colors.`),_.getPointContainer().getPointArray().unshift(utils_exports.Point.createByQuadruplet([0,0,0,0]));const $=applyPaletteSync(g,_);console.log(`OutPointContainer: ${$.getPointArray().length} points.`);const b=new Uint8Array($.toUint32Array());console.log(`Indexed pixel data size: ${b.length}.`);const tt=_.getPointContainer().getPointArray().length,st=new Uint8Array(tt*3);return _.getPointContainer().getPointArray().forEach((at,nt)=>{st[nt*3+0]=at.r,st[nt*3+1]=at.g,st[nt*3+2]=at.b,console.log(`Color ${nt}: R=${at.r}, G=${at.g}, B=${at.b}`)}),new TxSprite(o.width,o.height,tt,st,b,s)}get bpp(){return this.numColors<=0?4:this.numColors<=2?1:this.numColors<=4?2:(this.numColors<=16||console.warn(`numColors (${this.numColors}) is greater than 16. Defaulting BPP to 4.`),4)}pack(){let i;const a=this.bpp;switch(a){case 1:i=TxSprite._pack_1bit(this.pixelData);break;case 2:i=TxSprite._pack_2bit(this.pixelData);break;case 4:i=TxSprite._pack_4bit(this.pixelData);break;default:throw new Error(`Unsupported bpp: ${a}`)}const s=new Uint8Array(7),o=new DataView(s.buffer);o.setUint16(0,this.width,!1),o.setUint16(2,this.height,!1),o.setUint8(4,this.compress?1:0),o.setUint8(5,a),o.setUint8(6,this.numColors>16?16:this.numColors);let h=i;if(this.compress)try{h=lz4.compress(Buffer.from(i),9)}catch(_){throw console.error("LZ4 compression failed:",_),_}const g=new Uint8Array(s.length+this.paletteData.length+h.length);return g.set(s,0),g.set(this.paletteData,s.length),g.set(h,s.length+this.paletteData.length),g}static _pack_1bit(i){const a=Math.ceil(i.length/8),s=new Uint8Array(a);for(let o=0;o<i.length;o++){const h=Math.floor(o/8),g=7-o%8;i[o]&1&&(s[h]|=1<<g)}return s}static _pack_2bit(i){const a=Math.ceil(i.length/4),s=new Uint8Array(a);for(let o=0;o<i.length;o++){const h=Math.floor(o/4),g=(3-o%4)*2;s[h]|=(i[o]&3)<<g}return s}static _pack_4bit(i){const a=Math.ceil(i.length/2),s=new Uint8Array(a);for(let o=0;o<i.length;o++){const h=Math.floor(o/2),g=(1-o%2)*4;s[h]|=(i[o]&15)<<g}return s}}const Rt=class ms{constructor(i={}){$e(this,"nonFinalChunkFlag"),$e(this,"finalChunkFlag"),$e(this,"upright"),$e(this,"isRaw"),$e(this,"quality"),$e(this,"resolution"),$e(this,"queue"),$e(this,"_imageDataChunks"),this.nonFinalChunkFlag=i.nonFinalChunkFlag??7,this.finalChunkFlag=i.finalChunkFlag??8,this.upright=i.upright??!0,this.isRaw=i.isRaw??!1,this.quality=i.quality??null,this.resolution=i.resolution??null,this.queue=null,this._imageDataChunks=[]}static hasJpegHeader(i,a){return`${i}_${a}`in ms._jpegHeaderMap}concatenateImageData(){let i=0;for(const o of this._imageDataChunks)i+=o.length;const a=new Uint8Array(i);let s=0;for(const o of this._imageDataChunks)a.set(o,s),s+=o.length;return a}handleData(i){if(!this.queue){console.warn("RxPhoto: Received data but queue not initialized - call attach() first");return}const a=i[0],s=i.slice(1);this._imageDataChunks.push(s),a===this.finalChunkFlag&&this._processCompleteImage().catch(o=>{console.error("RxPhoto: Error processing complete image:",o),this._imageDataChunks=[]})}async _processCompleteImage(){if(!this.queue)return;let i;const a=this.concatenateImageData();if(this._imageDataChunks=[],this.isRaw){if(!this.quality||!this.resolution)throw new Error("RxPhoto: Quality and resolution must be set for raw images if no header is cached.");const s=`${this.quality}_${this.resolution}`,o=ms._jpegHeaderMap[s];if(!o)throw new Error(`RxPhoto: No JPEG header found for quality ${this.quality} and resolution ${this.resolution} - request full JPEG first to cache header.`);const h=new Uint8Array(o.length+a.length);h.set(o,0),h.set(a,o.length),i=h}else if(i=a,this.quality&&this.resolution){const s=`${this.quality}_${this.resolution}`;if(!ms._jpegHeaderMap[s]){const o=i.slice(0,623);ms._jpegHeaderMap[s]=o}}this.upright?(console.log("Rotating image 90 degrees counter-clockwise"),this.queue.put(await this.rotateJpeg90CounterClockwise(i))):this.queue.put(i)}async attach(i){return this.isRaw&&(!this.quality||!this.resolution)&&console.warn("RxPhoto: Handling raw images without quality/resolution specified. Header must be pre-cached or will fail."),this.queue=new AsyncQueue,this._imageDataChunks=[],i.registerDataResponseHandler(this,[this.nonFinalChunkFlag,this.finalChunkFlag],this.handleData.bind(this)),this.queue}detach(i){i.unregisterDataResponseHandler(this),this.queue&&this.queue.clear(),this.queue=null,this._imageDataChunks=[]}async rotateJpeg90CounterClockwise(i){const a=jpeg.decode(i,{useTArray:!0});if(!a||!a.data||!a.width||!a.height)throw new Error("Failed to decode JPEG image.");const s=document.createElement("canvas");s.width=a.height,s.height=a.width;const o=s.getContext("2d");if(!o)throw new Error("Failed to get canvas 2D context.");const h=document.createElement("canvas");h.width=a.width,h.height=a.height;const g=h.getContext("2d");if(!g)throw new Error("Failed to get temporary canvas 2D context.");g.putImageData(new ImageData(new Uint8ClampedArray(a.data.buffer),a.width,a.height),0,0),o.clearRect(0,0,s.width,s.height),o.translate(0,s.height),o.rotate(-90*Math.PI/180),o.drawImage(h,0,0);const _=await(await new Promise(($,b)=>{s.toBlob(tt=>{tt?$(tt):b(new Error("Failed to convert canvas to JPEG blob."))},"image/jpeg")})).arrayBuffer();return new Uint8Array(_)}};$e(Rt,"_jpegHeaderMap",{});let RxPhoto=Rt;const markinoFrameApp=`local data = require('data.min')
local plain_txt = require('plain_text.min')
local camera = require('camera.min')
local sprite = require('sprite.min')
local TEXT_MSG = 0x0A
local CAPTURE_SETTINGS_MSG = 0x0D
local IMAGE_SPRITE_MSG = 0x20
data.parsers[TEXT_MSG] = plain_txt.parse_plain_text
data.parsers[CAPTURE_SETTINGS_MSG] = camera.parse_capture_settings
data.parsers[IMAGE_SPRITE_MSG] = sprite.parse_sprite
local CHAR_PER_LINE = 25
local LINES_PER_PAGE = 5
local LINE_HEIGHT = 60
local wrapped = {}
local page = 1
local function wrap(s)
  local out = {}
  for i = 1, #s, CHAR_PER_LINE do
    out[#out + 1] = s:sub(i, i + CHAR_PER_LINE - 1)
  end
  return out
end
local function clear()
  frame.display.text(' ', 1, 1)
  frame.display.show()
  frame.sleep(0.04)
end
local function render()
  clear()
  for o = 0, LINES_PER_PAGE - 1 do
    local L = wrapped[page + o]
    if not L then break end
    frame.display.text(L, 1, o * LINE_HEIGHT + 1)
  end
  frame.display.show()
end
local function on_tap()
  page = page + LINES_PER_PAGE
  if page > #wrapped then page = 1 end
  render()
end
frame.imu.tap_callback(on_tap)
clear()
print('In esecuzione')
while true do
  local ok, err = pcall(function()
    local n = data.process_raw_items()
    if n > 0 then
      -- testo
      if data.app_data[TEXT_MSG] then
        wrapped = wrap(data.app_data[TEXT_MSG].string or '')
        page    = 1
        render()
        data.app_data[TEXT_MSG] = nil
      end
      if data.app_data[CAPTURE_SETTINGS_MSG] then
        camera.capture_and_send(data.app_data[CAPTURE_SETTINGS_MSG])
        data.app_data[CAPTURE_SETTINGS_MSG] = nil
      end
      if data.app_data[IMAGE_SPRITE_MSG] then
        local spr = data.app_data[IMAGE_SPRITE_MSG]
        print("Sprite ricevuto", spr.width, spr.height)
        sprite.set_palette(spr.num_colors, spr.palette_data)
        frame.display.bitmap(1, 1, spr.width, 2 ^ spr.bpp, 0, spr.pixel_data)
        frame.display.show()
        print("Sprite visualizzato")
        data.app_data[IMAGE_SPRITE_MSG] = nil
        collectgarbage('collect')
      end
    end
  end)
  if not ok then
    print('Errore:', err)
    clear()
  end
  frame.sleep(0.1)
end
`;var leafletSrc={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,i){(function(a,s){s(i)})(commonjsGlobal,function(a){var s="1.9.4";function o(d){var j,ot,gt,xt;for(ot=1,gt=arguments.length;ot<gt;ot++){xt=arguments[ot];for(j in xt)d[j]=xt[j]}return d}var h=Object.create||function(){function d(){}return function(j){return d.prototype=j,new d}}();function g(d,j){var ot=Array.prototype.slice;if(d.bind)return d.bind.apply(d,ot.call(arguments,1));var gt=ot.call(arguments,2);return function(){return d.apply(j,gt.length?gt.concat(ot.call(arguments)):arguments)}}var _=0;function $(d){return"_leaflet_id"in d||(d._leaflet_id=++_),d._leaflet_id}function b(d,j,ot){var gt,xt,Ot,Jt;return Jt=function(){gt=!1,xt&&(Ot.apply(ot,xt),xt=!1)},Ot=function(){gt?xt=arguments:(d.apply(ot,arguments),setTimeout(Jt,j),gt=!0)},Ot}function tt(d,j,ot){var gt=j[1],xt=j[0],Ot=gt-xt;return d===gt&&ot?d:((d-xt)%Ot+Ot)%Ot+xt}function st(){return!1}function at(d,j){if(j===!1)return d;var ot=Math.pow(10,j===void 0?6:j);return Math.round(d*ot)/ot}function nt(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function lt(d){return nt(d).split(/\s+/)}function ft(d,j){Object.prototype.hasOwnProperty.call(d,"options")||(d.options=d.options?h(d.options):{});for(var ot in j)d.options[ot]=j[ot];return d.options}function pt(d,j,ot){var gt=[];for(var xt in d)gt.push(encodeURIComponent(ot?xt.toUpperCase():xt)+"="+encodeURIComponent(d[xt]));return(!j||j.indexOf("?")===-1?"?":"&")+gt.join("&")}var dt=/\{ *([\w_ -]+) *\}/g;function _t(d,j){return d.replace(dt,function(ot,gt){var xt=j[gt];if(xt===void 0)throw new Error("No value provided for variable "+ot);return typeof xt=="function"&&(xt=xt(j)),xt})}var ut=Array.isArray||function(d){return Object.prototype.toString.call(d)==="[object Array]"};function mt(d,j){for(var ot=0;ot<d.length;ot++)if(d[ot]===j)return ot;return-1}var kt="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function bt(d){return window["webkit"+d]||window["moz"+d]||window["ms"+d]}var vt=0;function Et(d){var j=+new Date,ot=Math.max(0,16-(j-vt));return vt=j+ot,window.setTimeout(d,ot)}var Mt=window.requestAnimationFrame||bt("RequestAnimationFrame")||Et,At=window.cancelAnimationFrame||bt("CancelAnimationFrame")||bt("CancelRequestAnimationFrame")||function(d){window.clearTimeout(d)};function zt(d,j,ot){if(ot&&Mt===Et)d.call(j);else return Mt.call(window,g(d,j))}function Vt(d){d&&At.call(window,d)}var Gt={__proto__:null,extend:o,create:h,bind:g,get lastId(){return _},stamp:$,throttle:b,wrapNum:tt,falseFn:st,formatNum:at,trim:nt,splitWords:lt,setOptions:ft,getParamString:pt,template:_t,isArray:ut,indexOf:mt,emptyImageUrl:kt,requestFn:Mt,cancelFn:At,requestAnimFrame:zt,cancelAnimFrame:Vt};function Kt(){}Kt.extend=function(d){var j=function(){ft(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},ot=j.__super__=this.prototype,gt=h(ot);gt.constructor=j,j.prototype=gt;for(var xt in this)Object.prototype.hasOwnProperty.call(this,xt)&&xt!=="prototype"&&xt!=="__super__"&&(j[xt]=this[xt]);return d.statics&&o(j,d.statics),d.includes&&(Wt(d.includes),o.apply(null,[gt].concat(d.includes))),o(gt,d),delete gt.statics,delete gt.includes,gt.options&&(gt.options=ot.options?h(ot.options):{},o(gt.options,d.options)),gt._initHooks=[],gt.callInitHooks=function(){if(!this._initHooksCalled){ot.callInitHooks&&ot.callInitHooks.call(this),this._initHooksCalled=!0;for(var Ot=0,Jt=gt._initHooks.length;Ot<Jt;Ot++)gt._initHooks[Ot].call(this)}},j},Kt.include=function(d){var j=this.prototype.options;return o(this.prototype,d),d.options&&(this.prototype.options=j,this.mergeOptions(d.options)),this},Kt.mergeOptions=function(d){return o(this.prototype.options,d),this},Kt.addInitHook=function(d){var j=Array.prototype.slice.call(arguments,1),ot=typeof d=="function"?d:function(){this[d].apply(this,j)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(ot),this};function Wt(d){if(!(typeof L>"u"||!L||!L.Mixin)){d=ut(d)?d:[d];for(var j=0;j<d.length;j++)d[j]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var sn={on:function(d,j,ot){if(typeof d=="object")for(var gt in d)this._on(gt,d[gt],j);else{d=lt(d);for(var xt=0,Ot=d.length;xt<Ot;xt++)this._on(d[xt],j,ot)}return this},off:function(d,j,ot){if(!arguments.length)delete this._events;else if(typeof d=="object")for(var gt in d)this._off(gt,d[gt],j);else{d=lt(d);for(var xt=arguments.length===1,Ot=0,Jt=d.length;Ot<Jt;Ot++)xt?this._off(d[Ot]):this._off(d[Ot],j,ot)}return this},_on:function(d,j,ot,gt){if(typeof j!="function"){console.warn("wrong listener type: "+typeof j);return}if(this._listens(d,j,ot)===!1){ot===this&&(ot=void 0);var xt={fn:j,ctx:ot};gt&&(xt.once=!0),this._events=this._events||{},this._events[d]=this._events[d]||[],this._events[d].push(xt)}},_off:function(d,j,ot){var gt,xt,Ot;if(this._events&&(gt=this._events[d],!!gt)){if(arguments.length===1){if(this._firingCount)for(xt=0,Ot=gt.length;xt<Ot;xt++)gt[xt].fn=st;delete this._events[d];return}if(typeof j!="function"){console.warn("wrong listener type: "+typeof j);return}var Jt=this._listens(d,j,ot);if(Jt!==!1){var hn=gt[Jt];this._firingCount&&(hn.fn=st,this._events[d]=gt=gt.slice()),gt.splice(Jt,1)}}},fire:function(d,j,ot){if(!this.listens(d,ot))return this;var gt=o({},j,{type:d,target:this,sourceTarget:j&&j.sourceTarget||this});if(this._events){var xt=this._events[d];if(xt){this._firingCount=this._firingCount+1||1;for(var Ot=0,Jt=xt.length;Ot<Jt;Ot++){var hn=xt[Ot],bn=hn.fn;hn.once&&this.off(d,bn,hn.ctx),bn.call(hn.ctx||this,gt)}this._firingCount--}}return ot&&this._propagateEvent(gt),this},listens:function(d,j,ot,gt){typeof d!="string"&&console.warn('"string" type argument expected');var xt=j;typeof j!="function"&&(gt=!!j,xt=void 0,ot=void 0);var Ot=this._events&&this._events[d];if(Ot&&Ot.length&&this._listens(d,xt,ot)!==!1)return!0;if(gt){for(var Jt in this._eventParents)if(this._eventParents[Jt].listens(d,j,ot,gt))return!0}return!1},_listens:function(d,j,ot){if(!this._events)return!1;var gt=this._events[d]||[];if(!j)return!!gt.length;ot===this&&(ot=void 0);for(var xt=0,Ot=gt.length;xt<Ot;xt++)if(gt[xt].fn===j&&gt[xt].ctx===ot)return xt;return!1},once:function(d,j,ot){if(typeof d=="object")for(var gt in d)this._on(gt,d[gt],j,!0);else{d=lt(d);for(var xt=0,Ot=d.length;xt<Ot;xt++)this._on(d[xt],j,ot,!0)}return this},addEventParent:function(d){return this._eventParents=this._eventParents||{},this._eventParents[$(d)]=d,this},removeEventParent:function(d){return this._eventParents&&delete this._eventParents[$(d)],this},_propagateEvent:function(d){for(var j in this._eventParents)this._eventParents[j].fire(d.type,o({layer:d.target,propagatedFrom:d.target},d),!0)}};sn.addEventListener=sn.on,sn.removeEventListener=sn.clearAllEventListeners=sn.off,sn.addOneTimeEventListener=sn.once,sn.fireEvent=sn.fire,sn.hasEventListeners=sn.listens;var on=Kt.extend(sn);function Xt(d,j,ot){this.x=ot?Math.round(d):d,this.y=ot?Math.round(j):j}var ln=Math.trunc||function(d){return d>0?Math.floor(d):Math.ceil(d)};Xt.prototype={clone:function(){return new Xt(this.x,this.y)},add:function(d){return this.clone()._add(nn(d))},_add:function(d){return this.x+=d.x,this.y+=d.y,this},subtract:function(d){return this.clone()._subtract(nn(d))},_subtract:function(d){return this.x-=d.x,this.y-=d.y,this},divideBy:function(d){return this.clone()._divideBy(d)},_divideBy:function(d){return this.x/=d,this.y/=d,this},multiplyBy:function(d){return this.clone()._multiplyBy(d)},_multiplyBy:function(d){return this.x*=d,this.y*=d,this},scaleBy:function(d){return new Xt(this.x*d.x,this.y*d.y)},unscaleBy:function(d){return new Xt(this.x/d.x,this.y/d.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ln(this.x),this.y=ln(this.y),this},distanceTo:function(d){d=nn(d);var j=d.x-this.x,ot=d.y-this.y;return Math.sqrt(j*j+ot*ot)},equals:function(d){return d=nn(d),d.x===this.x&&d.y===this.y},contains:function(d){return d=nn(d),Math.abs(d.x)<=Math.abs(this.x)&&Math.abs(d.y)<=Math.abs(this.y)},toString:function(){return"Point("+at(this.x)+", "+at(this.y)+")"}};function nn(d,j,ot){return d instanceof Xt?d:ut(d)?new Xt(d[0],d[1]):d==null?d:typeof d=="object"&&"x"in d&&"y"in d?new Xt(d.x,d.y):new Xt(d,j,ot)}function gn(d,j){if(d)for(var ot=j?[d,j]:d,gt=0,xt=ot.length;gt<xt;gt++)this.extend(ot[gt])}gn.prototype={extend:function(d){var j,ot;if(!d)return this;if(d instanceof Xt||typeof d[0]=="number"||"x"in d)j=ot=nn(d);else if(d=dn(d),j=d.min,ot=d.max,!j||!ot)return this;return!this.min&&!this.max?(this.min=j.clone(),this.max=ot.clone()):(this.min.x=Math.min(j.x,this.min.x),this.max.x=Math.max(ot.x,this.max.x),this.min.y=Math.min(j.y,this.min.y),this.max.y=Math.max(ot.y,this.max.y)),this},getCenter:function(d){return nn((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,d)},getBottomLeft:function(){return nn(this.min.x,this.max.y)},getTopRight:function(){return nn(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(d){var j,ot;return typeof d[0]=="number"||d instanceof Xt?d=nn(d):d=dn(d),d instanceof gn?(j=d.min,ot=d.max):j=ot=d,j.x>=this.min.x&&ot.x<=this.max.x&&j.y>=this.min.y&&ot.y<=this.max.y},intersects:function(d){d=dn(d);var j=this.min,ot=this.max,gt=d.min,xt=d.max,Ot=xt.x>=j.x&&gt.x<=ot.x,Jt=xt.y>=j.y&&gt.y<=ot.y;return Ot&&Jt},overlaps:function(d){d=dn(d);var j=this.min,ot=this.max,gt=d.min,xt=d.max,Ot=xt.x>j.x&&gt.x<ot.x,Jt=xt.y>j.y&&gt.y<ot.y;return Ot&&Jt},isValid:function(){return!!(this.min&&this.max)},pad:function(d){var j=this.min,ot=this.max,gt=Math.abs(j.x-ot.x)*d,xt=Math.abs(j.y-ot.y)*d;return dn(nn(j.x-gt,j.y-xt),nn(ot.x+gt,ot.y+xt))},equals:function(d){return d?(d=dn(d),this.min.equals(d.getTopLeft())&&this.max.equals(d.getBottomRight())):!1}};function dn(d,j){return!d||d instanceof gn?d:new gn(d,j)}function $n(d,j){if(d)for(var ot=j?[d,j]:d,gt=0,xt=ot.length;gt<xt;gt++)this.extend(ot[gt])}$n.prototype={extend:function(d){var j=this._southWest,ot=this._northEast,gt,xt;if(d instanceof qt)gt=d,xt=d;else if(d instanceof $n){if(gt=d._southWest,xt=d._northEast,!gt||!xt)return this}else return d?this.extend(en(d)||En(d)):this;return!j&&!ot?(this._southWest=new qt(gt.lat,gt.lng),this._northEast=new qt(xt.lat,xt.lng)):(j.lat=Math.min(gt.lat,j.lat),j.lng=Math.min(gt.lng,j.lng),ot.lat=Math.max(xt.lat,ot.lat),ot.lng=Math.max(xt.lng,ot.lng)),this},pad:function(d){var j=this._southWest,ot=this._northEast,gt=Math.abs(j.lat-ot.lat)*d,xt=Math.abs(j.lng-ot.lng)*d;return new $n(new qt(j.lat-gt,j.lng-xt),new qt(ot.lat+gt,ot.lng+xt))},getCenter:function(){return new qt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new qt(this.getNorth(),this.getWest())},getSouthEast:function(){return new qt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(d){typeof d[0]=="number"||d instanceof qt||"lat"in d?d=en(d):d=En(d);var j=this._southWest,ot=this._northEast,gt,xt;return d instanceof $n?(gt=d.getSouthWest(),xt=d.getNorthEast()):gt=xt=d,gt.lat>=j.lat&&xt.lat<=ot.lat&&gt.lng>=j.lng&&xt.lng<=ot.lng},intersects:function(d){d=En(d);var j=this._southWest,ot=this._northEast,gt=d.getSouthWest(),xt=d.getNorthEast(),Ot=xt.lat>=j.lat&&gt.lat<=ot.lat,Jt=xt.lng>=j.lng&&gt.lng<=ot.lng;return Ot&&Jt},overlaps:function(d){d=En(d);var j=this._southWest,ot=this._northEast,gt=d.getSouthWest(),xt=d.getNorthEast(),Ot=xt.lat>j.lat&&gt.lat<ot.lat,Jt=xt.lng>j.lng&&gt.lng<ot.lng;return Ot&&Jt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(d,j){return d?(d=En(d),this._southWest.equals(d.getSouthWest(),j)&&this._northEast.equals(d.getNorthEast(),j)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function En(d,j){return d instanceof $n?d:new $n(d,j)}function qt(d,j,ot){if(isNaN(d)||isNaN(j))throw new Error("Invalid LatLng object: ("+d+", "+j+")");this.lat=+d,this.lng=+j,ot!==void 0&&(this.alt=+ot)}qt.prototype={equals:function(d,j){if(!d)return!1;d=en(d);var ot=Math.max(Math.abs(this.lat-d.lat),Math.abs(this.lng-d.lng));return ot<=(j===void 0?1e-9:j)},toString:function(d){return"LatLng("+at(this.lat,d)+", "+at(this.lng,d)+")"},distanceTo:function(d){return Sn.distance(this,en(d))},wrap:function(){return Sn.wrapLatLng(this)},toBounds:function(d){var j=180*d/40075017,ot=j/Math.cos(Math.PI/180*this.lat);return En([this.lat-j,this.lng-ot],[this.lat+j,this.lng+ot])},clone:function(){return new qt(this.lat,this.lng,this.alt)}};function en(d,j,ot){return d instanceof qt?d:ut(d)&&typeof d[0]!="object"?d.length===3?new qt(d[0],d[1],d[2]):d.length===2?new qt(d[0],d[1]):null:d==null?d:typeof d=="object"&&"lat"in d?new qt(d.lat,"lng"in d?d.lng:d.lon,d.alt):j===void 0?null:new qt(d,j,ot)}var Tn={latLngToPoint:function(d,j){var ot=this.projection.project(d),gt=this.scale(j);return this.transformation._transform(ot,gt)},pointToLatLng:function(d,j){var ot=this.scale(j),gt=this.transformation.untransform(d,ot);return this.projection.unproject(gt)},project:function(d){return this.projection.project(d)},unproject:function(d){return this.projection.unproject(d)},scale:function(d){return 256*Math.pow(2,d)},zoom:function(d){return Math.log(d/256)/Math.LN2},getProjectedBounds:function(d){if(this.infinite)return null;var j=this.projection.bounds,ot=this.scale(d),gt=this.transformation.transform(j.min,ot),xt=this.transformation.transform(j.max,ot);return new gn(gt,xt)},infinite:!1,wrapLatLng:function(d){var j=this.wrapLng?tt(d.lng,this.wrapLng,!0):d.lng,ot=this.wrapLat?tt(d.lat,this.wrapLat,!0):d.lat,gt=d.alt;return new qt(ot,j,gt)},wrapLatLngBounds:function(d){var j=d.getCenter(),ot=this.wrapLatLng(j),gt=j.lat-ot.lat,xt=j.lng-ot.lng;if(gt===0&&xt===0)return d;var Ot=d.getSouthWest(),Jt=d.getNorthEast(),hn=new qt(Ot.lat-gt,Ot.lng-xt),bn=new qt(Jt.lat-gt,Jt.lng-xt);return new $n(hn,bn)}},Sn=o({},Tn,{wrapLng:[-180,180],R:6371e3,distance:function(d,j){var ot=Math.PI/180,gt=d.lat*ot,xt=j.lat*ot,Ot=Math.sin((j.lat-d.lat)*ot/2),Jt=Math.sin((j.lng-d.lng)*ot/2),hn=Ot*Ot+Math.cos(gt)*Math.cos(xt)*Jt*Jt,bn=2*Math.atan2(Math.sqrt(hn),Math.sqrt(1-hn));return this.R*bn}}),fn=6378137,Wn={R:fn,MAX_LATITUDE:85.0511287798,project:function(d){var j=Math.PI/180,ot=this.MAX_LATITUDE,gt=Math.max(Math.min(ot,d.lat),-ot),xt=Math.sin(gt*j);return new Xt(this.R*d.lng*j,this.R*Math.log((1+xt)/(1-xt))/2)},unproject:function(d){var j=180/Math.PI;return new qt((2*Math.atan(Math.exp(d.y/this.R))-Math.PI/2)*j,d.x*j/this.R)},bounds:function(){var d=fn*Math.PI;return new gn([-d,-d],[d,d])}()};function Zn(d,j,ot,gt){if(ut(d)){this._a=d[0],this._b=d[1],this._c=d[2],this._d=d[3];return}this._a=d,this._b=j,this._c=ot,this._d=gt}Zn.prototype={transform:function(d,j){return this._transform(d.clone(),j)},_transform:function(d,j){return j=j||1,d.x=j*(this._a*d.x+this._b),d.y=j*(this._c*d.y+this._d),d},untransform:function(d,j){return j=j||1,new Xt((d.x/j-this._b)/this._a,(d.y/j-this._d)/this._c)}};function Gn(d,j,ot,gt){return new Zn(d,j,ot,gt)}var zn=o({},Sn,{code:"EPSG:3857",projection:Wn,transformation:function(){var d=.5/(Math.PI*Wn.R);return Gn(d,.5,-d,.5)}()}),Bn=o({},zn,{code:"EPSG:900913"});function or(d){return document.createElementNS("http://www.w3.org/2000/svg",d)}function Jn(d,j){var ot="",gt,xt,Ot,Jt,hn,bn;for(gt=0,Ot=d.length;gt<Ot;gt++){for(hn=d[gt],xt=0,Jt=hn.length;xt<Jt;xt++)bn=hn[xt],ot+=(xt?"L":"M")+bn.x+" "+bn.y;ot+=j?Ct.svg?"z":"x":""}return ot||"M0 0"}var Un=document.documentElement.style,nr="ActiveXObject"in window,wn=nr&&!document.addEventListener,jn="msLaunchUri"in navigator&&!("documentMode"in document),er=Nt("webkit"),Vn=Nt("android"),Rn=Nt("android 2")||Nt("android 3"),ar=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Hn=Vn&&Nt("Google")&&ar<537&&!("AudioNode"in window),Fn=!!window.opera,qn=!jn&&Nt("chrome"),ir=Nt("gecko")&&!er&&!Fn&&!nr,Nn=!qn&&Nt("safari"),Kn=Nt("phantom"),Ut="OTransition"in Un,xn=navigator.platform.indexOf("Win")===0,kn=nr&&"transition"in Un,Pn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Rn,tn="MozPerspective"in Un,vn=!window.L_DISABLE_3D&&(kn||Pn||tn)&&!Ut&&!Kn,Pt=typeof orientation<"u"||Nt("mobile"),An=Pt&&er,sr=Pt&&Pn,wt=!window.PointerEvent&&window.MSPointerEvent,mn=!!(window.PointerEvent||wt),yn="ontouchstart"in window||!!window.TouchEvent,Ft=!window.L_NO_TOUCH&&(yn||mn),Qt=Pt&&Fn,cn=Pt&&ir,tr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ct=function(){var d=!1;try{var j=Object.defineProperty({},"passive",{get:function(){d=!0}});window.addEventListener("testPassiveEventSupport",st,j),window.removeEventListener("testPassiveEventSupport",st,j)}catch{}return d}(),rt=function(){return!!document.createElement("canvas").getContext}(),et=!!(document.createElementNS&&or("svg").createSVGRect),it=!!et&&function(){var d=document.createElement("div");return d.innerHTML="<svg/>",(d.firstChild&&d.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ht=!et&&function(){try{var d=document.createElement("div");d.innerHTML='<v:shape adj="1"/>';var j=d.firstChild;return j.style.behavior="url(#default#VML)",j&&typeof j.adj=="object"}catch{return!1}}(),yt=navigator.platform.indexOf("Mac")===0,Lt=navigator.platform.indexOf("Linux")===0;function Nt(d){return navigator.userAgent.toLowerCase().indexOf(d)>=0}var Ct={ie:nr,ielt9:wn,edge:jn,webkit:er,android:Vn,android23:Rn,androidStock:Hn,opera:Fn,chrome:qn,gecko:ir,safari:Nn,phantom:Kn,opera12:Ut,win:xn,ie3d:kn,webkit3d:Pn,gecko3d:tn,any3d:vn,mobile:Pt,mobileWebkit:An,mobileWebkit3d:sr,msPointer:wt,pointer:mn,touch:Ft,touchNative:yn,mobileOpera:Qt,mobileGecko:cn,retina:tr,passiveEvents:ct,canvas:rt,svg:et,vml:ht,inlineSvg:it,mac:yt,linux:Lt},Ht=Ct.msPointer?"MSPointerDown":"pointerdown",rn=Ct.msPointer?"MSPointerMove":"pointermove",jt=Ct.msPointer?"MSPointerUp":"pointerup",pn=Ct.msPointer?"MSPointerCancel":"pointercancel",Mn={touchstart:Ht,touchmove:rn,touchend:jt,touchcancel:pn},un={touchstart:lr,touchmove:rr,touchend:rr,touchcancel:rr},_n={},On=!1;function _e(d,j,ot){return j==="touchstart"&&kr(),un[j]?(ot=un[j].bind(this,ot),d.addEventListener(Mn[j],ot,!1),ot):(console.warn("wrong event specified:",j),st)}function Dn(d,j,ot){if(!Mn[j]){console.warn("wrong event specified:",j);return}d.removeEventListener(Mn[j],ot,!1)}function Yn(d){_n[d.pointerId]=d}function hr(d){_n[d.pointerId]&&(_n[d.pointerId]=d)}function cr(d){delete _n[d.pointerId]}function kr(){On||(document.addEventListener(Ht,Yn,!0),document.addEventListener(rn,hr,!0),document.addEventListener(jt,cr,!0),document.addEventListener(pn,cr,!0),On=!0)}function rr(d,j){if(j.pointerType!==(j.MSPOINTER_TYPE_MOUSE||"mouse")){j.touches=[];for(var ot in _n)j.touches.push(_n[ot]);j.changedTouches=[j],d(j)}}function lr(d,j){j.MSPOINTER_TYPE_TOUCH&&j.pointerType===j.MSPOINTER_TYPE_TOUCH&&Dr(j),rr(d,j)}function Sr(d){var j={},ot,gt;for(gt in d)ot=d[gt],j[gt]=ot&&ot.bind?ot.bind(d):ot;return d=j,j.type="dblclick",j.detail=2,j.isTrusted=!1,j._simulated=!0,j}var an=200;function Cn(d,j){d.addEventListener("dblclick",j);var ot=0,gt;function xt(Ot){if(Ot.detail!==1){gt=Ot.detail;return}if(!(Ot.pointerType==="mouse"||Ot.sourceCapabilities&&!Ot.sourceCapabilities.firesTouchEvents)){var Jt=no(Ot);if(!(Jt.some(function(bn){return bn instanceof HTMLLabelElement&&bn.attributes.for})&&!Jt.some(function(bn){return bn instanceof HTMLInputElement||bn instanceof HTMLSelectElement}))){var hn=Date.now();hn-ot<=an?(gt++,gt===2&&j(Sr(Ot))):gt=1,ot=hn}}}return d.addEventListener("click",xt),{dblclick:j,simDblclick:xt}}function Xn(d,j){d.removeEventListener("dblclick",j.dblclick),d.removeEventListener("click",j.simDblclick)}var In=xa(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),br=xa(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),vr=br==="webkitTransition"||br==="OTransition"?br+"End":"transitionend";function Er(d){return typeof d=="string"?document.getElementById(d):d}function xr(d,j){var ot=d.style[j]||d.currentStyle&&d.currentStyle[j];if((!ot||ot==="auto")&&document.defaultView){var gt=document.defaultView.getComputedStyle(d,null);ot=gt?gt[j]:null}return ot==="auto"?null:ot}function fr(d,j,ot){var gt=document.createElement(d);return gt.className=j||"",ot&&ot.appendChild(gt),gt}function _r(d){var j=d.parentNode;j&&j.removeChild(d)}function Ar(d){for(;d.firstChild;)d.removeChild(d.firstChild)}function $r(d){var j=d.parentNode;j&&j.lastChild!==d&&j.appendChild(d)}function Ir(d){var j=d.parentNode;j&&j.firstChild!==d&&j.insertBefore(d,j.firstChild)}function pr(d,j){if(d.classList!==void 0)return d.classList.contains(j);var ot=Tr(d);return ot.length>0&&new RegExp("(^|\\s)"+j+"(\\s|$)").test(ot)}function ur(d,j){if(d.classList!==void 0)for(var ot=lt(j),gt=0,xt=ot.length;gt<xt;gt++)d.classList.add(ot[gt]);else if(!pr(d,j)){var Ot=Tr(d);Lr(d,(Ot?Ot+" ":"")+j)}}function wr(d,j){d.classList!==void 0?d.classList.remove(j):Lr(d,nt((" "+Tr(d)+" ").replace(" "+j+" "," ")))}function Lr(d,j){d.className.baseVal===void 0?d.className=j:d.className.baseVal=j}function Tr(d){return d.correspondingElement&&(d=d.correspondingElement),d.className.baseVal===void 0?d.className:d.className.baseVal}function Nr(d,j){"opacity"in d.style?d.style.opacity=j:"filter"in d.style&&Ps(d,j)}function Ps(d,j){var ot=!1,gt="DXImageTransform.Microsoft.Alpha";try{ot=d.filters.item(gt)}catch{if(j===1)return}j=Math.round(j*100),ot?(ot.Enabled=j!==100,ot.Opacity=j):d.style.filter+=" progid:"+gt+"(opacity="+j+")"}function xa(d){for(var j=document.documentElement.style,ot=0;ot<d.length;ot++)if(d[ot]in j)return d[ot];return!1}function Zr(d,j,ot){var gt=j||new Xt(0,0);d.style[In]=(Ct.ie3d?"translate("+gt.x+"px,"+gt.y+"px)":"translate3d("+gt.x+"px,"+gt.y+"px,0)")+(ot?" scale("+ot+")":"")}function Rr(d,j){d._leaflet_pos=j,Ct.any3d?Zr(d,j):(d.style.left=j.x+"px",d.style.top=j.y+"px")}function Yr(d){return d._leaflet_pos||new Xt(0,0)}var _i,na,as;if("onselectstart"in document)_i=function(){mr(window,"selectstart",Dr)},na=function(){Mr(window,"selectstart",Dr)};else{var ss=xa(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);_i=function(){if(ss){var d=document.documentElement.style;as=d[ss],d[ss]="none"}},na=function(){ss&&(document.documentElement.style[ss]=as,as=void 0)}}function Cs(){mr(window,"dragstart",Dr)}function $s(){Mr(window,"dragstart",Dr)}var ps,Ls;function Ds(d){for(;d.tabIndex===-1;)d=d.parentNode;d.style&&(gs(),ps=d,Ls=d.style.outlineStyle,d.style.outlineStyle="none",mr(window,"keydown",gs))}function gs(){ps&&(ps.style.outlineStyle=Ls,ps=void 0,Ls=void 0,Mr(window,"keydown",gs))}function to(d){do d=d.parentNode;while((!d.offsetWidth||!d.offsetHeight)&&d!==document.body);return d}function Is(d){var j=d.getBoundingClientRect();return{x:j.width/d.offsetWidth||1,y:j.height/d.offsetHeight||1,boundingClientRect:j}}var Ho={__proto__:null,TRANSFORM:In,TRANSITION:br,TRANSITION_END:vr,get:Er,getStyle:xr,create:fr,remove:_r,empty:Ar,toFront:$r,toBack:Ir,hasClass:pr,addClass:ur,removeClass:wr,setClass:Lr,getClass:Tr,setOpacity:Nr,testProp:xa,setTransform:Zr,setPosition:Rr,getPosition:Yr,get disableTextSelection(){return _i},get enableTextSelection(){return na},disableImageDrag:Cs,enableImageDrag:$s,preventOutline:Ds,restoreOutline:gs,getSizedParentNode:to,getScale:Is};function mr(d,j,ot,gt){if(j&&typeof j=="object")for(var xt in j)Ns(d,xt,j[xt],ot);else{j=lt(j);for(var Ot=0,Jt=j.length;Ot<Jt;Ot++)Ns(d,j[Ot],ot,gt)}return this}var qr="_leaflet_events";function Mr(d,j,ot,gt){if(arguments.length===1)eo(d),delete d[qr];else if(j&&typeof j=="object")for(var xt in j)zs(d,xt,j[xt],ot);else if(j=lt(j),arguments.length===2)eo(d,function(hn){return mt(j,hn)!==-1});else for(var Ot=0,Jt=j.length;Ot<Jt;Ot++)zs(d,j[Ot],ot,gt);return this}function eo(d,j){for(var ot in d[qr]){var gt=ot.split(/\d/)[0];(!j||j(gt))&&zs(d,gt,null,null,ot)}}var Bs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ns(d,j,ot,gt){var xt=j+$(ot)+(gt?"_"+$(gt):"");if(d[qr]&&d[qr][xt])return this;var Ot=function(hn){return ot.call(gt||d,hn||window.event)},Jt=Ot;!Ct.touchNative&&Ct.pointer&&j.indexOf("touch")===0?Ot=_e(d,j,Ot):Ct.touch&&j==="dblclick"?Ot=Cn(d,Ot):"addEventListener"in d?j==="touchstart"||j==="touchmove"||j==="wheel"||j==="mousewheel"?d.addEventListener(Bs[j]||j,Ot,Ct.passiveEvents?{passive:!1}:!1):j==="mouseenter"||j==="mouseleave"?(Ot=function(hn){hn=hn||window.event,Fs(d,hn)&&Jt(hn)},d.addEventListener(Bs[j],Ot,!1)):d.addEventListener(j,Jt,!1):d.attachEvent("on"+j,Ot),d[qr]=d[qr]||{},d[qr][xt]=Ot}function zs(d,j,ot,gt,xt){xt=xt||j+$(ot)+(gt?"_"+$(gt):"");var Ot=d[qr]&&d[qr][xt];if(!Ot)return this;!Ct.touchNative&&Ct.pointer&&j.indexOf("touch")===0?Dn(d,j,Ot):Ct.touch&&j==="dblclick"?Xn(d,Ot):"removeEventListener"in d?d.removeEventListener(Bs[j]||j,Ot,!1):d.detachEvent("on"+j,Ot),d[qr][xt]=null}function ga(d){return d.stopPropagation?d.stopPropagation():d.originalEvent?d.originalEvent._stopped=!0:d.cancelBubble=!0,this}function Os(d){return Ns(d,"wheel",ga),this}function os(d){return mr(d,"mousedown touchstart dblclick contextmenu",ga),d._leaflet_disable_click=!0,this}function Dr(d){return d.preventDefault?d.preventDefault():d.returnValue=!1,this}function _a(d){return Dr(d),ga(d),this}function no(d){if(d.composedPath)return d.composedPath();for(var j=[],ot=d.target;ot;)j.push(ot),ot=ot.parentNode;return j}function ro(d,j){if(!j)return new Xt(d.clientX,d.clientY);var ot=Is(j),gt=ot.boundingClientRect;return new Xt((d.clientX-gt.left)/ot.x-j.clientLeft,(d.clientY-gt.top)/ot.y-j.clientTop)}var qo=Ct.linux&&Ct.chrome?window.devicePixelRatio:Ct.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function io(d){return Ct.edge?d.wheelDeltaY/2:d.deltaY&&d.deltaMode===0?-d.deltaY/qo:d.deltaY&&d.deltaMode===1?-d.deltaY*20:d.deltaY&&d.deltaMode===2?-d.deltaY*60:d.deltaX||d.deltaZ?0:d.wheelDelta?(d.wheelDeltaY||d.wheelDelta)/2:d.detail&&Math.abs(d.detail)<32765?-d.detail*20:d.detail?d.detail/-32765*60:0}function Fs(d,j){var ot=j.relatedTarget;if(!ot)return!0;try{for(;ot&&ot!==d;)ot=ot.parentNode}catch{return!1}return ot!==d}var jo={__proto__:null,on:mr,off:Mr,stopPropagation:ga,disableScrollPropagation:Os,disableClickPropagation:os,preventDefault:Dr,stop:_a,getPropagationPath:no,getMousePosition:ro,getWheelDelta:io,isExternalTarget:Fs,addListener:mr,removeListener:Mr},ao=on.extend({run:function(d,j,ot,gt){this.stop(),this._el=d,this._inProgress=!0,this._duration=ot||.25,this._easeOutPower=1/Math.max(gt||.5,.2),this._startPos=Yr(d),this._offset=j.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=zt(this._animate,this),this._step()},_step:function(d){var j=+new Date-this._startTime,ot=this._duration*1e3;j<ot?this._runFrame(this._easeOut(j/ot),d):(this._runFrame(1),this._complete())},_runFrame:function(d,j){var ot=this._startPos.add(this._offset.multiplyBy(d));j&&ot._round(),Rr(this._el,ot),this.fire("step")},_complete:function(){Vt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(d){return 1-Math.pow(1-d,this._easeOutPower)}}),yr=on.extend({options:{crs:zn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(d,j){j=ft(this,j),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(d),this._initLayout(),this._onResize=g(this._onResize,this),this._initEvents(),j.maxBounds&&this.setMaxBounds(j.maxBounds),j.zoom!==void 0&&(this._zoom=this._limitZoom(j.zoom)),j.center&&j.zoom!==void 0&&this.setView(en(j.center),j.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=br&&Ct.any3d&&!Ct.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),mr(this._proxy,vr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(d,j,ot){if(j=j===void 0?this._zoom:this._limitZoom(j),d=this._limitCenter(en(d),j,this.options.maxBounds),ot=ot||{},this._stop(),this._loaded&&!ot.reset&&ot!==!0){ot.animate!==void 0&&(ot.zoom=o({animate:ot.animate},ot.zoom),ot.pan=o({animate:ot.animate,duration:ot.duration},ot.pan));var gt=this._zoom!==j?this._tryAnimatedZoom&&this._tryAnimatedZoom(d,j,ot.zoom):this._tryAnimatedPan(d,ot.pan);if(gt)return clearTimeout(this._sizeTimer),this}return this._resetView(d,j,ot.pan&&ot.pan.noMoveStart),this},setZoom:function(d,j){return this._loaded?this.setView(this.getCenter(),d,{zoom:j}):(this._zoom=d,this)},zoomIn:function(d,j){return d=d||(Ct.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+d,j)},zoomOut:function(d,j){return d=d||(Ct.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-d,j)},setZoomAround:function(d,j,ot){var gt=this.getZoomScale(j),xt=this.getSize().divideBy(2),Ot=d instanceof Xt?d:this.latLngToContainerPoint(d),Jt=Ot.subtract(xt).multiplyBy(1-1/gt),hn=this.containerPointToLatLng(xt.add(Jt));return this.setView(hn,j,{zoom:ot})},_getBoundsCenterZoom:function(d,j){j=j||{},d=d.getBounds?d.getBounds():En(d);var ot=nn(j.paddingTopLeft||j.padding||[0,0]),gt=nn(j.paddingBottomRight||j.padding||[0,0]),xt=this.getBoundsZoom(d,!1,ot.add(gt));if(xt=typeof j.maxZoom=="number"?Math.min(j.maxZoom,xt):xt,xt===1/0)return{center:d.getCenter(),zoom:xt};var Ot=gt.subtract(ot).divideBy(2),Jt=this.project(d.getSouthWest(),xt),hn=this.project(d.getNorthEast(),xt),bn=this.unproject(Jt.add(hn).divideBy(2).add(Ot),xt);return{center:bn,zoom:xt}},fitBounds:function(d,j){if(d=En(d),!d.isValid())throw new Error("Bounds are not valid.");var ot=this._getBoundsCenterZoom(d,j);return this.setView(ot.center,ot.zoom,j)},fitWorld:function(d){return this.fitBounds([[-90,-180],[90,180]],d)},panTo:function(d,j){return this.setView(d,this._zoom,{pan:j})},panBy:function(d,j){if(d=nn(d).round(),j=j||{},!d.x&&!d.y)return this.fire("moveend");if(j.animate!==!0&&!this.getSize().contains(d))return this._resetView(this.unproject(this.project(this.getCenter()).add(d)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ao,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),j.noMoveStart||this.fire("movestart"),j.animate!==!1){ur(this._mapPane,"leaflet-pan-anim");var ot=this._getMapPanePos().subtract(d).round();this._panAnim.run(this._mapPane,ot,j.duration||.25,j.easeLinearity)}else this._rawPanBy(d),this.fire("move").fire("moveend");return this},flyTo:function(d,j,ot){if(ot=ot||{},ot.animate===!1||!Ct.any3d)return this.setView(d,j,ot);this._stop();var gt=this.project(this.getCenter()),xt=this.project(d),Ot=this.getSize(),Jt=this._zoom;d=en(d),j=j===void 0?Jt:j;var hn=Math.max(Ot.x,Ot.y),bn=hn*this.getZoomScale(Jt,j),Ln=xt.distanceTo(gt)||1,Qn=1.42,dr=Qn*Qn;function gr(Pr){var Ts=Pr?-1:1,tu=Pr?bn:hn,eu=bn*bn-hn*hn+Ts*dr*dr*Ln*Ln,nu=2*tu*dr*Ln,Ws=eu/nu,Fo=Math.sqrt(Ws*Ws+1)-Ws,ru=Fo<1e-9?-18:Math.log(Fo);return ru}function Br(Pr){return(Math.exp(Pr)-Math.exp(-Pr))/2}function Cr(Pr){return(Math.exp(Pr)+Math.exp(-Pr))/2}function Fr(Pr){return Br(Pr)/Cr(Pr)}var zr=gr(0);function is(Pr){return hn*(Cr(zr)/Cr(zr+Qn*Pr))}function Kl(Pr){return hn*(Cr(zr)*Fr(zr+Qn*Pr)-Br(zr))/dr}function Wl(Pr){return 1-Math.pow(1-Pr,1.5)}var Ql=Date.now(),zo=(gr(1)-zr)/Qn,Jl=ot.duration?1e3*ot.duration:1e3*zo*.8;function Oo(){var Pr=(Date.now()-Ql)/Jl,Ts=Wl(Pr)*zo;Pr<=1?(this._flyToFrame=zt(Oo,this),this._move(this.unproject(gt.add(xt.subtract(gt).multiplyBy(Kl(Ts)/Ln)),Jt),this.getScaleZoom(hn/is(Ts),Jt),{flyTo:!0})):this._move(d,j)._moveEnd(!0)}return this._moveStart(!0,ot.noMoveStart),Oo.call(this),this},flyToBounds:function(d,j){var ot=this._getBoundsCenterZoom(d,j);return this.flyTo(ot.center,ot.zoom,j)},setMaxBounds:function(d){return d=En(d),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),d.isValid()?(this.options.maxBounds=d,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(d){var j=this.options.minZoom;return this.options.minZoom=d,this._loaded&&j!==d&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(d):this},setMaxZoom:function(d){var j=this.options.maxZoom;return this.options.maxZoom=d,this._loaded&&j!==d&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(d):this},panInsideBounds:function(d,j){this._enforcingBounds=!0;var ot=this.getCenter(),gt=this._limitCenter(ot,this._zoom,En(d));return ot.equals(gt)||this.panTo(gt,j),this._enforcingBounds=!1,this},panInside:function(d,j){j=j||{};var ot=nn(j.paddingTopLeft||j.padding||[0,0]),gt=nn(j.paddingBottomRight||j.padding||[0,0]),xt=this.project(this.getCenter()),Ot=this.project(d),Jt=this.getPixelBounds(),hn=dn([Jt.min.add(ot),Jt.max.subtract(gt)]),bn=hn.getSize();if(!hn.contains(Ot)){this._enforcingBounds=!0;var Ln=Ot.subtract(hn.getCenter()),Qn=hn.extend(Ot).getSize().subtract(bn);xt.x+=Ln.x<0?-Qn.x:Qn.x,xt.y+=Ln.y<0?-Qn.y:Qn.y,this.panTo(this.unproject(xt),j),this._enforcingBounds=!1}return this},invalidateSize:function(d){if(!this._loaded)return this;d=o({animate:!1,pan:!0},d===!0?{animate:!0}:d);var j=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var ot=this.getSize(),gt=j.divideBy(2).round(),xt=ot.divideBy(2).round(),Ot=gt.subtract(xt);return!Ot.x&&!Ot.y?this:(d.animate&&d.pan?this.panBy(Ot):(d.pan&&this._rawPanBy(Ot),this.fire("move"),d.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(g(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:j,newSize:ot}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(d){if(d=this._locateOptions=o({timeout:1e4,watch:!1},d),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var j=g(this._handleGeolocationResponse,this),ot=g(this._handleGeolocationError,this);return d.watch?this._locationWatchId=navigator.geolocation.watchPosition(j,ot,d):navigator.geolocation.getCurrentPosition(j,ot,d),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(d){if(this._container._leaflet_id){var j=d.code,ot=d.message||(j===1?"permission denied":j===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:j,message:"Geolocation error: "+ot+"."})}},_handleGeolocationResponse:function(d){if(this._container._leaflet_id){var j=d.coords.latitude,ot=d.coords.longitude,gt=new qt(j,ot),xt=gt.toBounds(d.coords.accuracy*2),Ot=this._locateOptions;if(Ot.setView){var Jt=this.getBoundsZoom(xt);this.setView(gt,Ot.maxZoom?Math.min(Jt,Ot.maxZoom):Jt)}var hn={latlng:gt,bounds:xt,timestamp:d.timestamp};for(var bn in d.coords)typeof d.coords[bn]=="number"&&(hn[bn]=d.coords[bn]);this.fire("locationfound",hn)}},addHandler:function(d,j){if(!j)return this;var ot=this[d]=new j(this);return this._handlers.push(ot),this.options[d]&&ot.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),_r(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Vt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var d;for(d in this._layers)this._layers[d].remove();for(d in this._panes)_r(this._panes[d]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(d,j){var ot="leaflet-pane"+(d?" leaflet-"+d.replace("Pane","")+"-pane":""),gt=fr("div",ot,j||this._mapPane);return d&&(this._panes[d]=gt),gt},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var d=this.getPixelBounds(),j=this.unproject(d.getBottomLeft()),ot=this.unproject(d.getTopRight());return new $n(j,ot)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(d,j,ot){d=En(d),ot=nn(ot||[0,0]);var gt=this.getZoom()||0,xt=this.getMinZoom(),Ot=this.getMaxZoom(),Jt=d.getNorthWest(),hn=d.getSouthEast(),bn=this.getSize().subtract(ot),Ln=dn(this.project(hn,gt),this.project(Jt,gt)).getSize(),Qn=Ct.any3d?this.options.zoomSnap:1,dr=bn.x/Ln.x,gr=bn.y/Ln.y,Br=j?Math.max(dr,gr):Math.min(dr,gr);return gt=this.getScaleZoom(Br,gt),Qn&&(gt=Math.round(gt/(Qn/100))*(Qn/100),gt=j?Math.ceil(gt/Qn)*Qn:Math.floor(gt/Qn)*Qn),Math.max(xt,Math.min(Ot,gt))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Xt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(d,j){var ot=this._getTopLeftPoint(d,j);return new gn(ot,ot.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(d){return this.options.crs.getProjectedBounds(d===void 0?this.getZoom():d)},getPane:function(d){return typeof d=="string"?this._panes[d]:d},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(d,j){var ot=this.options.crs;return j=j===void 0?this._zoom:j,ot.scale(d)/ot.scale(j)},getScaleZoom:function(d,j){var ot=this.options.crs;j=j===void 0?this._zoom:j;var gt=ot.zoom(d*ot.scale(j));return isNaN(gt)?1/0:gt},project:function(d,j){return j=j===void 0?this._zoom:j,this.options.crs.latLngToPoint(en(d),j)},unproject:function(d,j){return j=j===void 0?this._zoom:j,this.options.crs.pointToLatLng(nn(d),j)},layerPointToLatLng:function(d){var j=nn(d).add(this.getPixelOrigin());return this.unproject(j)},latLngToLayerPoint:function(d){var j=this.project(en(d))._round();return j._subtract(this.getPixelOrigin())},wrapLatLng:function(d){return this.options.crs.wrapLatLng(en(d))},wrapLatLngBounds:function(d){return this.options.crs.wrapLatLngBounds(En(d))},distance:function(d,j){return this.options.crs.distance(en(d),en(j))},containerPointToLayerPoint:function(d){return nn(d).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(d){return nn(d).add(this._getMapPanePos())},containerPointToLatLng:function(d){var j=this.containerPointToLayerPoint(nn(d));return this.layerPointToLatLng(j)},latLngToContainerPoint:function(d){return this.layerPointToContainerPoint(this.latLngToLayerPoint(en(d)))},mouseEventToContainerPoint:function(d){return ro(d,this._container)},mouseEventToLayerPoint:function(d){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(d))},mouseEventToLatLng:function(d){return this.layerPointToLatLng(this.mouseEventToLayerPoint(d))},_initContainer:function(d){var j=this._container=Er(d);if(j){if(j._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");mr(j,"scroll",this._onScroll,this),this._containerId=$(j)},_initLayout:function(){var d=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ct.any3d,ur(d,"leaflet-container"+(Ct.touch?" leaflet-touch":"")+(Ct.retina?" leaflet-retina":"")+(Ct.ielt9?" leaflet-oldie":"")+(Ct.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var j=xr(d,"position");j!=="absolute"&&j!=="relative"&&j!=="fixed"&&j!=="sticky"&&(d.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var d=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Rr(this._mapPane,new Xt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ur(d.markerPane,"leaflet-zoom-hide"),ur(d.shadowPane,"leaflet-zoom-hide"))},_resetView:function(d,j,ot){Rr(this._mapPane,new Xt(0,0));var gt=!this._loaded;this._loaded=!0,j=this._limitZoom(j),this.fire("viewprereset");var xt=this._zoom!==j;this._moveStart(xt,ot)._move(d,j)._moveEnd(xt),this.fire("viewreset"),gt&&this.fire("load")},_moveStart:function(d,j){return d&&this.fire("zoomstart"),j||this.fire("movestart"),this},_move:function(d,j,ot,gt){j===void 0&&(j=this._zoom);var xt=this._zoom!==j;return this._zoom=j,this._lastCenter=d,this._pixelOrigin=this._getNewPixelOrigin(d),gt?ot&&ot.pinch&&this.fire("zoom",ot):((xt||ot&&ot.pinch)&&this.fire("zoom",ot),this.fire("move",ot)),this},_moveEnd:function(d){return d&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Vt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(d){Rr(this._mapPane,this._getMapPanePos().subtract(d))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(d){this._targets={},this._targets[$(this._container)]=this;var j=d?Mr:mr;j(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&j(window,"resize",this._onResize,this),Ct.any3d&&this.options.transform3DLimit&&(d?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Vt(this._resizeRequest),this._resizeRequest=zt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var d=this._getMapPanePos();Math.max(Math.abs(d.x),Math.abs(d.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(d,j){for(var ot=[],gt,xt=j==="mouseout"||j==="mouseover",Ot=d.target||d.srcElement,Jt=!1;Ot;){if(gt=this._targets[$(Ot)],gt&&(j==="click"||j==="preclick")&&this._draggableMoved(gt)){Jt=!0;break}if(gt&&gt.listens(j,!0)&&(xt&&!Fs(Ot,d)||(ot.push(gt),xt))||Ot===this._container)break;Ot=Ot.parentNode}return!ot.length&&!Jt&&!xt&&this.listens(j,!0)&&(ot=[this]),ot},_isClickDisabled:function(d){for(;d&&d!==this._container;){if(d._leaflet_disable_click)return!0;d=d.parentNode}},_handleDOMEvent:function(d){var j=d.target||d.srcElement;if(!(!this._loaded||j._leaflet_disable_events||d.type==="click"&&this._isClickDisabled(j))){var ot=d.type;ot==="mousedown"&&Ds(j),this._fireDOMEvent(d,ot)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(d,j,ot){if(d.type==="click"){var gt=o({},d);gt.type="preclick",this._fireDOMEvent(gt,gt.type,ot)}var xt=this._findEventTargets(d,j);if(ot){for(var Ot=[],Jt=0;Jt<ot.length;Jt++)ot[Jt].listens(j,!0)&&Ot.push(ot[Jt]);xt=Ot.concat(xt)}if(xt.length){j==="contextmenu"&&Dr(d);var hn=xt[0],bn={originalEvent:d};if(d.type!=="keypress"&&d.type!=="keydown"&&d.type!=="keyup"){var Ln=hn.getLatLng&&(!hn._radius||hn._radius<=10);bn.containerPoint=Ln?this.latLngToContainerPoint(hn.getLatLng()):this.mouseEventToContainerPoint(d),bn.layerPoint=this.containerPointToLayerPoint(bn.containerPoint),bn.latlng=Ln?hn.getLatLng():this.layerPointToLatLng(bn.layerPoint)}for(Jt=0;Jt<xt.length;Jt++)if(xt[Jt].fire(j,bn,!0),bn.originalEvent._stopped||xt[Jt].options.bubblingMouseEvents===!1&&mt(this._mouseEvents,j)!==-1)return}},_draggableMoved:function(d){return d=d.dragging&&d.dragging.enabled()?d:this,d.dragging&&d.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var d=0,j=this._handlers.length;d<j;d++)this._handlers[d].disable()},whenReady:function(d,j){return this._loaded?d.call(j||this,{target:this}):this.on("load",d,j),this},_getMapPanePos:function(){return Yr(this._mapPane)||new Xt(0,0)},_moved:function(){var d=this._getMapPanePos();return d&&!d.equals([0,0])},_getTopLeftPoint:function(d,j){var ot=d&&j!==void 0?this._getNewPixelOrigin(d,j):this.getPixelOrigin();return ot.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(d,j){var ot=this.getSize()._divideBy(2);return this.project(d,j)._subtract(ot)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(d,j,ot){var gt=this._getNewPixelOrigin(ot,j);return this.project(d,j)._subtract(gt)},_latLngBoundsToNewLayerBounds:function(d,j,ot){var gt=this._getNewPixelOrigin(ot,j);return dn([this.project(d.getSouthWest(),j)._subtract(gt),this.project(d.getNorthWest(),j)._subtract(gt),this.project(d.getSouthEast(),j)._subtract(gt),this.project(d.getNorthEast(),j)._subtract(gt)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(d){return this.latLngToLayerPoint(d).subtract(this._getCenterLayerPoint())},_limitCenter:function(d,j,ot){if(!ot)return d;var gt=this.project(d,j),xt=this.getSize().divideBy(2),Ot=new gn(gt.subtract(xt),gt.add(xt)),Jt=this._getBoundsOffset(Ot,ot,j);return Math.abs(Jt.x)<=1&&Math.abs(Jt.y)<=1?d:this.unproject(gt.add(Jt),j)},_limitOffset:function(d,j){if(!j)return d;var ot=this.getPixelBounds(),gt=new gn(ot.min.add(d),ot.max.add(d));return d.add(this._getBoundsOffset(gt,j))},_getBoundsOffset:function(d,j,ot){var gt=dn(this.project(j.getNorthEast(),ot),this.project(j.getSouthWest(),ot)),xt=gt.min.subtract(d.min),Ot=gt.max.subtract(d.max),Jt=this._rebound(xt.x,-Ot.x),hn=this._rebound(xt.y,-Ot.y);return new Xt(Jt,hn)},_rebound:function(d,j){return d+j>0?Math.round(d-j)/2:Math.max(0,Math.ceil(d))-Math.max(0,Math.floor(j))},_limitZoom:function(d){var j=this.getMinZoom(),ot=this.getMaxZoom(),gt=Ct.any3d?this.options.zoomSnap:1;return gt&&(d=Math.round(d/gt)*gt),Math.max(j,Math.min(ot,d))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){wr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(d,j){var ot=this._getCenterOffset(d)._trunc();return(j&&j.animate)!==!0&&!this.getSize().contains(ot)?!1:(this.panBy(ot,j),!0)},_createAnimProxy:function(){var d=this._proxy=fr("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(d),this.on("zoomanim",function(j){var ot=In,gt=this._proxy.style[ot];Zr(this._proxy,this.project(j.center,j.zoom),this.getZoomScale(j.zoom,1)),gt===this._proxy.style[ot]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){_r(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var d=this.getCenter(),j=this.getZoom();Zr(this._proxy,this.project(d,j),this.getZoomScale(j,1))},_catchTransitionEnd:function(d){this._animatingZoom&&d.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(d,j,ot){if(this._animatingZoom)return!0;if(ot=ot||{},!this._zoomAnimated||ot.animate===!1||this._nothingToAnimate()||Math.abs(j-this._zoom)>this.options.zoomAnimationThreshold)return!1;var gt=this.getZoomScale(j),xt=this._getCenterOffset(d)._divideBy(1-1/gt);return ot.animate!==!0&&!this.getSize().contains(xt)?!1:(zt(function(){this._moveStart(!0,ot.noMoveStart||!1)._animateZoom(d,j,!0)},this),!0)},_animateZoom:function(d,j,ot,gt){this._mapPane&&(ot&&(this._animatingZoom=!0,this._animateToCenter=d,this._animateToZoom=j,ur(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:d,zoom:j,noUpdate:gt}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(g(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&wr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Go(d,j){return new yr(d,j)}var Ur=Kt.extend({options:{position:"topright"},initialize:function(d){ft(this,d)},getPosition:function(){return this.options.position},setPosition:function(d){var j=this._map;return j&&j.removeControl(this),this.options.position=d,j&&j.addControl(this),this},getContainer:function(){return this._container},addTo:function(d){this.remove(),this._map=d;var j=this._container=this.onAdd(d),ot=this.getPosition(),gt=d._controlCorners[ot];return ur(j,"leaflet-control"),ot.indexOf("bottom")!==-1?gt.insertBefore(j,gt.firstChild):gt.appendChild(j),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(_r(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(d){this._map&&d&&d.screenX>0&&d.screenY>0&&this._map.getContainer().focus()}}),ls=function(d){return new Ur(d)};yr.include({addControl:function(d){return d.addTo(this),this},removeControl:function(d){return d.remove(),this},_initControlPos:function(){var d=this._controlCorners={},j="leaflet-",ot=this._controlContainer=fr("div",j+"control-container",this._container);function gt(xt,Ot){var Jt=j+xt+" "+j+Ot;d[xt+Ot]=fr("div",Jt,ot)}gt("top","left"),gt("top","right"),gt("bottom","left"),gt("bottom","right")},_clearControlPos:function(){for(var d in this._controlCorners)_r(this._controlCorners[d]);_r(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var so=Ur.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(d,j,ot,gt){return ot<gt?-1:gt<ot?1:0}},initialize:function(d,j,ot){ft(this,ot),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var gt in d)this._addLayer(d[gt],gt);for(gt in j)this._addLayer(j[gt],gt,!0)},onAdd:function(d){this._initLayout(),this._update(),this._map=d,d.on("zoomend",this._checkDisabledLayers,this);for(var j=0;j<this._layers.length;j++)this._layers[j].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(d){return Ur.prototype.addTo.call(this,d),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(d,j){return this._addLayer(d,j),this._map?this._update():this},addOverlay:function(d,j){return this._addLayer(d,j,!0),this._map?this._update():this},removeLayer:function(d){d.off("add remove",this._onLayerChange,this);var j=this._getLayer($(d));return j&&this._layers.splice(this._layers.indexOf(j),1),this._map?this._update():this},expand:function(){ur(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var d=this._map.getSize().y-(this._container.offsetTop+50);return d<this._section.clientHeight?(ur(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=d+"px"):wr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return wr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var d="leaflet-control-layers",j=this._container=fr("div",d),ot=this.options.collapsed;j.setAttribute("aria-haspopup",!0),os(j),Os(j);var gt=this._section=fr("section",d+"-list");ot&&(this._map.on("click",this.collapse,this),mr(j,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var xt=this._layersLink=fr("a",d+"-toggle",j);xt.href="#",xt.title="Layers",xt.setAttribute("role","button"),mr(xt,{keydown:function(Ot){Ot.keyCode===13&&this._expandSafely()},click:function(Ot){Dr(Ot),this._expandSafely()}},this),ot||this.expand(),this._baseLayersList=fr("div",d+"-base",gt),this._separator=fr("div",d+"-separator",gt),this._overlaysList=fr("div",d+"-overlays",gt),j.appendChild(gt)},_getLayer:function(d){for(var j=0;j<this._layers.length;j++)if(this._layers[j]&&$(this._layers[j].layer)===d)return this._layers[j]},_addLayer:function(d,j,ot){this._map&&d.on("add remove",this._onLayerChange,this),this._layers.push({layer:d,name:j,overlay:ot}),this.options.sortLayers&&this._layers.sort(g(function(gt,xt){return this.options.sortFunction(gt.layer,xt.layer,gt.name,xt.name)},this)),this.options.autoZIndex&&d.setZIndex&&(this._lastZIndex++,d.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ar(this._baseLayersList),Ar(this._overlaysList),this._layerControlInputs=[];var d,j,ot,gt,xt=0;for(ot=0;ot<this._layers.length;ot++)gt=this._layers[ot],this._addItem(gt),j=j||gt.overlay,d=d||!gt.overlay,xt+=gt.overlay?0:1;return this.options.hideSingleBase&&(d=d&&xt>1,this._baseLayersList.style.display=d?"":"none"),this._separator.style.display=j&&d?"":"none",this},_onLayerChange:function(d){this._handlingClick||this._update();var j=this._getLayer($(d.target)),ot=j.overlay?d.type==="add"?"overlayadd":"overlayremove":d.type==="add"?"baselayerchange":null;ot&&this._map.fire(ot,j)},_createRadioElement:function(d,j){var ot='<input type="radio" class="leaflet-control-layers-selector" name="'+d+'"'+(j?' checked="checked"':"")+"/>",gt=document.createElement("div");return gt.innerHTML=ot,gt.firstChild},_addItem:function(d){var j=document.createElement("label"),ot=this._map.hasLayer(d.layer),gt;d.overlay?(gt=document.createElement("input"),gt.type="checkbox",gt.className="leaflet-control-layers-selector",gt.defaultChecked=ot):gt=this._createRadioElement("leaflet-base-layers_"+$(this),ot),this._layerControlInputs.push(gt),gt.layerId=$(d.layer),mr(gt,"click",this._onInputClick,this);var xt=document.createElement("span");xt.innerHTML=" "+d.name;var Ot=document.createElement("span");j.appendChild(Ot),Ot.appendChild(gt),Ot.appendChild(xt);var Jt=d.overlay?this._overlaysList:this._baseLayersList;return Jt.appendChild(j),this._checkDisabledLayers(),j},_onInputClick:function(){if(!this._preventClick){var d=this._layerControlInputs,j,ot,gt=[],xt=[];this._handlingClick=!0;for(var Ot=d.length-1;Ot>=0;Ot--)j=d[Ot],ot=this._getLayer(j.layerId).layer,j.checked?gt.push(ot):j.checked||xt.push(ot);for(Ot=0;Ot<xt.length;Ot++)this._map.hasLayer(xt[Ot])&&this._map.removeLayer(xt[Ot]);for(Ot=0;Ot<gt.length;Ot++)this._map.hasLayer(gt[Ot])||this._map.addLayer(gt[Ot]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var d=this._layerControlInputs,j,ot,gt=this._map.getZoom(),xt=d.length-1;xt>=0;xt--)j=d[xt],ot=this._getLayer(j.layerId).layer,j.disabled=ot.options.minZoom!==void 0&&gt<ot.options.minZoom||ot.options.maxZoom!==void 0&&gt>ot.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var d=this._section;this._preventClick=!0,mr(d,"click",Dr),this.expand();var j=this;setTimeout(function(){Mr(d,"click",Dr),j._preventClick=!1})}}),Zo=function(d,j,ot){return new so(d,j,ot)},Us=Ur.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(d){var j="leaflet-control-zoom",ot=fr("div",j+" leaflet-bar"),gt=this.options;return this._zoomInButton=this._createButton(gt.zoomInText,gt.zoomInTitle,j+"-in",ot,this._zoomIn),this._zoomOutButton=this._createButton(gt.zoomOutText,gt.zoomOutTitle,j+"-out",ot,this._zoomOut),this._updateDisabled(),d.on("zoomend zoomlevelschange",this._updateDisabled,this),ot},onRemove:function(d){d.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(d){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(d.shiftKey?3:1))},_zoomOut:function(d){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(d.shiftKey?3:1))},_createButton:function(d,j,ot,gt,xt){var Ot=fr("a",ot,gt);return Ot.innerHTML=d,Ot.href="#",Ot.title=j,Ot.setAttribute("role","button"),Ot.setAttribute("aria-label",j),os(Ot),mr(Ot,"click",_a),mr(Ot,"click",xt,this),mr(Ot,"click",this._refocusOnMap,this),Ot},_updateDisabled:function(){var d=this._map,j="leaflet-disabled";wr(this._zoomInButton,j),wr(this._zoomOutButton,j),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||d._zoom===d.getMinZoom())&&(ur(this._zoomOutButton,j),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||d._zoom===d.getMaxZoom())&&(ur(this._zoomInButton,j),this._zoomInButton.setAttribute("aria-disabled","true"))}});yr.mergeOptions({zoomControl:!0}),yr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Us,this.addControl(this.zoomControl))});var Yo=function(d){return new Us(d)},oo=Ur.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(d){var j="leaflet-control-scale",ot=fr("div",j),gt=this.options;return this._addScales(gt,j+"-line",ot),d.on(gt.updateWhenIdle?"moveend":"move",this._update,this),d.whenReady(this._update,this),ot},onRemove:function(d){d.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(d,j,ot){d.metric&&(this._mScale=fr("div",j,ot)),d.imperial&&(this._iScale=fr("div",j,ot))},_update:function(){var d=this._map,j=d.getSize().y/2,ot=d.distance(d.containerPointToLatLng([0,j]),d.containerPointToLatLng([this.options.maxWidth,j]));this._updateScales(ot)},_updateScales:function(d){this.options.metric&&d&&this._updateMetric(d),this.options.imperial&&d&&this._updateImperial(d)},_updateMetric:function(d){var j=this._getRoundNum(d),ot=j<1e3?j+" m":j/1e3+" km";this._updateScale(this._mScale,ot,j/d)},_updateImperial:function(d){var j=d*3.2808399,ot,gt,xt;j>5280?(ot=j/5280,gt=this._getRoundNum(ot),this._updateScale(this._iScale,gt+" mi",gt/ot)):(xt=this._getRoundNum(j),this._updateScale(this._iScale,xt+" ft",xt/j))},_updateScale:function(d,j,ot){d.style.width=Math.round(this.options.maxWidth*ot)+"px",d.innerHTML=j},_getRoundNum:function(d){var j=Math.pow(10,(Math.floor(d)+"").length-1),ot=d/j;return ot=ot>=10?10:ot>=5?5:ot>=3?3:ot>=2?2:1,j*ot}}),Vo=function(d){return new oo(d)},Xo='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Hs=Ur.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ct.inlineSvg?Xo+" ":"")+"Leaflet</a>"},initialize:function(d){ft(this,d),this._attributions={}},onAdd:function(d){d.attributionControl=this,this._container=fr("div","leaflet-control-attribution"),os(this._container);for(var j in d._layers)d._layers[j].getAttribution&&this.addAttribution(d._layers[j].getAttribution());return this._update(),d.on("layeradd",this._addAttribution,this),this._container},onRemove:function(d){d.off("layeradd",this._addAttribution,this)},_addAttribution:function(d){d.layer.getAttribution&&(this.addAttribution(d.layer.getAttribution()),d.layer.once("remove",function(){this.removeAttribution(d.layer.getAttribution())},this))},setPrefix:function(d){return this.options.prefix=d,this._update(),this},addAttribution:function(d){return d?(this._attributions[d]||(this._attributions[d]=0),this._attributions[d]++,this._update(),this):this},removeAttribution:function(d){return d?(this._attributions[d]&&(this._attributions[d]--,this._update()),this):this},_update:function(){if(this._map){var d=[];for(var j in this._attributions)this._attributions[j]&&d.push(j);var ot=[];this.options.prefix&&ot.push(this.options.prefix),d.length&&ot.push(d.join(", ")),this._container.innerHTML=ot.join(' <span aria-hidden="true">|</span> ')}}});yr.mergeOptions({attributionControl:!0}),yr.addInitHook(function(){this.options.attributionControl&&new Hs().addTo(this)});var Ko=function(d){return new Hs(d)};Ur.Layers=so,Ur.Zoom=Us,Ur.Scale=oo,Ur.Attribution=Hs,ls.layers=Zo,ls.zoom=Yo,ls.scale=Vo,ls.attribution=Ko;var jr=Kt.extend({initialize:function(d){this._map=d},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});jr.addTo=function(d,j){return d.addHandler(j,this),this};var Wo={Events:sn},lo=Ct.touch?"touchstart mousedown":"mousedown",Qr=on.extend({options:{clickTolerance:3},initialize:function(d,j,ot,gt){ft(this,gt),this._element=d,this._dragStartTarget=j||d,this._preventOutline=ot},enable:function(){this._enabled||(mr(this._dragStartTarget,lo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Qr._dragging===this&&this.finishDrag(!0),Mr(this._dragStartTarget,lo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(d){if(this._enabled&&(this._moved=!1,!pr(this._element,"leaflet-zoom-anim"))){if(d.touches&&d.touches.length!==1){Qr._dragging===this&&this.finishDrag();return}if(!(Qr._dragging||d.shiftKey||d.which!==1&&d.button!==1&&!d.touches)&&(Qr._dragging=this,this._preventOutline&&Ds(this._element),Cs(),_i(),!this._moving)){this.fire("down");var j=d.touches?d.touches[0]:d,ot=to(this._element);this._startPoint=new Xt(j.clientX,j.clientY),this._startPos=Yr(this._element),this._parentScale=Is(ot);var gt=d.type==="mousedown";mr(document,gt?"mousemove":"touchmove",this._onMove,this),mr(document,gt?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(d){if(this._enabled){if(d.touches&&d.touches.length>1){this._moved=!0;return}var j=d.touches&&d.touches.length===1?d.touches[0]:d,ot=new Xt(j.clientX,j.clientY)._subtract(this._startPoint);!ot.x&&!ot.y||Math.abs(ot.x)+Math.abs(ot.y)<this.options.clickTolerance||(ot.x/=this._parentScale.x,ot.y/=this._parentScale.y,Dr(d),this._moved||(this.fire("dragstart"),this._moved=!0,ur(document.body,"leaflet-dragging"),this._lastTarget=d.target||d.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ur(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(ot),this._moving=!0,this._lastEvent=d,this._updatePosition())}},_updatePosition:function(){var d={originalEvent:this._lastEvent};this.fire("predrag",d),Rr(this._element,this._newPos),this.fire("drag",d)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(d){wr(document.body,"leaflet-dragging"),this._lastTarget&&(wr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Mr(document,"mousemove touchmove",this._onMove,this),Mr(document,"mouseup touchend touchcancel",this._onUp,this),$s(),na();var j=this._moved&&this._moving;this._moving=!1,Qr._dragging=!1,j&&this.fire("dragend",{noInertia:d,distance:this._newPos.distanceTo(this._startPos)})}});function uo(d,j,ot){var gt,xt=[1,4,2,8],Ot,Jt,hn,bn,Ln,Qn,dr,gr;for(Ot=0,Qn=d.length;Ot<Qn;Ot++)d[Ot]._code=ba(d[Ot],j);for(hn=0;hn<4;hn++){for(dr=xt[hn],gt=[],Ot=0,Qn=d.length,Jt=Qn-1;Ot<Qn;Jt=Ot++)bn=d[Ot],Ln=d[Jt],bn._code&dr?Ln._code&dr||(gr=_s(Ln,bn,dr,j,ot),gr._code=ba(gr,j),gt.push(gr)):(Ln._code&dr&&(gr=_s(Ln,bn,dr,j,ot),gr._code=ba(gr,j),gt.push(gr)),gt.push(bn));d=gt}return d}function ho(d,j){var ot,gt,xt,Ot,Jt,hn,bn,Ln,Qn;if(!d||d.length===0)throw new Error("latlngs not passed");Or(d)||(console.warn("latlngs are not flat! Only the first ring will be used"),d=d[0]);var dr=en([0,0]),gr=En(d),Br=gr.getNorthWest().distanceTo(gr.getSouthWest())*gr.getNorthEast().distanceTo(gr.getNorthWest());Br<1700&&(dr=qs(d));var Cr=d.length,Fr=[];for(ot=0;ot<Cr;ot++){var zr=en(d[ot]);Fr.push(j.project(en([zr.lat-dr.lat,zr.lng-dr.lng])))}for(hn=bn=Ln=0,ot=0,gt=Cr-1;ot<Cr;gt=ot++)xt=Fr[ot],Ot=Fr[gt],Jt=xt.y*Ot.x-Ot.y*xt.x,bn+=(xt.x+Ot.x)*Jt,Ln+=(xt.y+Ot.y)*Jt,hn+=Jt*3;hn===0?Qn=Fr[0]:Qn=[bn/hn,Ln/hn];var is=j.unproject(nn(Qn));return en([is.lat+dr.lat,is.lng+dr.lng])}function qs(d){for(var j=0,ot=0,gt=0,xt=0;xt<d.length;xt++){var Ot=en(d[xt]);j+=Ot.lat,ot+=Ot.lng,gt++}return en([j/gt,ot/gt])}var Qo={__proto__:null,clipPolygon:uo,polygonCenter:ho,centroid:qs};function co(d,j){if(!j||!d.length)return d.slice();var ot=j*j;return d=wl(d,ot),d=_l(d,ot),d}function fo(d,j,ot){return Math.sqrt(us(d,j,ot,!0))}function Jo(d,j,ot){return us(d,j,ot)}function _l(d,j){var ot=d.length,gt=typeof Uint8Array<"u"?Uint8Array:Array,xt=new gt(ot);xt[0]=xt[ot-1]=1,js(d,xt,j,0,ot-1);var Ot,Jt=[];for(Ot=0;Ot<ot;Ot++)xt[Ot]&&Jt.push(d[Ot]);return Jt}function js(d,j,ot,gt,xt){var Ot=0,Jt,hn,bn;for(hn=gt+1;hn<=xt-1;hn++)bn=us(d[hn],d[gt],d[xt],!0),bn>Ot&&(Jt=hn,Ot=bn);Ot>ot&&(j[Jt]=1,js(d,j,ot,gt,Jt),js(d,j,ot,Jt,xt))}function wl(d,j){for(var ot=[d[0]],gt=1,xt=0,Ot=d.length;gt<Ot;gt++)yl(d[gt],d[xt])>j&&(ot.push(d[gt]),xt=gt);return xt<Ot-1&&ot.push(d[Ot-1]),ot}var mo;function po(d,j,ot,gt,xt){var Ot=gt?mo:ba(d,ot),Jt=ba(j,ot),hn,bn,Ln;for(mo=Jt;;){if(!(Ot|Jt))return[d,j];if(Ot&Jt)return!1;hn=Ot||Jt,bn=_s(d,j,hn,ot,xt),Ln=ba(bn,ot),hn===Ot?(d=bn,Ot=Ln):(j=bn,Jt=Ln)}}function _s(d,j,ot,gt,xt){var Ot=j.x-d.x,Jt=j.y-d.y,hn=gt.min,bn=gt.max,Ln,Qn;return ot&8?(Ln=d.x+Ot*(bn.y-d.y)/Jt,Qn=bn.y):ot&4?(Ln=d.x+Ot*(hn.y-d.y)/Jt,Qn=hn.y):ot&2?(Ln=bn.x,Qn=d.y+Jt*(bn.x-d.x)/Ot):ot&1&&(Ln=hn.x,Qn=d.y+Jt*(hn.x-d.x)/Ot),new Xt(Ln,Qn,xt)}function ba(d,j){var ot=0;return d.x<j.min.x?ot|=1:d.x>j.max.x&&(ot|=2),d.y<j.min.y?ot|=4:d.y>j.max.y&&(ot|=8),ot}function yl(d,j){var ot=j.x-d.x,gt=j.y-d.y;return ot*ot+gt*gt}function us(d,j,ot,gt){var xt=j.x,Ot=j.y,Jt=ot.x-xt,hn=ot.y-Ot,bn=Jt*Jt+hn*hn,Ln;return bn>0&&(Ln=((d.x-xt)*Jt+(d.y-Ot)*hn)/bn,Ln>1?(xt=ot.x,Ot=ot.y):Ln>0&&(xt+=Jt*Ln,Ot+=hn*Ln)),Jt=d.x-xt,hn=d.y-Ot,gt?Jt*Jt+hn*hn:new Xt(xt,Ot)}function Or(d){return!ut(d[0])||typeof d[0][0]!="object"&&typeof d[0][0]<"u"}function go(d){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Or(d)}function _o(d,j){var ot,gt,xt,Ot,Jt,hn,bn,Ln;if(!d||d.length===0)throw new Error("latlngs not passed");Or(d)||(console.warn("latlngs are not flat! Only the first ring will be used"),d=d[0]);var Qn=en([0,0]),dr=En(d),gr=dr.getNorthWest().distanceTo(dr.getSouthWest())*dr.getNorthEast().distanceTo(dr.getNorthWest());gr<1700&&(Qn=qs(d));var Br=d.length,Cr=[];for(ot=0;ot<Br;ot++){var Fr=en(d[ot]);Cr.push(j.project(en([Fr.lat-Qn.lat,Fr.lng-Qn.lng])))}for(ot=0,gt=0;ot<Br-1;ot++)gt+=Cr[ot].distanceTo(Cr[ot+1])/2;if(gt===0)Ln=Cr[0];else for(ot=0,Ot=0;ot<Br-1;ot++)if(Jt=Cr[ot],hn=Cr[ot+1],xt=Jt.distanceTo(hn),Ot+=xt,Ot>gt){bn=(Ot-gt)/xt,Ln=[hn.x-bn*(hn.x-Jt.x),hn.y-bn*(hn.y-Jt.y)];break}var zr=j.unproject(nn(Ln));return en([zr.lat+Qn.lat,zr.lng+Qn.lng])}var xl={__proto__:null,simplify:co,pointToSegmentDistance:fo,closestPointOnSegment:Jo,clipSegment:po,_getEdgeIntersection:_s,_getBitCode:ba,_sqClosestPointOnSegment:us,isFlat:Or,_flat:go,polylineCenter:_o},Gs={project:function(d){return new Xt(d.lng,d.lat)},unproject:function(d){return new qt(d.y,d.x)},bounds:new gn([-180,-90],[180,90])},Zs={R:6378137,R_MINOR:6356752314245179e-9,bounds:new gn([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(d){var j=Math.PI/180,ot=this.R,gt=d.lat*j,xt=this.R_MINOR/ot,Ot=Math.sqrt(1-xt*xt),Jt=Ot*Math.sin(gt),hn=Math.tan(Math.PI/4-gt/2)/Math.pow((1-Jt)/(1+Jt),Ot/2);return gt=-ot*Math.log(Math.max(hn,1e-10)),new Xt(d.lng*j*ot,gt)},unproject:function(d){for(var j=180/Math.PI,ot=this.R,gt=this.R_MINOR/ot,xt=Math.sqrt(1-gt*gt),Ot=Math.exp(-d.y/ot),Jt=Math.PI/2-2*Math.atan(Ot),hn=0,bn=.1,Ln;hn<15&&Math.abs(bn)>1e-7;hn++)Ln=xt*Math.sin(Jt),Ln=Math.pow((1-Ln)/(1+Ln),xt/2),bn=Math.PI/2-2*Math.atan(Ot*Ln)-Jt,Jt+=bn;return new qt(Jt*j,d.x*j/ot)}},Sl={__proto__:null,LonLat:Gs,Mercator:Zs,SphericalMercator:Wn},El=o({},Sn,{code:"EPSG:3395",projection:Zs,transformation:function(){var d=.5/(Math.PI*Zs.R);return Gn(d,.5,-d,.5)}()}),wo=o({},Sn,{code:"EPSG:4326",projection:Gs,transformation:Gn(1/180,1,-1/180,.5)}),Ml=o({},Tn,{projection:Gs,transformation:Gn(1,0,-1,0),scale:function(d){return Math.pow(2,d)},zoom:function(d){return Math.log(d)/Math.LN2},distance:function(d,j){var ot=j.lng-d.lng,gt=j.lat-d.lat;return Math.sqrt(ot*ot+gt*gt)},infinite:!0});Tn.Earth=Sn,Tn.EPSG3395=El,Tn.EPSG3857=zn,Tn.EPSG900913=Bn,Tn.EPSG4326=wo,Tn.Simple=Ml;var Hr=on.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(d){return d.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(d){return d&&d.removeLayer(this),this},getPane:function(d){return this._map.getPane(d?this.options[d]||d:this.options.pane)},addInteractiveTarget:function(d){return this._map._targets[$(d)]=this,this},removeInteractiveTarget:function(d){return delete this._map._targets[$(d)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(d){var j=d.target;if(j.hasLayer(this)){if(this._map=j,this._zoomAnimated=j._zoomAnimated,this.getEvents){var ot=this.getEvents();j.on(ot,this),this.once("remove",function(){j.off(ot,this)},this)}this.onAdd(j),this.fire("add"),j.fire("layeradd",{layer:this})}}});yr.include({addLayer:function(d){if(!d._layerAdd)throw new Error("The provided object is not a Layer.");var j=$(d);return this._layers[j]?this:(this._layers[j]=d,d._mapToAdd=this,d.beforeAdd&&d.beforeAdd(this),this.whenReady(d._layerAdd,d),this)},removeLayer:function(d){var j=$(d);return this._layers[j]?(this._loaded&&d.onRemove(this),delete this._layers[j],this._loaded&&(this.fire("layerremove",{layer:d}),d.fire("remove")),d._map=d._mapToAdd=null,this):this},hasLayer:function(d){return $(d)in this._layers},eachLayer:function(d,j){for(var ot in this._layers)d.call(j,this._layers[ot]);return this},_addLayers:function(d){d=d?ut(d)?d:[d]:[];for(var j=0,ot=d.length;j<ot;j++)this.addLayer(d[j])},_addZoomLimit:function(d){(!isNaN(d.options.maxZoom)||!isNaN(d.options.minZoom))&&(this._zoomBoundLayers[$(d)]=d,this._updateZoomLevels())},_removeZoomLimit:function(d){var j=$(d);this._zoomBoundLayers[j]&&(delete this._zoomBoundLayers[j],this._updateZoomLevels())},_updateZoomLevels:function(){var d=1/0,j=-1/0,ot=this._getZoomSpan();for(var gt in this._zoomBoundLayers){var xt=this._zoomBoundLayers[gt].options;d=xt.minZoom===void 0?d:Math.min(d,xt.minZoom),j=xt.maxZoom===void 0?j:Math.max(j,xt.maxZoom)}this._layersMaxZoom=j===-1/0?void 0:j,this._layersMinZoom=d===1/0?void 0:d,ot!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var $a=Hr.extend({initialize:function(d,j){ft(this,j),this._layers={};var ot,gt;if(d)for(ot=0,gt=d.length;ot<gt;ot++)this.addLayer(d[ot])},addLayer:function(d){var j=this.getLayerId(d);return this._layers[j]=d,this._map&&this._map.addLayer(d),this},removeLayer:function(d){var j=d in this._layers?d:this.getLayerId(d);return this._map&&this._layers[j]&&this._map.removeLayer(this._layers[j]),delete this._layers[j],this},hasLayer:function(d){var j=typeof d=="number"?d:this.getLayerId(d);return j in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(d){var j=Array.prototype.slice.call(arguments,1),ot,gt;for(ot in this._layers)gt=this._layers[ot],gt[d]&&gt[d].apply(gt,j);return this},onAdd:function(d){this.eachLayer(d.addLayer,d)},onRemove:function(d){this.eachLayer(d.removeLayer,d)},eachLayer:function(d,j){for(var ot in this._layers)d.call(j,this._layers[ot]);return this},getLayer:function(d){return this._layers[d]},getLayers:function(){var d=[];return this.eachLayer(d.push,d),d},setZIndex:function(d){return this.invoke("setZIndex",d)},getLayerId:function(d){return $(d)}}),Al=function(d,j){return new $a(d,j)},Vr=$a.extend({addLayer:function(d){return this.hasLayer(d)?this:(d.addEventParent(this),$a.prototype.addLayer.call(this,d),this.fire("layeradd",{layer:d}))},removeLayer:function(d){return this.hasLayer(d)?(d in this._layers&&(d=this._layers[d]),d.removeEventParent(this),$a.prototype.removeLayer.call(this,d),this.fire("layerremove",{layer:d})):this},setStyle:function(d){return this.invoke("setStyle",d)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var d=new $n;for(var j in this._layers){var ot=this._layers[j];d.extend(ot.getBounds?ot.getBounds():ot.getLatLng())}return d}}),Tl=function(d,j){return new Vr(d,j)},ts=Kt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(d){ft(this,d)},createIcon:function(d){return this._createIcon("icon",d)},createShadow:function(d){return this._createIcon("shadow",d)},_createIcon:function(d,j){var ot=this._getIconUrl(d);if(!ot){if(d==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var gt=this._createImg(ot,j&&j.tagName==="IMG"?j:null);return this._setIconStyles(gt,d),(this.options.crossOrigin||this.options.crossOrigin==="")&&(gt.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),gt},_setIconStyles:function(d,j){var ot=this.options,gt=ot[j+"Size"];typeof gt=="number"&&(gt=[gt,gt]);var xt=nn(gt),Ot=nn(j==="shadow"&&ot.shadowAnchor||ot.iconAnchor||xt&&xt.divideBy(2,!0));d.className="leaflet-marker-"+j+" "+(ot.className||""),Ot&&(d.style.marginLeft=-Ot.x+"px",d.style.marginTop=-Ot.y+"px"),xt&&(d.style.width=xt.x+"px",d.style.height=xt.y+"px")},_createImg:function(d,j){return j=j||document.createElement("img"),j.src=d,j},_getIconUrl:function(d){return Ct.retina&&this.options[d+"RetinaUrl"]||this.options[d+"Url"]}});function Rl(d){return new ts(d)}var hs=ts.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(d){return typeof hs.imagePath!="string"&&(hs.imagePath=this._detectIconPath()),(this.options.imagePath||hs.imagePath)+ts.prototype._getIconUrl.call(this,d)},_stripUrl:function(d){var j=function(ot,gt,xt){var Ot=gt.exec(ot);return Ot&&Ot[xt]};return d=j(d,/^url\((['"])?(.+)\1\)$/,2),d&&j(d,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var d=fr("div","leaflet-default-icon-path",document.body),j=xr(d,"background-image")||xr(d,"backgroundImage");if(document.body.removeChild(d),j=this._stripUrl(j),j)return j;var ot=document.querySelector('link[href$="leaflet.css"]');return ot?ot.href.substring(0,ot.href.length-11-1):""}}),yo=jr.extend({initialize:function(d){this._marker=d},addHooks:function(){var d=this._marker._icon;this._draggable||(this._draggable=new Qr(d,d,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ur(d,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&wr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(d){var j=this._marker,ot=j._map,gt=this._marker.options.autoPanSpeed,xt=this._marker.options.autoPanPadding,Ot=Yr(j._icon),Jt=ot.getPixelBounds(),hn=ot.getPixelOrigin(),bn=dn(Jt.min._subtract(hn).add(xt),Jt.max._subtract(hn).subtract(xt));if(!bn.contains(Ot)){var Ln=nn((Math.max(bn.max.x,Ot.x)-bn.max.x)/(Jt.max.x-bn.max.x)-(Math.min(bn.min.x,Ot.x)-bn.min.x)/(Jt.min.x-bn.min.x),(Math.max(bn.max.y,Ot.y)-bn.max.y)/(Jt.max.y-bn.max.y)-(Math.min(bn.min.y,Ot.y)-bn.min.y)/(Jt.min.y-bn.min.y)).multiplyBy(gt);ot.panBy(Ln,{animate:!1}),this._draggable._newPos._add(Ln),this._draggable._startPos._add(Ln),Rr(j._icon,this._draggable._newPos),this._onDrag(d),this._panRequest=zt(this._adjustPan.bind(this,d))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(d){this._marker.options.autoPan&&(Vt(this._panRequest),this._panRequest=zt(this._adjustPan.bind(this,d)))},_onDrag:function(d){var j=this._marker,ot=j._shadow,gt=Yr(j._icon),xt=j._map.layerPointToLatLng(gt);ot&&Rr(ot,gt),j._latlng=xt,d.latlng=xt,d.oldLatLng=this._oldLatLng,j.fire("move",d).fire("drag",d)},_onDragEnd:function(d){Vt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",d)}}),ws=Hr.extend({options:{icon:new hs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(d,j){ft(this,j),this._latlng=en(d)},onAdd:function(d){this._zoomAnimated=this._zoomAnimated&&d.options.markerZoomAnimation,this._zoomAnimated&&d.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(d){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&d.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(d){var j=this._latlng;return this._latlng=en(d),this.update(),this.fire("move",{oldLatLng:j,latlng:this._latlng})},setZIndexOffset:function(d){return this.options.zIndexOffset=d,this.update()},getIcon:function(){return this.options.icon},setIcon:function(d){return this.options.icon=d,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var d=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(d)}return this},_initIcon:function(){var d=this.options,j="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),ot=d.icon.createIcon(this._icon),gt=!1;ot!==this._icon&&(this._icon&&this._removeIcon(),gt=!0,d.title&&(ot.title=d.title),ot.tagName==="IMG"&&(ot.alt=d.alt||"")),ur(ot,j),d.keyboard&&(ot.tabIndex="0",ot.setAttribute("role","button")),this._icon=ot,d.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&mr(ot,"focus",this._panOnFocus,this);var xt=d.icon.createShadow(this._shadow),Ot=!1;xt!==this._shadow&&(this._removeShadow(),Ot=!0),xt&&(ur(xt,j),xt.alt=""),this._shadow=xt,d.opacity<1&&this._updateOpacity(),gt&&this.getPane().appendChild(this._icon),this._initInteraction(),xt&&Ot&&this.getPane(d.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Mr(this._icon,"focus",this._panOnFocus,this),_r(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&_r(this._shadow),this._shadow=null},_setPos:function(d){this._icon&&Rr(this._icon,d),this._shadow&&Rr(this._shadow,d),this._zIndex=d.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(d){this._icon&&(this._icon.style.zIndex=this._zIndex+d)},_animateZoom:function(d){var j=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center).round();this._setPos(j)},_initInteraction:function(){if(this.options.interactive&&(ur(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),yo)){var d=this.options.draggable;this.dragging&&(d=this.dragging.enabled(),this.dragging.disable()),this.dragging=new yo(this),d&&this.dragging.enable()}},setOpacity:function(d){return this.options.opacity=d,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var d=this.options.opacity;this._icon&&Nr(this._icon,d),this._shadow&&Nr(this._shadow,d)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var d=this._map;if(d){var j=this.options.icon.options,ot=j.iconSize?nn(j.iconSize):nn(0,0),gt=j.iconAnchor?nn(j.iconAnchor):nn(0,0);d.panInside(this._latlng,{paddingTopLeft:gt,paddingBottomRight:ot.subtract(gt)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Pl(d,j){return new ws(d,j)}var Jr=Hr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(d){this._renderer=d.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(d){return ft(this,d),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&d&&Object.prototype.hasOwnProperty.call(d,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ys=Jr.extend({options:{fill:!0,radius:10},initialize:function(d,j){ft(this,j),this._latlng=en(d),this._radius=this.options.radius},setLatLng:function(d){var j=this._latlng;return this._latlng=en(d),this.redraw(),this.fire("move",{oldLatLng:j,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(d){return this.options.radius=this._radius=d,this.redraw()},getRadius:function(){return this._radius},setStyle:function(d){var j=d&&d.radius||this._radius;return Jr.prototype.setStyle.call(this,d),this.setRadius(j),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var d=this._radius,j=this._radiusY||d,ot=this._clickTolerance(),gt=[d+ot,j+ot];this._pxBounds=new gn(this._point.subtract(gt),this._point.add(gt))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(d){return d.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Cl(d,j){return new ys(d,j)}var Ys=ys.extend({initialize:function(d,j,ot){if(typeof j=="number"&&(j=o({},ot,{radius:j})),ft(this,j),this._latlng=en(d),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(d){return this._mRadius=d,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var d=[this._radius,this._radiusY||this._radius];return new $n(this._map.layerPointToLatLng(this._point.subtract(d)),this._map.layerPointToLatLng(this._point.add(d)))},setStyle:Jr.prototype.setStyle,_project:function(){var d=this._latlng.lng,j=this._latlng.lat,ot=this._map,gt=ot.options.crs;if(gt.distance===Sn.distance){var xt=Math.PI/180,Ot=this._mRadius/Sn.R/xt,Jt=ot.project([j+Ot,d]),hn=ot.project([j-Ot,d]),bn=Jt.add(hn).divideBy(2),Ln=ot.unproject(bn).lat,Qn=Math.acos((Math.cos(Ot*xt)-Math.sin(j*xt)*Math.sin(Ln*xt))/(Math.cos(j*xt)*Math.cos(Ln*xt)))/xt;(isNaN(Qn)||Qn===0)&&(Qn=Ot/Math.cos(Math.PI/180*j)),this._point=bn.subtract(ot.getPixelOrigin()),this._radius=isNaN(Qn)?0:bn.x-ot.project([Ln,d-Qn]).x,this._radiusY=bn.y-Jt.y}else{var dr=gt.unproject(gt.project(this._latlng).subtract([this._mRadius,0]));this._point=ot.latLngToLayerPoint(this._latlng),this._radius=this._point.x-ot.latLngToLayerPoint(dr).x}this._updateBounds()}});function $l(d,j,ot){return new Ys(d,j,ot)}var Xr=Jr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(d,j){ft(this,j),this._setLatLngs(d)},getLatLngs:function(){return this._latlngs},setLatLngs:function(d){return this._setLatLngs(d),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(d){for(var j=1/0,ot=null,gt=us,xt,Ot,Jt=0,hn=this._parts.length;Jt<hn;Jt++)for(var bn=this._parts[Jt],Ln=1,Qn=bn.length;Ln<Qn;Ln++){xt=bn[Ln-1],Ot=bn[Ln];var dr=gt(d,xt,Ot,!0);dr<j&&(j=dr,ot=gt(d,xt,Ot))}return ot&&(ot.distance=Math.sqrt(j)),ot},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _o(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(d,j){return j=j||this._defaultShape(),d=en(d),j.push(d),this._bounds.extend(d),this.redraw()},_setLatLngs:function(d){this._bounds=new $n,this._latlngs=this._convertLatLngs(d)},_defaultShape:function(){return Or(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(d){for(var j=[],ot=Or(d),gt=0,xt=d.length;gt<xt;gt++)ot?(j[gt]=en(d[gt]),this._bounds.extend(j[gt])):j[gt]=this._convertLatLngs(d[gt]);return j},_project:function(){var d=new gn;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,d),this._bounds.isValid()&&d.isValid()&&(this._rawPxBounds=d,this._updateBounds())},_updateBounds:function(){var d=this._clickTolerance(),j=new Xt(d,d);this._rawPxBounds&&(this._pxBounds=new gn([this._rawPxBounds.min.subtract(j),this._rawPxBounds.max.add(j)]))},_projectLatlngs:function(d,j,ot){var gt=d[0]instanceof qt,xt=d.length,Ot,Jt;if(gt){for(Jt=[],Ot=0;Ot<xt;Ot++)Jt[Ot]=this._map.latLngToLayerPoint(d[Ot]),ot.extend(Jt[Ot]);j.push(Jt)}else for(Ot=0;Ot<xt;Ot++)this._projectLatlngs(d[Ot],j,ot)},_clipPoints:function(){var d=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(d))){if(this.options.noClip){this._parts=this._rings;return}var j=this._parts,ot,gt,xt,Ot,Jt,hn,bn;for(ot=0,xt=0,Ot=this._rings.length;ot<Ot;ot++)for(bn=this._rings[ot],gt=0,Jt=bn.length;gt<Jt-1;gt++)hn=po(bn[gt],bn[gt+1],d,gt,!0),hn&&(j[xt]=j[xt]||[],j[xt].push(hn[0]),(hn[1]!==bn[gt+1]||gt===Jt-2)&&(j[xt].push(hn[1]),xt++))}},_simplifyPoints:function(){for(var d=this._parts,j=this.options.smoothFactor,ot=0,gt=d.length;ot<gt;ot++)d[ot]=co(d[ot],j)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(d,j){var ot,gt,xt,Ot,Jt,hn,bn=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(d))return!1;for(ot=0,Ot=this._parts.length;ot<Ot;ot++)for(hn=this._parts[ot],gt=0,Jt=hn.length,xt=Jt-1;gt<Jt;xt=gt++)if(!(!j&&gt===0)&&fo(d,hn[xt],hn[gt])<=bn)return!0;return!1}});function Ll(d,j){return new Xr(d,j)}Xr._flat=go;var es=Xr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ho(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(d){var j=Xr.prototype._convertLatLngs.call(this,d),ot=j.length;return ot>=2&&j[0]instanceof qt&&j[0].equals(j[ot-1])&&j.pop(),j},_setLatLngs:function(d){Xr.prototype._setLatLngs.call(this,d),Or(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Or(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var d=this._renderer._bounds,j=this.options.weight,ot=new Xt(j,j);if(d=new gn(d.min.subtract(ot),d.max.add(ot)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(d))){if(this.options.noClip){this._parts=this._rings;return}for(var gt=0,xt=this._rings.length,Ot;gt<xt;gt++)Ot=uo(this._rings[gt],d,!0),Ot.length&&this._parts.push(Ot)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(d){var j=!1,ot,gt,xt,Ot,Jt,hn,bn,Ln;if(!this._pxBounds||!this._pxBounds.contains(d))return!1;for(Ot=0,bn=this._parts.length;Ot<bn;Ot++)for(ot=this._parts[Ot],Jt=0,Ln=ot.length,hn=Ln-1;Jt<Ln;hn=Jt++)gt=ot[Jt],xt=ot[hn],gt.y>d.y!=xt.y>d.y&&d.x<(xt.x-gt.x)*(d.y-gt.y)/(xt.y-gt.y)+gt.x&&(j=!j);return j||Xr.prototype._containsPoint.call(this,d,!0)}});function Dl(d,j){return new es(d,j)}var Kr=Vr.extend({initialize:function(d,j){ft(this,j),this._layers={},d&&this.addData(d)},addData:function(d){var j=ut(d)?d:d.features,ot,gt,xt;if(j){for(ot=0,gt=j.length;ot<gt;ot++)xt=j[ot],(xt.geometries||xt.geometry||xt.features||xt.coordinates)&&this.addData(xt);return this}var Ot=this.options;if(Ot.filter&&!Ot.filter(d))return this;var Jt=vs(d,Ot);return Jt?(Jt.feature=ks(d),Jt.defaultOptions=Jt.options,this.resetStyle(Jt),Ot.onEachFeature&&Ot.onEachFeature(d,Jt),this.addLayer(Jt)):this},resetStyle:function(d){return d===void 0?this.eachLayer(this.resetStyle,this):(d.options=o({},d.defaultOptions),this._setLayerStyle(d,this.options.style),this)},setStyle:function(d){return this.eachLayer(function(j){this._setLayerStyle(j,d)},this)},_setLayerStyle:function(d,j){d.setStyle&&(typeof j=="function"&&(j=j(d.feature)),d.setStyle(j))}});function vs(d,j){var ot=d.type==="Feature"?d.geometry:d,gt=ot?ot.coordinates:null,xt=[],Ot=j&&j.pointToLayer,Jt=j&&j.coordsToLatLng||Vs,hn,bn,Ln,Qn;if(!gt&&!ot)return null;switch(ot.type){case"Point":return hn=Jt(gt),vo(Ot,d,hn,j);case"MultiPoint":for(Ln=0,Qn=gt.length;Ln<Qn;Ln++)hn=Jt(gt[Ln]),xt.push(vo(Ot,d,hn,j));return new Vr(xt);case"LineString":case"MultiLineString":return bn=bs(gt,ot.type==="LineString"?0:1,Jt),new Xr(bn,j);case"Polygon":case"MultiPolygon":return bn=bs(gt,ot.type==="Polygon"?1:2,Jt),new es(bn,j);case"GeometryCollection":for(Ln=0,Qn=ot.geometries.length;Ln<Qn;Ln++){var dr=vs({geometry:ot.geometries[Ln],type:"Feature",properties:d.properties},j);dr&&xt.push(dr)}return new Vr(xt);case"FeatureCollection":for(Ln=0,Qn=ot.features.length;Ln<Qn;Ln++){var gr=vs(ot.features[Ln],j);gr&&xt.push(gr)}return new Vr(xt);default:throw new Error("Invalid GeoJSON object.")}}function vo(d,j,ot,gt){return d?d(j,ot):new ws(ot,gt&&gt.markersInheritOptions&&gt)}function Vs(d){return new qt(d[1],d[0],d[2])}function bs(d,j,ot){for(var gt=[],xt=0,Ot=d.length,Jt;xt<Ot;xt++)Jt=j?bs(d[xt],j-1,ot):(ot||Vs)(d[xt]),gt.push(Jt);return gt}function Xs(d,j){return d=en(d),d.alt!==void 0?[at(d.lng,j),at(d.lat,j),at(d.alt,j)]:[at(d.lng,j),at(d.lat,j)]}function xs(d,j,ot,gt){for(var xt=[],Ot=0,Jt=d.length;Ot<Jt;Ot++)xt.push(j?xs(d[Ot],Or(d[Ot])?0:j-1,ot,gt):Xs(d[Ot],gt));return!j&&ot&&xt.length>0&&xt.push(xt[0].slice()),xt}function ns(d,j){return d.feature?o({},d.feature,{geometry:j}):ks(j)}function ks(d){return d.type==="Feature"||d.type==="FeatureCollection"?d:{type:"Feature",properties:{},geometry:d}}var Ks={toGeoJSON:function(d){return ns(this,{type:"Point",coordinates:Xs(this.getLatLng(),d)})}};ws.include(Ks),Ys.include(Ks),ys.include(Ks),Xr.include({toGeoJSON:function(d){var j=!Or(this._latlngs),ot=xs(this._latlngs,j?1:0,!1,d);return ns(this,{type:(j?"Multi":"")+"LineString",coordinates:ot})}}),es.include({toGeoJSON:function(d){var j=!Or(this._latlngs),ot=j&&!Or(this._latlngs[0]),gt=xs(this._latlngs,ot?2:j?1:0,!0,d);return j||(gt=[gt]),ns(this,{type:(ot?"Multi":"")+"Polygon",coordinates:gt})}}),$a.include({toMultiPoint:function(d){var j=[];return this.eachLayer(function(ot){j.push(ot.toGeoJSON(d).geometry.coordinates)}),ns(this,{type:"MultiPoint",coordinates:j})},toGeoJSON:function(d){var j=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(j==="MultiPoint")return this.toMultiPoint(d);var ot=j==="GeometryCollection",gt=[];return this.eachLayer(function(xt){if(xt.toGeoJSON){var Ot=xt.toGeoJSON(d);if(ot)gt.push(Ot.geometry);else{var Jt=ks(Ot);Jt.type==="FeatureCollection"?gt.push.apply(gt,Jt.features):gt.push(Jt)}}}),ot?ns(this,{geometries:gt,type:"GeometryCollection"}):{type:"FeatureCollection",features:gt}}});function bo(d,j){return new Kr(d,j)}var Il=bo,Ss=Hr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(d,j,ot){this._url=d,this._bounds=En(j),ft(this,ot)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ur(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){_r(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(d){return this.options.opacity=d,this._image&&this._updateOpacity(),this},setStyle:function(d){return d.opacity&&this.setOpacity(d.opacity),this},bringToFront:function(){return this._map&&$r(this._image),this},bringToBack:function(){return this._map&&Ir(this._image),this},setUrl:function(d){return this._url=d,this._image&&(this._image.src=d),this},setBounds:function(d){return this._bounds=En(d),this._map&&this._reset(),this},getEvents:function(){var d={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var d=this._url.tagName==="IMG",j=this._image=d?this._url:fr("img");if(ur(j,"leaflet-image-layer"),this._zoomAnimated&&ur(j,"leaflet-zoom-animated"),this.options.className&&ur(j,this.options.className),j.onselectstart=st,j.onmousemove=st,j.onload=g(this.fire,this,"load"),j.onerror=g(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(j.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),d){this._url=j.src;return}j.src=this._url,j.alt=this.options.alt},_animateZoom:function(d){var j=this._map.getZoomScale(d.zoom),ot=this._map._latLngBoundsToNewLayerBounds(this._bounds,d.zoom,d.center).min;Zr(this._image,ot,j)},_reset:function(){var d=this._image,j=new gn(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),ot=j.getSize();Rr(d,j.min),d.style.width=ot.x+"px",d.style.height=ot.y+"px"},_updateOpacity:function(){Nr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var d=this.options.errorOverlayUrl;d&&this._url!==d&&(this._url=d,this._image.src=d)},getCenter:function(){return this._bounds.getCenter()}}),Bl=function(d,j,ot){return new Ss(d,j,ot)},xo=Ss.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var d=this._url.tagName==="VIDEO",j=this._image=d?this._url:fr("video");if(ur(j,"leaflet-image-layer"),this._zoomAnimated&&ur(j,"leaflet-zoom-animated"),this.options.className&&ur(j,this.options.className),j.onselectstart=st,j.onmousemove=st,j.onloadeddata=g(this.fire,this,"load"),d){for(var ot=j.getElementsByTagName("source"),gt=[],xt=0;xt<ot.length;xt++)gt.push(ot[xt].src);this._url=ot.length>0?gt:[j.src];return}ut(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(j.style,"objectFit")&&(j.style.objectFit="fill"),j.autoplay=!!this.options.autoplay,j.loop=!!this.options.loop,j.muted=!!this.options.muted,j.playsInline=!!this.options.playsInline;for(var Ot=0;Ot<this._url.length;Ot++){var Jt=fr("source");Jt.src=this._url[Ot],j.appendChild(Jt)}}});function Nl(d,j,ot){return new xo(d,j,ot)}var ko=Ss.extend({_initImage:function(){var d=this._image=this._url;ur(d,"leaflet-image-layer"),this._zoomAnimated&&ur(d,"leaflet-zoom-animated"),this.options.className&&ur(d,this.options.className),d.onselectstart=st,d.onmousemove=st}});function zl(d,j,ot){return new ko(d,j,ot)}var Gr=Hr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(d,j){d&&(d instanceof qt||ut(d))?(this._latlng=en(d),ft(this,j)):(ft(this,d),this._source=j),this.options.content&&(this._content=this.options.content)},openOn:function(d){return d=arguments.length?d:this._source._map,d.hasLayer(this)||d.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(d){return this._map?this.close():(arguments.length?this._source=d:d=this._source,this._prepareOpen(),this.openOn(d._map)),this},onAdd:function(d){this._zoomAnimated=d._zoomAnimated,this._container||this._initLayout(),d._fadeAnimated&&Nr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),d._fadeAnimated&&Nr(this._container,1),this.bringToFront(),this.options.interactive&&(ur(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(d){d._fadeAnimated?(Nr(this._container,0),this._removeTimeout=setTimeout(g(_r,void 0,this._container),200)):_r(this._container),this.options.interactive&&(wr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(d){return this._latlng=en(d),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(d){return this._content=d,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var d={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&$r(this._container),this},bringToBack:function(){return this._map&&Ir(this._container),this},_prepareOpen:function(d){var j=this._source;if(!j._map)return!1;if(j instanceof Vr){j=null;var ot=this._source._layers;for(var gt in ot)if(ot[gt]._map){j=ot[gt];break}if(!j)return!1;this._source=j}if(!d)if(j.getCenter)d=j.getCenter();else if(j.getLatLng)d=j.getLatLng();else if(j.getBounds)d=j.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(d),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var d=this._contentNode,j=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof j=="string")d.innerHTML=j;else{for(;d.hasChildNodes();)d.removeChild(d.firstChild);d.appendChild(j)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var d=this._map.latLngToLayerPoint(this._latlng),j=nn(this.options.offset),ot=this._getAnchor();this._zoomAnimated?Rr(this._container,d.add(ot)):j=j.add(d).add(ot);var gt=this._containerBottom=-j.y,xt=this._containerLeft=-Math.round(this._containerWidth/2)+j.x;this._container.style.bottom=gt+"px",this._container.style.left=xt+"px"}},_getAnchor:function(){return[0,0]}});yr.include({_initOverlay:function(d,j,ot,gt){var xt=j;return xt instanceof d||(xt=new d(gt).setContent(j)),ot&&xt.setLatLng(ot),xt}}),Hr.include({_initOverlay:function(d,j,ot,gt){var xt=ot;return xt instanceof d?(ft(xt,gt),xt._source=this):(xt=j&&!gt?j:new d(gt,this),xt.setContent(ot)),xt}});var Es=Gr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(d){return d=arguments.length?d:this._source._map,!d.hasLayer(this)&&d._popup&&d._popup.options.autoClose&&d.removeLayer(d._popup),d._popup=this,Gr.prototype.openOn.call(this,d)},onAdd:function(d){Gr.prototype.onAdd.call(this,d),d.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Jr||this._source.on("preclick",ga))},onRemove:function(d){Gr.prototype.onRemove.call(this,d),d.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Jr||this._source.off("preclick",ga))},getEvents:function(){var d=Gr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(d.preclick=this.close),this.options.keepInView&&(d.moveend=this._adjustPan),d},_initLayout:function(){var d="leaflet-popup",j=this._container=fr("div",d+" "+(this.options.className||"")+" leaflet-zoom-animated"),ot=this._wrapper=fr("div",d+"-content-wrapper",j);if(this._contentNode=fr("div",d+"-content",ot),os(j),Os(this._contentNode),mr(j,"contextmenu",ga),this._tipContainer=fr("div",d+"-tip-container",j),this._tip=fr("div",d+"-tip",this._tipContainer),this.options.closeButton){var gt=this._closeButton=fr("a",d+"-close-button",j);gt.setAttribute("role","button"),gt.setAttribute("aria-label","Close popup"),gt.href="#close",gt.innerHTML='<span aria-hidden="true">&#215;</span>',mr(gt,"click",function(xt){Dr(xt),this.close()},this)}},_updateLayout:function(){var d=this._contentNode,j=d.style;j.width="",j.whiteSpace="nowrap";var ot=d.offsetWidth;ot=Math.min(ot,this.options.maxWidth),ot=Math.max(ot,this.options.minWidth),j.width=ot+1+"px",j.whiteSpace="",j.height="";var gt=d.offsetHeight,xt=this.options.maxHeight,Ot="leaflet-popup-scrolled";xt&&gt>xt?(j.height=xt+"px",ur(d,Ot)):wr(d,Ot),this._containerWidth=this._container.offsetWidth},_animateZoom:function(d){var j=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center),ot=this._getAnchor();Rr(this._container,j.add(ot))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var d=this._map,j=parseInt(xr(this._container,"marginBottom"),10)||0,ot=this._container.offsetHeight+j,gt=this._containerWidth,xt=new Xt(this._containerLeft,-ot-this._containerBottom);xt._add(Yr(this._container));var Ot=d.layerPointToContainerPoint(xt),Jt=nn(this.options.autoPanPadding),hn=nn(this.options.autoPanPaddingTopLeft||Jt),bn=nn(this.options.autoPanPaddingBottomRight||Jt),Ln=d.getSize(),Qn=0,dr=0;Ot.x+gt+bn.x>Ln.x&&(Qn=Ot.x+gt-Ln.x+bn.x),Ot.x-Qn-hn.x<0&&(Qn=Ot.x-hn.x),Ot.y+ot+bn.y>Ln.y&&(dr=Ot.y+ot-Ln.y+bn.y),Ot.y-dr-hn.y<0&&(dr=Ot.y-hn.y),(Qn||dr)&&(this.options.keepInView&&(this._autopanning=!0),d.fire("autopanstart").panBy([Qn,dr]))}},_getAnchor:function(){return nn(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ol=function(d,j){return new Es(d,j)};yr.mergeOptions({closePopupOnClick:!0}),yr.include({openPopup:function(d,j,ot){return this._initOverlay(Es,d,j,ot).openOn(this),this},closePopup:function(d){return d=arguments.length?d:this._popup,d&&d.close(),this}}),Hr.include({bindPopup:function(d,j){return this._popup=this._initOverlay(Es,this._popup,d,j),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(d){return this._popup&&(this instanceof Vr||(this._popup._source=this),this._popup._prepareOpen(d||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(d){return this._popup&&this._popup.setContent(d),this},getPopup:function(){return this._popup},_openPopup:function(d){if(!(!this._popup||!this._map)){_a(d);var j=d.layer||d.target;if(this._popup._source===j&&!(j instanceof Jr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(d.latlng);return}this._popup._source=j,this.openPopup(d.latlng)}},_movePopup:function(d){this._popup.setLatLng(d.latlng)},_onKeyPress:function(d){d.originalEvent.keyCode===13&&this._openPopup(d)}});var Ms=Gr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(d){Gr.prototype.onAdd.call(this,d),this.setOpacity(this.options.opacity),d.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(d){Gr.prototype.onRemove.call(this,d),d.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var d=Gr.prototype.getEvents.call(this);return this.options.permanent||(d.preclick=this.close),d},_initLayout:function(){var d="leaflet-tooltip",j=d+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=fr("div",j),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+$(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(d){var j,ot,gt=this._map,xt=this._container,Ot=gt.latLngToContainerPoint(gt.getCenter()),Jt=gt.layerPointToContainerPoint(d),hn=this.options.direction,bn=xt.offsetWidth,Ln=xt.offsetHeight,Qn=nn(this.options.offset),dr=this._getAnchor();hn==="top"?(j=bn/2,ot=Ln):hn==="bottom"?(j=bn/2,ot=0):hn==="center"?(j=bn/2,ot=Ln/2):hn==="right"?(j=0,ot=Ln/2):hn==="left"?(j=bn,ot=Ln/2):Jt.x<Ot.x?(hn="right",j=0,ot=Ln/2):(hn="left",j=bn+(Qn.x+dr.x)*2,ot=Ln/2),d=d.subtract(nn(j,ot,!0)).add(Qn).add(dr),wr(xt,"leaflet-tooltip-right"),wr(xt,"leaflet-tooltip-left"),wr(xt,"leaflet-tooltip-top"),wr(xt,"leaflet-tooltip-bottom"),ur(xt,"leaflet-tooltip-"+hn),Rr(xt,d)},_updatePosition:function(){var d=this._map.latLngToLayerPoint(this._latlng);this._setPosition(d)},setOpacity:function(d){this.options.opacity=d,this._container&&Nr(this._container,d)},_animateZoom:function(d){var j=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center);this._setPosition(j)},_getAnchor:function(){return nn(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Fl=function(d,j){return new Ms(d,j)};yr.include({openTooltip:function(d,j,ot){return this._initOverlay(Ms,d,j,ot).openOn(this),this},closeTooltip:function(d){return d.close(),this}}),Hr.include({bindTooltip:function(d,j){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ms,this._tooltip,d,j),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(d){if(!(!d&&this._tooltipHandlersAdded)){var j=d?"off":"on",ot={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?ot.add=this._openTooltip:(ot.mouseover=this._openTooltip,ot.mouseout=this.closeTooltip,ot.click=this._openTooltip,this._map?this._addFocusListeners():ot.add=this._addFocusListeners),this._tooltip.options.sticky&&(ot.mousemove=this._moveTooltip),this[j](ot),this._tooltipHandlersAdded=!d}},openTooltip:function(d){return this._tooltip&&(this instanceof Vr||(this._tooltip._source=this),this._tooltip._prepareOpen(d)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(d){return this._tooltip&&this._tooltip.setContent(d),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(d){var j=typeof d.getElement=="function"&&d.getElement();j&&(mr(j,"focus",function(){this._tooltip._source=d,this.openTooltip()},this),mr(j,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(d){var j=typeof d.getElement=="function"&&d.getElement();j&&j.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(d){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var j=this;this._map.once("moveend",function(){j._openOnceFlag=!1,j._openTooltip(d)});return}this._tooltip._source=d.layer||d.target,this.openTooltip(this._tooltip.options.sticky?d.latlng:void 0)}},_moveTooltip:function(d){var j=d.latlng,ot,gt;this._tooltip.options.sticky&&d.originalEvent&&(ot=this._map.mouseEventToContainerPoint(d.originalEvent),gt=this._map.containerPointToLayerPoint(ot),j=this._map.layerPointToLatLng(gt)),this._tooltip.setLatLng(j)}});var So=ts.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(d){var j=d&&d.tagName==="DIV"?d:document.createElement("div"),ot=this.options;if(ot.html instanceof Element?(Ar(j),j.appendChild(ot.html)):j.innerHTML=ot.html!==!1?ot.html:"",ot.bgPos){var gt=nn(ot.bgPos);j.style.backgroundPosition=-gt.x+"px "+-gt.y+"px"}return this._setIconStyles(j,"icon"),j},createShadow:function(){return null}});function Ul(d){return new So(d)}ts.Default=hs;var cs=Hr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ct.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(d){ft(this,d)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(d){d._addZoomLimit(this)},onRemove:function(d){this._removeAllTiles(),_r(this._container),d._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&($r(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ir(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(d){return this.options.opacity=d,this._updateOpacity(),this},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var d=this._clampZoom(this._map.getZoom());d!==this._tileZoom&&(this._tileZoom=d,this._updateLevels()),this._update()}return this},getEvents:function(){var d={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=b(this._onMoveEnd,this.options.updateInterval,this)),d.move=this._onMove),this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},createTile:function(){return document.createElement("div")},getTileSize:function(){var d=this.options.tileSize;return d instanceof Xt?d:new Xt(d,d)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(d){for(var j=this.getPane().children,ot=-d(-1/0,1/0),gt=0,xt=j.length,Ot;gt<xt;gt++)Ot=j[gt].style.zIndex,j[gt]!==this._container&&Ot&&(ot=d(ot,+Ot));isFinite(ot)&&(this.options.zIndex=ot+d(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ct.ielt9){Nr(this._container,this.options.opacity);var d=+new Date,j=!1,ot=!1;for(var gt in this._tiles){var xt=this._tiles[gt];if(!(!xt.current||!xt.loaded)){var Ot=Math.min(1,(d-xt.loaded)/200);Nr(xt.el,Ot),Ot<1?j=!0:(xt.active?ot=!0:this._onOpaqueTile(xt),xt.active=!0)}}ot&&!this._noPrune&&this._pruneTiles(),j&&(Vt(this._fadeFrame),this._fadeFrame=zt(this._updateOpacity,this))}},_onOpaqueTile:st,_initContainer:function(){this._container||(this._container=fr("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var d=this._tileZoom,j=this.options.maxZoom;if(d!==void 0){for(var ot in this._levels)ot=Number(ot),this._levels[ot].el.children.length||ot===d?(this._levels[ot].el.style.zIndex=j-Math.abs(d-ot),this._onUpdateLevel(ot)):(_r(this._levels[ot].el),this._removeTilesAtZoom(ot),this._onRemoveLevel(ot),delete this._levels[ot]);var gt=this._levels[d],xt=this._map;return gt||(gt=this._levels[d]={},gt.el=fr("div","leaflet-tile-container leaflet-zoom-animated",this._container),gt.el.style.zIndex=j,gt.origin=xt.project(xt.unproject(xt.getPixelOrigin()),d).round(),gt.zoom=d,this._setZoomTransform(gt,xt.getCenter(),xt.getZoom()),st(gt.el.offsetWidth),this._onCreateLevel(gt)),this._level=gt,gt}},_onUpdateLevel:st,_onRemoveLevel:st,_onCreateLevel:st,_pruneTiles:function(){if(this._map){var d,j,ot=this._map.getZoom();if(ot>this.options.maxZoom||ot<this.options.minZoom){this._removeAllTiles();return}for(d in this._tiles)j=this._tiles[d],j.retain=j.current;for(d in this._tiles)if(j=this._tiles[d],j.current&&!j.active){var gt=j.coords;this._retainParent(gt.x,gt.y,gt.z,gt.z-5)||this._retainChildren(gt.x,gt.y,gt.z,gt.z+2)}for(d in this._tiles)this._tiles[d].retain||this._removeTile(d)}},_removeTilesAtZoom:function(d){for(var j in this._tiles)this._tiles[j].coords.z===d&&this._removeTile(j)},_removeAllTiles:function(){for(var d in this._tiles)this._removeTile(d)},_invalidateAll:function(){for(var d in this._levels)_r(this._levels[d].el),this._onRemoveLevel(Number(d)),delete this._levels[d];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(d,j,ot,gt){var xt=Math.floor(d/2),Ot=Math.floor(j/2),Jt=ot-1,hn=new Xt(+xt,+Ot);hn.z=+Jt;var bn=this._tileCoordsToKey(hn),Ln=this._tiles[bn];return Ln&&Ln.active?(Ln.retain=!0,!0):(Ln&&Ln.loaded&&(Ln.retain=!0),Jt>gt?this._retainParent(xt,Ot,Jt,gt):!1)},_retainChildren:function(d,j,ot,gt){for(var xt=2*d;xt<2*d+2;xt++)for(var Ot=2*j;Ot<2*j+2;Ot++){var Jt=new Xt(xt,Ot);Jt.z=ot+1;var hn=this._tileCoordsToKey(Jt),bn=this._tiles[hn];if(bn&&bn.active){bn.retain=!0;continue}else bn&&bn.loaded&&(bn.retain=!0);ot+1<gt&&this._retainChildren(xt,Ot,ot+1,gt)}},_resetView:function(d){var j=d&&(d.pinch||d.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),j,j)},_animateZoom:function(d){this._setView(d.center,d.zoom,!0,d.noUpdate)},_clampZoom:function(d){var j=this.options;return j.minNativeZoom!==void 0&&d<j.minNativeZoom?j.minNativeZoom:j.maxNativeZoom!==void 0&&j.maxNativeZoom<d?j.maxNativeZoom:d},_setView:function(d,j,ot,gt){var xt=Math.round(j);this.options.maxZoom!==void 0&&xt>this.options.maxZoom||this.options.minZoom!==void 0&&xt<this.options.minZoom?xt=void 0:xt=this._clampZoom(xt);var Ot=this.options.updateWhenZooming&&xt!==this._tileZoom;(!gt||Ot)&&(this._tileZoom=xt,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),xt!==void 0&&this._update(d),ot||this._pruneTiles(),this._noPrune=!!ot),this._setZoomTransforms(d,j)},_setZoomTransforms:function(d,j){for(var ot in this._levels)this._setZoomTransform(this._levels[ot],d,j)},_setZoomTransform:function(d,j,ot){var gt=this._map.getZoomScale(ot,d.zoom),xt=d.origin.multiplyBy(gt).subtract(this._map._getNewPixelOrigin(j,ot)).round();Ct.any3d?Zr(d.el,xt,gt):Rr(d.el,xt)},_resetGrid:function(){var d=this._map,j=d.options.crs,ot=this._tileSize=this.getTileSize(),gt=this._tileZoom,xt=this._map.getPixelWorldBounds(this._tileZoom);xt&&(this._globalTileRange=this._pxBoundsToTileRange(xt)),this._wrapX=j.wrapLng&&!this.options.noWrap&&[Math.floor(d.project([0,j.wrapLng[0]],gt).x/ot.x),Math.ceil(d.project([0,j.wrapLng[1]],gt).x/ot.y)],this._wrapY=j.wrapLat&&!this.options.noWrap&&[Math.floor(d.project([j.wrapLat[0],0],gt).y/ot.x),Math.ceil(d.project([j.wrapLat[1],0],gt).y/ot.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(d){var j=this._map,ot=j._animatingZoom?Math.max(j._animateToZoom,j.getZoom()):j.getZoom(),gt=j.getZoomScale(ot,this._tileZoom),xt=j.project(d,this._tileZoom).floor(),Ot=j.getSize().divideBy(gt*2);return new gn(xt.subtract(Ot),xt.add(Ot))},_update:function(d){var j=this._map;if(j){var ot=this._clampZoom(j.getZoom());if(d===void 0&&(d=j.getCenter()),this._tileZoom!==void 0){var gt=this._getTiledPixelBounds(d),xt=this._pxBoundsToTileRange(gt),Ot=xt.getCenter(),Jt=[],hn=this.options.keepBuffer,bn=new gn(xt.getBottomLeft().subtract([hn,-hn]),xt.getTopRight().add([hn,-hn]));if(!(isFinite(xt.min.x)&&isFinite(xt.min.y)&&isFinite(xt.max.x)&&isFinite(xt.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ln in this._tiles){var Qn=this._tiles[Ln].coords;(Qn.z!==this._tileZoom||!bn.contains(new Xt(Qn.x,Qn.y)))&&(this._tiles[Ln].current=!1)}if(Math.abs(ot-this._tileZoom)>1){this._setView(d,ot);return}for(var dr=xt.min.y;dr<=xt.max.y;dr++)for(var gr=xt.min.x;gr<=xt.max.x;gr++){var Br=new Xt(gr,dr);if(Br.z=this._tileZoom,!!this._isValidTile(Br)){var Cr=this._tiles[this._tileCoordsToKey(Br)];Cr?Cr.current=!0:Jt.push(Br)}}if(Jt.sort(function(zr,is){return zr.distanceTo(Ot)-is.distanceTo(Ot)}),Jt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Fr=document.createDocumentFragment();for(gr=0;gr<Jt.length;gr++)this._addTile(Jt[gr],Fr);this._level.el.appendChild(Fr)}}}},_isValidTile:function(d){var j=this._map.options.crs;if(!j.infinite){var ot=this._globalTileRange;if(!j.wrapLng&&(d.x<ot.min.x||d.x>ot.max.x)||!j.wrapLat&&(d.y<ot.min.y||d.y>ot.max.y))return!1}if(!this.options.bounds)return!0;var gt=this._tileCoordsToBounds(d);return En(this.options.bounds).overlaps(gt)},_keyToBounds:function(d){return this._tileCoordsToBounds(this._keyToTileCoords(d))},_tileCoordsToNwSe:function(d){var j=this._map,ot=this.getTileSize(),gt=d.scaleBy(ot),xt=gt.add(ot),Ot=j.unproject(gt,d.z),Jt=j.unproject(xt,d.z);return[Ot,Jt]},_tileCoordsToBounds:function(d){var j=this._tileCoordsToNwSe(d),ot=new $n(j[0],j[1]);return this.options.noWrap||(ot=this._map.wrapLatLngBounds(ot)),ot},_tileCoordsToKey:function(d){return d.x+":"+d.y+":"+d.z},_keyToTileCoords:function(d){var j=d.split(":"),ot=new Xt(+j[0],+j[1]);return ot.z=+j[2],ot},_removeTile:function(d){var j=this._tiles[d];j&&(_r(j.el),delete this._tiles[d],this.fire("tileunload",{tile:j.el,coords:this._keyToTileCoords(d)}))},_initTile:function(d){ur(d,"leaflet-tile");var j=this.getTileSize();d.style.width=j.x+"px",d.style.height=j.y+"px",d.onselectstart=st,d.onmousemove=st,Ct.ielt9&&this.options.opacity<1&&Nr(d,this.options.opacity)},_addTile:function(d,j){var ot=this._getTilePos(d),gt=this._tileCoordsToKey(d),xt=this.createTile(this._wrapCoords(d),g(this._tileReady,this,d));this._initTile(xt),this.createTile.length<2&&zt(g(this._tileReady,this,d,null,xt)),Rr(xt,ot),this._tiles[gt]={el:xt,coords:d,current:!0},j.appendChild(xt),this.fire("tileloadstart",{tile:xt,coords:d})},_tileReady:function(d,j,ot){j&&this.fire("tileerror",{error:j,tile:ot,coords:d});var gt=this._tileCoordsToKey(d);ot=this._tiles[gt],ot&&(ot.loaded=+new Date,this._map._fadeAnimated?(Nr(ot.el,0),Vt(this._fadeFrame),this._fadeFrame=zt(this._updateOpacity,this)):(ot.active=!0,this._pruneTiles()),j||(ur(ot.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:ot.el,coords:d})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ct.ielt9||!this._map._fadeAnimated?zt(this._pruneTiles,this):setTimeout(g(this._pruneTiles,this),250)))},_getTilePos:function(d){return d.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(d){var j=new Xt(this._wrapX?tt(d.x,this._wrapX):d.x,this._wrapY?tt(d.y,this._wrapY):d.y);return j.z=d.z,j},_pxBoundsToTileRange:function(d){var j=this.getTileSize();return new gn(d.min.unscaleBy(j).floor(),d.max.unscaleBy(j).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var d in this._tiles)if(!this._tiles[d].loaded)return!1;return!0}});function Hl(d){return new cs(d)}var rs=cs.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(d,j){this._url=d,j=ft(this,j),j.detectRetina&&Ct.retina&&j.maxZoom>0?(j.tileSize=Math.floor(j.tileSize/2),j.zoomReverse?(j.zoomOffset--,j.minZoom=Math.min(j.maxZoom,j.minZoom+1)):(j.zoomOffset++,j.maxZoom=Math.max(j.minZoom,j.maxZoom-1)),j.minZoom=Math.max(0,j.minZoom)):j.zoomReverse?j.minZoom=Math.min(j.maxZoom,j.minZoom):j.maxZoom=Math.max(j.minZoom,j.maxZoom),typeof j.subdomains=="string"&&(j.subdomains=j.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(d,j){return this._url===d&&j===void 0&&(j=!0),this._url=d,j||this.redraw(),this},createTile:function(d,j){var ot=document.createElement("img");return mr(ot,"load",g(this._tileOnLoad,this,j,ot)),mr(ot,"error",g(this._tileOnError,this,j,ot)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(ot.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(ot.referrerPolicy=this.options.referrerPolicy),ot.alt="",ot.src=this.getTileUrl(d),ot},getTileUrl:function(d){var j={r:Ct.retina?"@2x":"",s:this._getSubdomain(d),x:d.x,y:d.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var ot=this._globalTileRange.max.y-d.y;this.options.tms&&(j.y=ot),j["-y"]=ot}return _t(this._url,o(j,this.options))},_tileOnLoad:function(d,j){Ct.ielt9?setTimeout(g(d,this,null,j),0):d(null,j)},_tileOnError:function(d,j,ot){var gt=this.options.errorTileUrl;gt&&j.getAttribute("src")!==gt&&(j.src=gt),d(ot,j)},_onTileRemove:function(d){d.tile.onload=null},_getZoomForUrl:function(){var d=this._tileZoom,j=this.options.maxZoom,ot=this.options.zoomReverse,gt=this.options.zoomOffset;return ot&&(d=j-d),d+gt},_getSubdomain:function(d){var j=Math.abs(d.x+d.y)%this.options.subdomains.length;return this.options.subdomains[j]},_abortLoading:function(){var d,j;for(d in this._tiles)if(this._tiles[d].coords.z!==this._tileZoom&&(j=this._tiles[d].el,j.onload=st,j.onerror=st,!j.complete)){j.src=kt;var ot=this._tiles[d].coords;_r(j),delete this._tiles[d],this.fire("tileabort",{tile:j,coords:ot})}},_removeTile:function(d){var j=this._tiles[d];if(j)return j.el.setAttribute("src",kt),cs.prototype._removeTile.call(this,d)},_tileReady:function(d,j,ot){if(!(!this._map||ot&&ot.getAttribute("src")===kt))return cs.prototype._tileReady.call(this,d,j,ot)}});function Eo(d,j){return new rs(d,j)}var Mo=rs.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(d,j){this._url=d;var ot=o({},this.defaultWmsParams);for(var gt in j)gt in this.options||(ot[gt]=j[gt]);j=ft(this,j);var xt=j.detectRetina&&Ct.retina?2:1,Ot=this.getTileSize();ot.width=Ot.x*xt,ot.height=Ot.y*xt,this.wmsParams=ot},onAdd:function(d){this._crs=this.options.crs||d.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var j=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[j]=this._crs.code,rs.prototype.onAdd.call(this,d)},getTileUrl:function(d){var j=this._tileCoordsToNwSe(d),ot=this._crs,gt=dn(ot.project(j[0]),ot.project(j[1])),xt=gt.min,Ot=gt.max,Jt=(this._wmsVersion>=1.3&&this._crs===wo?[xt.y,xt.x,Ot.y,Ot.x]:[xt.x,xt.y,Ot.x,Ot.y]).join(","),hn=rs.prototype.getTileUrl.call(this,d);return hn+pt(this.wmsParams,hn,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Jt},setParams:function(d,j){return o(this.wmsParams,d),j||this.redraw(),this}});function Gl(d,j){return new Mo(d,j)}rs.WMS=Mo,Eo.wms=Gl;var Wr=Hr.extend({options:{padding:.1},initialize:function(d){ft(this,d),$(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ur(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var d={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(d.zoomanim=this._onAnimZoom),d},_onAnimZoom:function(d){this._updateTransform(d.center,d.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(d,j){var ot=this._map.getZoomScale(j,this._zoom),gt=this._map.getSize().multiplyBy(.5+this.options.padding),xt=this._map.project(this._center,j),Ot=gt.multiplyBy(-ot).add(xt).subtract(this._map._getNewPixelOrigin(d,j));Ct.any3d?Zr(this._container,Ot,ot):Rr(this._container,Ot)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var d in this._layers)this._layers[d]._reset()},_onZoomEnd:function(){for(var d in this._layers)this._layers[d]._project()},_updatePaths:function(){for(var d in this._layers)this._layers[d]._update()},_update:function(){var d=this.options.padding,j=this._map.getSize(),ot=this._map.containerPointToLayerPoint(j.multiplyBy(-d)).round();this._bounds=new gn(ot,ot.add(j.multiplyBy(1+d*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ao=Wr.extend({options:{tolerance:0},getEvents:function(){var d=Wr.prototype.getEvents.call(this);return d.viewprereset=this._onViewPreReset,d},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Wr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var d=this._container=document.createElement("canvas");mr(d,"mousemove",this._onMouseMove,this),mr(d,"click dblclick mousedown mouseup contextmenu",this._onClick,this),mr(d,"mouseout",this._handleMouseOut,this),d._leaflet_disable_events=!0,this._ctx=d.getContext("2d")},_destroyContainer:function(){Vt(this._redrawRequest),delete this._ctx,_r(this._container),Mr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var d;this._redrawBounds=null;for(var j in this._layers)d=this._layers[j],d._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Wr.prototype._update.call(this);var d=this._bounds,j=this._container,ot=d.getSize(),gt=Ct.retina?2:1;Rr(j,d.min),j.width=gt*ot.x,j.height=gt*ot.y,j.style.width=ot.x+"px",j.style.height=ot.y+"px",Ct.retina&&this._ctx.scale(2,2),this._ctx.translate(-d.min.x,-d.min.y),this.fire("update")}},_reset:function(){Wr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(d){this._updateDashArray(d),this._layers[$(d)]=d;var j=d._order={layer:d,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=j),this._drawLast=j,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(d){this._requestRedraw(d)},_removePath:function(d){var j=d._order,ot=j.next,gt=j.prev;ot?ot.prev=gt:this._drawLast=gt,gt?gt.next=ot:this._drawFirst=ot,delete d._order,delete this._layers[$(d)],this._requestRedraw(d)},_updatePath:function(d){this._extendRedrawBounds(d),d._project(),d._update(),this._requestRedraw(d)},_updateStyle:function(d){this._updateDashArray(d),this._requestRedraw(d)},_updateDashArray:function(d){if(typeof d.options.dashArray=="string"){var j=d.options.dashArray.split(/[, ]+/),ot=[],gt,xt;for(xt=0;xt<j.length;xt++){if(gt=Number(j[xt]),isNaN(gt))return;ot.push(gt)}d.options._dashArray=ot}else d.options._dashArray=d.options.dashArray},_requestRedraw:function(d){this._map&&(this._extendRedrawBounds(d),this._redrawRequest=this._redrawRequest||zt(this._redraw,this))},_extendRedrawBounds:function(d){if(d._pxBounds){var j=(d.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new gn,this._redrawBounds.extend(d._pxBounds.min.subtract([j,j])),this._redrawBounds.extend(d._pxBounds.max.add([j,j]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var d=this._redrawBounds;if(d){var j=d.getSize();this._ctx.clearRect(d.min.x,d.min.y,j.x,j.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var d,j=this._redrawBounds;if(this._ctx.save(),j){var ot=j.getSize();this._ctx.beginPath(),this._ctx.rect(j.min.x,j.min.y,ot.x,ot.y),this._ctx.clip()}this._drawing=!0;for(var gt=this._drawFirst;gt;gt=gt.next)d=gt.layer,(!j||d._pxBounds&&d._pxBounds.intersects(j))&&d._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(d,j){if(this._drawing){var ot,gt,xt,Ot,Jt=d._parts,hn=Jt.length,bn=this._ctx;if(hn){for(bn.beginPath(),ot=0;ot<hn;ot++){for(gt=0,xt=Jt[ot].length;gt<xt;gt++)Ot=Jt[ot][gt],bn[gt?"lineTo":"moveTo"](Ot.x,Ot.y);j&&bn.closePath()}this._fillStroke(bn,d)}}},_updateCircle:function(d){if(!(!this._drawing||d._empty())){var j=d._point,ot=this._ctx,gt=Math.max(Math.round(d._radius),1),xt=(Math.max(Math.round(d._radiusY),1)||gt)/gt;xt!==1&&(ot.save(),ot.scale(1,xt)),ot.beginPath(),ot.arc(j.x,j.y/xt,gt,0,Math.PI*2,!1),xt!==1&&ot.restore(),this._fillStroke(ot,d)}},_fillStroke:function(d,j){var ot=j.options;ot.fill&&(d.globalAlpha=ot.fillOpacity,d.fillStyle=ot.fillColor||ot.color,d.fill(ot.fillRule||"evenodd")),ot.stroke&&ot.weight!==0&&(d.setLineDash&&d.setLineDash(j.options&&j.options._dashArray||[]),d.globalAlpha=ot.opacity,d.lineWidth=ot.weight,d.strokeStyle=ot.color,d.lineCap=ot.lineCap,d.lineJoin=ot.lineJoin,d.stroke())},_onClick:function(d){for(var j=this._map.mouseEventToLayerPoint(d),ot,gt,xt=this._drawFirst;xt;xt=xt.next)ot=xt.layer,ot.options.interactive&&ot._containsPoint(j)&&(!(d.type==="click"||d.type==="preclick")||!this._map._draggableMoved(ot))&&(gt=ot);this._fireEvent(gt?[gt]:!1,d)},_onMouseMove:function(d){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var j=this._map.mouseEventToLayerPoint(d);this._handleMouseHover(d,j)}},_handleMouseOut:function(d){var j=this._hoveredLayer;j&&(wr(this._container,"leaflet-interactive"),this._fireEvent([j],d,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(d,j){if(!this._mouseHoverThrottled){for(var ot,gt,xt=this._drawFirst;xt;xt=xt.next)ot=xt.layer,ot.options.interactive&&ot._containsPoint(j)&&(gt=ot);gt!==this._hoveredLayer&&(this._handleMouseOut(d),gt&&(ur(this._container,"leaflet-interactive"),this._fireEvent([gt],d,"mouseover"),this._hoveredLayer=gt)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,d),this._mouseHoverThrottled=!0,setTimeout(g(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(d,j,ot){this._map._fireDOMEvent(j,ot||j.type,d)},_bringToFront:function(d){var j=d._order;if(j){var ot=j.next,gt=j.prev;if(ot)ot.prev=gt;else return;gt?gt.next=ot:ot&&(this._drawFirst=ot),j.prev=this._drawLast,this._drawLast.next=j,j.next=null,this._drawLast=j,this._requestRedraw(d)}},_bringToBack:function(d){var j=d._order;if(j){var ot=j.next,gt=j.prev;if(gt)gt.next=ot;else return;ot?ot.prev=gt:gt&&(this._drawLast=gt),j.prev=null,j.next=this._drawFirst,this._drawFirst.prev=j,this._drawFirst=j,this._requestRedraw(d)}}});function To(d){return Ct.canvas?new Ao(d):null}var fs=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(d){return document.createElement("<lvml:"+d+' class="lvml">')}}catch{}return function(d){return document.createElement("<"+d+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Zl={_initContainer:function(){this._container=fr("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Wr.prototype._update.call(this),this.fire("update"))},_initPath:function(d){var j=d._container=fs("shape");ur(j,"leaflet-vml-shape "+(this.options.className||"")),j.coordsize="1 1",d._path=fs("path"),j.appendChild(d._path),this._updateStyle(d),this._layers[$(d)]=d},_addPath:function(d){var j=d._container;this._container.appendChild(j),d.options.interactive&&d.addInteractiveTarget(j)},_removePath:function(d){var j=d._container;_r(j),d.removeInteractiveTarget(j),delete this._layers[$(d)]},_updateStyle:function(d){var j=d._stroke,ot=d._fill,gt=d.options,xt=d._container;xt.stroked=!!gt.stroke,xt.filled=!!gt.fill,gt.stroke?(j||(j=d._stroke=fs("stroke")),xt.appendChild(j),j.weight=gt.weight+"px",j.color=gt.color,j.opacity=gt.opacity,gt.dashArray?j.dashStyle=ut(gt.dashArray)?gt.dashArray.join(" "):gt.dashArray.replace(/( *, *)/g," "):j.dashStyle="",j.endcap=gt.lineCap.replace("butt","flat"),j.joinstyle=gt.lineJoin):j&&(xt.removeChild(j),d._stroke=null),gt.fill?(ot||(ot=d._fill=fs("fill")),xt.appendChild(ot),ot.color=gt.fillColor||gt.color,ot.opacity=gt.fillOpacity):ot&&(xt.removeChild(ot),d._fill=null)},_updateCircle:function(d){var j=d._point.round(),ot=Math.round(d._radius),gt=Math.round(d._radiusY||ot);this._setPath(d,d._empty()?"M0 0":"AL "+j.x+","+j.y+" "+ot+","+gt+" 0,"+65535*360)},_setPath:function(d,j){d._path.v=j},_bringToFront:function(d){$r(d._container)},_bringToBack:function(d){Ir(d._container)}},As=Ct.vml?fs:or,ds=Wr.extend({_initContainer:function(){this._container=As("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=As("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){_r(this._container),Mr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Wr.prototype._update.call(this);var d=this._bounds,j=d.getSize(),ot=this._container;(!this._svgSize||!this._svgSize.equals(j))&&(this._svgSize=j,ot.setAttribute("width",j.x),ot.setAttribute("height",j.y)),Rr(ot,d.min),ot.setAttribute("viewBox",[d.min.x,d.min.y,j.x,j.y].join(" ")),this.fire("update")}},_initPath:function(d){var j=d._path=As("path");d.options.className&&ur(j,d.options.className),d.options.interactive&&ur(j,"leaflet-interactive"),this._updateStyle(d),this._layers[$(d)]=d},_addPath:function(d){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(d._path),d.addInteractiveTarget(d._path)},_removePath:function(d){_r(d._path),d.removeInteractiveTarget(d._path),delete this._layers[$(d)]},_updatePath:function(d){d._project(),d._update()},_updateStyle:function(d){var j=d._path,ot=d.options;j&&(ot.stroke?(j.setAttribute("stroke",ot.color),j.setAttribute("stroke-opacity",ot.opacity),j.setAttribute("stroke-width",ot.weight),j.setAttribute("stroke-linecap",ot.lineCap),j.setAttribute("stroke-linejoin",ot.lineJoin),ot.dashArray?j.setAttribute("stroke-dasharray",ot.dashArray):j.removeAttribute("stroke-dasharray"),ot.dashOffset?j.setAttribute("stroke-dashoffset",ot.dashOffset):j.removeAttribute("stroke-dashoffset")):j.setAttribute("stroke","none"),ot.fill?(j.setAttribute("fill",ot.fillColor||ot.color),j.setAttribute("fill-opacity",ot.fillOpacity),j.setAttribute("fill-rule",ot.fillRule||"evenodd")):j.setAttribute("fill","none"))},_updatePoly:function(d,j){this._setPath(d,Jn(d._parts,j))},_updateCircle:function(d){var j=d._point,ot=Math.max(Math.round(d._radius),1),gt=Math.max(Math.round(d._radiusY),1)||ot,xt="a"+ot+","+gt+" 0 1,0 ",Ot=d._empty()?"M0 0":"M"+(j.x-ot)+","+j.y+xt+ot*2+",0 "+xt+-ot*2+",0 ";this._setPath(d,Ot)},_setPath:function(d,j){d._path.setAttribute("d",j)},_bringToFront:function(d){$r(d._path)},_bringToBack:function(d){Ir(d._path)}});Ct.vml&&ds.include(Zl);function Ro(d){return Ct.svg||Ct.vml?new ds(d):null}yr.include({getRenderer:function(d){var j=d.options.renderer||this._getPaneRenderer(d.options.pane)||this.options.renderer||this._renderer;return j||(j=this._renderer=this._createRenderer()),this.hasLayer(j)||this.addLayer(j),j},_getPaneRenderer:function(d){if(d==="overlayPane"||d===void 0)return!1;var j=this._paneRenderers[d];return j===void 0&&(j=this._createRenderer({pane:d}),this._paneRenderers[d]=j),j},_createRenderer:function(d){return this.options.preferCanvas&&To(d)||Ro(d)}});var Po=es.extend({initialize:function(d,j){es.prototype.initialize.call(this,this._boundsToLatLngs(d),j)},setBounds:function(d){return this.setLatLngs(this._boundsToLatLngs(d))},_boundsToLatLngs:function(d){return d=En(d),[d.getSouthWest(),d.getNorthWest(),d.getNorthEast(),d.getSouthEast()]}});function Yl(d,j){return new Po(d,j)}ds.create=As,ds.pointsToPath=Jn,Kr.geometryToLayer=vs,Kr.coordsToLatLng=Vs,Kr.coordsToLatLngs=bs,Kr.latLngToCoords=Xs,Kr.latLngsToCoords=xs,Kr.getFeature=ns,Kr.asFeature=ks,yr.mergeOptions({boxZoom:!0});var Co=jr.extend({initialize:function(d){this._map=d,this._container=d._container,this._pane=d._panes.overlayPane,this._resetStateTimeout=0,d.on("unload",this._destroy,this)},addHooks:function(){mr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Mr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){_r(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(d){if(!d.shiftKey||d.which!==1&&d.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),_i(),Cs(),this._startPoint=this._map.mouseEventToContainerPoint(d),mr(document,{contextmenu:_a,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(d){this._moved||(this._moved=!0,this._box=fr("div","leaflet-zoom-box",this._container),ur(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(d);var j=new gn(this._point,this._startPoint),ot=j.getSize();Rr(this._box,j.min),this._box.style.width=ot.x+"px",this._box.style.height=ot.y+"px"},_finish:function(){this._moved&&(_r(this._box),wr(this._container,"leaflet-crosshair")),na(),$s(),Mr(document,{contextmenu:_a,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(d){if(!(d.which!==1&&d.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(g(this._resetState,this),0);var j=new $n(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(j).fire("boxzoomend",{boxZoomBounds:j})}},_onKeyDown:function(d){d.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});yr.addInitHook("addHandler","boxZoom",Co),yr.mergeOptions({doubleClickZoom:!0});var $o=jr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(d){var j=this._map,ot=j.getZoom(),gt=j.options.zoomDelta,xt=d.originalEvent.shiftKey?ot-gt:ot+gt;j.options.doubleClickZoom==="center"?j.setZoom(xt):j.setZoomAround(d.containerPoint,xt)}});yr.addInitHook("addHandler","doubleClickZoom",$o),yr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Lo=jr.extend({addHooks:function(){if(!this._draggable){var d=this._map;this._draggable=new Qr(d._mapPane,d._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),d.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),d.on("zoomend",this._onZoomEnd,this),d.whenReady(this._onZoomEnd,this))}ur(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){wr(this._map._container,"leaflet-grab"),wr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var d=this._map;if(d._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var j=En(this._map.options.maxBounds);this._offsetLimit=dn(this._map.latLngToContainerPoint(j.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(j.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;d.fire("movestart").fire("dragstart"),d.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(d){if(this._map.options.inertia){var j=this._lastTime=+new Date,ot=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(ot),this._times.push(j),this._prunePositions(j)}this._map.fire("move",d).fire("drag",d)},_prunePositions:function(d){for(;this._positions.length>1&&d-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var d=this._map.getSize().divideBy(2),j=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=j.subtract(d).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(d,j){return d-(d-j)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var d=this._draggable._newPos.subtract(this._draggable._startPos),j=this._offsetLimit;d.x<j.min.x&&(d.x=this._viscousLimit(d.x,j.min.x)),d.y<j.min.y&&(d.y=this._viscousLimit(d.y,j.min.y)),d.x>j.max.x&&(d.x=this._viscousLimit(d.x,j.max.x)),d.y>j.max.y&&(d.y=this._viscousLimit(d.y,j.max.y)),this._draggable._newPos=this._draggable._startPos.add(d)}},_onPreDragWrap:function(){var d=this._worldWidth,j=Math.round(d/2),ot=this._initialWorldOffset,gt=this._draggable._newPos.x,xt=(gt-j+ot)%d+j-ot,Ot=(gt+j+ot)%d-j-ot,Jt=Math.abs(xt+ot)<Math.abs(Ot+ot)?xt:Ot;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Jt},_onDragEnd:function(d){var j=this._map,ot=j.options,gt=!ot.inertia||d.noInertia||this._times.length<2;if(j.fire("dragend",d),gt)j.fire("moveend");else{this._prunePositions(+new Date);var xt=this._lastPos.subtract(this._positions[0]),Ot=(this._lastTime-this._times[0])/1e3,Jt=ot.easeLinearity,hn=xt.multiplyBy(Jt/Ot),bn=hn.distanceTo([0,0]),Ln=Math.min(ot.inertiaMaxSpeed,bn),Qn=hn.multiplyBy(Ln/bn),dr=Ln/(ot.inertiaDeceleration*Jt),gr=Qn.multiplyBy(-dr/2).round();!gr.x&&!gr.y?j.fire("moveend"):(gr=j._limitOffset(gr,j.options.maxBounds),zt(function(){j.panBy(gr,{duration:dr,easeLinearity:Jt,noMoveStart:!0,animate:!0})}))}}});yr.addInitHook("addHandler","dragging",Lo),yr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Do=jr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(d){this._map=d,this._setPanDelta(d.options.keyboardPanDelta),this._setZoomDelta(d.options.zoomDelta)},addHooks:function(){var d=this._map._container;d.tabIndex<=0&&(d.tabIndex="0"),mr(d,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Mr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var d=document.body,j=document.documentElement,ot=d.scrollTop||j.scrollTop,gt=d.scrollLeft||j.scrollLeft;this._map._container.focus(),window.scrollTo(gt,ot)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(d){var j=this._panKeys={},ot=this.keyCodes,gt,xt;for(gt=0,xt=ot.left.length;gt<xt;gt++)j[ot.left[gt]]=[-1*d,0];for(gt=0,xt=ot.right.length;gt<xt;gt++)j[ot.right[gt]]=[d,0];for(gt=0,xt=ot.down.length;gt<xt;gt++)j[ot.down[gt]]=[0,d];for(gt=0,xt=ot.up.length;gt<xt;gt++)j[ot.up[gt]]=[0,-1*d]},_setZoomDelta:function(d){var j=this._zoomKeys={},ot=this.keyCodes,gt,xt;for(gt=0,xt=ot.zoomIn.length;gt<xt;gt++)j[ot.zoomIn[gt]]=d;for(gt=0,xt=ot.zoomOut.length;gt<xt;gt++)j[ot.zoomOut[gt]]=-d},_addHooks:function(){mr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Mr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(d){if(!(d.altKey||d.ctrlKey||d.metaKey)){var j=d.keyCode,ot=this._map,gt;if(j in this._panKeys){if(!ot._panAnim||!ot._panAnim._inProgress)if(gt=this._panKeys[j],d.shiftKey&&(gt=nn(gt).multiplyBy(3)),ot.options.maxBounds&&(gt=ot._limitOffset(nn(gt),ot.options.maxBounds)),ot.options.worldCopyJump){var xt=ot.wrapLatLng(ot.unproject(ot.project(ot.getCenter()).add(gt)));ot.panTo(xt)}else ot.panBy(gt)}else if(j in this._zoomKeys)ot.setZoom(ot.getZoom()+(d.shiftKey?3:1)*this._zoomKeys[j]);else if(j===27&&ot._popup&&ot._popup.options.closeOnEscapeKey)ot.closePopup();else return;_a(d)}}});yr.addInitHook("addHandler","keyboard",Do),yr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Io=jr.extend({addHooks:function(){mr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Mr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(d){var j=io(d),ot=this._map.options.wheelDebounceTime;this._delta+=j,this._lastMousePos=this._map.mouseEventToContainerPoint(d),this._startTime||(this._startTime=+new Date);var gt=Math.max(ot-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(g(this._performZoom,this),gt),_a(d)},_performZoom:function(){var d=this._map,j=d.getZoom(),ot=this._map.options.zoomSnap||0;d._stop();var gt=this._delta/(this._map.options.wheelPxPerZoomLevel*4),xt=4*Math.log(2/(1+Math.exp(-Math.abs(gt))))/Math.LN2,Ot=ot?Math.ceil(xt/ot)*ot:xt,Jt=d._limitZoom(j+(this._delta>0?Ot:-Ot))-j;this._delta=0,this._startTime=null,Jt&&(d.options.scrollWheelZoom==="center"?d.setZoom(j+Jt):d.setZoomAround(this._lastMousePos,j+Jt))}});yr.addInitHook("addHandler","scrollWheelZoom",Io);var Vl=600;yr.mergeOptions({tapHold:Ct.touchNative&&Ct.safari&&Ct.mobile,tapTolerance:15});var Bo=jr.extend({addHooks:function(){mr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Mr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(d){if(clearTimeout(this._holdTimeout),d.touches.length===1){var j=d.touches[0];this._startPos=this._newPos=new Xt(j.clientX,j.clientY),this._holdTimeout=setTimeout(g(function(){this._cancel(),this._isTapValid()&&(mr(document,"touchend",Dr),mr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",j))},this),Vl),mr(document,"touchend touchcancel contextmenu",this._cancel,this),mr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function d(){Mr(document,"touchend",Dr),Mr(document,"touchend touchcancel",d)},_cancel:function(){clearTimeout(this._holdTimeout),Mr(document,"touchend touchcancel contextmenu",this._cancel,this),Mr(document,"touchmove",this._onMove,this)},_onMove:function(d){var j=d.touches[0];this._newPos=new Xt(j.clientX,j.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(d,j){var ot=new MouseEvent(d,{bubbles:!0,cancelable:!0,view:window,screenX:j.screenX,screenY:j.screenY,clientX:j.clientX,clientY:j.clientY});ot._simulated=!0,j.target.dispatchEvent(ot)}});yr.addInitHook("addHandler","tapHold",Bo),yr.mergeOptions({touchZoom:Ct.touch,bounceAtZoomLimits:!0});var No=jr.extend({addHooks:function(){ur(this._map._container,"leaflet-touch-zoom"),mr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){wr(this._map._container,"leaflet-touch-zoom"),Mr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(d){var j=this._map;if(!(!d.touches||d.touches.length!==2||j._animatingZoom||this._zooming)){var ot=j.mouseEventToContainerPoint(d.touches[0]),gt=j.mouseEventToContainerPoint(d.touches[1]);this._centerPoint=j.getSize()._divideBy(2),this._startLatLng=j.containerPointToLatLng(this._centerPoint),j.options.touchZoom!=="center"&&(this._pinchStartLatLng=j.containerPointToLatLng(ot.add(gt)._divideBy(2))),this._startDist=ot.distanceTo(gt),this._startZoom=j.getZoom(),this._moved=!1,this._zooming=!0,j._stop(),mr(document,"touchmove",this._onTouchMove,this),mr(document,"touchend touchcancel",this._onTouchEnd,this),Dr(d)}},_onTouchMove:function(d){if(!(!d.touches||d.touches.length!==2||!this._zooming)){var j=this._map,ot=j.mouseEventToContainerPoint(d.touches[0]),gt=j.mouseEventToContainerPoint(d.touches[1]),xt=ot.distanceTo(gt)/this._startDist;if(this._zoom=j.getScaleZoom(xt,this._startZoom),!j.options.bounceAtZoomLimits&&(this._zoom<j.getMinZoom()&&xt<1||this._zoom>j.getMaxZoom()&&xt>1)&&(this._zoom=j._limitZoom(this._zoom)),j.options.touchZoom==="center"){if(this._center=this._startLatLng,xt===1)return}else{var Ot=ot._add(gt)._divideBy(2)._subtract(this._centerPoint);if(xt===1&&Ot.x===0&&Ot.y===0)return;this._center=j.unproject(j.project(this._pinchStartLatLng,this._zoom).subtract(Ot),this._zoom)}this._moved||(j._moveStart(!0,!1),this._moved=!0),Vt(this._animRequest);var Jt=g(j._move,j,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=zt(Jt,this,!0),Dr(d)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Vt(this._animRequest),Mr(document,"touchmove",this._onTouchMove,this),Mr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});yr.addInitHook("addHandler","touchZoom",No),yr.BoxZoom=Co,yr.DoubleClickZoom=$o,yr.Drag=Lo,yr.Keyboard=Do,yr.ScrollWheelZoom=Io,yr.TapHold=Bo,yr.TouchZoom=No,a.Bounds=gn,a.Browser=Ct,a.CRS=Tn,a.Canvas=Ao,a.Circle=Ys,a.CircleMarker=ys,a.Class=Kt,a.Control=Ur,a.DivIcon=So,a.DivOverlay=Gr,a.DomEvent=jo,a.DomUtil=Ho,a.Draggable=Qr,a.Evented=on,a.FeatureGroup=Vr,a.GeoJSON=Kr,a.GridLayer=cs,a.Handler=jr,a.Icon=ts,a.ImageOverlay=Ss,a.LatLng=qt,a.LatLngBounds=$n,a.Layer=Hr,a.LayerGroup=$a,a.LineUtil=xl,a.Map=yr,a.Marker=ws,a.Mixin=Wo,a.Path=Jr,a.Point=Xt,a.PolyUtil=Qo,a.Polygon=es,a.Polyline=Xr,a.Popup=Es,a.PosAnimation=ao,a.Projection=Sl,a.Rectangle=Po,a.Renderer=Wr,a.SVG=ds,a.SVGOverlay=ko,a.TileLayer=rs,a.Tooltip=Ms,a.Transformation=Zn,a.Util=Gt,a.VideoOverlay=xo,a.bind=g,a.bounds=dn,a.canvas=To,a.circle=$l,a.circleMarker=Cl,a.control=ls,a.divIcon=Ul,a.extend=o,a.featureGroup=Tl,a.geoJSON=bo,a.geoJson=Il,a.gridLayer=Hl,a.icon=Rl,a.imageOverlay=Bl,a.latLng=en,a.latLngBounds=En,a.layerGroup=Al,a.map=Go,a.marker=Pl,a.point=nn,a.polygon=Dl,a.polyline=Ll,a.popup=Ol,a.rectangle=Yl,a.setOptions=ft,a.stamp=$,a.svg=Ro,a.svgOverlay=zl,a.tileLayer=Eo,a.tooltip=Fl,a.transformation=Gn,a.version=s,a.videoOverlay=Nl;var Xl=window.L;a.noConflict=function(){return window.L=Xl,this},window.L=a})})(leafletSrc,leafletSrc.exports);var leafletSrcExports=leafletSrc.exports;const L$1=getDefaultExportFromCjs$1(leafletSrcExports);var version="2.0.3",slice=[].slice,noabort={};function Queue(e){if(!(e>=1))throw new Error;this._size=e,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}Queue.prototype=queue$1.prototype={constructor:Queue,defer:function(e){if(typeof e!="function"||this._call)throw new Error;if(this._error!=null)return this;var i=slice.call(arguments,1);return i.push(e),++this._waiting,this._tasks.push(i),poke(this),this},abort:function(){return this._error==null&&abort(this,new Error("abort")),this},await:function(e){if(typeof e!="function"||this._call)throw new Error;return this._call=function(i,a){e.apply(null,[i].concat(a))},maybeNotify(this),this},awaitAll:function(e){if(typeof e!="function"||this._call)throw new Error;return this._call=e,maybeNotify(this),this}};function poke(e){if(!e._start)try{start(e)}catch(i){e._tasks[e._ended+e._active-1]&&abort(e,i)}}function start(e){for(;e._start=e._waiting&&e._active<e._size;){var i=e._ended+e._active,a=e._tasks[i],s=a.length-1,o=a[s];a[s]=end(e,i),--e._waiting,++e._active,a=o.apply(null,a),e._tasks[i]&&(e._tasks[i]=a||noabort)}}function end(e,i){return function(a,s){e._tasks[i]&&(--e._active,++e._ended,e._tasks[i]=null,e._error==null&&(a!=null?abort(e,a):(e._data[i]=s,e._waiting?poke(e):maybeNotify(e))))}}function abort(e,i){var a=e._tasks.length,s;for(e._error=i,e._data=void 0,e._waiting=NaN;--a>=0;)if((s=e._tasks[a])&&(e._tasks[a]=null,s.abort))try{s.abort()}catch{}e._active=NaN,maybeNotify(e)}function maybeNotify(e){!e._active&&e._call&&e._call(e._error,e._data)}function queue$1(e){return new Queue(arguments.length?+e:1/0)}const d3Queue=Object.freeze(Object.defineProperty({__proto__:null,queue:queue$1,version},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace$1(d3Queue);var queue=require$$0.queue,cacheBusterDate=+new Date,leafletImage=function e(i,a){var s=!!L.mapbox,o=i.getSize(),h=new queue(1),g=document.createElement("canvas");g.width=o.x,g.height=o.y;var _=g.getContext("2d"),$=document.createElement("canvas");$.width=1,$.height=1;var b=$.getContext("2d");if(b.fillStyle="rgba(0,0,0,0)",b.fillRect(0,0,1,1),i.eachLayer(st),i.eachLayer(nt),i._pathRoot)h.defer(dt,i._pathRoot);else if(i._panes){var tt=i._panes.overlayPane.getElementsByTagName("canvas").item(0);tt&&h.defer(dt,tt)}i.eachLayer(at),h.awaitAll(ft);function st(bt){bt instanceof L.TileLayer?h.defer(pt,bt):bt._heat&&h.defer(dt,bt._canvas)}function at(bt){bt instanceof L.Marker&&bt.options.icon instanceof L.Icon&&h.defer(_t,bt)}function nt(bt){L.esri&&bt instanceof L.esri.DynamicMapLayer&&h.defer(ut,bt)}function lt(){a(null,g)}function ft(bt,vt){if(bt)throw bt;vt.forEach(function(Et){Et&&Et.canvas&&_.drawImage(Et.canvas,0,0)}),lt()}function pt(bt,vt){var Et=L.TileLayer.Canvas&&bt instanceof L.TileLayer.Canvas,Mt=document.createElement("canvas");Mt.width=o.x,Mt.height=o.y;var At=Mt.getContext("2d"),zt=i.getPixelBounds(),Vt=i.getZoom(),Gt=bt.options.tileSize;if(Vt>bt.options.maxZoom||Vt<bt.options.minZoom||s&&bt instanceof L.mapbox.tileLayer&&!bt.options.tiles)return vt();var Kt=L.bounds(zt.min.divideBy(Gt)._floor(),zt.max.divideBy(Gt)._floor()),Wt=[],sn,on,Xt=new queue(1);for(sn=Kt.min.y;sn<=Kt.max.y;sn++)for(on=Kt.min.x;on<=Kt.max.x;on++)Wt.push(new L.Point(on,sn));Wt.forEach(function($n){var En=$n.clone();bt._adjustTilePoint&&bt._adjustTilePoint($n);var qt=En.scaleBy(new L.Point(Gt,Gt)).subtract(zt.min);if($n.y>=0)if(Et){var en=bt._tiles[$n.x+":"+$n.y];Xt.defer(ln,en,qt,Gt)}else{var Tn=mt(bt.getTileUrl($n));Xt.defer(nn,Tn,qt,Gt)}}),Xt.awaitAll(gn);function ln($n,En,qt,en){en(null,{img:$n,pos:En,size:qt})}function nn($n,En,qt,en){var Tn=new Image;Tn.crossOrigin="",Tn.onload=function(){en(null,{img:this,pos:En,size:qt})},Tn.onerror=function(Sn){bt.options.errorTileUrl!=""&&Sn.target.errorCheck===void 0?(Sn.target.errorCheck=!0,Sn.target.src=bt.options.errorTileUrl):en(null,{img:$,pos:En,size:qt})},Tn.src=$n}function gn($n,En){En.forEach(dn),vt(null,{canvas:Mt})}function dn($n){At.drawImage($n.img,Math.floor($n.pos.x),Math.floor($n.pos.y),$n.size,$n.size)}}function dt(bt,vt){var Et=i.getPixelBounds(),Mt=i.getPixelOrigin(),At=document.createElement("canvas");At.width=o.x,At.height=o.y;var zt=At.getContext("2d"),Vt=L.DomUtil.getPosition(bt).subtract(Et.min).add(Mt);try{zt.drawImage(bt,Vt.x,Vt.y,At.width-Vt.x*2,At.height-Vt.y*2),vt(null,{canvas:At})}catch{console.error("Element could not be drawn on canvas",bt)}}function _t(bt,vt){var Et=document.createElement("canvas"),Mt=Et.getContext("2d"),At=i.getPixelBounds(),zt=new L.Point(At.min.x,At.min.y),Vt=i.project(bt.getLatLng()),Gt=/^data\:/.test(bt._icon.src),Kt=Gt?bt._icon.src:mt(bt._icon.src),Wt=new Image,sn=bt.options.icon.options,on=sn.iconSize,Xt=Vt.subtract(zt),ln=L.point(sn.iconAnchor||on&&on.divideBy(2,!0));on instanceof L.Point&&(on=[on.x,on.y]);var nn=Math.round(Xt.x-on[0]+ln.x),gn=Math.round(Xt.y-ln.y);Et.width=o.x,Et.height=o.y,Wt.crossOrigin="",Wt.onload=function(){Mt.drawImage(this,nn,gn,on[0],on[1]),vt(null,{canvas:Et})},Wt.src=Kt,Gt&&Wt.onload()}function ut(bt,vt){var Et=document.createElement("canvas");Et.width=o.x,Et.height=o.y;var Mt=Et.getContext("2d"),At=new Image;At.crossOrigin="",At.src=mt(bt._currentImage._image.src),At.onload=function(){Mt.drawImage(At,0,0),vt(null,{canvas:Et})}}function mt(bt){return kt(bt)||bt.indexOf("mapbox.com/styles/v1")!==-1?bt:bt+(bt.match(/\?/)?"&":"?")+"cache="+cacheBusterDate}function kt(bt){var vt=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i;return!!bt.match(vt)}};const leafletImage$1=getDefaultExportFromCjs$1(leafletImage),GEMINI_API_KEY="AIzaSyCUspjopyRDqf8iR-ftL7UsPyaYfAt1p_M",OSRM_URL="https://router.project-osrm.org",blobUrl=(e,i="image/jpeg")=>URL.createObjectURL(new Blob([e],{type:i}));async function fetchGemini(e,i){const a="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key="+GEMINI_API_KEY,s=[];if(i){const g=i.replace(/^data:image\/\w+;base64,/,"");s.push({inline_data:{mime_type:"image/jpeg",data:g}})}s.push({text:e});const o=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:s}]})});if(!o.ok)throw new Error(`Gemini error ${o.status}: ${await o.text()}`);return(await o.json()).candidates[0].content.parts[0].text}function App(){const[e,i]=reactExports.useState(null),[a,s]=reactExports.useState(""),[o,h]=reactExports.useState(""),[g,_]=reactExports.useState(null),[$,b]=reactExports.useState(null),[tt,st]=reactExports.useState(!1),[at,nt]=reactExports.useState("Pronto!"),[lt,ft]=reactExports.useState([]),[pt,dt]=reactExports.useState(0),[_t,ut]=reactExports.useState(null),[mt,kt]=reactExports.useState({lat:"",lng:""}),[bt,vt]=reactExports.useState(null),Et=reactExports.useRef(null),Mt=reactExports.useRef(null),At=reactExports.useRef(null),zt=reactExports.useRef(null),Vt=qt=>ft(en=>[...en.slice(-19),`${new Date().toLocaleTimeString()}: ${qt}`]);reactExports.useEffect(()=>{const qt=en=>{en.absolute&&en.alpha!=null&&dt(en.alpha)};return window.addEventListener("deviceorientation",qt),()=>window.removeEventListener("deviceorientation",qt)},[]),reactExports.useEffect(()=>{const qt=navigator.geolocation.watchPosition(en=>ut({lat:en.coords.latitude,lng:en.coords.longitude}),()=>{},{enableHighAccuracy:!0});return()=>navigator.geolocation.clearWatch(qt)},[]),reactExports.useEffect(()=>{Mt.current&&!At.current&&(At.current=L$1.map(Mt.current,{center:[40.8362,16.5936],zoom:15,zoomControl:!1,attributionControl:!1}),L$1.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{subdomains:"abcd",crossOrigin:!0,attribution:""}).addTo(At.current)),At.current&&_t&&(At.current.setView([_t.lat,_t.lng]),At.current.eachLayer(qt=>{(qt._icon||qt._path)&&At.current.removeLayer(qt)}),L$1.circleMarker([_t.lat,_t.lng],{radius:6,color:"#00ffff",fillColor:"#00ffff",fillOpacity:.8}).addTo(At.current),bt&&fetch(`${OSRM_URL}/route/v1/driving/${_t.lng},${_t.lat};${bt.lng},${bt.lat}?overview=full&geometries=geojson`).then(qt=>qt.json()).then(qt=>{var Tn;const en=qt.routes[0].geometry.coordinates.map(([Sn,fn])=>[fn,Sn]);(Tn=Et.current)==null||Tn.remove(),Et.current=L$1.polyline(en,{color:"red",weight:4}).addTo(At.current)}).catch(qt=>console.warn("OSRM error",qt)))},[_t,bt]);const Gt=async()=>{nt("Connessione in corso…"),Vt("▶ handleConnect");try{const qt=new FrameMsg;await qt.connect(),Vt("✔ connected"),qt.attachPrintResponseHandler(en=>Vt("[Frame] "+en)),await qt.uploadStdLuaLibs([StdLua.DataMin,StdLua.PlainTextMin,StdLua.CameraMin,StdLua.SpriteMin]),Vt("✔ libs loaded"),await qt.uploadFrameApp(markinoFrameApp),Vt("✔ Lua script uploaded"),await qt.startFrameApp(),i(qt),nt("Occhiali pronti!")}catch(qt){Vt("✖ connect: "+qt.message),nt("Errore connect: "+qt.message)}},Kt=async()=>{if(!e||!Mt.current)return nt("Init mappa o frame");nt("Snap mappa…"),Vt("▶ sendMapToFrame"),leafletImage$1(At.current,(qt,en)=>{if(qt){Vt("✖ leaflet-image error: "+qt),nt("Errore snapshot");return}en.toBlob(async Tn=>{if(!Tn){Vt("✖ toBlob fallito"),nt("Errore blob");return}const Sn=await Tn.arrayBuffer(),fn=await TxSprite.fromImageBytes(Sn,35e3);await e.sendMessage(32,fn.pack()),Vt("✔ mappa inviata"),nt("Mappa mostrata!")},"image/jpeg",.9)})},Wt=()=>{zt.current||(zt.current=setInterval(Kt,5e3),Vt("▶ Auto‐update ON"))},sn=()=>{zt.current&&(clearInterval(zt.current),zt.current=null,Vt("■ Auto‐update OFF"))},on=()=>{const qt=parseFloat(mt.lat),en=parseFloat(mt.lng);!isNaN(qt)&&!isNaN(en)&&(vt({lat:qt,lng:en}),Vt(`▶ destinazione settata: ${qt.toFixed(5)},${en.toFixed(5)}`)),kt({lat:"",lng:""})},Xt=async()=>{if(!e)return nt("Connetti prima gli occhiali!");nt("Cattura foto…"),Vt("▶ handleCapture");try{const qt=new RxPhoto({}),en=await qt.attach(e);await e.sendMessage(13,new TxCaptureSettings(720).pack());const Tn=await en.get();qt.detach(e);const Sn=blobUrl(Tn);_(Sn),b(null),st(!1),nt("Foto catturata (nascosta)")}catch(qt){Vt("✖ capture: "+qt.message),nt("Errore capture: "+qt.message)}},ln=async()=>{var qt;if(!e)return nt("Connetti prima gli occhiali!");nt("Generazione immagine…"),Vt("▶ handleGenerateImage");try{const en=`https://image.pollinations.ai/prompt/${encodeURIComponent(a||"abstract art")}`,Sn=await(await fetch(en)).arrayBuffer(),fn=blobUrl(Sn);_(fn),st(!0);const Wn=await TxSprite.fromImageBytes(Sn,45e3),Zn=(qt=Wn.toPngBytes)==null?void 0:qt.call(Wn);Zn&&b(blobUrl(Zn,"image/png")),await e.sendMessage(32,Wn.pack()),Vt("✔ sprite inviato agli occhiali"),nt("Immagine Pollinations mostrata!")}catch(en){Vt("✖ generateImage: "+en.message),nt("Errore generazione immagine: "+en.message)}},nn=async()=>{nt("Preparazione richiesta a Gemini…"),Vt("▶ handleSend");try{let qt;if(g){const Sn=await(await fetch(g)).blob();qt=await new Promise(fn=>{const Wn=new FileReader;Wn.onloadend=()=>fn(Wn.result),Wn.readAsDataURL(Sn)})}const en=await fetchGemini(a,qt);h(en),Vt("✔ Gemini reply"),e&&(await e.sendMessage(10,new TxPlainText(en).pack()),nt("Risposta mostrata sugli occhiali!"))}catch(qt){Vt("✖ handleSend: "+qt.message),nt("Errore Gemini: "+qt.message)}},gn=async()=>{e&&(await e.sendMessage(10,new TxPlainText("").pack()),nt("Schermo pulito"))},dn=async()=>{if(e)try{await e.stopFrameApp(),await e.disconnect(),i(null),nt("Disconnesso")}catch(qt){nt("Errore disconnect: "+qt.message)}},$n=async()=>{if(!e)return nt("Connetti prima");Vt("▶ showDashboard"),await e.sendMessage(10,new TxPlainText("").pack());const en=new Date().toLocaleTimeString(),Tn=await e.sendLua('print(frame.battery_level() .. " / " .. collectgarbage("count"))',{showMe:!0});let Sn="meteo sconosciuto";if(_t)try{const Gn=(await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${_t.lat}&longitude=${_t.lng}&current_weather=true`)).json()).current_weather;Sn=`${Gn.temperature}°C, vento ${Gn.windspeed} km/h`}catch{}const fn=`Ora: ${en}
Batt/Mem: ${Tn}
Meteo: ${Sn}`;await e.sendMessage(10,new TxPlainText(fn).pack()),nt("Dashboard inviata")},En=(qt,en=!1)=>({...qt,...en?styles.btnDisabled:{}});return jsxRuntimeExports.jsxs("div",{style:styles.container,children:[jsxRuntimeExports.jsx("h1",{style:styles.header,children:"Markino Solutions → Frame"}),jsxRuntimeExports.jsxs("div",{style:styles.controls,children:[jsxRuntimeExports.jsx("button",{onClick:Gt,style:En(styles.btnSecondary,!!e),children:"🔌Connetti & Carica"}),jsxRuntimeExports.jsx("button",{onClick:$n,disabled:!e,style:En(styles.btnSecondary,!e),children:"📊 Dashboard"}),jsxRuntimeExports.jsx("button",{onClick:Xt,disabled:!e,style:En(styles.btnPrimary,!e),children:"📸 Cattura Foto"}),jsxRuntimeExports.jsx("button",{onClick:()=>st(qt=>!qt),disabled:!g,style:En(styles.btnSecondary,!g),children:tt?"Nascondi Media":"Mostra Media"}),jsxRuntimeExports.jsx("button",{onClick:gn,disabled:!e,style:En(styles.btnSecondary,!e),children:"🧹 Pulisci Schermo"}),jsxRuntimeExports.jsxs("div",{style:{marginBottom:8},children:[jsxRuntimeExports.jsx("button",{onClick:Kt,disabled:!e,children:"🗺️ Mostra Mappa"}),jsxRuntimeExports.jsx("button",{onClick:Wt,children:"▶ Auto"}),jsxRuntimeExports.jsx("button",{onClick:sn,children:"■ Stop"})]}),jsxRuntimeExports.jsxs("div",{style:{marginBottom:16,textAlign:"center"},children:[jsxRuntimeExports.jsx("input",{style:styles.input,type:"text",placeholder:"lat",value:mt.lat,onChange:qt=>kt({...mt,lat:qt.target.value})}),jsxRuntimeExports.jsx("input",{style:styles.input,type:"text",placeholder:"lng",value:mt.lng,onChange:qt=>kt({...mt,lng:qt.target.value})}),jsxRuntimeExports.jsx("button",{onClick:on,style:En(styles.btnPrimary,!e),disabled:!e,children:"📍 Avvia Navigazione"})]}),jsxRuntimeExports.jsx("button",{onClick:dn,disabled:!e,style:En(styles.btnSecondary,!e),children:"🔌Disconnetti"}),jsxRuntimeExports.jsx("button",{onClick:ln,disabled:!e||!a,style:En(styles.btnPrimary,!e||!a),children:"🎨 Genera Immagine"})]}),tt&&g&&jsxRuntimeExports.jsxs("div",{style:styles.imageWrapper,children:[jsxRuntimeExports.jsx("h4",{children:"Originale Pollinations"}),jsxRuntimeExports.jsx("img",{src:g,alt:"original",style:styles.image})]}),tt&&$&&jsxRuntimeExports.jsxs("div",{style:styles.imageWrapper,children:[jsxRuntimeExports.jsx("h4",{children:"Sprite Quantizzato"}),jsxRuntimeExports.jsx("img",{src:$,alt:"sprite",style:styles.image})]}),jsxRuntimeExports.jsx("textarea",{rows:3,value:a,onChange:qt=>s(qt.target.value),placeholder:"Prompt…",style:styles.textarea}),jsxRuntimeExports.jsx("button",{onClick:nn,disabled:!e&&!a,style:En(styles.sendButton,!e&&!a),children:"Invia a Gemini & Frame"}),jsxRuntimeExports.jsxs("div",{style:styles.status,children:[jsxRuntimeExports.jsx("b",{children:"Stato:"})," ",at]}),jsxRuntimeExports.jsx("pre",{style:styles.logs,children:lt.join(`
`)}),jsxRuntimeExports.jsxs("div",{style:styles.response,children:[jsxRuntimeExports.jsx("b",{children:"Risposta Gemini:"}),jsxRuntimeExports.jsx("pre",{style:styles.responsePre,children:o})]}),jsxRuntimeExports.jsx("div",{ref:Mt,style:{width:"100%",height:300,borderRadius:8,overflow:"hidden",marginBottom:16,boxShadow:"0 2px 6px rgba(0,0,0,.5)"}})]})}const styles={container:{maxWidth:650,margin:"0 auto",padding:16,backgroundColor:"#111827",color:"#f3f4f6",fontFamily:"'Helvetica Neue', Arial, sans-serif"},header:{textAlign:"center",fontSize:24,marginBottom:16,color:"#60a5fa"},controls:{display:"flex",flexWrap:"wrap",gap:8,justifyContent:"center",marginBottom:16},btnPrimary:{padding:"10px 14px",backgroundColor:"#2563eb",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",flex:1,minWidth:120},btnSecondary:{padding:"10px 14px",backgroundColor:"#059669",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",flex:1,minWidth:120},btnDisabled:{opacity:.5,cursor:"not-allowed"},status:{textAlign:"center",marginBottom:8,color:"#9ca3af"},logs:{backgroundColor:"#1f2937",padding:12,borderRadius:6,fontSize:14,color:"#d1d5db",maxHeight:120,overflowY:"auto",marginBottom:16},input:{width:100,marginRight:8,padding:6,borderRadius:4,border:"1px solid #374151",backgroundColor:"#1f2937",color:"#f3f4f6"}};client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
