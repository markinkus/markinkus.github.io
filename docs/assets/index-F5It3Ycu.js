(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerPolicy&&(h.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?h.credentials="include":o.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(o){if(o.ep)return;o.ep=!0;const h=a(o);fetch(o.href,h)}})();function getDefaultExportFromCjs$1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,i,a){this.props=e,this.context=i,this.refs=D$1,this.updater=a||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,i,a){this.props=e,this.context=i,this.refs=D$1,this.updater=a||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,i,a){var s,o={},h=null,d=null;if(i!=null)for(s in i.ref!==void 0&&(d=i.ref),i.key!==void 0&&(h=""+i.key),i)J.call(i,s)&&!L$1.hasOwnProperty(s)&&(o[s]=i[s]);var g=arguments.length-2;if(g===1)o.children=a;else if(1<g){for(var b=Array(g),_=0;_<g;_++)b[_]=arguments[_+2];o.children=b}if(e&&e.defaultProps)for(s in g=e.defaultProps,g)o[s]===void 0&&(o[s]=g[s]);return{$$typeof:l$1,type:e,key:h,ref:d,props:o,_owner:K$1.current}}function N$1(e,i){return{$$typeof:l$1,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return i[a]})}var P$1=/\/+/g;function Q$1(e,i){return typeof e=="object"&&e!==null&&e.key!=null?escape(""+e.key):i.toString(36)}function R$2(e,i,a,s,o){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(h){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:d=!0}}if(d)return d=e,o=o(d),e=s===""?"."+Q$1(d,0):s,I$1(o)?(a="",e!=null&&(a=e.replace(P$1,"$&/")+"/"),R$2(o,i,a,"",function(_){return _})):o!=null&&(O$1(o)&&(o=N$1(o,a+(!o.key||d&&d.key===o.key?"":(""+o.key).replace(P$1,"$&/")+"/")+e)),i.push(o)),1;if(d=0,s=s===""?".":s+":",I$1(e))for(var g=0;g<e.length;g++){h=e[g];var b=s+Q$1(h,g);d+=R$2(h,i,a,b,o)}else if(b=A$1(e),typeof b=="function")for(e=b.call(e),g=0;!(h=e.next()).done;)h=h.value,b=s+Q$1(h,g++),d+=R$2(h,i,a,b,o);else if(h==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return d}function S$1(e,i,a){if(e==null)return e;var s=[],o=0;return R$2(e,s,"","",function(h){return i.call(a,h,o++)}),s}function T$1(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,i,a){S$1(e,function(){i.apply(this,arguments)},a)},count:function(e){var i=0;return S$1(e,function(){i++}),i},toArray:function(e){return S$1(e,function(i){return i})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$3;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(e,i,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=C$1({},e.props),o=e.key,h=e.ref,d=e._owner;if(i!=null){if(i.ref!==void 0&&(h=i.ref,d=K$1.current),i.key!==void 0&&(o=""+i.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for(b in i)J.call(i,b)&&!L$1.hasOwnProperty(b)&&(s[b]=i[b]===void 0&&g!==void 0?g[b]:i[b])}var b=arguments.length-2;if(b===1)s.children=a;else if(1<b){g=Array(b);for(var _=0;_<b;_++)g[_]=arguments[_+2];s.children=g}return{$$typeof:l$1,type:e.type,key:o,ref:h,props:s,_owner:d}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var i=M$1.bind(null,e);return i.type=e,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y$1,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,i){return{$$typeof:x$1,type:e,compare:i===void 0?null:i}};react_production_min.startTransition=function(e){var i=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=i}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(e,i){return U$1.current.useCallback(e,i)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,i){return U$1.current.useEffect(e,i)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,i,a){return U$1.current.useImperativeHandle(e,i,a)};react_production_min.useInsertionEffect=function(e,i){return U$1.current.useInsertionEffect(e,i)};react_production_min.useLayoutEffect=function(e,i){return U$1.current.useLayoutEffect(e,i)};react_production_min.useMemo=function(e,i){return U$1.current.useMemo(e,i)};react_production_min.useReducer=function(e,i,a){return U$1.current.useReducer(e,i,a)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,i,a){return U$1.current.useSyncExternalStore(e,i,a)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs$1(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q(e,i,a){var s,o={},h=null,d=null;a!==void 0&&(h=""+a),i.key!==void 0&&(h=""+i.key),i.ref!==void 0&&(d=i.ref);for(s in i)m$2.call(i,s)&&!p$2.hasOwnProperty(s)&&(o[s]=i[s]);if(e&&e.defaultProps)for(s in i=e.defaultProps,i)o[s]===void 0&&(o[s]=i[s]);return{$$typeof:k,type:e,key:h,ref:d,props:o,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(Gt,Jt){var or=Gt.length;Gt.push(Jt);t:for(;0<or;){var mr=or-1>>>1,hr=Gt[mr];if(0<o(hr,Jt))Gt[mr]=Jt,Gt[or]=hr,or=mr;else break t}}function a(Gt){return Gt.length===0?null:Gt[0]}function s(Gt){if(Gt.length===0)return null;var Jt=Gt[0],or=Gt.pop();if(or!==Jt){Gt[0]=or;t:for(var mr=0,hr=Gt.length,Lr=hr>>>1;mr<Lr;){var Er=2*(mr+1)-1,Kt=Gt[Er],fr=Er+1,Rr=Gt[fr];if(0>o(Kt,or))fr<hr&&0>o(Rr,Kt)?(Gt[mr]=Rr,Gt[fr]=or,mr=fr):(Gt[mr]=Kt,Gt[Er]=or,mr=Er);else if(fr<hr&&0>o(Rr,or))Gt[mr]=Rr,Gt[fr]=or,mr=fr;else break t}}return Jt}function o(Gt,Jt){var or=Gt.sortIndex-Jt.sortIndex;return or!==0?or:Gt.id-Jt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var d=Date,g=d.now();e.unstable_now=function(){return d.now()-g}}var b=[],_=[],$=1,it=null,nt=3,tt=!1,at=!1,ut=!1,ft=typeof setTimeout=="function"?setTimeout:null,ht=typeof clearTimeout=="function"?clearTimeout:null,dt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function st(Gt){for(var Jt=a(_);Jt!==null;){if(Jt.callback===null)s(_);else if(Jt.startTime<=Gt)s(_),Jt.sortIndex=Jt.expirationTime,i(b,Jt);else break;Jt=a(_)}}function ct(Gt){if(ut=!1,st(Gt),!at)if(a(b)!==null)at=!0,Qt(wt);else{var Jt=a(_);Jt!==null&&_e(ct,Jt.startTime-Gt)}}function wt(Gt,Jt){at=!1,ut&&(ut=!1,ht(yt),yt=-1),tt=!0;var or=nt;try{for(st(Jt),it=a(b);it!==null&&(!(it.expirationTime>Jt)||Gt&&!Ct());){var mr=it.callback;if(typeof mr=="function"){it.callback=null,nt=it.priorityLevel;var hr=mr(it.expirationTime<=Jt);Jt=e.unstable_now(),typeof hr=="function"?it.callback=hr:it===a(b)&&s(b),st(Jt)}else s(b);it=a(b)}if(it!==null)var Lr=!0;else{var Er=a(_);Er!==null&&_e(ct,Er.startTime-Jt),Lr=!1}return Lr}finally{it=null,nt=or,tt=!1}}var _t=!1,gt=null,yt=-1,bt=5,vt=-1;function Ct(){return!(e.unstable_now()-vt<bt)}function Ht(){if(gt!==null){var Gt=e.unstable_now();vt=Gt;var Jt=!0;try{Jt=gt(!0,Gt)}finally{Jt?Ft():(_t=!1,gt=null)}}else _t=!1}var Ft;if(typeof dt=="function")Ft=function(){dt(Ht)};else if(typeof MessageChannel<"u"){var qt=new MessageChannel,zt=qt.port2;qt.port1.onmessage=Ht,Ft=function(){zt.postMessage(null)}}else Ft=function(){ft(Ht,0)};function Qt(Gt){gt=Gt,_t||(_t=!0,Ft())}function _e(Gt,Jt){yt=ft(function(){Gt(e.unstable_now())},Jt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Gt){Gt.callback=null},e.unstable_continueExecution=function(){at||tt||(at=!0,Qt(wt))},e.unstable_forceFrameRate=function(Gt){0>Gt||125<Gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):bt=0<Gt?Math.floor(1e3/Gt):5},e.unstable_getCurrentPriorityLevel=function(){return nt},e.unstable_getFirstCallbackNode=function(){return a(b)},e.unstable_next=function(Gt){switch(nt){case 1:case 2:case 3:var Jt=3;break;default:Jt=nt}var or=nt;nt=Jt;try{return Gt()}finally{nt=or}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Gt,Jt){switch(Gt){case 1:case 2:case 3:case 4:case 5:break;default:Gt=3}var or=nt;nt=Gt;try{return Jt()}finally{nt=or}},e.unstable_scheduleCallback=function(Gt,Jt,or){var mr=e.unstable_now();switch(typeof or=="object"&&or!==null?(or=or.delay,or=typeof or=="number"&&0<or?mr+or:mr):or=mr,Gt){case 1:var hr=-1;break;case 2:hr=250;break;case 5:hr=1073741823;break;case 4:hr=1e4;break;default:hr=5e3}return hr=or+hr,Gt={id:$++,callback:Jt,priorityLevel:Gt,startTime:or,expirationTime:hr,sortIndex:-1},or>mr?(Gt.sortIndex=or,i(_,Gt),a(b)===null&&Gt===a(_)&&(ut?(ht(yt),yt=-1):ut=!0,_e(ct,or-mr))):(Gt.sortIndex=hr,i(b,Gt),at||tt||(at=!0,Qt(wt))),Gt},e.unstable_shouldYield=Ct,e.unstable_wrapCallback=function(Gt){var Jt=nt;return function(){var or=nt;nt=Jt;try{return Gt.apply(this,arguments)}finally{nt=or}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,i){ha(e,i),ha(e+"Capture",i)}function ha(e,i){for(ea[e]=i,e=0;e<i.length;e++)da.add(i[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,i,a,s){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return s?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,i,a,s){if(i===null||typeof i>"u"||pa(e,i,a,s))return!0;if(s)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v(e,i,a,s,o,h,d){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=a,this.propertyName=e,this.type=i,this.sanitizeURL=h,this.removeEmptyString=d}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];z[i]=new v(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,i,a,s){var o=z.hasOwnProperty(i)?z[i]:null;(o!==null?o.type!==0:s||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,a,o,s)&&(a=null),s||o===null?oa(i)&&(a===null?e.removeAttribute(i):e.setAttribute(i,""+a)):o.mustUseProperty?e[o.propertyName]=a===null?o.type===3?!1:"":a:(i=o.attributeName,s=o.attributeNamespace,a===null?e.removeAttribute(i):(o=o.type,a=o===3||o===4&&a===!0?"":""+a,s?e.setAttributeNS(s,i,a):e.setAttribute(i,a))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+e}var Na=!1;function Oa(e,i){if(!e||Na)return"";Na=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(_){var s=_}Reflect.construct(e,[],i)}else{try{i.call()}catch(_){s=_}e.call(i.prototype)}else{try{throw Error()}catch(_){s=_}e()}}catch(_){if(_&&s&&typeof _.stack=="string"){for(var o=_.stack.split(`
`),h=s.stack.split(`
`),d=o.length-1,g=h.length-1;1<=d&&0<=g&&o[d]!==h[g];)g--;for(;1<=d&&0<=g;d--,g--)if(o[d]!==h[g]){if(d!==1||g!==1)do if(d--,g--,0>g||o[d]!==h[g]){var b=`
`+o[d].replace(" at new "," at ");return e.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",e.displayName)),b}while(1<=d&&0<=g);break}}}finally{Na=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return i=e.displayName||null,i!==null?i:Qa(e.type)||"Memo";case Ha:i=e._payload,e=e._init;try{return Qa(e(i))}catch{}}return null}function Ra(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(e){var i=Ta(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),s=""+e[i];if(!e.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var o=a.get,h=a.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return o.call(this)},set:function(d){s=""+d,h.call(this,d)}}),Object.defineProperty(e,i,{enumerable:a.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var a=i.getValue(),s="";return e&&(s=Ta(e)?e.checked?"true":"false":e.value),e=s,e!==a?(i.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,i){var a=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function Za(e,i){var a=i.defaultValue==null?"":i.defaultValue,s=i.checked!=null?i.checked:i.defaultChecked;a=Sa(i.value!=null?i.value:a),e._wrapperState={initialChecked:s,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(e,i){i=i.checked,i!=null&&ta(e,"checked",i,!1)}function bb(e,i){ab(e,i);var a=Sa(i.value),s=i.type;if(a!=null)s==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?cb(e,i.type,a):i.hasOwnProperty("defaultValue")&&cb(e,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function db(e,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var s=i.type;if(!(s!=="submit"&&s!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,a||i===e.value||(e.value=i),e.defaultValue=i}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function cb(e,i,a){(i!=="number"||Xa(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var eb=Array.isArray;function fb(e,i,a,s){if(e=e.options,i){i={};for(var o=0;o<a.length;o++)i["$"+a[o]]=!0;for(a=0;a<e.length;a++)o=i.hasOwnProperty("$"+e[a].value),e[a].selected!==o&&(e[a].selected=o),o&&s&&(e[a].defaultSelected=!0)}else{for(a=""+Sa(a),i=null,o=0;o<e.length;o++){if(e[o].value===a){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}i!==null||e[o].disabled||(i=e[o])}i!==null&&(i.selected=!0)}}function gb(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(p$1(92));if(eb(a)){if(1<a.length)throw Error(p$1(93));a=a[0]}i=a}i==null&&(i=""),a=i}e._wrapperState={initialValue:Sa(a)}}function ib(e,i){var a=Sa(i.value),s=Sa(i.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),i.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),s!=null&&(e.defaultValue=""+s)}function jb(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,s,o){MSApp.execUnsafeLocalFunction(function(){return e(i,a,s,o)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function ob(e,i){if(i){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=i;return}}e.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),pb[i]=pb[e]})});function rb(e,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||pb.hasOwnProperty(e)&&pb[e]?(""+i).trim():i+"px"}function sb(e,i){e=e.style;for(var a in i)if(i.hasOwnProperty(a)){var s=a.indexOf("--")===0,o=rb(a,i[a],s);a==="float"&&(a="cssFloat"),s?e.setProperty(a,o):e[a]=o}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,i){if(i){if(tb[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p$1(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p$1(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p$1(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p$1(62))}}function vb(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p$1(280));var i=e.stateNode;i&&(i=Db(i),yb(e.stateNode,e.type,i))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,i=Ab;if(Ab=zb=null,Bb(e),i)for(e=0;e<i.length;e++)Bb(i[e])}}function Gb(e,i){return e(i)}function Hb(){}var Ib=!1;function Jb(e,i,a){if(Ib)return e(i,a);Ib=!0;try{return Gb(e,i,a)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,i){var a=e.stateNode;if(a===null)return null;var s=Db(a);if(s===null)return null;a=s[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(p$1(231,i,typeof a));return a}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,i,a,s,o,h,d,g,b){var _=Array.prototype.slice.call(arguments,3);try{i.apply(a,_)}catch($){this.onError($)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,i,a,s,o,h,d,g,b){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,i,a,s,o,h,d,g,b){if(Tb.apply(this,arguments),Ob){if(Ob){var _=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=_)}}function Vb(e){var i=e,a=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(a=i.return),e=i.return;while(e)}return i.tag===3?a:null}function Wb(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p$1(188))}function Yb(e){var i=e.alternate;if(!i){if(i=Vb(e),i===null)throw Error(p$1(188));return i!==e?null:e}for(var a=e,s=i;;){var o=a.return;if(o===null)break;var h=o.alternate;if(h===null){if(s=o.return,s!==null){a=s;continue}break}if(o.child===h.child){for(h=o.child;h;){if(h===a)return Xb(o),e;if(h===s)return Xb(o),i;h=h.sibling}throw Error(p$1(188))}if(a.return!==s.return)a=o,s=h;else{for(var d=!1,g=o.child;g;){if(g===a){d=!0,a=o,s=h;break}if(g===s){d=!0,s=o,a=h;break}g=g.sibling}if(!d){for(g=h.child;g;){if(g===a){d=!0,a=h,s=o;break}if(g===s){d=!0,s=h,a=o;break}g=g.sibling}if(!d)throw Error(p$1(189))}}if(a.alternate!==s)throw Error(p$1(190))}if(a.tag!==3)throw Error(p$1(188));return a.stateNode.current===a?e:i}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=$b(e);if(i!==null)return i;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,i){var a=e.pendingLanes;if(a===0)return 0;var s=0,o=e.suspendedLanes,h=e.pingedLanes,d=a&268435455;if(d!==0){var g=d&~o;g!==0?s=tc(g):(h&=d,h!==0&&(s=tc(h)))}else d=a&~o,d!==0?s=tc(d):h!==0&&(s=tc(h));if(s===0)return 0;if(i!==0&&i!==s&&!(i&o)&&(o=s&-s,h=i&-i,o>=h||o===16&&(h&4194240)!==0))return i;if(s&4&&(s|=a&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=s;0<i;)a=31-oc(i),o=1<<a,s|=e[a],i&=~o;return s}function vc(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,i){for(var a=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,h=e.pendingLanes;0<h;){var d=31-oc(h),g=1<<d,b=o[d];b===-1?(!(g&a)||g&s)&&(o[d]=vc(g,i)):b<=i&&(e.expiredLanes|=g),h&=~g}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var i=[],a=0;31>a;a++)i.push(e);return i}function Ac(e,i,a){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-oc(i),e[i]=a}function Bc(e,i){var a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<a;){var o=31-oc(a),h=1<<o;i[o]=0,s[o]=-1,e[o]=-1,a&=~h}}function Cc(e,i){var a=e.entangledLanes|=i;for(e=e.entanglements;a;){var s=31-oc(a),o=1<<s;o&i|e[s]&i&&(e[s]|=i),a&=~o}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,i){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(e,i,a,s,o,h){return e===null||e.nativeEvent!==h?(e={blockedOn:i,domEventName:a,eventSystemFlags:s,nativeEvent:h,targetContainers:[o]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),e):(e.eventSystemFlags|=s,i=e.targetContainers,o!==null&&i.indexOf(o)===-1&&i.push(o),e)}function Uc(e,i,a,s,o){switch(i){case"focusin":return Lc=Tc(Lc,e,i,a,s,o),!0;case"dragenter":return Mc=Tc(Mc,e,i,a,s,o),!0;case"mouseover":return Nc=Tc(Nc,e,i,a,s,o),!0;case"pointerover":var h=o.pointerId;return Oc.set(h,Tc(Oc.get(h)||null,e,i,a,s,o)),!0;case"gotpointercapture":return h=o.pointerId,Pc.set(h,Tc(Pc.get(h)||null,e,i,a,s,o)),!0}return!1}function Vc(e){var i=Wc(e.target);if(i!==null){var a=Vb(i);if(a!==null){if(i=a.tag,i===13){if(i=Wb(a),i!==null){e.blockedOn=i,Ic(e.priority,function(){Gc(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var a=Yc(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var s=new a.constructor(a.type,a);wb=s,a.target.dispatchEvent(s),wb=null}else return i=Cb(a),i!==null&&Fc(i),e.blockedOn=a,!1;i.shift()}return!0}function Zc(e,i,a){Xc(e)&&a.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,i){e.blockedOn===i&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function i(o){return ad(o,e)}if(0<Kc.length){ad(Kc[0],e);for(var a=1;a<Kc.length;a++){var s=Kc[a];s.blockedOn===e&&(s.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(i),Pc.forEach(i),a=0;a<Qc.length;a++)s=Qc[a],s.blockedOn===e&&(s.blockedOn=null);for(;0<Qc.length&&(a=Qc[0],a.blockedOn===null);)Vc(a),a.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,i,a,s){var o=C,h=cd.transition;cd.transition=null;try{C=1,fd(e,i,a,s)}finally{C=o,cd.transition=h}}function gd(e,i,a,s){var o=C,h=cd.transition;cd.transition=null;try{C=4,fd(e,i,a,s)}finally{C=o,cd.transition=h}}function fd(e,i,a,s){if(dd){var o=Yc(e,i,a,s);if(o===null)hd(e,i,s,id,a),Sc(e,s);else if(Uc(o,e,i,a,s))s.stopPropagation();else if(Sc(e,s),i&4&&-1<Rc.indexOf(e)){for(;o!==null;){var h=Cb(o);if(h!==null&&Ec(h),h=Yc(e,i,a,s),h===null&&hd(e,i,s,id,a),h===o)break;o=h}o!==null&&s.stopPropagation()}else hd(e,i,s,null,a)}}var id=null;function Yc(e,i,a,s){if(id=null,e=xb(s),e=Wc(e),e!==null)if(i=Vb(e),i===null)e=null;else if(a=i.tag,a===13){if(e=Wb(i),e!==null)return e;e=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,i=ld,a=i.length,s,o="value"in kd?kd.value:kd.textContent,h=o.length;for(e=0;e<a&&i[e]===o[e];e++);var d=a-e;for(s=1;s<=d&&i[a-s]===o[h-s];s++);return md=o.slice(e,1<s?1-s:void 0)}function od(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function i(a,s,o,h,d){this._reactName=a,this._targetInst=o,this.type=s,this.nativeEvent=h,this.target=d,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(a=e[g],this[g]=a?a(h):h[g]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od[e])?!!i[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var i=Md[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(e,i){switch(e){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,i){switch(e){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe=!0,ee);case"textInput":return e=i.data,e===ee&&fe?null:e;default:return null}}function ke(e,i){if(ie)return e==="compositionend"||!ae&&ge(e,i)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de&&i.locale!=="ko"?null:i.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!le[e.type]:i==="textarea"}function ne(e,i,a,s){Eb(s),i=oe(i,"onChange"),0<i.length&&(a=new td("onChange","change",null,a,s),e.push({event:a,listeners:i}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){var i=ue(e);if(Wa(i))return e}function ve(e,i){if(e==="change")return i}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var i=[];ne(i,qe,e,xb(e)),Jb(re,i)}}function Ce(e,i,a){e==="focusin"?(Ae(),pe=i,qe=a,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,i){if(e==="click")return te(i)}function Fe(e,i){if(e==="input"||e==="change")return te(i)}function Ge(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,i){if(He(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var a=Object.keys(e),s=Object.keys(i);if(a.length!==s.length)return!1;for(s=0;s<a.length;s++){var o=a[s];if(!ja.call(i,o)||!He(e[o],i[o]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,i){var a=Je(e);e=0;for(var s;a;){if(a.nodeType===3){if(s=e+a.textContent.length,e<=i&&s>=i)return{node:a,offset:i-e};e=s}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=Je(a)}}function Le(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Le(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var e=window,i=Xa();i instanceof e.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)e=i.contentWindow;else break;i=Xa(e.document)}return i}function Ne(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Oe(e){var i=Me(),a=e.focusedElem,s=e.selectionRange;if(i!==a&&a&&a.ownerDocument&&Le(a.ownerDocument.documentElement,a)){if(s!==null&&Ne(a)){if(i=s.start,e=s.end,e===void 0&&(e=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(e,a.value.length);else if(e=(i=a.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var o=a.textContent.length,h=Math.min(s.start,o);s=s.end===void 0?h:Math.min(s.end,o),!e.extend&&h>s&&(o=s,s=h,h=o),o=Ke(a,h);var d=Ke(a,s);o&&d&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(i=i.createRange(),i.setStart(o.node,o.offset),e.removeAllRanges(),h>s?(e.addRange(i),e.extend(d.node,d.offset)):(i.setEnd(d.node,d.offset),e.addRange(i)))}}for(i=[],e=a;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)e=i[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,i,a){var s=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Te||Qe==null||Qe!==Xa(s)||(s=Qe,"selectionStart"in s&&Ne(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Se&&Ie(Se,s)||(Se=s,s=oe(Re,"onSelect"),0<s.length&&(i=new td("onSelect","select",null,i,a),e.push({event:i,listeners:s}),i.target=Qe)))}function Ve(e,i){var a={};return a[e.toLowerCase()]=i.toLowerCase(),a["Webkit"+e]="webkit"+i,a["Moz"+e]="moz"+i,a}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var i=We[e],a;for(a in i)if(i.hasOwnProperty(a)&&a in Ye)return Xe[e]=i[a];return e}var $e$1=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,i){df.set(e,i),fa(i,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e$1,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,i,a){var s=e.type||"unknown-event";e.currentTarget=a,Ub(s,i,void 0,e),e.currentTarget=null}function se(e,i){i=(i&4)!==0;for(var a=0;a<e.length;a++){var s=e[a],o=s.event;s=s.listeners;t:{var h=void 0;if(i)for(var d=s.length-1;0<=d;d--){var g=s[d],b=g.instance,_=g.currentTarget;if(g=g.listener,b!==h&&o.isPropagationStopped())break t;nf(o,g,_),h=b}else for(d=0;d<s.length;d++){if(g=s[d],b=g.instance,_=g.currentTarget,g=g.listener,b!==h&&o.isPropagationStopped())break t;nf(o,g,_),h=b}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,i){var a=i[of];a===void 0&&(a=i[of]=new Set);var s=e+"__bubble";a.has(s)||(pf(i,e,2,!1),a.add(s))}function qf(e,i,a){var s=0;i&&(s|=4),pf(a,e,s,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(a){a!=="selectionchange"&&(mf.has(a)||qf(a,!1,e),qf(a,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(e,i,a,s){switch(jd(i)){case 1:var o=ed;break;case 4:o=gd;break;default:o=fd}a=o.bind(null,i,a,e),o=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(i,a,{capture:!0,passive:o}):e.addEventListener(i,a,!0):o!==void 0?e.addEventListener(i,a,{passive:o}):e.addEventListener(i,a,!1)}function hd(e,i,a,s,o){var h=s;if(!(i&1)&&!(i&2)&&s!==null)t:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var g=s.stateNode.containerInfo;if(g===o||g.nodeType===8&&g.parentNode===o)break;if(d===4)for(d=s.return;d!==null;){var b=d.tag;if((b===3||b===4)&&(b=d.stateNode.containerInfo,b===o||b.nodeType===8&&b.parentNode===o))return;d=d.return}for(;g!==null;){if(d=Wc(g),d===null)return;if(b=d.tag,b===5||b===6){s=h=d;continue t}g=g.parentNode}}s=s.return}Jb(function(){var _=h,$=xb(a),it=[];t:{var nt=df.get(e);if(nt!==void 0){var tt=td,at=e;switch(e){case"keypress":if(od(a)===0)break t;case"keydown":case"keyup":tt=Rd;break;case"focusin":at="focus",tt=Fd;break;case"focusout":at="blur",tt=Fd;break;case"beforeblur":case"afterblur":tt=Fd;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=Vd;break;case $e$1:case af:case bf:tt=Hd;break;case cf:tt=Xd;break;case"scroll":tt=vd;break;case"wheel":tt=Zd;break;case"copy":case"cut":case"paste":tt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=Td}var ut=(i&4)!==0,ft=!ut&&e==="scroll",ht=ut?nt!==null?nt+"Capture":null:nt;ut=[];for(var dt=_,st;dt!==null;){st=dt;var ct=st.stateNode;if(st.tag===5&&ct!==null&&(st=ct,ht!==null&&(ct=Kb(dt,ht),ct!=null&&ut.push(tf(dt,ct,st)))),ft)break;dt=dt.return}0<ut.length&&(nt=new tt(nt,at,null,a,$),it.push({event:nt,listeners:ut}))}}if(!(i&7)){t:{if(nt=e==="mouseover"||e==="pointerover",tt=e==="mouseout"||e==="pointerout",nt&&a!==wb&&(at=a.relatedTarget||a.fromElement)&&(Wc(at)||at[uf]))break t;if((tt||nt)&&(nt=$.window===$?$:(nt=$.ownerDocument)?nt.defaultView||nt.parentWindow:window,tt?(at=a.relatedTarget||a.toElement,tt=_,at=at?Wc(at):null,at!==null&&(ft=Vb(at),at!==ft||at.tag!==5&&at.tag!==6)&&(at=null)):(tt=null,at=_),tt!==at)){if(ut=Bd,ct="onMouseLeave",ht="onMouseEnter",dt="mouse",(e==="pointerout"||e==="pointerover")&&(ut=Td,ct="onPointerLeave",ht="onPointerEnter",dt="pointer"),ft=tt==null?nt:ue(tt),st=at==null?nt:ue(at),nt=new ut(ct,dt+"leave",tt,a,$),nt.target=ft,nt.relatedTarget=st,ct=null,Wc($)===_&&(ut=new ut(ht,dt+"enter",at,a,$),ut.target=st,ut.relatedTarget=ft,ct=ut),ft=ct,tt&&at)e:{for(ut=tt,ht=at,dt=0,st=ut;st;st=vf(st))dt++;for(st=0,ct=ht;ct;ct=vf(ct))st++;for(;0<dt-st;)ut=vf(ut),dt--;for(;0<st-dt;)ht=vf(ht),st--;for(;dt--;){if(ut===ht||ht!==null&&ut===ht.alternate)break e;ut=vf(ut),ht=vf(ht)}ut=null}else ut=null;tt!==null&&wf(it,nt,tt,ut,!1),at!==null&&ft!==null&&wf(it,ft,at,ut,!0)}}t:{if(nt=_?ue(_):window,tt=nt.nodeName&&nt.nodeName.toLowerCase(),tt==="select"||tt==="input"&&nt.type==="file")var wt=ve;else if(me(nt))if(we)wt=Fe;else{wt=De;var _t=Ce}else(tt=nt.nodeName)&&tt.toLowerCase()==="input"&&(nt.type==="checkbox"||nt.type==="radio")&&(wt=Ee);if(wt&&(wt=wt(e,_))){ne(it,wt,a,$);break t}_t&&_t(e,nt,_),e==="focusout"&&(_t=nt._wrapperState)&&_t.controlled&&nt.type==="number"&&cb(nt,"number",nt.value)}switch(_t=_?ue(_):window,e){case"focusin":(me(_t)||_t.contentEditable==="true")&&(Qe=_t,Re=_,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(it,a,$);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(it,a,$)}var gt;if(ae)t:{switch(e){case"compositionstart":var yt="onCompositionStart";break t;case"compositionend":yt="onCompositionEnd";break t;case"compositionupdate":yt="onCompositionUpdate";break t}yt=void 0}else ie?ge(e,a)&&(yt="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(yt="onCompositionStart");yt&&(de&&a.locale!=="ko"&&(ie||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&ie&&(gt=nd()):(kd=$,ld="value"in kd?kd.value:kd.textContent,ie=!0)),_t=oe(_,yt),0<_t.length&&(yt=new Ld(yt,e,null,a,$),it.push({event:yt,listeners:_t}),gt?yt.data=gt:(gt=he(a),gt!==null&&(yt.data=gt)))),(gt=ce?je(e,a):ke(e,a))&&(_=oe(_,"onBeforeInput"),0<_.length&&($=new Ld("onBeforeInput","beforeinput",null,a,$),it.push({event:$,listeners:_}),$.data=gt))}se(it,i)})}function tf(e,i,a){return{instance:e,listener:i,currentTarget:a}}function oe(e,i){for(var a=i+"Capture",s=[];e!==null;){var o=e,h=o.stateNode;o.tag===5&&h!==null&&(o=h,h=Kb(e,a),h!=null&&s.unshift(tf(e,h,o)),h=Kb(e,i),h!=null&&s.push(tf(e,h,o))),e=e.return}return s}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,i,a,s,o){for(var h=i._reactName,d=[];a!==null&&a!==s;){var g=a,b=g.alternate,_=g.stateNode;if(b!==null&&b===s)break;g.tag===5&&_!==null&&(g=_,o?(b=Kb(a,h),b!=null&&d.unshift(tf(a,b,g))):o||(b=Kb(a,h),b!=null&&d.push(tf(a,b,g)))),a=a.return}d.length!==0&&e.push({event:i,listeners:d})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,i,a){if(i=zf(i),zf(e)!==i&&a)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,i){var a=i,s=0;do{var o=a.nextSibling;if(e.removeChild(a),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(s===0){e.removeChild(o),bd(i);return}s--}else a!=="$"&&a!=="$?"&&a!=="$!"||s++;a=o}while(a);bd(i)}function Lf(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return e;i--}else a==="/$"&&i++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var i=e[Of];if(i)return i;for(var a=e.parentNode;a;){if(i=a[uf]||a[Of]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(e=Mf(e);e!==null;){if(a=e[Of])return a;e=Mf(e)}return i}e=a,a=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p$1(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,i){Tf++,Sf[Tf]=e.current,e.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,i){var a=e.type.contextTypes;if(!a)return Vf;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===i)return s.__reactInternalMemoizedMaskedChildContext;var o={},h;for(h in a)o[h]=i[h];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),o}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H)}function ag(e,i,a){if(H.current!==Vf)throw Error(p$1(168));G(H,i),G(Wf,a)}function bg(e,i,a){var s=e.stateNode;if(i=i.childContextTypes,typeof s.getChildContext!="function")return a;s=s.getChildContext();for(var o in s)if(!(o in i))throw Error(p$1(108,Ra(e)||"Unknown",o));return A({},a,s)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,i,a){var s=e.stateNode;if(!s)throw Error(p$1(169));a?(e=bg(e,i,Xf),s.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H),G(H,e)):E(Wf),G(Wf,a)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,i=C;try{var a=eg;for(C=1;e<a.length;e++){var s=a[e];do s=s(!0);while(s!==null)}eg=null,fg=!1}catch(o){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),o}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,i){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=i}function ug(e,i,a){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var s=rg;e=sg;var o=32-oc(s)-1;s&=~(1<<o),a+=1;var h=32-oc(i)+o;if(30<h){var d=o-o%5;h=(s&(1<<d)-1).toString(32),s>>=d,o-=d,rg=1<<32-oc(i)+o|a<<o|s,sg=h+e}else rg=1<<h|a<<o|s,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,i){var a=Bg(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=e,i=e.deletions,i===null?(e.deletions=[a],e.flags|=16):i.push(a)}function Cg(e,i){switch(e.tag){case 5:var a=e.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,xg=e,yg=Lf(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,xg=e,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=Bg(18,null,null,0),a.stateNode=i,a.return=e,e.child=a,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var i=yg;if(i){var a=i;if(!Cg(e,i)){if(Dg(e))throw Error(p$1(418));i=Lf(a.nextSibling);var s=xg;i&&Cg(e,i)?Ag(s,a):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p$1(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!Ef(e.type,e.memoizedProps)),i&&(i=yg)){if(Dg(e))throw Hg(),Error(p$1(418));for(;i;)Ag(e,i),i=Lf(i.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p$1(317));t:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(i===0){yg=Lf(e.nextSibling);break t}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,i,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(p$1(309));var s=a.stateNode}if(!s)throw Error(p$1(147,e));var o=s,h=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===h?i.ref:(i=function(d){var g=o.refs;d===null?delete g[h]:g[h]=d},i._stringRef=h,i)}if(typeof e!="string")throw Error(p$1(284));if(!a._owner)throw Error(p$1(290,e))}return e}function Mg(e,i){throw e=Object.prototype.toString.call(i),Error(p$1(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function Ng(e){var i=e._init;return i(e._payload)}function Og(e){function i(ht,dt){if(e){var st=ht.deletions;st===null?(ht.deletions=[dt],ht.flags|=16):st.push(dt)}}function a(ht,dt){if(!e)return null;for(;dt!==null;)i(ht,dt),dt=dt.sibling;return null}function s(ht,dt){for(ht=new Map;dt!==null;)dt.key!==null?ht.set(dt.key,dt):ht.set(dt.index,dt),dt=dt.sibling;return ht}function o(ht,dt){return ht=Pg(ht,dt),ht.index=0,ht.sibling=null,ht}function h(ht,dt,st){return ht.index=st,e?(st=ht.alternate,st!==null?(st=st.index,st<dt?(ht.flags|=2,dt):st):(ht.flags|=2,dt)):(ht.flags|=1048576,dt)}function d(ht){return e&&ht.alternate===null&&(ht.flags|=2),ht}function g(ht,dt,st,ct){return dt===null||dt.tag!==6?(dt=Qg(st,ht.mode,ct),dt.return=ht,dt):(dt=o(dt,st),dt.return=ht,dt)}function b(ht,dt,st,ct){var wt=st.type;return wt===ya?$(ht,dt,st.props.children,ct,st.key):dt!==null&&(dt.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===Ha&&Ng(wt)===dt.type)?(ct=o(dt,st.props),ct.ref=Lg(ht,dt,st),ct.return=ht,ct):(ct=Rg(st.type,st.key,st.props,null,ht.mode,ct),ct.ref=Lg(ht,dt,st),ct.return=ht,ct)}function _(ht,dt,st,ct){return dt===null||dt.tag!==4||dt.stateNode.containerInfo!==st.containerInfo||dt.stateNode.implementation!==st.implementation?(dt=Sg(st,ht.mode,ct),dt.return=ht,dt):(dt=o(dt,st.children||[]),dt.return=ht,dt)}function $(ht,dt,st,ct,wt){return dt===null||dt.tag!==7?(dt=Tg(st,ht.mode,ct,wt),dt.return=ht,dt):(dt=o(dt,st),dt.return=ht,dt)}function it(ht,dt,st){if(typeof dt=="string"&&dt!==""||typeof dt=="number")return dt=Qg(""+dt,ht.mode,st),dt.return=ht,dt;if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case va:return st=Rg(dt.type,dt.key,dt.props,null,ht.mode,st),st.ref=Lg(ht,null,dt),st.return=ht,st;case wa:return dt=Sg(dt,ht.mode,st),dt.return=ht,dt;case Ha:var ct=dt._init;return it(ht,ct(dt._payload),st)}if(eb(dt)||Ka(dt))return dt=Tg(dt,ht.mode,st,null),dt.return=ht,dt;Mg(ht,dt)}return null}function nt(ht,dt,st,ct){var wt=dt!==null?dt.key:null;if(typeof st=="string"&&st!==""||typeof st=="number")return wt!==null?null:g(ht,dt,""+st,ct);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case va:return st.key===wt?b(ht,dt,st,ct):null;case wa:return st.key===wt?_(ht,dt,st,ct):null;case Ha:return wt=st._init,nt(ht,dt,wt(st._payload),ct)}if(eb(st)||Ka(st))return wt!==null?null:$(ht,dt,st,ct,null);Mg(ht,st)}return null}function tt(ht,dt,st,ct,wt){if(typeof ct=="string"&&ct!==""||typeof ct=="number")return ht=ht.get(st)||null,g(dt,ht,""+ct,wt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case va:return ht=ht.get(ct.key===null?st:ct.key)||null,b(dt,ht,ct,wt);case wa:return ht=ht.get(ct.key===null?st:ct.key)||null,_(dt,ht,ct,wt);case Ha:var _t=ct._init;return tt(ht,dt,st,_t(ct._payload),wt)}if(eb(ct)||Ka(ct))return ht=ht.get(st)||null,$(dt,ht,ct,wt,null);Mg(dt,ct)}return null}function at(ht,dt,st,ct){for(var wt=null,_t=null,gt=dt,yt=dt=0,bt=null;gt!==null&&yt<st.length;yt++){gt.index>yt?(bt=gt,gt=null):bt=gt.sibling;var vt=nt(ht,gt,st[yt],ct);if(vt===null){gt===null&&(gt=bt);break}e&&gt&&vt.alternate===null&&i(ht,gt),dt=h(vt,dt,yt),_t===null?wt=vt:_t.sibling=vt,_t=vt,gt=bt}if(yt===st.length)return a(ht,gt),I&&tg(ht,yt),wt;if(gt===null){for(;yt<st.length;yt++)gt=it(ht,st[yt],ct),gt!==null&&(dt=h(gt,dt,yt),_t===null?wt=gt:_t.sibling=gt,_t=gt);return I&&tg(ht,yt),wt}for(gt=s(ht,gt);yt<st.length;yt++)bt=tt(gt,ht,yt,st[yt],ct),bt!==null&&(e&&bt.alternate!==null&&gt.delete(bt.key===null?yt:bt.key),dt=h(bt,dt,yt),_t===null?wt=bt:_t.sibling=bt,_t=bt);return e&&gt.forEach(function(Ct){return i(ht,Ct)}),I&&tg(ht,yt),wt}function ut(ht,dt,st,ct){var wt=Ka(st);if(typeof wt!="function")throw Error(p$1(150));if(st=wt.call(st),st==null)throw Error(p$1(151));for(var _t=wt=null,gt=dt,yt=dt=0,bt=null,vt=st.next();gt!==null&&!vt.done;yt++,vt=st.next()){gt.index>yt?(bt=gt,gt=null):bt=gt.sibling;var Ct=nt(ht,gt,vt.value,ct);if(Ct===null){gt===null&&(gt=bt);break}e&&gt&&Ct.alternate===null&&i(ht,gt),dt=h(Ct,dt,yt),_t===null?wt=Ct:_t.sibling=Ct,_t=Ct,gt=bt}if(vt.done)return a(ht,gt),I&&tg(ht,yt),wt;if(gt===null){for(;!vt.done;yt++,vt=st.next())vt=it(ht,vt.value,ct),vt!==null&&(dt=h(vt,dt,yt),_t===null?wt=vt:_t.sibling=vt,_t=vt);return I&&tg(ht,yt),wt}for(gt=s(ht,gt);!vt.done;yt++,vt=st.next())vt=tt(gt,ht,yt,vt.value,ct),vt!==null&&(e&&vt.alternate!==null&&gt.delete(vt.key===null?yt:vt.key),dt=h(vt,dt,yt),_t===null?wt=vt:_t.sibling=vt,_t=vt);return e&&gt.forEach(function(Ht){return i(ht,Ht)}),I&&tg(ht,yt),wt}function ft(ht,dt,st,ct){if(typeof st=="object"&&st!==null&&st.type===ya&&st.key===null&&(st=st.props.children),typeof st=="object"&&st!==null){switch(st.$$typeof){case va:t:{for(var wt=st.key,_t=dt;_t!==null;){if(_t.key===wt){if(wt=st.type,wt===ya){if(_t.tag===7){a(ht,_t.sibling),dt=o(_t,st.props.children),dt.return=ht,ht=dt;break t}}else if(_t.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===Ha&&Ng(wt)===_t.type){a(ht,_t.sibling),dt=o(_t,st.props),dt.ref=Lg(ht,_t,st),dt.return=ht,ht=dt;break t}a(ht,_t);break}else i(ht,_t);_t=_t.sibling}st.type===ya?(dt=Tg(st.props.children,ht.mode,ct,st.key),dt.return=ht,ht=dt):(ct=Rg(st.type,st.key,st.props,null,ht.mode,ct),ct.ref=Lg(ht,dt,st),ct.return=ht,ht=ct)}return d(ht);case wa:t:{for(_t=st.key;dt!==null;){if(dt.key===_t)if(dt.tag===4&&dt.stateNode.containerInfo===st.containerInfo&&dt.stateNode.implementation===st.implementation){a(ht,dt.sibling),dt=o(dt,st.children||[]),dt.return=ht,ht=dt;break t}else{a(ht,dt);break}else i(ht,dt);dt=dt.sibling}dt=Sg(st,ht.mode,ct),dt.return=ht,ht=dt}return d(ht);case Ha:return _t=st._init,ft(ht,dt,_t(st._payload),ct)}if(eb(st))return at(ht,dt,st,ct);if(Ka(st))return ut(ht,dt,st,ct);Mg(ht,st)}return typeof st=="string"&&st!==""||typeof st=="number"?(st=""+st,dt!==null&&dt.tag===6?(a(ht,dt.sibling),dt=o(dt,st),dt.return=ht,ht=dt):(a(ht,dt),dt=Qg(st,ht.mode,ct),dt.return=ht,ht=dt),d(ht)):a(ht,dt)}return ft}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var i=Wg.current;E(Wg),e._currentValue=i}function bh(e,i,a){for(;e!==null;){var s=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,s!==null&&(s.childLanes|=i)):s!==null&&(s.childLanes&i)!==i&&(s.childLanes|=i),e===a)break;e=e.return}}function ch(e,i){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(dh=!0),e.firstContext=null)}function eh(e){var i=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:i,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return i}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,i,a,s){var o=i.interleaved;return o===null?(a.next=a,gh(i)):(a.next=o.next,o.next=a),i.interleaved=a,ih(e,s)}function ih(e,i){e.lanes|=i;var a=e.alternate;for(a!==null&&(a.lanes|=i),a=e,e=e.return;e!==null;)e.childLanes|=i,a=e.alternate,a!==null&&(a.childLanes|=i),a=e,e=e.return;return a.tag===3?a.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function nh(e,i,a){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,K&2){var o=s.pending;return o===null?i.next=i:(i.next=o.next,o.next=i),s.pending=i,ih(e,a)}return o=s.interleaved,o===null?(i.next=i,gh(s)):(i.next=o.next,o.next=i),s.interleaved=i,ih(e,a)}function oh(e,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var s=i.lanes;s&=e.pendingLanes,a|=s,i.lanes=a,Cc(e,a)}}function ph(e,i){var a=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,a===s)){var o=null,h=null;if(a=a.firstBaseUpdate,a!==null){do{var d={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};h===null?o=h=d:h=h.next=d,a=a.next}while(a!==null);h===null?o=h=i:h=h.next=i}else o=h=i;a={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:h,shared:s.shared,effects:s.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=i:e.next=i,a.lastBaseUpdate=i}function qh(e,i,a,s){var o=e.updateQueue;jh=!1;var h=o.firstBaseUpdate,d=o.lastBaseUpdate,g=o.shared.pending;if(g!==null){o.shared.pending=null;var b=g,_=b.next;b.next=null,d===null?h=_:d.next=_,d=b;var $=e.alternate;$!==null&&($=$.updateQueue,g=$.lastBaseUpdate,g!==d&&(g===null?$.firstBaseUpdate=_:g.next=_,$.lastBaseUpdate=b))}if(h!==null){var it=o.baseState;d=0,$=_=b=null,g=h;do{var nt=g.lane,tt=g.eventTime;if((s&nt)===nt){$!==null&&($=$.next={eventTime:tt,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});t:{var at=e,ut=g;switch(nt=i,tt=a,ut.tag){case 1:if(at=ut.payload,typeof at=="function"){it=at.call(tt,it,nt);break t}it=at;break t;case 3:at.flags=at.flags&-65537|128;case 0:if(at=ut.payload,nt=typeof at=="function"?at.call(tt,it,nt):at,nt==null)break t;it=A({},it,nt);break t;case 2:jh=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,nt=o.effects,nt===null?o.effects=[g]:nt.push(g))}else tt={eventTime:tt,lane:nt,tag:g.tag,payload:g.payload,callback:g.callback,next:null},$===null?(_=$=tt,b=it):$=$.next=tt,d|=nt;if(g=g.next,g===null){if(g=o.shared.pending,g===null)break;nt=g,g=nt.next,nt.next=null,o.lastBaseUpdate=nt,o.shared.pending=null}}while(!0);if($===null&&(b=it),o.baseState=b,o.firstBaseUpdate=_,o.lastBaseUpdate=$,i=o.shared.interleaved,i!==null){o=i;do d|=o.lane,o=o.next;while(o!==i)}else h===null&&(o.shared.lanes=0);rh|=d,e.lanes=d,e.memoizedState=it}}function sh(e,i,a){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var s=e[i],o=s.callback;if(o!==null){if(s.callback=null,s=a,typeof o!="function")throw Error(p$1(191,o));o.call(s)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p$1(174));return e}function yh(e,i){switch(G(wh,i),G(vh,e),G(uh,th),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=lb(i,e)}E(uh),G(uh,i)}function zh(){E(uh),E(vh),E(wh)}function Ah(e){xh(wh.current);var i=xh(uh.current),a=lb(i,e.type);i!==a&&(G(vh,e),G(uh,a))}function Bh(e){vh.current===e&&(E(uh),E(vh))}var L=Uf(0);function Ch(e){for(var i=e;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p$1(321))}function Mh(e,i){if(i===null)return!1;for(var a=0;a<i.length&&a<e.length;a++)if(!He(e[a],i[a]))return!1;return!0}function Nh(e,i,a,s,o,h){if(Hh=h,M=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=a(s,o),Jh){h=0;do{if(Jh=!1,Kh=0,25<=h)throw Error(p$1(301));h+=1,O=N=null,i.updateQueue=null,Fh.current=Qh,e=a(s,o)}while(Jh)}if(Fh.current=Rh,i=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,i)throw Error(p$1(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=e:O=O.next=e,O}function Uh(){if(N===null){var e=M.alternate;e=e!==null?e.memoizedState:null}else e=N.next;var i=O===null?M.memoizedState:O.next;if(i!==null)O=i,N=e;else{if(e===null)throw Error(p$1(310));N=e,e={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=e:O=O.next=e}return O}function Vh(e,i){return typeof i=="function"?i(e):i}function Wh(e){var i=Uh(),a=i.queue;if(a===null)throw Error(p$1(311));a.lastRenderedReducer=e;var s=N,o=s.baseQueue,h=a.pending;if(h!==null){if(o!==null){var d=o.next;o.next=h.next,h.next=d}s.baseQueue=o=h,a.pending=null}if(o!==null){h=o.next,s=s.baseState;var g=d=null,b=null,_=h;do{var $=_.lane;if((Hh&$)===$)b!==null&&(b=b.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),s=_.hasEagerState?_.eagerState:e(s,_.action);else{var it={lane:$,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};b===null?(g=b=it,d=s):b=b.next=it,M.lanes|=$,rh|=$}_=_.next}while(_!==null&&_!==h);b===null?d=s:b.next=g,He(s,i.memoizedState)||(dh=!0),i.memoizedState=s,i.baseState=d,i.baseQueue=b,a.lastRenderedState=s}if(e=a.interleaved,e!==null){o=e;do h=o.lane,M.lanes|=h,rh|=h,o=o.next;while(o!==e)}else o===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Xh(e){var i=Uh(),a=i.queue;if(a===null)throw Error(p$1(311));a.lastRenderedReducer=e;var s=a.dispatch,o=a.pending,h=i.memoizedState;if(o!==null){a.pending=null;var d=o=o.next;do h=e(h,d.action),d=d.next;while(d!==o);He(h,i.memoizedState)||(dh=!0),i.memoizedState=h,i.baseQueue===null&&(i.baseState=h),a.lastRenderedState=h}return[h,s]}function Yh(){}function Zh(e,i){var a=M,s=Uh(),o=i(),h=!He(s.memoizedState,o);if(h&&(s.memoizedState=o,dh=!0),s=s.queue,$h(ai.bind(null,a,s,e),[e]),s.getSnapshot!==i||h||O!==null&&O.memoizedState.tag&1){if(a.flags|=2048,bi(9,ci.bind(null,a,s,o,i),void 0,null),Q===null)throw Error(p$1(349));Hh&30||di(a,i,o)}return o}function di(e,i,a){e.flags|=16384,e={getSnapshot:i,value:a},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.stores=[e]):(a=i.stores,a===null?i.stores=[e]:a.push(e))}function ci(e,i,a,s){i.value=a,i.getSnapshot=s,ei(i)&&fi(e)}function ai(e,i,a){return a(function(){ei(i)&&fi(e)})}function ei(e){var i=e.getSnapshot;e=e.value;try{var a=i();return!He(e,a)}catch{return!0}}function fi(e){var i=ih(e,1);i!==null&&gi(i,e,1,-1)}function hi(e){var i=Th();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},i.queue=e,e=e.dispatch=ii.bind(null,M,e),[i.memoizedState,e]}function bi(e,i,a,s){return e={tag:e,create:i,destroy:a,deps:s,next:null},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.lastEffect=e.next=e):(a=i.lastEffect,a===null?i.lastEffect=e.next=e:(s=a.next,a.next=e,e.next=s,i.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,i,a,s){var o=Th();M.flags|=e,o.memoizedState=bi(1|i,a,void 0,s===void 0?null:s)}function li$1(e,i,a,s){var o=Uh();s=s===void 0?null:s;var h=void 0;if(N!==null){var d=N.memoizedState;if(h=d.destroy,s!==null&&Mh(s,d.deps)){o.memoizedState=bi(i,a,h,s);return}}M.flags|=e,o.memoizedState=bi(1|i,a,h,s)}function mi(e,i){return ki(8390656,8,e,i)}function $h(e,i){return li$1(2048,8,e,i)}function ni(e,i){return li$1(4,2,e,i)}function oi(e,i){return li$1(4,4,e,i)}function pi(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function qi(e,i,a){return a=a!=null?a.concat([e]):null,li$1(4,4,pi.bind(null,i,e),a)}function ri(){}function si(e,i){var a=Uh();i=i===void 0?null:i;var s=a.memoizedState;return s!==null&&i!==null&&Mh(i,s[1])?s[0]:(a.memoizedState=[e,i],e)}function ti(e,i){var a=Uh();i=i===void 0?null:i;var s=a.memoizedState;return s!==null&&i!==null&&Mh(i,s[1])?s[0]:(e=e(),a.memoizedState=[e,i],e)}function ui(e,i,a){return Hh&21?(He(a,i)||(a=yc(),M.lanes|=a,rh|=a,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=a)}function vi(e,i){var a=C;C=a!==0&&4>a?a:4,e(!0);var s=Gh.transition;Gh.transition={};try{e(!1),i()}finally{C=a,Gh.transition=s}}function wi(){return Uh().memoizedState}function xi(e,i,a){var s=yi(e);if(a={lane:s,action:a,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(i,a);else if(a=hh(e,i,a,s),a!==null){var o=R$1();gi(a,e,s,o),Bi(a,i,s)}}function ii(e,i,a){var s=yi(e),o={lane:s,action:a,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(i,o);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=i.lastRenderedReducer,h!==null))try{var d=i.lastRenderedState,g=h(d,a);if(o.hasEagerState=!0,o.eagerState=g,He(g,d)){var b=i.interleaved;b===null?(o.next=o,gh(i)):(o.next=b.next,b.next=o),i.interleaved=o;return}}catch{}finally{}a=hh(e,i,o,s),a!==null&&(o=R$1(),gi(a,e,s,o),Bi(a,i,s))}}function zi(e){var i=e.alternate;return e===M||i!==null&&i===M}function Ai(e,i){Jh=Ih=!0;var a=e.pending;a===null?i.next=i:(i.next=a.next,a.next=i),e.pending=i}function Bi(e,i,a){if(a&4194240){var s=i.lanes;s&=e.pendingLanes,a|=s,i.lanes=a,Cc(e,a)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,i){return Th().memoizedState=[e,i===void 0?null:i],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,i,a){return a=a!=null?a.concat([e]):null,ki(4194308,4,pi.bind(null,i,e),a)},useLayoutEffect:function(e,i){return ki(4194308,4,e,i)},useInsertionEffect:function(e,i){return ki(4,2,e,i)},useMemo:function(e,i){var a=Th();return i=i===void 0?null:i,e=e(),a.memoizedState=[e,i],e},useReducer:function(e,i,a){var s=Th();return i=a!==void 0?a(i):i,s.memoizedState=s.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},s.queue=e,e=e.dispatch=xi.bind(null,M,e),[s.memoizedState,e]},useRef:function(e){var i=Th();return e={current:e},i.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),i=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,a){var s=M,o=Th();if(I){if(a===void 0)throw Error(p$1(407));a=a()}else{if(a=i(),Q===null)throw Error(p$1(349));Hh&30||di(s,i,a)}o.memoizedState=a;var h={value:a,getSnapshot:i};return o.queue=h,mi(ai.bind(null,s,h,e),[e]),s.flags|=2048,bi(9,ci.bind(null,s,h,a,i),void 0,null),a},useId:function(){var e=Th(),i=Q.identifierPrefix;if(I){var a=sg,s=rg;a=(s&~(1<<32-oc(s)-1)).toString(32)+a,i=":"+i+"R"+a,a=Kh++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=Lh++,i=":"+i+"r"+a.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return ui(i,N.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return N===null?i.memoizedState=e:ui(i,N.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,i){if(e&&e.defaultProps){i=A({},i),e=e.defaultProps;for(var a in e)i[a]===void 0&&(i[a]=e[a]);return i}return i}function Di(e,i,a,s){i=e.memoizedState,a=a(s,i),a=a==null?i:A({},i,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,i,a){e=e._reactInternals;var s=R$1(),o=yi(e),h=mh(s,o);h.payload=i,a!=null&&(h.callback=a),i=nh(e,h,o),i!==null&&(gi(i,e,o,s),oh(i,e,o))},enqueueReplaceState:function(e,i,a){e=e._reactInternals;var s=R$1(),o=yi(e),h=mh(s,o);h.tag=1,h.payload=i,a!=null&&(h.callback=a),i=nh(e,h,o),i!==null&&(gi(i,e,o,s),oh(i,e,o))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var a=R$1(),s=yi(e),o=mh(a,s);o.tag=2,i!=null&&(o.callback=i),i=nh(e,o,s),i!==null&&(gi(i,e,s,a),oh(i,e,s))}};function Fi(e,i,a,s,o,h,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,h,d):i.prototype&&i.prototype.isPureReactComponent?!Ie(a,s)||!Ie(o,h):!0}function Gi(e,i,a){var s=!1,o=Vf,h=i.contextType;return typeof h=="object"&&h!==null?h=eh(h):(o=Zf(i)?Xf:H.current,s=i.contextTypes,h=(s=s!=null)?Yf(e,o):Vf),i=new i(a,h),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ei,e.stateNode=i,i._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=h),i}function Hi(e,i,a,s){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,s),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,s),i.state!==e&&Ei.enqueueReplaceState(i,i.state,null)}function Ii(e,i,a,s){var o=e.stateNode;o.props=a,o.state=e.memoizedState,o.refs={},kh(e);var h=i.contextType;typeof h=="object"&&h!==null?o.context=eh(h):(h=Zf(i)?Xf:H.current,o.context=Yf(e,h)),o.state=e.memoizedState,h=i.getDerivedStateFromProps,typeof h=="function"&&(Di(e,i,h,a),o.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(i=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),i!==o.state&&Ei.enqueueReplaceState(o,o.state,null),qh(e,a,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,i){try{var a="",s=i;do a+=Pa(s),s=s.return;while(s);var o=a}catch(h){o=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:i,stack:o,digest:null}}function Ki(e,i,a){return{value:e,source:null,stack:a??null,digest:i??null}}function Li(e,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,i,a){a=mh(-1,a),a.tag=3,a.payload={element:null};var s=i.value;return a.callback=function(){Oi||(Oi=!0,Pi=s),Li(e,i)},a}function Qi(e,i,a){a=mh(-1,a),a.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=i.value;a.payload=function(){return s(o)},a.callback=function(){Li(e,i)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(a.callback=function(){Li(e,i),typeof s!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var d=i.stack;this.componentDidCatch(i.value,{componentStack:d!==null?d:""})}),a}function Si(e,i,a){var s=e.pingCache;if(s===null){s=e.pingCache=new Mi;var o=new Set;s.set(i,o)}else o=s.get(i),o===void 0&&(o=new Set,s.set(i,o));o.has(a)||(o.add(a),e=Ti.bind(null,e,i,a),i.then(e,e))}function Ui(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Vi(e,i,a,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===i?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=mh(-1,1),i.tag=2,nh(a,i,1))),a.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,i,a,s){i.child=e===null?Vg(i,null,a,s):Ug(i,e.child,a,s)}function Yi(e,i,a,s,o){a=a.render;var h=i.ref;return ch(i,o),s=Nh(e,i,a,s,h,o),a=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~o,Zi(e,i,o)):(I&&a&&vg(i),i.flags|=1,Xi(e,i,s,o),i.child)}function $i(e,i,a,s,o){if(e===null){var h=a.type;return typeof h=="function"&&!aj(h)&&h.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=h,bj(e,i,h,s,o)):(e=Rg(a.type,null,s,i,i.mode,o),e.ref=i.ref,e.return=i,i.child=e)}if(h=e.child,!(e.lanes&o)){var d=h.memoizedProps;if(a=a.compare,a=a!==null?a:Ie,a(d,s)&&e.ref===i.ref)return Zi(e,i,o)}return i.flags|=1,e=Pg(h,s),e.ref=i.ref,e.return=i,i.child=e}function bj(e,i,a,s,o){if(e!==null){var h=e.memoizedProps;if(Ie(h,s)&&e.ref===i.ref)if(dh=!1,i.pendingProps=s=h,(e.lanes&o)!==0)e.flags&131072&&(dh=!0);else return i.lanes=e.lanes,Zi(e,i,o)}return cj(e,i,a,s,o)}function dj(e,i,a){var s=i.pendingProps,o=s.children,h=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=a;else{if(!(a&1073741824))return e=h!==null?h.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,G(ej,fj),fj|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=h!==null?h.baseLanes:a,G(ej,fj),fj|=s}else h!==null?(s=h.baseLanes|a,i.memoizedState=null):s=a,G(ej,fj),fj|=s;return Xi(e,i,o,a),i.child}function gj(e,i){var a=i.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function cj(e,i,a,s,o){var h=Zf(a)?Xf:H.current;return h=Yf(i,h),ch(i,o),a=Nh(e,i,a,s,h,o),s=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~o,Zi(e,i,o)):(I&&s&&vg(i),i.flags|=1,Xi(e,i,a,o),i.child)}function hj(e,i,a,s,o){if(Zf(a)){var h=!0;cg(i)}else h=!1;if(ch(i,o),i.stateNode===null)ij(e,i),Gi(i,a,s),Ii(i,a,s,o),s=!0;else if(e===null){var d=i.stateNode,g=i.memoizedProps;d.props=g;var b=d.context,_=a.contextType;typeof _=="object"&&_!==null?_=eh(_):(_=Zf(a)?Xf:H.current,_=Yf(i,_));var $=a.getDerivedStateFromProps,it=typeof $=="function"||typeof d.getSnapshotBeforeUpdate=="function";it||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(g!==s||b!==_)&&Hi(i,d,s,_),jh=!1;var nt=i.memoizedState;d.state=nt,qh(i,s,d,o),b=i.memoizedState,g!==s||nt!==b||Wf.current||jh?(typeof $=="function"&&(Di(i,a,$,s),b=i.memoizedState),(g=jh||Fi(i,a,g,s,nt,b,_))?(it||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(i.flags|=4194308)):(typeof d.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=s,i.memoizedState=b),d.props=s,d.state=b,d.context=_,s=g):(typeof d.componentDidMount=="function"&&(i.flags|=4194308),s=!1)}else{d=i.stateNode,lh(e,i),g=i.memoizedProps,_=i.type===i.elementType?g:Ci(i.type,g),d.props=_,it=i.pendingProps,nt=d.context,b=a.contextType,typeof b=="object"&&b!==null?b=eh(b):(b=Zf(a)?Xf:H.current,b=Yf(i,b));var tt=a.getDerivedStateFromProps;($=typeof tt=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(g!==it||nt!==b)&&Hi(i,d,s,b),jh=!1,nt=i.memoizedState,d.state=nt,qh(i,s,d,o);var at=i.memoizedState;g!==it||nt!==at||Wf.current||jh?(typeof tt=="function"&&(Di(i,a,tt,s),at=i.memoizedState),(_=jh||Fi(i,a,_,s,nt,at,b)||!1)?($||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(s,at,b),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(s,at,b)),typeof d.componentDidUpdate=="function"&&(i.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof d.componentDidUpdate!="function"||g===e.memoizedProps&&nt===e.memoizedState||(i.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&nt===e.memoizedState||(i.flags|=1024),i.memoizedProps=s,i.memoizedState=at),d.props=s,d.state=at,d.context=b,s=_):(typeof d.componentDidUpdate!="function"||g===e.memoizedProps&&nt===e.memoizedState||(i.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&nt===e.memoizedState||(i.flags|=1024),s=!1)}return jj(e,i,a,s,h,o)}function jj(e,i,a,s,o,h){gj(e,i);var d=(i.flags&128)!==0;if(!s&&!d)return o&&dg(i,a,!1),Zi(e,i,h);s=i.stateNode,Wi.current=i;var g=d&&typeof a.getDerivedStateFromError!="function"?null:s.render();return i.flags|=1,e!==null&&d?(i.child=Ug(i,e.child,null,h),i.child=Ug(i,null,g,h)):Xi(e,i,g,h),i.memoizedState=s.state,o&&dg(i,a,!0),i.child}function kj(e){var i=e.stateNode;i.pendingContext?ag(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(e,i.context,!1),yh(e,i.containerInfo)}function lj(e,i,a,s,o){return Ig(),Jg(o),i.flags|=256,Xi(e,i,a,s),i.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,i,a){var s=i.pendingProps,o=L.current,h=!1,d=(i.flags&128)!==0,g;if((g=d)||(g=e!==null&&e.memoizedState===null?!1:(o&2)!==0),g?(h=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),G(L,o&1),e===null)return Eg(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(d=s.children,e=s.fallback,h?(s=i.mode,h=i.child,d={mode:"hidden",children:d},!(s&1)&&h!==null?(h.childLanes=0,h.pendingProps=d):h=pj(d,s,0,null),e=Tg(e,s,a,null),h.return=i,e.return=i,h.sibling=e,i.child=h,i.child.memoizedState=nj(a),i.memoizedState=mj,e):qj(i,d));if(o=e.memoizedState,o!==null&&(g=o.dehydrated,g!==null))return rj(e,i,d,s,g,o,a);if(h){h=s.fallback,d=i.mode,o=e.child,g=o.sibling;var b={mode:"hidden",children:s.children};return!(d&1)&&i.child!==o?(s=i.child,s.childLanes=0,s.pendingProps=b,i.deletions=null):(s=Pg(o,b),s.subtreeFlags=o.subtreeFlags&14680064),g!==null?h=Pg(g,h):(h=Tg(h,d,a,null),h.flags|=2),h.return=i,s.return=i,s.sibling=h,i.child=s,s=h,h=i.child,d=e.child.memoizedState,d=d===null?nj(a):{baseLanes:d.baseLanes|a,cachePool:null,transitions:d.transitions},h.memoizedState=d,h.childLanes=e.childLanes&~a,i.memoizedState=mj,s}return h=e.child,e=h.sibling,s=Pg(h,{mode:"visible",children:s.children}),!(i.mode&1)&&(s.lanes=a),s.return=i,s.sibling=null,e!==null&&(a=i.deletions,a===null?(i.deletions=[e],i.flags|=16):a.push(e)),i.child=s,i.memoizedState=null,s}function qj(e,i){return i=pj({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function sj(e,i,a,s){return s!==null&&Jg(s),Ug(i,e.child,null,a),e=qj(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function rj(e,i,a,s,o,h,d){if(a)return i.flags&256?(i.flags&=-257,s=Ki(Error(p$1(422))),sj(e,i,d,s)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(h=s.fallback,o=i.mode,s=pj({mode:"visible",children:s.children},o,0,null),h=Tg(h,o,d,null),h.flags|=2,s.return=i,h.return=i,s.sibling=h,i.child=s,i.mode&1&&Ug(i,e.child,null,d),i.child.memoizedState=nj(d),i.memoizedState=mj,h);if(!(i.mode&1))return sj(e,i,d,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var g=s.dgst;return s=g,h=Error(p$1(419)),s=Ki(h,s,void 0),sj(e,i,d,s)}if(g=(d&e.childLanes)!==0,dh||g){if(s=Q,s!==null){switch(d&-d){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|d)?0:o,o!==0&&o!==h.retryLane&&(h.retryLane=o,ih(e,o),gi(s,e,o,-1))}return tj(),s=Ki(Error(p$1(421))),sj(e,i,d,s)}return o.data==="$?"?(i.flags|=128,i.child=e.child,i=uj.bind(null,e),o._reactRetry=i,null):(e=h.treeContext,yg=Lf(o.nextSibling),xg=i,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=i),i=qj(i,s.children),i.flags|=4096,i)}function vj(e,i,a){e.lanes|=i;var s=e.alternate;s!==null&&(s.lanes|=i),bh(e.return,i,a)}function wj(e,i,a,s,o){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:s,tail:a,tailMode:o}:(h.isBackwards=i,h.rendering=null,h.renderingStartTime=0,h.last=s,h.tail=a,h.tailMode=o)}function xj(e,i,a){var s=i.pendingProps,o=s.revealOrder,h=s.tail;if(Xi(e,i,s.children,a),s=L.current,s&2)s=s&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,a,i);else if(e.tag===19)vj(e,a,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(G(L,s),!(i.mode&1))i.memoizedState=null;else switch(o){case"forwards":for(a=i.child,o=null;a!==null;)e=a.alternate,e!==null&&Ch(e)===null&&(o=a),a=a.sibling;a=o,a===null?(o=i.child,i.child=null):(o=a.sibling,a.sibling=null),wj(i,!1,o,a,h);break;case"backwards":for(a=null,o=i.child,i.child=null;o!==null;){if(e=o.alternate,e!==null&&Ch(e)===null){i.child=o;break}e=o.sibling,o.sibling=a,a=o,o=e}wj(i,!0,a,null,h);break;case"together":wj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ij(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function Zi(e,i,a){if(e!==null&&(i.dependencies=e.dependencies),rh|=i.lanes,!(a&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(p$1(153));if(i.child!==null){for(e=i.child,a=Pg(e,e.pendingProps),i.child=a,a.return=i;e.sibling!==null;)e=e.sibling,a=a.sibling=Pg(e,e.pendingProps),a.return=i;a.sibling=null}return i.child}function yj(e,i,a){switch(i.tag){case 3:kj(i),Ig();break;case 5:Ah(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:yh(i,i.stateNode.containerInfo);break;case 10:var s=i.type._context,o=i.memoizedProps.value;G(Wg,s._currentValue),s._currentValue=o;break;case 13:if(s=i.memoizedState,s!==null)return s.dehydrated!==null?(G(L,L.current&1),i.flags|=128,null):a&i.child.childLanes?oj(e,i,a):(G(L,L.current&1),e=Zi(e,i,a),e!==null?e.sibling:null);G(L,L.current&1);break;case 19:if(s=(a&i.childLanes)!==0,e.flags&128){if(s)return xj(e,i,a);i.flags|=128}if(o=i.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),G(L,L.current),s)break;return null;case 22:case 23:return i.lanes=0,dj(e,i,a)}return Zi(e,i,a)}var zj,Aj,Bj,Cj;zj=function(e,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Aj=function(){};Bj=function(e,i,a,s){var o=e.memoizedProps;if(o!==s){e=i.stateNode,xh(uh.current);var h=null;switch(a){case"input":o=Ya(e,o),s=Ya(e,s),h=[];break;case"select":o=A({},o,{value:void 0}),s=A({},s,{value:void 0}),h=[];break;case"textarea":o=gb(e,o),s=gb(e,s),h=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Bf)}ub(a,s);var d;a=null;for(_ in o)if(!s.hasOwnProperty(_)&&o.hasOwnProperty(_)&&o[_]!=null)if(_==="style"){var g=o[_];for(d in g)g.hasOwnProperty(d)&&(a||(a={}),a[d]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ea.hasOwnProperty(_)?h||(h=[]):(h=h||[]).push(_,null));for(_ in s){var b=s[_];if(g=o!=null?o[_]:void 0,s.hasOwnProperty(_)&&b!==g&&(b!=null||g!=null))if(_==="style")if(g){for(d in g)!g.hasOwnProperty(d)||b&&b.hasOwnProperty(d)||(a||(a={}),a[d]="");for(d in b)b.hasOwnProperty(d)&&g[d]!==b[d]&&(a||(a={}),a[d]=b[d])}else a||(h||(h=[]),h.push(_,a)),a=b;else _==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,g=g?g.__html:void 0,b!=null&&g!==b&&(h=h||[]).push(_,b)):_==="children"?typeof b!="string"&&typeof b!="number"||(h=h||[]).push(_,""+b):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_)?(b!=null&&_==="onScroll"&&D("scroll",e),h||g===b||(h=[])):(h=h||[]).push(_,b))}a&&(h=h||[]).push("style",a);var _=h;(i.updateQueue=_)&&(i.flags|=4)}};Cj=function(e,i,a,s){a!==s&&(i.flags|=4)};function Dj(e,i){if(!I)switch(e.tailMode){case"hidden":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function S(e){var i=e.alternate!==null&&e.alternate.child===e.child,a=0,s=0;if(i)for(var o=e.child;o!==null;)a|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)a|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=a,i}function Ej(e,i,a){var s=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return s=i.stateNode,zh(),E(Wf),E(H),Eh(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Gg(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,i),S(i),null;case 5:Bh(i);var o=xh(wh.current);if(a=i.type,e!==null&&i.stateNode!=null)Bj(e,i,a,s,o),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!s){if(i.stateNode===null)throw Error(p$1(166));return S(i),null}if(e=xh(uh.current),Gg(i)){s=i.stateNode,a=i.type;var h=i.memoizedProps;switch(s[Of]=i,s[Pf]=h,e=(i.mode&1)!==0,a){case"dialog":D("cancel",s),D("close",s);break;case"iframe":case"object":case"embed":D("load",s);break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],s);break;case"source":D("error",s);break;case"img":case"image":case"link":D("error",s),D("load",s);break;case"details":D("toggle",s);break;case"input":Za(s,h),D("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!h.multiple},D("invalid",s);break;case"textarea":hb(s,h),D("invalid",s)}ub(a,h),o=null;for(var d in h)if(h.hasOwnProperty(d)){var g=h[d];d==="children"?typeof g=="string"?s.textContent!==g&&(h.suppressHydrationWarning!==!0&&Af(s.textContent,g,e),o=["children",g]):typeof g=="number"&&s.textContent!==""+g&&(h.suppressHydrationWarning!==!0&&Af(s.textContent,g,e),o=["children",""+g]):ea.hasOwnProperty(d)&&g!=null&&d==="onScroll"&&D("scroll",s)}switch(a){case"input":Va(s),db(s,h,!0);break;case"textarea":Va(s),jb(s);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(s.onclick=Bf)}s=o,i.updateQueue=s,s!==null&&(i.flags|=4)}else{d=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=d.createElement(a,{is:s.is}):(e=d.createElement(a),a==="select"&&(d=e,s.multiple?d.multiple=!0:s.size&&(d.size=s.size))):e=d.createElementNS(e,a),e[Of]=i,e[Pf]=s,zj(e,i,!1,!1),i.stateNode=e;t:{switch(d=vb(a,s),a){case"dialog":D("cancel",e),D("close",e),o=s;break;case"iframe":case"object":case"embed":D("load",e),o=s;break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],e);o=s;break;case"source":D("error",e),o=s;break;case"img":case"image":case"link":D("error",e),D("load",e),o=s;break;case"details":D("toggle",e),o=s;break;case"input":Za(e,s),o=Ya(e,s),D("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=A({},s,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,s),o=gb(e,s),D("invalid",e);break;default:o=s}ub(a,o),g=o;for(h in g)if(g.hasOwnProperty(h)){var b=g[h];h==="style"?sb(e,b):h==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&nb(e,b)):h==="children"?typeof b=="string"?(a!=="textarea"||b!=="")&&ob(e,b):typeof b=="number"&&ob(e,""+b):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ea.hasOwnProperty(h)?b!=null&&h==="onScroll"&&D("scroll",e):b!=null&&ta(e,h,b,d))}switch(a){case"input":Va(e),db(e,s,!1);break;case"textarea":Va(e),jb(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Sa(s.value));break;case"select":e.multiple=!!s.multiple,h=s.value,h!=null?fb(e,!!s.multiple,h,!1):s.defaultValue!=null&&fb(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Bf)}switch(a){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break t;case"img":s=!0;break t;default:s=!1}}s&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(e&&i.stateNode!=null)Cj(e,i,e.memoizedProps,s);else{if(typeof s!="string"&&i.stateNode===null)throw Error(p$1(166));if(a=xh(wh.current),xh(uh.current),Gg(i)){if(s=i.stateNode,a=i.memoizedProps,s[Of]=i,(h=s.nodeValue!==a)&&(e=xg,e!==null))switch(e.tag){case 3:Af(s.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(s.nodeValue,a,(e.mode&1)!==0)}h&&(i.flags|=4)}else s=(a.nodeType===9?a:a.ownerDocument).createTextNode(s),s[Of]=i,i.stateNode=s}return S(i),null;case 13:if(E(L),s=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,h=!1;else if(h=Gg(i),s!==null&&s.dehydrated!==null){if(e===null){if(!h)throw Error(p$1(318));if(h=i.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(p$1(317));h[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),h=!1}else zg!==null&&(Fj(zg),zg=null),h=!0;if(!h)return i.flags&65536?i:null}return i.flags&128?(i.lanes=a,i):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(i.child.flags|=8192,i.mode&1&&(e===null||L.current&1?T===0&&(T=3):tj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return zh(),Aj(e,i),e===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return ah(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E(L),h=i.memoizedState,h===null)return S(i),null;if(s=(i.flags&128)!==0,d=h.rendering,d===null)if(s)Dj(h,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(d=Ch(e),d!==null){for(i.flags|=128,Dj(h,!1),s=d.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),i.subtreeFlags=0,s=a,a=i.child;a!==null;)h=a,e=s,h.flags&=14680066,d=h.alternate,d===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=d.childLanes,h.lanes=d.lanes,h.child=d.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=d.memoizedProps,h.memoizedState=d.memoizedState,h.updateQueue=d.updateQueue,h.type=d.type,e=d.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return G(L,L.current&1|2),i.child}e=e.sibling}h.tail!==null&&B()>Gj&&(i.flags|=128,s=!0,Dj(h,!1),i.lanes=4194304)}else{if(!s)if(e=Ch(d),e!==null){if(i.flags|=128,s=!0,a=e.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),Dj(h,!0),h.tail===null&&h.tailMode==="hidden"&&!d.alternate&&!I)return S(i),null}else 2*B()-h.renderingStartTime>Gj&&a!==1073741824&&(i.flags|=128,s=!0,Dj(h,!1),i.lanes=4194304);h.isBackwards?(d.sibling=i.child,i.child=d):(a=h.last,a!==null?a.sibling=d:i.child=d,h.last=d)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=B(),i.sibling=null,a=L.current,G(L,s?a&1|2:a&1),i):(S(i),null);case 22:case 23:return Hj(),s=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(i.flags|=8192),s&&i.mode&1?fj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p$1(156,i.tag))}function Ij(e,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return zh(),E(Wf),E(H),Eh(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Bh(i),null;case 13:if(E(L),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(p$1(340));Ig()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,i){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(s){W(e,i,s)}else a.current=null}function Mj(e,i,a){try{a()}catch(s){W(e,i,s)}}var Nj=!1;function Oj(e,i){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var s=a.getSelection&&a.getSelection();if(s&&s.rangeCount!==0){a=s.anchorNode;var o=s.anchorOffset,h=s.focusNode;s=s.focusOffset;try{a.nodeType,h.nodeType}catch{a=null;break t}var d=0,g=-1,b=-1,_=0,$=0,it=e,nt=null;e:for(;;){for(var tt;it!==a||o!==0&&it.nodeType!==3||(g=d+o),it!==h||s!==0&&it.nodeType!==3||(b=d+s),it.nodeType===3&&(d+=it.nodeValue.length),(tt=it.firstChild)!==null;)nt=it,it=tt;for(;;){if(it===e)break e;if(nt===a&&++_===o&&(g=d),nt===h&&++$===s&&(b=d),(tt=it.nextSibling)!==null)break;it=nt,nt=it.parentNode}it=tt}a=g===-1||b===-1?null:{start:g,end:b}}else a=null}a=a||{start:0,end:0}}else a=null;for(Df={focusedElem:e,selectionRange:a},dd=!1,V=i;V!==null;)if(i=V,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,V=e;else for(;V!==null;){i=V;try{var at=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(at!==null){var ut=at.memoizedProps,ft=at.memoizedState,ht=i.stateNode,dt=ht.getSnapshotBeforeUpdate(i.elementType===i.type?ut:Ci(i.type,ut),ft);ht.__reactInternalSnapshotBeforeUpdate=dt}break;case 3:var st=i.stateNode.containerInfo;st.nodeType===1?st.textContent="":st.nodeType===9&&st.documentElement&&st.removeChild(st.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(ct){W(i,i.return,ct)}if(e=i.sibling,e!==null){e.return=i.return,V=e;break}V=i.return}return at=Nj,Nj=!1,at}function Pj(e,i,a){var s=i.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var h=o.destroy;o.destroy=void 0,h!==void 0&&Mj(i,a,h)}o=o.next}while(o!==s)}}function Qj(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var s=a.create;a.destroy=s()}a=a.next}while(a!==i)}}function Rj(e){var i=e.ref;if(i!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof i=="function"?i(e):i.current=e}}function Sj(e){var i=e.alternate;i!==null&&(e.alternate=null,Sj(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,i,a){var s=e.tag;if(s===5||s===6)e=e.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(e,i):a.insertBefore(e,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(e,a)):(i=a,i.appendChild(e)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=Bf));else if(s!==4&&(e=e.child,e!==null))for(Vj(e,i,a),e=e.sibling;e!==null;)Vj(e,i,a),e=e.sibling}function Wj(e,i,a){var s=e.tag;if(s===5||s===6)e=e.stateNode,i?a.insertBefore(e,i):a.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Wj(e,i,a),e=e.sibling;e!==null;)Wj(e,i,a),e=e.sibling}var X=null,Xj=!1;function Yj(e,i,a){for(a=a.child;a!==null;)Zj(e,i,a),a=a.sibling}function Zj(e,i,a){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,a)}catch{}switch(a.tag){case 5:U||Lj(a,i);case 6:var s=X,o=Xj;X=null,Yj(e,i,a),X=s,Xj=o,X!==null&&(Xj?(e=X,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):X.removeChild(a.stateNode));break;case 18:X!==null&&(Xj?(e=X,a=a.stateNode,e.nodeType===8?Kf(e.parentNode,a):e.nodeType===1&&Kf(e,a),bd(e)):Kf(X,a.stateNode));break;case 4:s=X,o=Xj,X=a.stateNode.containerInfo,Xj=!0,Yj(e,i,a),X=s,Xj=o;break;case 0:case 11:case 14:case 15:if(!U&&(s=a.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var h=o,d=h.destroy;h=h.tag,d!==void 0&&(h&2||h&4)&&Mj(a,i,d),o=o.next}while(o!==s)}Yj(e,i,a);break;case 1:if(!U&&(Lj(a,i),s=a.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=a.memoizedProps,s.state=a.memoizedState,s.componentWillUnmount()}catch(g){W(a,i,g)}Yj(e,i,a);break;case 21:Yj(e,i,a);break;case 22:a.mode&1?(U=(s=U)||a.memoizedState!==null,Yj(e,i,a),U=s):Yj(e,i,a);break;default:Yj(e,i,a)}}function ak(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new Kj),i.forEach(function(s){var o=bk.bind(null,e,s);a.has(s)||(a.add(s),s.then(o,o))})}}function ck(e,i){var a=i.deletions;if(a!==null)for(var s=0;s<a.length;s++){var o=a[s];try{var h=e,d=i,g=d;t:for(;g!==null;){switch(g.tag){case 5:X=g.stateNode,Xj=!1;break t;case 3:X=g.stateNode.containerInfo,Xj=!0;break t;case 4:X=g.stateNode.containerInfo,Xj=!0;break t}g=g.return}if(X===null)throw Error(p$1(160));Zj(h,d,o),X=null,Xj=!1;var b=o.alternate;b!==null&&(b.return=null),o.return=null}catch(_){W(o,i,_)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)dk(i,e),i=i.sibling}function dk(e,i){var a=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(i,e),ek(e),s&4){try{Pj(3,e,e.return),Qj(3,e)}catch(ut){W(e,e.return,ut)}try{Pj(5,e,e.return)}catch(ut){W(e,e.return,ut)}}break;case 1:ck(i,e),ek(e),s&512&&a!==null&&Lj(a,a.return);break;case 5:if(ck(i,e),ek(e),s&512&&a!==null&&Lj(a,a.return),e.flags&32){var o=e.stateNode;try{ob(o,"")}catch(ut){W(e,e.return,ut)}}if(s&4&&(o=e.stateNode,o!=null)){var h=e.memoizedProps,d=a!==null?a.memoizedProps:h,g=e.type,b=e.updateQueue;if(e.updateQueue=null,b!==null)try{g==="input"&&h.type==="radio"&&h.name!=null&&ab(o,h),vb(g,d);var _=vb(g,h);for(d=0;d<b.length;d+=2){var $=b[d],it=b[d+1];$==="style"?sb(o,it):$==="dangerouslySetInnerHTML"?nb(o,it):$==="children"?ob(o,it):ta(o,$,it,_)}switch(g){case"input":bb(o,h);break;case"textarea":ib(o,h);break;case"select":var nt=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!h.multiple;var tt=h.value;tt!=null?fb(o,!!h.multiple,tt,!1):nt!==!!h.multiple&&(h.defaultValue!=null?fb(o,!!h.multiple,h.defaultValue,!0):fb(o,!!h.multiple,h.multiple?[]:"",!1))}o[Pf]=h}catch(ut){W(e,e.return,ut)}}break;case 6:if(ck(i,e),ek(e),s&4){if(e.stateNode===null)throw Error(p$1(162));o=e.stateNode,h=e.memoizedProps;try{o.nodeValue=h}catch(ut){W(e,e.return,ut)}}break;case 3:if(ck(i,e),ek(e),s&4&&a!==null&&a.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(ut){W(e,e.return,ut)}break;case 4:ck(i,e),ek(e);break;case 13:ck(i,e),ek(e),o=e.child,o.flags&8192&&(h=o.memoizedState!==null,o.stateNode.isHidden=h,!h||o.alternate!==null&&o.alternate.memoizedState!==null||(fk=B())),s&4&&ak(e);break;case 22:if($=a!==null&&a.memoizedState!==null,e.mode&1?(U=(_=U)||$,ck(i,e),U=_):ck(i,e),ek(e),s&8192){if(_=e.memoizedState!==null,(e.stateNode.isHidden=_)&&!$&&e.mode&1)for(V=e,$=e.child;$!==null;){for(it=V=$;V!==null;){switch(nt=V,tt=nt.child,nt.tag){case 0:case 11:case 14:case 15:Pj(4,nt,nt.return);break;case 1:Lj(nt,nt.return);var at=nt.stateNode;if(typeof at.componentWillUnmount=="function"){s=nt,a=nt.return;try{i=s,at.props=i.memoizedProps,at.state=i.memoizedState,at.componentWillUnmount()}catch(ut){W(s,a,ut)}}break;case 5:Lj(nt,nt.return);break;case 22:if(nt.memoizedState!==null){gk(it);continue}}tt!==null?(tt.return=nt,V=tt):gk(it)}$=$.sibling}t:for($=null,it=e;;){if(it.tag===5){if($===null){$=it;try{o=it.stateNode,_?(h=o.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(g=it.stateNode,b=it.memoizedProps.style,d=b!=null&&b.hasOwnProperty("display")?b.display:null,g.style.display=rb("display",d))}catch(ut){W(e,e.return,ut)}}}else if(it.tag===6){if($===null)try{it.stateNode.nodeValue=_?"":it.memoizedProps}catch(ut){W(e,e.return,ut)}}else if((it.tag!==22&&it.tag!==23||it.memoizedState===null||it===e)&&it.child!==null){it.child.return=it,it=it.child;continue}if(it===e)break t;for(;it.sibling===null;){if(it.return===null||it.return===e)break t;$===it&&($=null),it=it.return}$===it&&($=null),it.sibling.return=it.return,it=it.sibling}}break;case 19:ck(i,e),ek(e),s&4&&ak(e);break;case 21:break;default:ck(i,e),ek(e)}}function ek(e){var i=e.flags;if(i&2){try{t:{for(var a=e.return;a!==null;){if(Tj(a)){var s=a;break t}a=a.return}throw Error(p$1(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(ob(o,""),s.flags&=-33);var h=Uj(e);Wj(e,h,o);break;case 3:case 4:var d=s.stateNode.containerInfo,g=Uj(e);Vj(e,g,d);break;default:throw Error(p$1(161))}}catch(b){W(e,e.return,b)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function hk(e,i,a){V=e,ik(e)}function ik(e,i,a){for(var s=(e.mode&1)!==0;V!==null;){var o=V,h=o.child;if(o.tag===22&&s){var d=o.memoizedState!==null||Jj;if(!d){var g=o.alternate,b=g!==null&&g.memoizedState!==null||U;g=Jj;var _=U;if(Jj=d,(U=b)&&!_)for(V=o;V!==null;)d=V,b=d.child,d.tag===22&&d.memoizedState!==null?jk(o):b!==null?(b.return=d,V=b):jk(o);for(;h!==null;)V=h,ik(h),h=h.sibling;V=o,Jj=g,U=_}kk(e)}else o.subtreeFlags&8772&&h!==null?(h.return=o,V=h):kk(e)}}function kk(e){for(;V!==null;){var i=V;if(i.flags&8772){var a=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U||Qj(5,i);break;case 1:var s=i.stateNode;if(i.flags&4&&!U)if(a===null)s.componentDidMount();else{var o=i.elementType===i.type?a.memoizedProps:Ci(i.type,a.memoizedProps);s.componentDidUpdate(o,a.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var h=i.updateQueue;h!==null&&sh(i,h,s);break;case 3:var d=i.updateQueue;if(d!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}sh(i,d,a)}break;case 5:var g=i.stateNode;if(a===null&&i.flags&4){a=g;var b=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&a.focus();break;case"img":b.src&&(a.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var _=i.alternate;if(_!==null){var $=_.memoizedState;if($!==null){var it=$.dehydrated;it!==null&&bd(it)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||i.flags&512&&Rj(i)}catch(nt){W(i,i.return,nt)}}if(i===e){V=null;break}if(a=i.sibling,a!==null){a.return=i.return,V=a;break}V=i.return}}function gk(e){for(;V!==null;){var i=V;if(i===e){V=null;break}var a=i.sibling;if(a!==null){a.return=i.return,V=a;break}V=i.return}}function jk(e){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Qj(4,i)}catch(b){W(i,a,b)}break;case 1:var s=i.stateNode;if(typeof s.componentDidMount=="function"){var o=i.return;try{s.componentDidMount()}catch(b){W(i,o,b)}}var h=i.return;try{Rj(i)}catch(b){W(i,h,b)}break;case 5:var d=i.return;try{Rj(i)}catch(b){W(i,d,b)}}}catch(b){W(i,i.return,b)}if(i===e){V=null;break}var g=i.sibling;if(g!==null){g.return=i.return,V=g;break}V=i.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y$1=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,i,a,s){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(e,a,s),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=a),T===4&&Ck(e,Z)),Dk(e,s),a===1&&K===0&&!(i.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(e,i){var a=e.callbackNode;wc(e,i);var s=uc(e,e===Q?Z:0);if(s===0)a!==null&&bc(a),e.callbackNode=null,e.callbackPriority=0;else if(i=s&-s,e.callbackPriority!==i){if(a!=null&&bc(a),i===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),a=null;else{switch(Dc(s)){case 1:a=fc;break;case 4:a=gc;break;case 16:a=hc;break;case 536870912:a=jc;break;default:a=hc}a=Fk(a,Gk.bind(null,e))}e.callbackPriority=i,e.callbackNode=a}}function Gk(e,i){if(Ak=-1,Bk=0,K&6)throw Error(p$1(327));var a=e.callbackNode;if(Hk()&&e.callbackNode!==a)return null;var s=uc(e,e===Q?Z:0);if(s===0)return null;if(s&30||s&e.expiredLanes||i)i=Ik(e,s);else{i=s;var o=K;K|=2;var h=Jk();(Q!==e||Z!==i)&&(uk=null,Gj=B()+500,Kk(e,i));do try{Lk();break}catch(g){Mk(e,g)}while(!0);$g(),mk.current=h,K=o,Y$1!==null?i=0:(Q=null,Z=0,i=T)}if(i!==0){if(i===2&&(o=xc(e),o!==0&&(s=o,i=Nk(e,o))),i===1)throw a=pk,Kk(e,0),Ck(e,s),Dk(e,B()),a;if(i===6)Ck(e,s);else{if(o=e.current.alternate,!(s&30)&&!Ok(o)&&(i=Ik(e,s),i===2&&(h=xc(e),h!==0&&(s=h,i=Nk(e,h))),i===1))throw a=pk,Kk(e,0),Ck(e,s),Dk(e,B()),a;switch(e.finishedWork=o,e.finishedLanes=s,i){case 0:case 1:throw Error(p$1(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,s),(s&130023424)===s&&(i=fk+500-B(),10<i)){if(uc(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){R$1(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),i);break}Pk(e,tk,uk);break;case 4:if(Ck(e,s),(s&4194240)===s)break;for(i=e.eventTimes,o=-1;0<s;){var d=31-oc(s);h=1<<d,d=i[d],d>o&&(o=d),s&=~h}if(s=o,s=B()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*lk(s/1960))-s,10<s){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),s);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(e,B()),e.callbackNode===a?Gk.bind(null,e):null}function Nk(e,i){var a=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,i).flags|=256),e=Ik(e,i),e!==2&&(i=tk,tk=a,i!==null&&Fj(i)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var i=e;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var s=0;s<a.length;s++){var o=a[s],h=o.getSnapshot;o=o.value;try{if(!He(h(),o))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ck(e,i){for(i&=~rk,i&=~qk,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var a=31-oc(i),s=1<<a;e[a]=-1,i&=~s}}function Ek(e){if(K&6)throw Error(p$1(327));Hk();var i=uc(e,0);if(!(i&1))return Dk(e,B()),null;var a=Ik(e,i);if(e.tag!==0&&a===2){var s=xc(e);s!==0&&(i=s,a=Nk(e,s))}if(a===1)throw a=pk,Kk(e,0),Ck(e,i),Dk(e,B()),a;if(a===6)throw Error(p$1(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,i){var a=K;K|=1;try{return e(i)}finally{K=a,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var i=K;K|=1;var a=ok.transition,s=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=s,ok.transition=a,K=i,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(e,i){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,Gf(a)),Y$1!==null)for(a=Y$1.return;a!==null;){var s=a;switch(wg(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(s);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(s.type._context);break;case 22:case 23:Hj()}a=a.return}if(Q=e,Y$1=e=Pg(e.current,null),Z=fj=i,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(i=0;i<fh.length;i++)if(a=fh[i],s=a.interleaved,s!==null){a.interleaved=null;var o=s.next,h=a.pending;if(h!==null){var d=h.next;h.next=o,s.next=d}a.pending=s}fh=null}return e}function Mk(e,i){do{var a=Y$1;try{if($g(),Fh.current=Rh,Ih){for(var s=M.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,a===null||a.return===null){T=1,pk=i,Y$1=null;break}t:{var h=e,d=a.return,g=a,b=i;if(i=Z,g.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var _=b,$=g,it=$.tag;if(!($.mode&1)&&(it===0||it===11||it===15)){var nt=$.alternate;nt?($.updateQueue=nt.updateQueue,$.memoizedState=nt.memoizedState,$.lanes=nt.lanes):($.updateQueue=null,$.memoizedState=null)}var tt=Ui(d);if(tt!==null){tt.flags&=-257,Vi(tt,d,g,h,i),tt.mode&1&&Si(h,_,i),i=tt,b=_;var at=i.updateQueue;if(at===null){var ut=new Set;ut.add(b),i.updateQueue=ut}else at.add(b);break t}else{if(!(i&1)){Si(h,_,i),tj();break t}b=Error(p$1(426))}}else if(I&&g.mode&1){var ft=Ui(d);if(ft!==null){!(ft.flags&65536)&&(ft.flags|=256),Vi(ft,d,g,h,i),Jg(Ji(b,g));break t}}h=b=Ji(b,g),T!==4&&(T=2),sk===null?sk=[h]:sk.push(h),h=d;do{switch(h.tag){case 3:h.flags|=65536,i&=-i,h.lanes|=i;var ht=Ni(h,b,i);ph(h,ht);break t;case 1:g=b;var dt=h.type,st=h.stateNode;if(!(h.flags&128)&&(typeof dt.getDerivedStateFromError=="function"||st!==null&&typeof st.componentDidCatch=="function"&&(Ri===null||!Ri.has(st)))){h.flags|=65536,i&=-i,h.lanes|=i;var ct=Qi(h,g,i);ph(h,ct);break t}}h=h.return}while(h!==null)}Sk(a)}catch(wt){i=wt,Y$1===a&&a!==null&&(Y$1=a=a.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,i){var a=K;K|=2;var s=Jk();(Q!==e||Z!==i)&&(uk=null,Kk(e,i));do try{Tk();break}catch(o){Mk(e,o)}while(!0);if($g(),K=a,mk.current=s,Y$1!==null)throw Error(p$1(261));return Q=null,Z=0,T}function Tk(){for(;Y$1!==null;)Uk(Y$1)}function Lk(){for(;Y$1!==null&&!cc();)Uk(Y$1)}function Uk(e){var i=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,i===null?Sk(e):Y$1=i,nk.current=null}function Sk(e){var i=e;do{var a=i.alternate;if(e=i.return,i.flags&32768){if(a=Ij(a,i),a!==null){a.flags&=32767,Y$1=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y$1=null;return}}else if(a=Ej(a,i,fj),a!==null){Y$1=a;return}if(i=i.sibling,i!==null){Y$1=i;return}Y$1=i=e}while(i!==null);T===0&&(T=5)}function Pk(e,i,a){var s=C,o=ok.transition;try{ok.transition=null,C=1,Wk(e,i,a,s)}finally{ok.transition=o,C=s}return null}function Wk(e,i,a,s){do Hk();while(wk!==null);if(K&6)throw Error(p$1(327));a=e.finishedWork;var o=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(p$1(177));e.callbackNode=null,e.callbackPriority=0;var h=a.lanes|a.childLanes;if(Bc(e,h),e===Q&&(Y$1=Q=null,Z=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),h=(a.flags&15990)!==0,a.subtreeFlags&15990||h){h=ok.transition,ok.transition=null;var d=C;C=1;var g=K;K|=4,nk.current=null,Oj(e,a),dk(a,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=a,hk(a),dc(),K=g,C=d,ok.transition=h}else e.current=a;if(vk&&(vk=!1,wk=e,xk=o),h=e.pendingLanes,h===0&&(Ri=null),mc(a.stateNode),Dk(e,B()),i!==null)for(s=e.onRecoverableError,a=0;a<i.length;a++)o=i[a],s(o.value,{componentStack:o.stack,digest:o.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),h=e.pendingLanes,h&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),i=ok.transition,a=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var s=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p$1(331));var o=K;for(K|=4,V=e.current;V!==null;){var h=V,d=h.child;if(V.flags&16){var g=h.deletions;if(g!==null){for(var b=0;b<g.length;b++){var _=g[b];for(V=_;V!==null;){var $=V;switch($.tag){case 0:case 11:case 15:Pj(8,$,h)}var it=$.child;if(it!==null)it.return=$,V=it;else for(;V!==null;){$=V;var nt=$.sibling,tt=$.return;if(Sj($),$===_){V=null;break}if(nt!==null){nt.return=tt,V=nt;break}V=tt}}}var at=h.alternate;if(at!==null){var ut=at.child;if(ut!==null){at.child=null;do{var ft=ut.sibling;ut.sibling=null,ut=ft}while(ut!==null)}}V=h}}if(h.subtreeFlags&2064&&d!==null)d.return=h,V=d;else t:for(;V!==null;){if(h=V,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Pj(9,h,h.return)}var ht=h.sibling;if(ht!==null){ht.return=h.return,V=ht;break t}V=h.return}}var dt=e.current;for(V=dt;V!==null;){d=V;var st=d.child;if(d.subtreeFlags&2064&&st!==null)st.return=d,V=st;else t:for(d=dt;V!==null;){if(g=V,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Qj(9,g)}}catch(wt){W(g,g.return,wt)}if(g===d){V=null;break t}var ct=g.sibling;if(ct!==null){ct.return=g.return,V=ct;break t}V=g.return}}if(K=o,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}s=!0}return s}finally{C=a,ok.transition=i}}return!1}function Xk(e,i,a){i=Ji(a,i),i=Ni(e,i,1),e=nh(e,i,1),i=R$1(),e!==null&&(Ac(e,1,i),Dk(e,i))}function W(e,i,a){if(e.tag===3)Xk(e,e,a);else for(;i!==null;){if(i.tag===3){Xk(i,e,a);break}else if(i.tag===1){var s=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ri===null||!Ri.has(s))){e=Ji(a,e),e=Qi(i,e,1),i=nh(i,e,1),e=R$1(),i!==null&&(Ac(i,1,e),Dk(i,e));break}}i=i.return}}function Ti(e,i,a){var s=e.pingCache;s!==null&&s.delete(i),i=R$1(),e.pingedLanes|=e.suspendedLanes&a,Q===e&&(Z&a)===a&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=a),Dk(e,i)}function Yk(e,i){i===0&&(e.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var a=R$1();e=ih(e,i),e!==null&&(Ac(e,i,a),Dk(e,a))}function uj(e){var i=e.memoizedState,a=0;i!==null&&(a=i.retryLane),Yk(e,a)}function bk(e,i){var a=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(a=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(p$1(314))}s!==null&&s.delete(i),Yk(e,a)}var Vk;Vk=function(e,i,a){if(e!==null)if(e.memoizedProps!==i.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&a)&&!(i.flags&128))return dh=!1,yj(e,i,a);dh=!!(e.flags&131072)}else dh=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var s=i.type;ij(e,i),e=i.pendingProps;var o=Yf(i,H.current);ch(i,a),o=Nh(null,i,s,e,o,a);var h=Sh();return i.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf(s)?(h=!0,cg(i)):h=!1,i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,kh(i),o.updater=Ei,i.stateNode=o,o._reactInternals=i,Ii(i,s,e,a),i=jj(null,i,s,!0,h,a)):(i.tag=0,I&&h&&vg(i),Xi(null,i,o,a),i=i.child),i;case 16:s=i.elementType;t:{switch(ij(e,i),e=i.pendingProps,o=s._init,s=o(s._payload),i.type=s,o=i.tag=Zk(s),e=Ci(s,e),o){case 0:i=cj(null,i,s,e,a);break t;case 1:i=hj(null,i,s,e,a);break t;case 11:i=Yi(null,i,s,e,a);break t;case 14:i=$i(null,i,s,Ci(s.type,e),a);break t}throw Error(p$1(306,s,""))}return i;case 0:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),cj(e,i,s,o,a);case 1:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),hj(e,i,s,o,a);case 3:t:{if(kj(i),e===null)throw Error(p$1(387));s=i.pendingProps,h=i.memoizedState,o=h.element,lh(e,i),qh(i,s,null,a);var d=i.memoizedState;if(s=d.element,h.isDehydrated)if(h={element:s,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},i.updateQueue.baseState=h,i.memoizedState=h,i.flags&256){o=Ji(Error(p$1(423)),i),i=lj(e,i,s,a,o);break t}else if(s!==o){o=Ji(Error(p$1(424)),i),i=lj(e,i,s,a,o);break t}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,a=Vg(i,null,s,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ig(),s===o){i=Zi(e,i,a);break t}Xi(e,i,s,a)}i=i.child}return i;case 5:return Ah(i),e===null&&Eg(i),s=i.type,o=i.pendingProps,h=e!==null?e.memoizedProps:null,d=o.children,Ef(s,o)?d=null:h!==null&&Ef(s,h)&&(i.flags|=32),gj(e,i),Xi(e,i,d,a),i.child;case 6:return e===null&&Eg(i),null;case 13:return oj(e,i,a);case 4:return yh(i,i.stateNode.containerInfo),s=i.pendingProps,e===null?i.child=Ug(i,null,s,a):Xi(e,i,s,a),i.child;case 11:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),Yi(e,i,s,o,a);case 7:return Xi(e,i,i.pendingProps,a),i.child;case 8:return Xi(e,i,i.pendingProps.children,a),i.child;case 12:return Xi(e,i,i.pendingProps.children,a),i.child;case 10:t:{if(s=i.type._context,o=i.pendingProps,h=i.memoizedProps,d=o.value,G(Wg,s._currentValue),s._currentValue=d,h!==null)if(He(h.value,d)){if(h.children===o.children&&!Wf.current){i=Zi(e,i,a);break t}}else for(h=i.child,h!==null&&(h.return=i);h!==null;){var g=h.dependencies;if(g!==null){d=h.child;for(var b=g.firstContext;b!==null;){if(b.context===s){if(h.tag===1){b=mh(-1,a&-a),b.tag=2;var _=h.updateQueue;if(_!==null){_=_.shared;var $=_.pending;$===null?b.next=b:(b.next=$.next,$.next=b),_.pending=b}}h.lanes|=a,b=h.alternate,b!==null&&(b.lanes|=a),bh(h.return,a,i),g.lanes|=a;break}b=b.next}}else if(h.tag===10)d=h.type===i.type?null:h.child;else if(h.tag===18){if(d=h.return,d===null)throw Error(p$1(341));d.lanes|=a,g=d.alternate,g!==null&&(g.lanes|=a),bh(d,a,i),d=h.sibling}else d=h.child;if(d!==null)d.return=h;else for(d=h;d!==null;){if(d===i){d=null;break}if(h=d.sibling,h!==null){h.return=d.return,d=h;break}d=d.return}h=d}Xi(e,i,o.children,a),i=i.child}return i;case 9:return o=i.type,s=i.pendingProps.children,ch(i,a),o=eh(o),s=s(o),i.flags|=1,Xi(e,i,s,a),i.child;case 14:return s=i.type,o=Ci(s,i.pendingProps),o=Ci(s.type,o),$i(e,i,s,o,a);case 15:return bj(e,i,i.type,i.pendingProps,a);case 17:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),ij(e,i),i.tag=1,Zf(s)?(e=!0,cg(i)):e=!1,ch(i,a),Gi(i,s,o),Ii(i,s,o,a),jj(null,i,s,!0,e,a);case 19:return xj(e,i,a);case 22:return dj(e,i,a)}throw Error(p$1(156,i.tag))};function Fk(e,i){return ac(e,i)}function $k(e,i,a,s){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,i,a,s){return new $k(e,i,a,s)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,i){var a=e.alternate;return a===null?(a=Bg(e.tag,i,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=i,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,i=e.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Rg(e,i,a,s,o,h){var d=2;if(s=e,typeof e=="function")aj(e)&&(d=1);else if(typeof e=="string")d=5;else t:switch(e){case ya:return Tg(a.children,o,h,i);case za:d=8,o|=8;break;case Aa:return e=Bg(12,a,i,o|2),e.elementType=Aa,e.lanes=h,e;case Ea:return e=Bg(13,a,i,o),e.elementType=Ea,e.lanes=h,e;case Fa:return e=Bg(19,a,i,o),e.elementType=Fa,e.lanes=h,e;case Ia:return pj(a,o,h,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:d=10;break t;case Ca:d=9;break t;case Da:d=11;break t;case Ga:d=14;break t;case Ha:d=16,s=null;break t}throw Error(p$1(130,e==null?e:typeof e,""))}return i=Bg(d,a,i,o),i.elementType=e,i.type=s,i.lanes=h,i}function Tg(e,i,a,s){return e=Bg(7,e,s,i),e.lanes=a,e}function pj(e,i,a,s){return e=Bg(22,e,s,i),e.elementType=Ia,e.lanes=a,e.stateNode={isHidden:!1},e}function Qg(e,i,a){return e=Bg(6,e,null,i),e.lanes=a,e}function Sg(e,i,a){return i=Bg(4,e.children!==null?e.children:[],e.key,i),i.lanes=a,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function al(e,i,a,s,o){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function bl(e,i,a,s,o,h,d,g,b){return e=new al(e,i,a,g,b),i===1?(i=1,h===!0&&(i|=8)):i=0,h=Bg(3,null,null,i),e.current=h,h.stateNode=e,h.memoizedState={element:s,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(h),e}function cl(e,i,a){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:s==null?null:""+s,children:e,containerInfo:i,implementation:a}}function dl(e){if(!e)return Vf;e=e._reactInternals;t:{if(Vb(e)!==e||e.tag!==1)throw Error(p$1(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(i!==null);throw Error(p$1(171))}if(e.tag===1){var a=e.type;if(Zf(a))return bg(e,a,i)}return i}function el(e,i,a,s,o,h,d,g,b){return e=bl(a,s,!0,e,o,h,d,g,b),e.context=dl(null),a=e.current,s=R$1(),o=yi(a),h=mh(s,o),h.callback=i??null,nh(a,h,o),e.current.lanes=o,Ac(e,o,s),Dk(e,s),e}function fl(e,i,a,s){var o=i.current,h=R$1(),d=yi(o);return a=dl(a),i.context===null?i.context=a:i.pendingContext=a,i=mh(h,d),i.payload={element:e},s=s===void 0?null:s,s!==null&&(i.callback=s),e=nh(o,i,d),e!==null&&(gi(e,o,d,h),oh(e,o,d)),d}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<i?a:i}}function il(e,i){hl(e,i),(e=e.alternate)&&hl(e,i)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(p$1(409));fl(e,i,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Rk(function(){fl(null,e,null,null)}),i[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var i=Hc();e={blockedOn:null,target:e,priority:i};for(var a=0;a<Qc.length&&i!==0&&i<Qc[a].priority;a++);Qc.splice(a,0,e),a===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,i,a,s,o){if(o){if(typeof s=="function"){var h=s;s=function(){var _=gl(d);h.call(_)}}var d=el(i,s,e,0,null,!1,!1,"",pl);return e._reactRootContainer=d,e[uf]=d.current,sf(e.nodeType===8?e.parentNode:e),Rk(),d}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var g=s;s=function(){var _=gl(b);g.call(_)}}var b=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=b,e[uf]=b.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl(i,b,a,s)}),b}function rl(e,i,a,s,o){var h=a._reactRootContainer;if(h){var d=h;if(typeof o=="function"){var g=o;o=function(){var b=gl(d);g.call(b)}}fl(i,d,e,o)}else d=ql(a,i,e,o,s);return gl(d)}Ec=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var a=tc(i.pendingLanes);a!==0&&(Cc(i,a|1),Dk(i,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var s=ih(e,1);if(s!==null){var o=R$1();gi(s,e,1,o)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var i=ih(e,134217728);if(i!==null){var a=R$1();gi(i,e,134217728,a)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var i=yi(e),a=ih(e,i);if(a!==null){var s=R$1();gi(a,e,i,s)}il(e,i)}};Hc=function(){return C};Ic=function(e,i){var a=C;try{return C=e,i()}finally{C=a}};yb=function(e,i,a){switch(i){case"input":if(bb(e,a),i=a.name,a.type==="radio"&&i!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var s=a[i];if(s!==e&&s.form===e.form){var o=Db(s);if(!o)throw Error(p$1(90));Wa(s),bb(s,o)}}}break;case"textarea":ib(e,a);break;case"select":i=a.value,i!=null&&fb(e,!!a.multiple,i,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(i))throw Error(p$1(200));return cl(e,i,null,a)};reactDom_production_min.createRoot=function(e,i){if(!nl(e))throw Error(p$1(299));var a=!1,s="",o=kl;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(o=i.onRecoverableError)),i=bl(e,1,!1,null,null,a,!1,s,o),e[uf]=i.current,sf(e.nodeType===8?e.parentNode:e),new ll(i)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(p$1(188)):(e=Object.keys(e).join(","),Error(p$1(268,e)));return e=Zb(i),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,i,a){if(!ol(i))throw Error(p$1(200));return rl(null,e,i,!0,a)};reactDom_production_min.hydrateRoot=function(e,i,a){if(!nl(e))throw Error(p$1(405));var s=a!=null&&a.hydratedSources||null,o=!1,h="",d=kl;if(a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onRecoverableError!==void 0&&(d=a.onRecoverableError)),i=el(i,null,e,1,a??null,o,!1,h,d),e[uf]=i.current,sf(e),s)for(e=0;e<s.length;e++)a=s[e],o=a._getVersion,o=o(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,o]:i.mutableSourceEagerHydrationData.push(a,o);return new ml(i)};reactDom_production_min.render=function(e,i,a){if(!ol(i))throw Error(p$1(200));return rl(null,e,i,!1,a)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p$1(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,i,a,s){if(!ol(a))throw Error(p$1(200));if(e==null||e._reactInternals===void 0)throw Error(p$1(38));return rl(e,i,a,!1,s)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;var Yt=Object.defineProperty,Bt=e=>{throw TypeError(e)},Zt=(e,i,a)=>i in e?Yt(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,$e=(e,i,a)=>Zt(e,typeof i!="symbol"?i+"":i,a),Tt=(e,i,a)=>i.has(e)||Bt("Cannot "+a),St=(e,i,a)=>(Tt(e,i,"read from private field"),a?a.call(e):i.get(e)),It=(e,i,a)=>i.has(e)?Bt("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,a),Dt=(e,i,a,s)=>(Tt(e,i,"write to private field"),i.set(e,a),a),$t=(e,i,a)=>(Tt(e,i,"access private method"),a),m=Object.defineProperty,p=(e,i,a)=>i in e?m(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,c=(e,i,a)=>p(e,typeof i!="symbol"?i+"":i,a);class R{constructor(){c(this,"device"),c(this,"server"),c(this,"txCharacteristic"),c(this,"rxCharacteristic"),c(this,"SERVICE_UUID","7a230001-5475-a6a4-654c-8431f6ad49c4"),c(this,"TX_CHARACTERISTIC_UUID","7a230002-5475-a6a4-654c-8431f6ad49c4"),c(this,"RX_CHARACTERISTIC_UUID","7a230003-5475-a6a4-654c-8431f6ad49c4"),c(this,"maxPayload",60),c(this,"awaitingPrintResponse",!1),c(this,"awaitingDataResponse",!1),c(this,"printTimeoutId"),c(this,"printResponsePromise"),c(this,"printResolve"),c(this,"dataResponsePromise"),c(this,"dataResolve"),c(this,"onDataResponse"),c(this,"onPrintResponse"),c(this,"onDisconnectHandler"),c(this,"handleDisconnect",()=>{this.device=void 0,this.server=void 0,this.txCharacteristic=void 0,this.rxCharacteristic=void 0,this.onDisconnectHandler&&this.onDisconnectHandler()}),c(this,"notificationHandler",i=>{const a=i.target.value;if(!(!a||a.buffer.byteLength===0))if(a.byteLength>0&&a.getUint8(0)===1){const s=new Uint8Array(a.buffer,a.byteOffset+1,a.byteLength-1);if(this.awaitingDataResponse&&this.dataResolve&&(this.awaitingDataResponse=!1,this.dataResolve(s)),this.onDataResponse){const o=this.onDataResponse(s);o instanceof Promise&&o.catch(console.error)}}else{const s=new TextDecoder().decode(a);if(this.awaitingPrintResponse&&this.printResolve&&(this.awaitingPrintResponse=!1,this.printResolve(s)),this.onPrintResponse){const o=this.onPrintResponse(s);o instanceof Promise&&o.catch(console.error)}}})}setDataResponseHandler(i){this.onDataResponse=i}setPrintResponseHandler(i){this.onPrintResponse=i}setDisconnectHandler(i){this.onDisconnectHandler=i}async _attemptConnection(){var i,a,s,o;if(!this.device||!this.device.gatt)throw new Error("Bluetooth device or GATT interface not available for connection attempt.");this.txCharacteristic=void 0,this.rxCharacteristic=void 0,this.server=void 0;try{console.log(`Attempting to connect to GATT server on device: ${this.device.name||this.device.id}...`),this.server=await this.device.gatt.connect(),console.log("GATT server connected."),console.log("Getting primary service...");const h=await this.server.getPrimaryService(this.SERVICE_UUID);console.log("Primary service obtained."),console.log("Getting TX characteristic..."),this.txCharacteristic=await h.getCharacteristic(this.TX_CHARACTERISTIC_UUID),console.log("TX characteristic obtained."),console.log("Getting RX characteristic..."),this.rxCharacteristic=await h.getCharacteristic(this.RX_CHARACTERISTIC_UUID),console.log("RX characteristic obtained."),console.log("Starting notifications on RX characteristic..."),await this.rxCharacteristic.startNotifications(),this.rxCharacteristic.addEventListener("characteristicvaluechanged",this.notificationHandler),console.log("Notifications started."),await this.sendBreakSignal(!1),console.log("Fetching MTU size (max_length) from device...");const d=await this.sendLua("print(frame.bluetooth.max_length())",{awaitPrint:!0});if(d==null)throw new Error("Failed to get MTU size from device: no response.");const g=parseInt(d);if(isNaN(g)||g<=0)throw new Error(`Invalid MTU size received: '${d}'`);this.maxPayload=g,console.log(`MTU size set to: ${this.maxPayload}`)}catch(h){if(console.error("Error during connection attempt:",h),this.rxCharacteristic){try{(a=(i=this.device)==null?void 0:i.gatt)!=null&&a.connected&&await this.rxCharacteristic.stopNotifications()}catch{}this.rxCharacteristic.removeEventListener("characteristicvaluechanged",this.notificationHandler),this.rxCharacteristic=void 0}throw this.txCharacteristic=void 0,(o=(s=this.device)==null?void 0:s.gatt)!=null&&o.connected&&this.device.gatt.disconnect(),this.server=void 0,h}}async connect(i={}){var a;const{name:s,namePrefix:o,numAttempts:h=5,retryDelayMs:d=1e3}=i;if(!navigator.bluetooth)throw new Error("Web Bluetooth API not available.");if(!this.device){const _={filters:[s?{services:[this.SERVICE_UUID],name:s}:o?{services:[this.SERVICE_UUID],namePrefix:o}:{services:[this.SERVICE_UUID]}],optionalServices:[this.SERVICE_UUID]};try{if(console.log("Requesting Bluetooth device from user..."),this.device=await navigator.bluetooth.requestDevice(_),!this.device)throw new Error("No device selected by the user.");console.log(`Device selected: ${this.device.name||this.device.id}`)}catch($){throw console.error("Bluetooth device request failed:",$),this.device=void 0,$}}if(!this.device)throw new Error("Device not available after selection phase.");const g=this.device;g.removeEventListener("gattserverdisconnected",this.handleDisconnect),g.addEventListener("gattserverdisconnected",this.handleDisconnect);let b;for(let _=1;_<=h;_++){if(!this.device){console.warn(`Device (id: ${g.id}) was disconnected externally during connection attempts.`),b=b||new Error(`Device disconnected externally during connection attempt ${_}.`);break}try{return console.log(`Connection attempt ${_} of ${h} to device '${g.name||g.id}'...`),await this._attemptConnection(),console.log(`Successfully connected to ${g.name||g.id} on attempt ${_}.`),g.id||g.name||"Unknown Device"}catch($){if(b=$,console.error(`Attempt ${_} to connect to '${g.name||g.id}' failed:`,$),$ instanceof Error&&$.name==="NetworkError"&&($.message.includes("Connection attempt failed.")||$.message.includes("GATT operation failed for unknown reason.")||$.message.includes("GATT Server is disconnected.")||$.message.includes("Bluetooth device is already connected."))&&_<h)console.log(`Retryable error encountered. Retrying in ${d/1e3}s...`),await new Promise(it=>setTimeout(it,d));else{console.log("Non-retryable error or max attempts reached. Aborting connection process.");break}}}throw console.error(`Failed to connect to device '${g.name||g.id}' after ${h} attempts or due to external disconnection.`),g.removeEventListener("gattserverdisconnected",this.handleDisconnect),(a=g.gatt)!=null&&a.connected&&g.gatt.disconnect(),this.server=void 0,this.txCharacteristic=void 0,this.rxCharacteristic=void 0,this.device=void 0,b||new Error(`Failed to connect to ${g.name||g.id} after ${h} attempts. No specific error recorded, or device disconnected externally.`)}async disconnect(){var i;this.device&&(i=this.device.gatt)!=null&&i.connected?this.device.gatt.disconnect():this.handleDisconnect()}isConnected(){return!!(this.device&&this.device.gatt&&this.device.gatt.connected)}getMaxPayload(i){return i?this.maxPayload:this.maxPayload-1}async transmit(i,a=!1){if(!this.txCharacteristic)throw new Error("Not connected or TX characteristic not available.");if(i.byteLength>this.maxPayload)throw new Error(`Payload length: ${i.byteLength} exceeds maximum BLE packet size: ${this.maxPayload}`);a&&console.log("Transmitting (hex):",Array.from(i).map(s=>s.toString(16).padStart(2,"0")).join(" ")),await this.txCharacteristic.writeValueWithResponse(i)}async sendLua(i,a={}){const{showMe:s=!1,awaitPrint:o=!1,timeout:h=5e3}=a,d=new TextEncoder().encode(i);if(d.byteLength>this.getMaxPayload(!0))throw new Error(`Lua string payload (${d.byteLength} bytes) is too large for max Lua payload (${this.getMaxPayload(!0)} bytes).`);if(o&&(this.printTimeoutId&&clearTimeout(this.printTimeoutId),this.awaitingPrintResponse=!0,this.printResponsePromise=new Promise((g,b)=>{this.printResolve=g,this.printTimeoutId=setTimeout(()=>{this.awaitingPrintResponse&&(this.awaitingPrintResponse=!1,this.printResolve=void 0,b(new Error(`Device didn't respond with a print within ${h}ms.`)))},h)}).finally(()=>{this.printTimeoutId&&(clearTimeout(this.printTimeoutId),this.printTimeoutId=void 0)})),await this.transmit(d,s),o)return this.printResponsePromise}async sendData(i,a={}){const{showMe:s=!1,awaitData:o=!1,timeout:h=5e3}=a;if(!this.txCharacteristic)throw new Error("Not connected or TX characteristic not available.");if(i.byteLength>this.getMaxPayload(!1))throw new Error(`Data payload (${i.byteLength} bytes) is too large for max data payload (${this.getMaxPayload(!1)} bytes).`);const d=new Uint8Array([1]),g=new Uint8Array(d.length+i.byteLength);g.set(d,0),g.set(i,d.length);let b;if(o&&(this.awaitingDataResponse=!0,this.dataResponsePromise=new Promise((_,$)=>{this.dataResolve=_,b=setTimeout(()=>{this.awaitingDataResponse&&(this.awaitingDataResponse=!1,this.dataResolve=void 0,$(new Error(`Device didn't respond with data within ${h}ms.`)))},h)}).finally(()=>{b&&clearTimeout(b)})),await this.transmit(g,s),o)return this.dataResponsePromise}async sendResetSignal(i=!1){const a=new Uint8Array([4]);await this.transmit(a,i),await new Promise(s=>setTimeout(s,200))}async sendBreakSignal(i=!1){const a=new Uint8Array([3]);await this.transmit(a,i),await new Promise(s=>setTimeout(s,200))}async uploadFileFromString(i,a="main.lua"){let s=i.replace(/\r/g,"").replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/'/g,"\\'").replace(/"/g,'\\"');const o=await this.sendLua(`f=frame.file.open('${a}','w');print(1)`,{awaitPrint:!0});if(o!=="1")throw new Error(`Failed to open file ${a} on device. Response: ${o}`);const h=this.getMaxPayload(!0)-20;if(h<=0)throw new Error("Max payload size too small for file upload operations.");let d=0;for(;d<s.length;){let g=Math.min(h,s.length-d),b=s.substring(d,d+g);for(;b.endsWith("\\");){let $=0;for(let it=b.length-1;it>=0&&b[it]==="\\";it--)$++;if($%2!==0)if(g>1)g--,b=s.substring(d,d+g);else throw await this.sendLua("f:close();print(nil)",{awaitPrint:!0}),new Error("Cannot safely chunk content due to isolated escape character at chunk boundary.");else break}const _=await this.sendLua(`f:write("${b}");print(1)`,{awaitPrint:!0});if(_!=="1")throw await this.sendLua("f:close();print(nil)",{awaitPrint:!0}),new Error(`Failed to write chunk to ${a}. Response: ${_}`);d+=g}await this.sendLua("f:close();print(nil)",{awaitPrint:!0})}async uploadFile(i,a="main.lua"){await this.uploadFileFromString(i,a)}async sendMessage(i,a,s=!1){if(i<0||i>255)throw new Error(`Message code must be 0-255, got ${i}`);const o=a.byteLength;if(o>65535)throw new Error(`Payload size ${o} exceeds maximum 65535 bytes`);const h=this.getMaxPayload(!1),d=h-1-2,g=h-1;if(d<=0||g<=0)throw new Error("Max payload size too small for message sending protocol.");let b=0;const _=Math.min(d,o),$=new Uint8Array(3+_);for($[0]=i,$[1]=o>>8,$[2]=o&255,$.set(a.subarray(0,_),3),await this.sendData($,{showMe:s,awaitData:!0}),b+=_;b<o;){const it=o-b,nt=Math.min(g,it),tt=new Uint8Array(1+nt);tt[0]=i,tt.set(a.subarray(b,b+nt),1),await this.sendData(tt,{showMe:s,awaitData:!0}),b+=nt}}}const stdDataMinLua="local a={}local b={}a.app_data_accum=b;local c={}a.app_data_block=c;local d={}a.app_data=d;local e={}a.parsers=e;function a.update_app_data_accum(f)rc,err=pcall(function()local g=string.byte(f,1)local h=a.app_data_accum[g]if h==nil or next(h)==nil then h={chunk_table={},num_chunks=0,size=0,recv_bytes=0}a.app_data_accum[g]=h end;if h.num_chunks==0 then h.size=string.byte(f,2)<<8|string.byte(f,3)h.chunk_table[1]=string.sub(f,4)h.num_chunks=1;h.recv_bytes=string.len(f)-3;if h.recv_bytes==h.size then a.app_data_block[g]=h.chunk_table[1]h.size=0;h.recv_bytes=0;h.num_chunks=0;h.chunk_table[1]=nil;b[g]=h end else h.chunk_table[h.num_chunks+1]=string.sub(f,2)h.num_chunks=h.num_chunks+1;h.recv_bytes=h.recv_bytes+string.len(f)-1;if h.recv_bytes==h.size then collectgarbage('collect')a.app_data_block[g]=table.concat(h.chunk_table)for i,j in pairs(h.chunk_table)do h.chunk_table[i]=nil end;collectgarbage('collect')h.size=0;h.recv_bytes=0;h.num_chunks=0;a.app_data_accum[g]=h end end;while true do if pcall(frame.bluetooth.send,'\\x00')then break end;frame.sleep(0.0025)end end)if rc==false then print('Error in data accumulator: '..err)while true do if pcall(frame.bluetooth.send,'\\x01')then break end;frame.sleep(0.0025)end;error(err)end end;frame.bluetooth.receive_callback(a.update_app_data_accum)function a.process_raw_items()local k=0;rc,err=pcall(function()collectgarbage('collect')for l,m in pairs(a.app_data_block)do if a.parsers[l]==nil then print('Error: No parser for flag: '..tostring(l))else a.app_data[l]=a.parsers[l](m,a.app_data[l])a.app_data_block[l]=nil;k=k+1 end end end)if rc==false then print('Error processing raw items: '..err)error(err)end;return k end;return a",stdAudioMinLua="local a={}local b=0x06;local c=0x05;local d=frame.bluetooth.max_length()if d%2==1 then d=d-1 end;function a.start(e)local f=e and e.sample_rate or 8000;local g=e and e.bit_depth or 8;pcall(frame.microphone.start,{sample_rate=f,bit_depth=g})end;function a.stop()pcall(frame.microphone.stop)end;function a.read_and_send_audio()audio_data=frame.microphone.read(d)if audio_data==nil then while true do if pcall(frame.bluetooth.send,string.char(b))then break end end;return nil elseif audio_data~=''then while true do if pcall(frame.bluetooth.send,string.char(c)..audio_data)then break end end;return string.len(audio_data)end;return 0 end;return a",stdCameraMinLua=`local a={}local b=0x07;local c=0x08;local d=0x11;local e=0x12;local f={'VERY_LOW','LOW','MEDIUM','HIGH','VERY_HIGH'}local g={'SPOT','CENTER_WEIGHTED','AVERAGE'}local h={metering='CENTER_WEIGHTED',exposure=0.1,exposure_speed=0.45,shutter_limit=16383,analog_gain_limit=16.0,white_balance_speed=0.5,rgb_gain_limit=287}local i={shutter=4096,analog_gain=1,red_gain=121,green_gain=64,blue_gain=140}a.is_auto_exp=true;function update_if_present(j,k)for l,m in pairs(k)do if m~=nil then j[l]=m end end end;function a.set_auto_exp_settings(n)update_if_present(h,n)a.is_auto_exp=true end;function a.set_manual_exp_settings(n)a.is_auto_exp=false;update_if_present(i,n)frame.camera.set_shutter(i.shutter)frame.camera.set_gain(i.analog_gain)frame.camera.set_white_balance(i.red_gain,i.green_gain,i.blue_gain)end;function a.parse_auto_exp_settings(o)local j={}j.metering=g[string.byte(o,1)+1]j.exposure=string.byte(o,2)/255.0;j.exposure_speed=string.byte(o,3)/255.0;j.shutter_limit=string.byte(o,4)<<8|(string.byte(o,5)&0x3FFF)j.analog_gain_limit=string.byte(o,6)&0xFF;j.white_balance_speed=string.byte(o,7)/255.0;j.rgb_gain_limit=string.byte(o,8)<<8|(string.byte(o,9)&0x3FF)return j end;function a.parse_manual_exp_settings(o)local j={}j.shutter=string.byte(o,1)<<8|(string.byte(o,2)&0x3FFF)j.analog_gain=string.byte(o,3)&0xFF;j.red_gain=string.byte(o,4)<<8|(string.byte(o,5)&0x3FF)j.green_gain=string.byte(o,6)<<8|(string.byte(o,7)&0x3FF)j.blue_gain=string.byte(o,8)<<8|(string.byte(o,9)&0x3FF)return j end;function a.parse_capture_settings(o)local j={}j.quality=f[string.byte(o,1)+1]local p=string.byte(o,2)<<8|string.byte(o,3)j.resolution=p*2;local q=string.byte(o,4)<<8|string.byte(o,5)j.pan=q-140;j.raw=string.byte(o,6)>0;return j end;function send_data(o)local r=false;local s=frame.time.utc()+2;while frame.time.utc()<s do if pcall(frame.bluetooth.send,o)then r=true;break end end;if not r then error('Error sending photo data')end end;function a.run_auto_exposure()return frame.camera.auto(h)end;function a.send_autoexp_result(t)local o=string.pack("<Bffffffffffffffff",d,t['error'],t['shutter'],t['analog_gain'],t['red_gain'],t['green_gain'],t['blue_gain'],t['brightness']['center_weighted_average'],t['brightness']['scene'],t['brightness']['matrix']['r'],t['brightness']['matrix']['g'],t['brightness']['matrix']['b'],t['brightness']['matrix']['average'],t['brightness']['spot']['r'],t['brightness']['spot']['g'],t['brightness']['spot']['b'],t['brightness']['spot']['average'])send_data(o)end;function a.send_metering_data()send_data(string.char(e)..frame.fpga_read(0x25,6))end;function a.capture_and_send(n)frame.camera.capture{resolution=n.resolution,quality=n.quality,pan=n.pan}while not frame.camera.image_ready()do frame.sleep(0.005)end;local o=''local u=n.raw;while true do if u then o=frame.camera.read_raw(frame.bluetooth.max_length()-1)else o=frame.camera.read(frame.bluetooth.max_length()-1)end;if o~=nil then send_data(string.char(b)..o)else send_data(string.char(c))break end end end;return a`,stdCodeMinLua="local _M={}function _M.parse_code(a)local b={}b.value=string.byte(a,1)return b end;return _M",stdIMUMinLua='local _M={}local a=0x0A;function _M.send_imu_data(b)local c=b or a;local d=frame.imu.raw()local e=string.pack("<Bxhhhhhh",c,d.compass.x,d.compass.y,d.compass.z,d.accelerometer.x,d.accelerometer.y,d.accelerometer.z)pcall(frame.bluetooth.send,e)end;return _M',stdImageSpriteBlockMinLua="local a={}function a.parse_image_sprite_block(b,c)if string.byte(b,1)==0xFF then if c~=nil then for d,e in pairs(c.sprites)do c.sprites[d]=nil end;c=nil;collectgarbage('collect')end;local f={}f.width=string.byte(b,2)<<8|string.byte(b,3)f.height=string.byte(b,4)<<8|string.byte(b,5)f.sprite_line_height=string.byte(b,6)<<8|string.byte(b,7)f.progressive_render=string.byte(b,8)==1;f.updatable=string.byte(b,9)==1;f.sprites={}local g=f.height+f.sprite_line_height-1;f.total_sprites=g//f.sprite_line_height;f.active_sprites=0;f.current_sprite_index=0;return f else if c==nil then return nil end;c.current_sprite_index=c.current_sprite_index+1;if c.current_sprite_index>c.total_sprites then if c.updatable then c.current_sprite_index=1 else return c end end;if c.active_sprites<c.total_sprites then c.active_sprites=c.active_sprites+1 end;local h={}h.width=string.byte(b,1)<<8|string.byte(b,2)h.height=string.byte(b,3)<<8|string.byte(b,4)h.compressed=string.byte(b,5)>0;h.bpp=string.byte(b,6)h.num_colors=string.byte(b,7)h.palette_data=string.sub(b,8,8+h.num_colors*3-1)h.pixel_data=string.sub(b,8+h.num_colors*3)c.sprites[c.current_sprite_index]=h;return c end end;function a.set_palette(i,j)local k={'VOID','WHITE','GREY','RED','PINK','DARKBROWN','BROWN','ORANGE','YELLOW','DARKGREEN','GREEN','LIGHTGREEN','NIGHTBLUE','SEABLUE','SKYBLUE','CLOUDBLUE'}for l=1,i do local m=(l-1)*3;frame.display.assign_color(k[l],string.byte(j,m+1),string.byte(j,m+2),string.byte(j,m+3))end end;return a",stdPlainTextMinLua="local _M={}local a={'VOID','WHITE','GREY','RED','PINK','DARKBROWN','BROWN','ORANGE','YELLOW','DARKGREEN','GREEN','LIGHTGREEN','NIGHTBLUE','SEABLUE','SKYBLUE','CLOUDBLUE'}function _M.parse_plain_text(b)local c={}c.x=string.byte(b,1)<<8|string.byte(b,2)c.y=string.byte(b,3)<<8|string.byte(b,4)c.palette_offset=string.byte(b,5)c.color=a[c.palette_offset%16+1]c.spacing=string.byte(b,6)c.string=string.sub(b,7)return c end;return _M",stdSpriteMinLua="local a={}function a.parse_sprite(b)local c={}c.width=string.byte(b,1)<<8|string.byte(b,2)c.height=string.byte(b,3)<<8|string.byte(b,4)c.compressed=string.byte(b,5)>0;c.bpp=string.byte(b,6)c.num_colors=string.byte(b,7)c.palette_data=string.sub(b,8,8+c.num_colors*3-1)c.pixel_data=string.sub(b,8+c.num_colors*3)return c end;function a.set_palette(d,e)local f={'VOID','WHITE','GREY','RED','PINK','DARKBROWN','BROWN','ORANGE','YELLOW','DARKGREEN','GREEN','LIGHTGREEN','NIGHTBLUE','SEABLUE','SKYBLUE','CLOUDBLUE'}for g=1,d do local h=(g-1)*3;frame.display.assign_color(f[g],string.byte(e,h+1),string.byte(e,h+2),string.byte(e,h+3))end end;return a",stdSpriteCoordsMinLua="local a={}function a.parse_sprite_coords(b)local c={}c.code=string.byte(b,1)c.x=string.byte(b,2)<<8|string.byte(b,3)c.y=string.byte(b,4)<<8|string.byte(b,5)c.offset=string.byte(b,6)return c end;return a",stdTapMinLua="local a={}local b=0x09;function a.send_tap()rc,err=pcall(frame.bluetooth.send,string.char(b))if rc==false then print(err)end end;return a",stdTextSpriteBlockMinLua="local a={}function a.parse_text_sprite_block(b,c)if string.byte(b,1)==0xFF then local d={}d.width=string.byte(b,2)<<8|string.byte(b,3)d.max_display_rows=string.byte(b,4)d.lines=string.byte(b,5)local e={}for f=0,d.lines-1 do local g={}g.x=string.byte(b,5+4*f+1)<<8|string.byte(b,5+4*f+2)g.y=string.byte(b,5+4*f+3)<<8|string.byte(b,5+4*f+4)table.insert(e,g)end;d.offsets=e;d.sprites={}d.last_sprite_index=0;d.first_sprite_index=0;return d else if c==nil then return nil end;c.last_sprite_index=c.last_sprite_index+1;if c.first_sprite_index==0 then c.first_sprite_index=1 end;if c.last_sprite_index-c.first_sprite_index+1>c.max_display_rows then c.sprites[c.first_sprite_index]=nil;c.first_sprite_index=c.first_sprite_index+1 end;local h={}h.width=string.byte(b,1)<<8|string.byte(b,2)h.height=string.byte(b,3)<<8|string.byte(b,4)h.compressed=string.byte(b,5)>0;h.bpp=string.byte(b,6)h.num_colors=string.byte(b,7)h.palette_data=string.sub(b,8,8+h.num_colors*3-1)h.pixel_data=string.sub(b,8+h.num_colors*3)c.sprites[c.last_sprite_index]=h;return c end end;return a";var StdLua=(e=>(e.DataMin="stdDataMin",e.AudioMin="stdAudioMin",e.CameraMin="stdCameraMin",e.CodeMin="stdCodeMin",e.IMUMin="stdIMUMin",e.ImageSpriteBlockMin="stdImageSpriteBlockMin",e.PlainTextMin="stdPlainTextMin",e.SpriteMin="stdSpriteMin",e.SpriteCoordsMin="stdSpriteCoordsMin",e.TapMin="stdTapMin",e.TextSpriteBlockMin="stdTextSpriteBlockMin",e))(StdLua||{});const standardLuaLibrarySources={stdDataMin:{content:stdDataMinLua,targetFileName:"data.min.lua"},stdAudioMin:{content:stdAudioMinLua,targetFileName:"audio.min.lua"},stdCameraMin:{content:stdCameraMinLua,targetFileName:"camera.min.lua"},stdCodeMin:{content:stdCodeMinLua,targetFileName:"code.min.lua"},stdIMUMin:{content:stdIMUMinLua,targetFileName:"imu.min.lua"},stdImageSpriteBlockMin:{content:stdImageSpriteBlockMinLua,targetFileName:"image_sprite_block.min.lua"},stdPlainTextMin:{content:stdPlainTextMinLua,targetFileName:"plain_text.min.lua"},stdSpriteMin:{content:stdSpriteMinLua,targetFileName:"sprite.min.lua"},stdSpriteCoordsMin:{content:stdSpriteCoordsMinLua,targetFileName:"sprite_coords.min.lua"},stdTapMin:{content:stdTapMinLua,targetFileName:"tap.min.lua"},stdTextSpriteBlockMin:{content:stdTextSpriteBlockMinLua,targetFileName:"text_sprite_block.min.lua"}};class FrameMsg{constructor(){$e(this,"ble"),$e(this,"dataResponseHandlers"),this.ble=new R,this.dataResponseHandlers=new Map,this.ble.setDataResponseHandler(this._handleDataResponse.bind(this))}async connect(i=!0,a={}){try{const s={name:a.name,namePrefix:a.namePrefix},o=await this.ble.connect(s);return i&&(await this.ble.sendBreakSignal(),await this.ble.sendResetSignal(),await this.ble.sendBreakSignal()),o}catch(s){throw this.ble.isConnected()&&await this.ble.disconnect(),s}}async disconnect(){this.ble.isConnected()&&await this.ble.disconnect()}isConnected(){return this.ble.isConnected()}async printShortText(i=""){const a=i.replace(/'/g,"\\'").replace(/\n/g,"");return this.ble.sendLua(`frame.display.text('${a}',1,1);frame.display.show();print(0)`,{awaitPrint:!0})}async uploadStdLuaLibs(i){for(const a of i){const s=standardLuaLibrarySources[a];s?await this.ble.uploadFileFromString(s.content,s.targetFileName):console.warn(`Standard Lua library key "${a}" not found. Skipping.`)}}async uploadFrameApp(i,a="frame_app.lua"){await this.ble.uploadFile(i,a)}async startFrameApp(i="frame_app",a=!0){return this.ble.sendLua(`require('${i}')`,{awaitPrint:a})}async stopFrameApp(i=!0){await this.ble.sendBreakSignal(),i&&await this.ble.sendResetSignal()}attachPrintResponseHandler(i=console.log){this.ble.setPrintResponseHandler(i)}detachPrintResponseHandler(){this.ble.setPrintResponseHandler(void 0)}async sendMessage(i,a,s=!1){await this.ble.sendMessage(i,a,s)}registerDataResponseHandler(i,a,s){for(const o of a){this.dataResponseHandlers.has(o)||this.dataResponseHandlers.set(o,[]);const h=this.dataResponseHandlers.get(o);h.find(d=>d.subscriber===i&&d.handler===s)||h.push({subscriber:i,handler:s})}}unregisterDataResponseHandler(i){this.dataResponseHandlers.forEach((a,s)=>{const o=a.filter(h=>h.subscriber!==i);o.length===0?this.dataResponseHandlers.delete(s):this.dataResponseHandlers.set(s,o)})}_handleDataResponse(i){if(i&&i.byteLength>0){const a=i[0];this.dataResponseHandlers.has(a)&&this.dataResponseHandlers.get(a).forEach(s=>{try{s.handler(i)}catch(o){console.error("Error in FrameMsg data response handler for msgCode",a,":",o)}})}}async sendLua(i,a={}){return this.ble.sendLua(i,a)}async sendData(i,a={}){return this.ble.sendData(i,a)}async sendResetSignal(i=!1){return this.ble.sendResetSignal(i)}async sendBreakSignal(i=!1){return this.ble.sendBreakSignal(i)}getMaxPayload(i){return this.ble?this.ble.getMaxPayload(i):(console.warn("FrameBle instance not initialized or not connected for getMaxPayload."),60)}}class AsyncQueue{constructor(){$e(this,"promises"),$e(this,"resolvers"),this.promises=[],this.resolvers=[]}add(){this.promises.push(new Promise(i=>{this.resolvers.push(i)}))}put(i){this.resolvers.length||this.add();const a=this.resolvers.shift();a&&a(i)}async get(){return this.promises.length||this.add(),this.promises.shift()||new Promise(a=>{this.resolvers.push(a),this.promises.push(this.get())})}isEmpty(){return this.promises.length===0}size(){return this.promises.length}clear(){this.resolvers.forEach(i=>{}),this.promises=[],this.resolvers=[]}}class TxPlainText{constructor(i,a=1,s=1,o=1,h=4){this.text=i,this.x=a,this.y=s,this.paletteOffset=o,this.spacing=h}pack(){const i=new TextEncoder().encode(this.text),a=new Uint8Array(6),s=new DataView(a.buffer);s.setUint16(0,this.x,!1),s.setUint16(2,this.y,!1),s.setUint8(4,this.paletteOffset&15),s.setUint8(5,this.spacing&255);const o=new Uint8Array(a.length+i.length);return o.set(a),o.set(i,a.length),o}}const bitMethods={getBit(e){return this.data[getSlot(e)]&1<<getShift(e)?1:0},setBit(e){this.data[getSlot(e)]|=1<<getShift(e)},clearBit(e){this.data[getSlot(e)]&=~(1<<getShift(e))},toggleBit(e){this.data[getSlot(e)]^=1<<getShift(e)},getBitXY(e,i){return e>=this.width||i>=this.height?0:this.getBit(i*this.width+e)},setBitXY(e,i){this.setBit(i*this.width+e)},clearBitXY(e,i){this.clearBit(i*this.width+e)},toggleBitXY(e,i){this.toggleBit(i*this.width+e)}};function getSlot(e){return e>>3}function getShift(e){return 7-(e&7)}function setBitMethods(e){for(const i in bitMethods)e.prototype[i]=bitMethods[i]}function checkProcessable(e,i={}){let{bitDepth:a,alpha:s,colorModel:o,components:h,channels:d}=i;if(typeof e!="string"||e.length===0)throw new TypeError("processName must be a string");if(a&&(Array.isArray(a)||(a=[a]),!a.includes(this.bitDepth)))throw new TypeError(`The process: ${e} can only be applied if bit depth is in: ${a}`);if(s&&(Array.isArray(s)||(s=[s]),!s.includes(this.alpha)))throw new TypeError(`The process: ${e} can only be applied if alpha is in: ${s}`);if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.colorModel)))throw new TypeError(`The process: ${e} can only be applied if color model is in: ${o}`);if(h&&(Array.isArray(h)||(h=[h]),!h.includes(this.components))){let g=`The process: ${e} can only be applied if the number of components is in: ${h}`;throw h.length===1&&h[0]===1?new TypeError(`${g}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(g)}if(d&&(Array.isArray(d)||(d=[d]),!d.includes(this.channels)))throw new TypeError(`The process: ${e} can only be applied if the number of channels is in: ${d}`)}function createBlob(e,i){e=e||[],i=i||{},typeof i=="string"&&(i={type:i});try{return new Blob(e,i)}catch(h){if(h.name!=="TypeError")throw h;for(var a=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,s=new a,o=0;o<e.length;o+=1)s.append(e[o]);return s.getBlob(i.type)}}function dataURLToBlob(e){var i=e.match(/data:([^;]+)/)[1],a=e.replace(/^[^,]+,/,""),s=binaryStringToArrayBuffer(atob(a));return createBlob([s],{type:i})}function canvasToBlob(e,i,a){return typeof e.toBlob=="function"?new Promise(function(s){e.toBlob(s,i,a)}):Promise.resolve(dataURLToBlob(e.toDataURL(i,a)))}function binaryStringToArrayBuffer(e){for(var i=e.length,a=new ArrayBuffer(i),s=new Uint8Array(a),o=-1;++o<i;)s[o]=e.charCodeAt(o);return a}function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var i=e.default;if(typeof i=="function"){var a=function s(){return this instanceof s?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};a.prototype=i.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var o=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return e[s]}})}),a}var src$5={};function decode$2(e,i="utf8"){return new TextDecoder(i).decode(e)}const encoder$1=new TextEncoder;function encode$1(e){return encoder$1.encode(e)}const defaultByteLength=1024*8,hostBigEndian=(()=>{const e=new Uint8Array(4),i=new Uint32Array(e.buffer);return!((i[0]=1)&e[0])})(),typedArrays={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class IOBuffer{constructor(i=defaultByteLength,a={}){$e(this,"buffer"),$e(this,"byteLength"),$e(this,"byteOffset"),$e(this,"length"),$e(this,"offset"),$e(this,"lastWrittenByte"),$e(this,"littleEndian"),$e(this,"_data"),$e(this,"_mark"),$e(this,"_marks");let s=!1;typeof i=="number"?i=new ArrayBuffer(i):(s=!0,this.lastWrittenByte=i.byteLength);const o=a.offset?a.offset>>>0:0,h=i.byteLength-o;let d=o;(ArrayBuffer.isView(i)||i instanceof IOBuffer)&&(i.byteLength!==i.buffer.byteLength&&(d=i.byteOffset+o),i=i.buffer),s?this.lastWrittenByte=h:this.lastWrittenByte=0,this.buffer=i,this.length=h,this.byteLength=h,this.byteOffset=d,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,d,h),this._mark=0,this._marks=[]}available(i=1){return this.offset+i<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(i=1){return this.offset+=i,this}back(i=1){return this.offset-=i,this}seek(i){return this.offset=i,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const i=this._marks.pop();if(i===void 0)throw new Error("Mark stack empty");return this.seek(i),this}rewind(){return this.offset=0,this}ensureAvailable(i=1){if(!this.available(i)){const a=(this.offset+i)*2,s=new Uint8Array(a);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(i=1){return this.readArray(i,"uint8")}readArray(i,a){const s=typedArrays[a].BYTES_PER_ELEMENT*i,o=this.byteOffset+this.offset,h=this.buffer.slice(o,o+s);if(this.littleEndian===hostBigEndian&&a!=="uint8"&&a!=="int8"){const g=new Uint8Array(this.buffer.slice(o,o+s));g.reverse();const b=new typedArrays[a](g.buffer);return this.offset+=s,b.reverse(),b}const d=new typedArrays[a](h);return this.offset+=s,d}readInt16(){const i=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,i}readUint16(){const i=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,i}readInt32(){const i=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,i}readUint32(){const i=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,i}readFloat32(){const i=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,i}readFloat64(){const i=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,i}readBigInt64(){const i=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,i}readBigUint64(){const i=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,i}readChar(){return String.fromCharCode(this.readInt8())}readChars(i=1){let a="";for(let s=0;s<i;s++)a+=this.readChar();return a}readUtf8(i=1){return decode$2(this.readBytes(i))}decodeText(i=1,a="utf8"){return decode$2(this.readBytes(i),a)}writeBoolean(i){return this.writeUint8(i?255:0),this}writeInt8(i){return this.ensureAvailable(1),this._data.setInt8(this.offset++,i),this._updateLastWrittenByte(),this}writeUint8(i){return this.ensureAvailable(1),this._data.setUint8(this.offset++,i),this._updateLastWrittenByte(),this}writeByte(i){return this.writeUint8(i)}writeBytes(i){this.ensureAvailable(i.length);for(let a=0;a<i.length;a++)this._data.setUint8(this.offset++,i[a]);return this._updateLastWrittenByte(),this}writeInt16(i){return this.ensureAvailable(2),this._data.setInt16(this.offset,i,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(i){return this.ensureAvailable(2),this._data.setUint16(this.offset,i,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(i){return this.ensureAvailable(4),this._data.setInt32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(i){return this.ensureAvailable(4),this._data.setUint32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(i){return this.ensureAvailable(4),this._data.setFloat32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(i){return this.ensureAvailable(8),this._data.setFloat64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(i){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(i){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(i){return this.writeUint8(i.charCodeAt(0))}writeChars(i){for(let a=0;a<i.length;a++)this.writeUint8(i.charCodeAt(a));return this}writeUtf8(i){return this.writeBytes(encode$1(i))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}const IOBuffer$1=Object.freeze(Object.defineProperty({__proto__:null,IOBuffer},Symbol.toStringTag,{value:"Module"})),require$$0$3=getAugmentedNamespace(IOBuffer$1);var constants$1,hasRequiredConstants$1;function requireConstants$1(){return hasRequiredConstants$1||(hasRequiredConstants$1=1,constants$1={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}),constants$1}var BMPEncoder_1,hasRequiredBMPEncoder;function requireBMPEncoder(){if(hasRequiredBMPEncoder)return BMPEncoder_1;hasRequiredBMPEncoder=1;const{IOBuffer:e}=require$$0$3,i=requireConstants$1(),a=[];for(let o=0;o<=8;o++)a.push(255<<o);class s extends e{constructor(h){if(h.bitDepth!==1)throw new Error("Only bitDepth of 1 is supported");if(!h.height||!h.width)throw new Error("ImageData width and height are required");super(h.data),this.width=h.width,this.height=h.height,this.bitDepth=h.bitDepth,this.channels=h.channels,this.components=h.components}encode(){this.encoded=new e,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const h=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(h),this.encoded.toArray()}writePixelArray(){let h=this.encoded;const d=Math.floor((this.bitDepth*this.width+31)/32)*4,g=Math.ceil(this.bitDepth*this.width/8),b=d-g,_=this.bitDepth*this.width%8,$=_===0?0:8-_,it=d*this.height;let nt,tt,at=0,ut=0,ft=8;h.mark(),tt=this.readUint8();for(let ht=this.height-1;ht>=0;ht--){const dt=ht===0;h.reset(),h.skip(ht*d);for(let st=0;st<g;st++){const ct=st===g-1;ut<=$&&ct?(h.writeByte(tt<<ut),($===0||$===ut)&&!dt&&(nt=tt,tt=this.readByte())):ut===0?(nt=tt,tt=this.readUint8(),h.writeByte(nt)):(nt=tt,tt=this.readUint8(),h.writeByte(nt<<ut&a[ut]|tt>>ft)),ct&&(at+=_||0,h.skip(b),ut=at%8,ft=8-ut)}}d>g&&(h.reset(),h.skip(it-1),h.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(h){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(h)}writeBitmapV5Header(){const h=Math.floor((this.bitDepth*this.width+31)/32)*4*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(i.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(h).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(i.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(i.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}return BMPEncoder_1=s,BMPEncoder_1}var hasRequiredSrc$5;function requireSrc$5(){if(hasRequiredSrc$5)return src$5;hasRequiredSrc$5=1;const e=requireBMPEncoder();return src$5.encode=function(i){return new e(i).encode()},src$5}var srcExports$3=requireSrc$5();/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1$1(e){let i=e.length;for(;--i>=0;)e[i]=0}const STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1$1=3,MAX_MATCH$1$1=258,LENGTH_CODES$1$1=29,LITERALS$1$1=256,L_CODES$1$1=LITERALS$1$1+1+LENGTH_CODES$1$1,D_CODES$1$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN$1=512,static_ltree$1=new Array((L_CODES$1$1+2)*2);zero$1$1(static_ltree$1);const static_dtree$1=new Array(D_CODES$1$1*2);zero$1$1(static_dtree$1);const _dist_code$1=new Array(DIST_CODE_LEN$1);zero$1$1(_dist_code$1);const _length_code$1=new Array(MAX_MATCH$1$1-MIN_MATCH$1$1+1);zero$1$1(_length_code$1);const base_length$1=new Array(LENGTH_CODES$1$1);zero$1$1(base_length$1);const base_dist$1=new Array(D_CODES$1$1);zero$1$1(base_dist$1);function StaticTreeDesc(e,i,a,s,o){this.static_tree=e,this.extra_bits=i,this.extra_base=a,this.elems=s,this.max_length=o,this.has_stree=e&&e.length}let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(e,i){this.dyn_tree=e,this.max_code=0,this.stat_desc=i}const d_code=e=>e<256?_dist_code$1[e]:_dist_code$1[256+(e>>>7)],put_short=(e,i)=>{e.pending_buf[e.pending++]=i&255,e.pending_buf[e.pending++]=i>>>8&255},send_bits=(e,i,a)=>{e.bi_valid>Buf_size-a?(e.bi_buf|=i<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=i>>Buf_size-e.bi_valid,e.bi_valid+=a-Buf_size):(e.bi_buf|=i<<e.bi_valid&65535,e.bi_valid+=a)},send_code=(e,i,a)=>{send_bits(e,a[i*2],a[i*2+1])},bi_reverse=(e,i)=>{let a=0;do a|=e&1,e>>>=1,a<<=1;while(--i>0);return a>>>1},bi_flush=e=>{e.bi_valid===16?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},gen_bitlen=(e,i)=>{const a=i.dyn_tree,s=i.max_code,o=i.stat_desc.static_tree,h=i.stat_desc.has_stree,d=i.stat_desc.extra_bits,g=i.stat_desc.extra_base,b=i.stat_desc.max_length;let _,$,it,nt,tt,at,ut=0;for(nt=0;nt<=MAX_BITS$1;nt++)e.bl_count[nt]=0;for(a[e.heap[e.heap_max]*2+1]=0,_=e.heap_max+1;_<HEAP_SIZE$1;_++)$=e.heap[_],nt=a[a[$*2+1]*2+1]+1,nt>b&&(nt=b,ut++),a[$*2+1]=nt,!($>s)&&(e.bl_count[nt]++,tt=0,$>=g&&(tt=d[$-g]),at=a[$*2],e.opt_len+=at*(nt+tt),h&&(e.static_len+=at*(o[$*2+1]+tt)));if(ut!==0){do{for(nt=b-1;e.bl_count[nt]===0;)nt--;e.bl_count[nt]--,e.bl_count[nt+1]+=2,e.bl_count[b]--,ut-=2}while(ut>0);for(nt=b;nt!==0;nt--)for($=e.bl_count[nt];$!==0;)it=e.heap[--_],!(it>s)&&(a[it*2+1]!==nt&&(e.opt_len+=(nt-a[it*2+1])*a[it*2],a[it*2+1]=nt),$--)}},gen_codes=(e,i,a)=>{const s=new Array(MAX_BITS$1+1);let o=0,h,d;for(h=1;h<=MAX_BITS$1;h++)o=o+a[h-1]<<1,s[h]=o;for(d=0;d<=i;d++){let g=e[d*2+1];g!==0&&(e[d*2]=bi_reverse(s[g]++,g))}},tr_static_init=()=>{let e,i,a,s,o;const h=new Array(MAX_BITS$1+1);for(a=0,s=0;s<LENGTH_CODES$1$1-1;s++)for(base_length$1[s]=a,e=0;e<1<<extra_lbits[s];e++)_length_code$1[a++]=s;for(_length_code$1[a-1]=s,o=0,s=0;s<16;s++)for(base_dist$1[s]=o,e=0;e<1<<extra_dbits[s];e++)_dist_code$1[o++]=s;for(o>>=7;s<D_CODES$1$1;s++)for(base_dist$1[s]=o<<7,e=0;e<1<<extra_dbits[s]-7;e++)_dist_code$1[256+o++]=s;for(i=0;i<=MAX_BITS$1;i++)h[i]=0;for(e=0;e<=143;)static_ltree$1[e*2+1]=8,e++,h[8]++;for(;e<=255;)static_ltree$1[e*2+1]=9,e++,h[9]++;for(;e<=279;)static_ltree$1[e*2+1]=7,e++,h[7]++;for(;e<=287;)static_ltree$1[e*2+1]=8,e++,h[8]++;for(gen_codes(static_ltree$1,L_CODES$1$1+1,h),e=0;e<D_CODES$1$1;e++)static_dtree$1[e*2+1]=5,static_dtree$1[e*2]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree$1,extra_lbits,LITERALS$1$1+1,L_CODES$1$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree$1,extra_dbits,0,D_CODES$1$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)},init_block=e=>{let i;for(i=0;i<L_CODES$1$1;i++)e.dyn_ltree[i*2]=0;for(i=0;i<D_CODES$1$1;i++)e.dyn_dtree[i*2]=0;for(i=0;i<BL_CODES$1;i++)e.bl_tree[i*2]=0;e.dyn_ltree[END_BLOCK*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},bi_windup=e=>{e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},smaller=(e,i,a,s)=>{const o=i*2,h=a*2;return e[o]<e[h]||e[o]===e[h]&&s[i]<=s[a]},pqdownheap=(e,i,a)=>{const s=e.heap[a];let o=a<<1;for(;o<=e.heap_len&&(o<e.heap_len&&smaller(i,e.heap[o+1],e.heap[o],e.depth)&&o++,!smaller(i,s,e.heap[o],e.depth));)e.heap[a]=e.heap[o],a=o,o<<=1;e.heap[a]=s},compress_block=(e,i,a)=>{let s,o,h=0,d,g;if(e.sym_next!==0)do s=e.pending_buf[e.sym_buf+h++]&255,s+=(e.pending_buf[e.sym_buf+h++]&255)<<8,o=e.pending_buf[e.sym_buf+h++],s===0?send_code(e,o,i):(d=_length_code$1[o],send_code(e,d+LITERALS$1$1+1,i),g=extra_lbits[d],g!==0&&(o-=base_length$1[d],send_bits(e,o,g)),s--,d=d_code(s),send_code(e,d,a),g=extra_dbits[d],g!==0&&(s-=base_dist$1[d],send_bits(e,s,g)));while(h<e.sym_next);send_code(e,END_BLOCK,i)},build_tree=(e,i)=>{const a=i.dyn_tree,s=i.stat_desc.static_tree,o=i.stat_desc.has_stree,h=i.stat_desc.elems;let d,g,b=-1,_;for(e.heap_len=0,e.heap_max=HEAP_SIZE$1,d=0;d<h;d++)a[d*2]!==0?(e.heap[++e.heap_len]=b=d,e.depth[d]=0):a[d*2+1]=0;for(;e.heap_len<2;)_=e.heap[++e.heap_len]=b<2?++b:0,a[_*2]=1,e.depth[_]=0,e.opt_len--,o&&(e.static_len-=s[_*2+1]);for(i.max_code=b,d=e.heap_len>>1;d>=1;d--)pqdownheap(e,a,d);_=h;do d=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,a,1),g=e.heap[1],e.heap[--e.heap_max]=d,e.heap[--e.heap_max]=g,a[_*2]=a[d*2]+a[g*2],e.depth[_]=(e.depth[d]>=e.depth[g]?e.depth[d]:e.depth[g])+1,a[d*2+1]=a[g*2+1]=_,e.heap[1]=_++,pqdownheap(e,a,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,i),gen_codes(a,b,e.bl_count)},scan_tree=(e,i,a)=>{let s,o=-1,h,d=i[0*2+1],g=0,b=7,_=4;for(d===0&&(b=138,_=3),i[(a+1)*2+1]=65535,s=0;s<=a;s++)h=d,d=i[(s+1)*2+1],!(++g<b&&h===d)&&(g<_?e.bl_tree[h*2]+=g:h!==0?(h!==o&&e.bl_tree[h*2]++,e.bl_tree[REP_3_6*2]++):g<=10?e.bl_tree[REPZ_3_10*2]++:e.bl_tree[REPZ_11_138*2]++,g=0,o=h,d===0?(b=138,_=3):h===d?(b=6,_=3):(b=7,_=4))},send_tree=(e,i,a)=>{let s,o=-1,h,d=i[0*2+1],g=0,b=7,_=4;for(d===0&&(b=138,_=3),s=0;s<=a;s++)if(h=d,d=i[(s+1)*2+1],!(++g<b&&h===d)){if(g<_)do send_code(e,h,e.bl_tree);while(--g!==0);else h!==0?(h!==o&&(send_code(e,h,e.bl_tree),g--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,g-3,2)):g<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,g-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,g-11,7));g=0,o=h,d===0?(b=138,_=3):h===d?(b=6,_=3):(b=7,_=4)}},build_bl_tree=e=>{let i;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),i=BL_CODES$1-1;i>=3&&e.bl_tree[bl_order[i]*2+1]===0;i--);return e.opt_len+=3*(i+1)+5+5+4,i},send_all_trees=(e,i,a,s)=>{let o;for(send_bits(e,i-257,5),send_bits(e,a-1,5),send_bits(e,s-4,4),o=0;o<s;o++)send_bits(e,e.bl_tree[bl_order[o]*2+1],3);send_tree(e,e.dyn_ltree,i-1),send_tree(e,e.dyn_dtree,a-1)},detect_data_type=e=>{let i=4093624447,a;for(a=0;a<=31;a++,i>>>=1)if(i&1&&e.dyn_ltree[a*2]!==0)return Z_BINARY;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Z_TEXT;for(a=32;a<LITERALS$1$1;a++)if(e.dyn_ltree[a*2]!==0)return Z_TEXT;return Z_BINARY};let static_init_done=!1;const _tr_init$1=e=>{static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)},_tr_stored_block$1=(e,i,a,s)=>{send_bits(e,(STORED_BLOCK<<1)+(s?1:0),3),bi_windup(e),put_short(e,a),put_short(e,~a),a&&e.pending_buf.set(e.window.subarray(i,i+a),e.pending),e.pending+=a},_tr_align$1=e=>{send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree$1),bi_flush(e)},_tr_flush_block$1=(e,i,a,s)=>{let o,h,d=0;e.level>0?(e.strm.data_type===Z_UNKNOWN$1&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),d=build_bl_tree(e),o=e.opt_len+3+7>>>3,h=e.static_len+3+7>>>3,h<=o&&(o=h)):o=h=a+5,a+4<=o&&i!==-1?_tr_stored_block$1(e,i,a,s):e.strategy===Z_FIXED$1||h===o?(send_bits(e,(STATIC_TREES<<1)+(s?1:0),3),compress_block(e,static_ltree$1,static_dtree$1)):(send_bits(e,(DYN_TREES<<1)+(s?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,d+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),s&&bi_windup(e)},_tr_tally$1=(e,i,a)=>(e.pending_buf[e.sym_buf+e.sym_next++]=i,e.pending_buf[e.sym_buf+e.sym_next++]=i>>8,e.pending_buf[e.sym_buf+e.sym_next++]=a,i===0?e.dyn_ltree[a*2]++:(e.matches++,i--,e.dyn_ltree[(_length_code$1[a]+LITERALS$1$1+1)*2]++,e.dyn_dtree[d_code(i)*2]++),e.sym_next===e.sym_end);var _tr_init_1=_tr_init$1,_tr_stored_block_1=_tr_stored_block$1,_tr_flush_block_1=_tr_flush_block$1,_tr_tally_1=_tr_tally$1,_tr_align_1=_tr_align$1,trees$1={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1};const adler32$1=(e,i,a,s)=>{let o=e&65535|0,h=e>>>16&65535|0,d=0;for(;a!==0;){d=a>2e3?2e3:a,a-=d;do o=o+i[s++]|0,h=h+o|0;while(--d);o%=65521,h%=65521}return o|h<<16|0};var adler32_1$2=adler32$1;const makeTable$1=()=>{let e,i=[];for(var a=0;a<256;a++){e=a;for(var s=0;s<8;s++)e=e&1?3988292384^e>>>1:e>>>1;i[a]=e}return i},crcTable$2=new Uint32Array(makeTable$1()),crc32$1=(e,i,a,s)=>{const o=crcTable$2,h=s+a;e^=-1;for(let d=s;d<h;d++)e=e>>>8^o[(e^i[d])&255];return e^-1};var crc32_1$2=crc32$1,messages$2={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=trees$1,{Z_NO_FLUSH:Z_NO_FLUSH$2,Z_PARTIAL_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH$1,Z_FINISH:Z_FINISH$3,Z_BLOCK:Z_BLOCK$1,Z_OK:Z_OK$3,Z_STREAM_END:Z_STREAM_END$3,Z_STREAM_ERROR:Z_STREAM_ERROR$2,Z_DATA_ERROR:Z_DATA_ERROR$2,Z_BUF_ERROR:Z_BUF_ERROR$1,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION$1,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY$1,Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED$2}=constants$2$1,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,GZIP_STATE=57,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=(e,i)=>(e.msg=messages$2[i],i),rank=e=>e*2-(e>4?9:0),zero=e=>{let i=e.length;for(;--i>=0;)e[i]=0},slide_hash=e=>{let i,a,s,o=e.w_size;i=e.hash_size,s=i;do a=e.head[--s],e.head[s]=a>=o?a-o:0;while(--i);i=o,s=i;do a=e.prev[--s],e.prev[s]=a>=o?a-o:0;while(--i)};let HASH_ZLIB=(e,i,a)=>(i<<e.hash_shift^a)&e.hash_mask,HASH=HASH_ZLIB;const flush_pending=e=>{const i=e.state;let a=i.pending;a>e.avail_out&&(a=e.avail_out),a!==0&&(e.output.set(i.pending_buf.subarray(i.pending_out,i.pending_out+a),e.next_out),e.next_out+=a,i.pending_out+=a,e.total_out+=a,e.avail_out-=a,i.pending-=a,i.pending===0&&(i.pending_out=0))},flush_block_only=(e,i)=>{_tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,i),e.block_start=e.strstart,flush_pending(e.strm)},put_byte=(e,i)=>{e.pending_buf[e.pending++]=i},putShortMSB=(e,i)=>{e.pending_buf[e.pending++]=i>>>8&255,e.pending_buf[e.pending++]=i&255},read_buf=(e,i,a,s)=>{let o=e.avail_in;return o>s&&(o=s),o===0?0:(e.avail_in-=o,i.set(e.input.subarray(e.next_in,e.next_in+o),a),e.state.wrap===1?e.adler=adler32_1$2(e.adler,i,o,a):e.state.wrap===2&&(e.adler=crc32_1$2(e.adler,i,o,a)),e.next_in+=o,e.total_in+=o,o)},longest_match=(e,i)=>{let a=e.max_chain_length,s=e.strstart,o,h,d=e.prev_length,g=e.nice_match;const b=e.strstart>e.w_size-MIN_LOOKAHEAD?e.strstart-(e.w_size-MIN_LOOKAHEAD):0,_=e.window,$=e.w_mask,it=e.prev,nt=e.strstart+MAX_MATCH;let tt=_[s+d-1],at=_[s+d];e.prev_length>=e.good_match&&(a>>=2),g>e.lookahead&&(g=e.lookahead);do if(o=i,!(_[o+d]!==at||_[o+d-1]!==tt||_[o]!==_[s]||_[++o]!==_[s+1])){s+=2,o++;do;while(_[++s]===_[++o]&&_[++s]===_[++o]&&_[++s]===_[++o]&&_[++s]===_[++o]&&_[++s]===_[++o]&&_[++s]===_[++o]&&_[++s]===_[++o]&&_[++s]===_[++o]&&s<nt);if(h=MAX_MATCH-(nt-s),s=nt-MAX_MATCH,h>d){if(e.match_start=i,d=h,h>=g)break;tt=_[s+d-1],at=_[s+d]}}while((i=it[i&$])>b&&--a!==0);return d<=e.lookahead?d:e.lookahead},fill_window=e=>{const i=e.w_size;let a,s,o;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=i+(i-MIN_LOOKAHEAD)&&(e.window.set(e.window.subarray(i,i+i-s),0),e.match_start-=i,e.strstart-=i,e.block_start-=i,e.insert>e.strstart&&(e.insert=e.strstart),slide_hash(e),s+=i),e.strm.avail_in===0)break;if(a=read_buf(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=a,e.lookahead+e.insert>=MIN_MATCH)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=HASH(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=HASH(e,e.ins_h,e.window[o+MIN_MATCH-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<MIN_MATCH)););}while(e.lookahead<MIN_LOOKAHEAD&&e.strm.avail_in!==0)},deflate_stored=(e,i)=>{let a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s,o,h,d=0,g=e.strm.avail_in;do{if(s=65535,h=e.bi_valid+42>>3,e.strm.avail_out<h||(h=e.strm.avail_out-h,o=e.strstart-e.block_start,s>o+e.strm.avail_in&&(s=o+e.strm.avail_in),s>h&&(s=h),s<a&&(s===0&&i!==Z_FINISH$3||i===Z_NO_FLUSH$2||s!==o+e.strm.avail_in)))break;d=i===Z_FINISH$3&&s===o+e.strm.avail_in?1:0,_tr_stored_block(e,0,0,d),e.pending_buf[e.pending-4]=s,e.pending_buf[e.pending-3]=s>>8,e.pending_buf[e.pending-2]=~s,e.pending_buf[e.pending-1]=~s>>8,flush_pending(e.strm),o&&(o>s&&(o=s),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+o),e.strm.next_out),e.strm.next_out+=o,e.strm.avail_out-=o,e.strm.total_out+=o,e.block_start+=o,s-=o),s&&(read_buf(e.strm,e.strm.output,e.strm.next_out,s),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s)}while(d===0);return g-=e.strm.avail_in,g&&(g>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=g&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-g,e.strm.next_in),e.strstart),e.strstart+=g,e.insert+=g>e.w_size-e.insert?e.w_size-e.insert:g),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),d?BS_FINISH_DONE:i!==Z_NO_FLUSH$2&&i!==Z_FINISH$3&&e.strm.avail_in===0&&e.strstart===e.block_start?BS_BLOCK_DONE:(h=e.window_size-e.strstart,e.strm.avail_in>h&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,h+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),h>e.strm.avail_in&&(h=e.strm.avail_in),h&&(read_buf(e.strm,e.window,e.strstart,h),e.strstart+=h,e.insert+=h>e.w_size-e.insert?e.w_size-e.insert:h),e.high_water<e.strstart&&(e.high_water=e.strstart),h=e.bi_valid+42>>3,h=e.pending_buf_size-h>65535?65535:e.pending_buf_size-h,a=h>e.w_size?e.w_size:h,o=e.strstart-e.block_start,(o>=a||(o||i===Z_FINISH$3)&&i!==Z_NO_FLUSH$2&&e.strm.avail_in===0&&o<=h)&&(s=o>h?h:o,d=i===Z_FINISH$3&&e.strm.avail_in===0&&s===o?1:0,_tr_stored_block(e,e.block_start,s,d),e.block_start+=s,flush_pending(e.strm)),d?BS_FINISH_STARTED:BS_NEED_MORE)},deflate_fast=(e,i)=>{let a,s;for(;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&i===Z_NO_FLUSH$2)return BS_NEED_MORE;if(e.lookahead===0)break}if(a=0,e.lookahead>=MIN_MATCH&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),a!==0&&e.strstart-a<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,a)),e.match_length>=MIN_MATCH)if(s=_tr_tally(e,e.strstart-e.match_start,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=MIN_MATCH){e.match_length--;do e.strstart++,e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+1]);else s=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,i===Z_FINISH$3?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.sym_next&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=(e,i)=>{let a,s,o;for(;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&i===Z_NO_FLUSH$2)return BS_NEED_MORE;if(e.lookahead===0)break}if(a=0,e.lookahead>=MIN_MATCH&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=MIN_MATCH-1,a!==0&&e.prev_length<e.max_lazy_match&&e.strstart-a<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,a),e.match_length<=5&&(e.strategy===Z_FILTERED||e.match_length===MIN_MATCH&&e.strstart-e.match_start>4096)&&(e.match_length=MIN_MATCH-1)),e.prev_length>=MIN_MATCH&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-MIN_MATCH,s=_tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-MIN_MATCH),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=MIN_MATCH-1,e.strstart++,s&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}else if(e.match_available){if(s=_tr_tally(e,0,e.window[e.strstart-1]),s&&flush_block_only(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=_tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,i===Z_FINISH$3?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.sym_next&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=(e,i)=>{let a,s,o,h;const d=e.window;for(;;){if(e.lookahead<=MAX_MATCH){if(fill_window(e),e.lookahead<=MAX_MATCH&&i===Z_NO_FLUSH$2)return BS_NEED_MORE;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=MIN_MATCH&&e.strstart>0&&(o=e.strstart-1,s=d[o],s===d[++o]&&s===d[++o]&&s===d[++o])){h=e.strstart+MAX_MATCH;do;while(s===d[++o]&&s===d[++o]&&s===d[++o]&&s===d[++o]&&s===d[++o]&&s===d[++o]&&s===d[++o]&&s===d[++o]&&o<h);e.match_length=MAX_MATCH-(h-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=MIN_MATCH?(a=_tr_tally(e,1,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(a=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),a&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,i===Z_FINISH$3?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.sym_next&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=(e,i)=>{let a;for(;;){if(e.lookahead===0&&(fill_window(e),e.lookahead===0)){if(i===Z_NO_FLUSH$2)return BS_NEED_MORE;break}if(e.match_length=0,a=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,a&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,i===Z_FINISH$3?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.sym_next&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(e,i,a,s,o){this.good_length=e,this.max_lazy=i,this.nice_length=a,this.max_chain=s,this.func=o}const configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=e=>{e.window_size=2*e.w_size,zero(e.head),e.max_lazy_match=configuration_table[e.level].max_lazy,e.good_match=configuration_table[e.level].good_length,e.nice_match=configuration_table[e.level].nice_length,e.max_chain_length=configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=MIN_MATCH-1,e.match_available=0,e.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(HEAP_SIZE*2),this.dyn_dtree=new Uint16Array((2*D_CODES+1)*2),this.bl_tree=new Uint16Array((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateStateCheck=e=>{if(!e)return 1;const i=e.state;return!i||i.strm!==e||i.status!==INIT_STATE&&i.status!==GZIP_STATE&&i.status!==EXTRA_STATE&&i.status!==NAME_STATE&&i.status!==COMMENT_STATE&&i.status!==HCRC_STATE&&i.status!==BUSY_STATE&&i.status!==FINISH_STATE?1:0},deflateResetKeep=e=>{if(deflateStateCheck(e))return err(e,Z_STREAM_ERROR$2);e.total_in=e.total_out=0,e.data_type=Z_UNKNOWN;const i=e.state;return i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap===2?GZIP_STATE:i.wrap?INIT_STATE:BUSY_STATE,e.adler=i.wrap===2?0:1,i.last_flush=-2,_tr_init(i),Z_OK$3},deflateReset=e=>{const i=deflateResetKeep(e);return i===Z_OK$3&&lm_init(e.state),i},deflateSetHeader=(e,i)=>deflateStateCheck(e)||e.state.wrap!==2?Z_STREAM_ERROR$2:(e.state.gzhead=i,Z_OK$3),deflateInit2=(e,i,a,s,o,h)=>{if(!e)return Z_STREAM_ERROR$2;let d=1;if(i===Z_DEFAULT_COMPRESSION$1&&(i=6),s<0?(d=0,s=-s):s>15&&(d=2,s-=16),o<1||o>MAX_MEM_LEVEL||a!==Z_DEFLATED$2||s<8||s>15||i<0||i>9||h<0||h>Z_FIXED||s===8&&d!==1)return err(e,Z_STREAM_ERROR$2);s===8&&(s=9);const g=new DeflateState;return e.state=g,g.strm=e,g.status=INIT_STATE,g.wrap=d,g.gzhead=null,g.w_bits=s,g.w_size=1<<g.w_bits,g.w_mask=g.w_size-1,g.hash_bits=o+7,g.hash_size=1<<g.hash_bits,g.hash_mask=g.hash_size-1,g.hash_shift=~~((g.hash_bits+MIN_MATCH-1)/MIN_MATCH),g.window=new Uint8Array(g.w_size*2),g.head=new Uint16Array(g.hash_size),g.prev=new Uint16Array(g.w_size),g.lit_bufsize=1<<o+6,g.pending_buf_size=g.lit_bufsize*4,g.pending_buf=new Uint8Array(g.pending_buf_size),g.sym_buf=g.lit_bufsize,g.sym_end=(g.lit_bufsize-1)*3,g.level=i,g.strategy=h,g.method=a,deflateReset(e)},deflateInit=(e,i)=>deflateInit2(e,i,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1),deflate$2=(e,i)=>{if(deflateStateCheck(e)||i>Z_BLOCK$1||i<0)return e?err(e,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;const a=e.state;if(!e.output||e.avail_in!==0&&!e.input||a.status===FINISH_STATE&&i!==Z_FINISH$3)return err(e,e.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$2);const s=a.last_flush;if(a.last_flush=i,a.pending!==0){if(flush_pending(e),e.avail_out===0)return a.last_flush=-1,Z_OK$3}else if(e.avail_in===0&&rank(i)<=rank(s)&&i!==Z_FINISH$3)return err(e,Z_BUF_ERROR$1);if(a.status===FINISH_STATE&&e.avail_in!==0)return err(e,Z_BUF_ERROR$1);if(a.status===INIT_STATE&&a.wrap===0&&(a.status=BUSY_STATE),a.status===INIT_STATE){let o=Z_DEFLATED$2+(a.w_bits-8<<4)<<8,h=-1;if(a.strategy>=Z_HUFFMAN_ONLY||a.level<2?h=0:a.level<6?h=1:a.level===6?h=2:h=3,o|=h<<6,a.strstart!==0&&(o|=PRESET_DICT),o+=31-o%31,putShortMSB(a,o),a.strstart!==0&&(putShortMSB(a,e.adler>>>16),putShortMSB(a,e.adler&65535)),e.adler=1,a.status=BUSY_STATE,flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3}if(a.status===GZIP_STATE){if(e.adler=0,put_byte(a,31),put_byte(a,139),put_byte(a,8),a.gzhead)put_byte(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),put_byte(a,a.gzhead.time&255),put_byte(a,a.gzhead.time>>8&255),put_byte(a,a.gzhead.time>>16&255),put_byte(a,a.gzhead.time>>24&255),put_byte(a,a.level===9?2:a.strategy>=Z_HUFFMAN_ONLY||a.level<2?4:0),put_byte(a,a.gzhead.os&255),a.gzhead.extra&&a.gzhead.extra.length&&(put_byte(a,a.gzhead.extra.length&255),put_byte(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=EXTRA_STATE;else if(put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,0),put_byte(a,a.level===9?2:a.strategy>=Z_HUFFMAN_ONLY||a.level<2?4:0),put_byte(a,OS_CODE),a.status=BUSY_STATE,flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3}if(a.status===EXTRA_STATE){if(a.gzhead.extra){let o=a.pending,h=(a.gzhead.extra.length&65535)-a.gzindex;for(;a.pending+h>a.pending_buf_size;){let g=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+g),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex+=g,flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3;o=0,h-=g}let d=new Uint8Array(a.gzhead.extra);a.pending_buf.set(d.subarray(a.gzindex,a.gzindex+h),a.pending),a.pending+=h,a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex=0}a.status=NAME_STATE}if(a.status===NAME_STATE){if(a.gzhead.name){let o=a.pending,h;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3;o=0}a.gzindex<a.gzhead.name.length?h=a.gzhead.name.charCodeAt(a.gzindex++)&255:h=0,put_byte(a,h)}while(h!==0);a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex=0}a.status=COMMENT_STATE}if(a.status===COMMENT_STATE){if(a.gzhead.comment){let o=a.pending,h;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o)),flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3;o=0}a.gzindex<a.gzhead.comment.length?h=a.gzhead.comment.charCodeAt(a.gzindex++)&255:h=0,put_byte(a,h)}while(h!==0);a.gzhead.hcrc&&a.pending>o&&(e.adler=crc32_1$2(e.adler,a.pending_buf,a.pending-o,o))}a.status=HCRC_STATE}if(a.status===HCRC_STATE){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(flush_pending(e),a.pending!==0))return a.last_flush=-1,Z_OK$3;put_byte(a,e.adler&255),put_byte(a,e.adler>>8&255),e.adler=0}if(a.status=BUSY_STATE,flush_pending(e),a.pending!==0)return a.last_flush=-1,Z_OK$3}if(e.avail_in!==0||a.lookahead!==0||i!==Z_NO_FLUSH$2&&a.status!==FINISH_STATE){let o=a.level===0?deflate_stored(a,i):a.strategy===Z_HUFFMAN_ONLY?deflate_huff(a,i):a.strategy===Z_RLE?deflate_rle(a,i):configuration_table[a.level].func(a,i);if((o===BS_FINISH_STARTED||o===BS_FINISH_DONE)&&(a.status=FINISH_STATE),o===BS_NEED_MORE||o===BS_FINISH_STARTED)return e.avail_out===0&&(a.last_flush=-1),Z_OK$3;if(o===BS_BLOCK_DONE&&(i===Z_PARTIAL_FLUSH?_tr_align(a):i!==Z_BLOCK$1&&(_tr_stored_block(a,0,0,!1),i===Z_FULL_FLUSH$1&&(zero(a.head),a.lookahead===0&&(a.strstart=0,a.block_start=0,a.insert=0))),flush_pending(e),e.avail_out===0))return a.last_flush=-1,Z_OK$3}return i!==Z_FINISH$3?Z_OK$3:a.wrap<=0?Z_STREAM_END$3:(a.wrap===2?(put_byte(a,e.adler&255),put_byte(a,e.adler>>8&255),put_byte(a,e.adler>>16&255),put_byte(a,e.adler>>24&255),put_byte(a,e.total_in&255),put_byte(a,e.total_in>>8&255),put_byte(a,e.total_in>>16&255),put_byte(a,e.total_in>>24&255)):(putShortMSB(a,e.adler>>>16),putShortMSB(a,e.adler&65535)),flush_pending(e),a.wrap>0&&(a.wrap=-a.wrap),a.pending!==0?Z_OK$3:Z_STREAM_END$3)},deflateEnd=e=>{if(deflateStateCheck(e))return Z_STREAM_ERROR$2;const i=e.state.status;return e.state=null,i===BUSY_STATE?err(e,Z_DATA_ERROR$2):Z_OK$3},deflateSetDictionary=(e,i)=>{let a=i.length;if(deflateStateCheck(e))return Z_STREAM_ERROR$2;const s=e.state,o=s.wrap;if(o===2||o===1&&s.status!==INIT_STATE||s.lookahead)return Z_STREAM_ERROR$2;if(o===1&&(e.adler=adler32_1$2(e.adler,i,a,0)),s.wrap=0,a>=s.w_size){o===0&&(zero(s.head),s.strstart=0,s.block_start=0,s.insert=0);let b=new Uint8Array(s.w_size);b.set(i.subarray(a-s.w_size,a),0),i=b,a=s.w_size}const h=e.avail_in,d=e.next_in,g=e.input;for(e.avail_in=a,e.next_in=0,e.input=i,fill_window(s);s.lookahead>=MIN_MATCH;){let b=s.strstart,_=s.lookahead-(MIN_MATCH-1);do s.ins_h=HASH(s,s.ins_h,s.window[b+MIN_MATCH-1]),s.prev[b&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=b,b++;while(--_);s.strstart=b,s.lookahead=MIN_MATCH-1,fill_window(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,e.next_in=d,e.input=g,e.avail_in=h,s.wrap=o,Z_OK$3};var deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2$1=deflate$2,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1$2={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2$1,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo};const _has$1=(e,i)=>Object.prototype.hasOwnProperty.call(e,i);var assign$1=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const a=i.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(const s in a)_has$1(a,s)&&(e[s]=a[s])}}return e},flattenChunks$1=e=>{let i=0;for(let s=0,o=e.length;s<o;s++)i+=e[s].length;const a=new Uint8Array(i);for(let s=0,o=0,h=e.length;s<h;s++){let d=e[s];a.set(d,o),o+=d.length}return a},common$2={assign:assign$1,flattenChunks:flattenChunks$1};let STR_APPLY_UIA_OK$1=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{STR_APPLY_UIA_OK$1=!1}const _utf8len$1=new Uint8Array(256);for(let e=0;e<256;e++)_utf8len$1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_utf8len$1[254]=_utf8len$1[254]=1;var string2buf$1=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let i,a,s,o,h,d=e.length,g=0;for(o=0;o<d;o++)a=e.charCodeAt(o),(a&64512)===55296&&o+1<d&&(s=e.charCodeAt(o+1),(s&64512)===56320&&(a=65536+(a-55296<<10)+(s-56320),o++)),g+=a<128?1:a<2048?2:a<65536?3:4;for(i=new Uint8Array(g),h=0,o=0;h<g;o++)a=e.charCodeAt(o),(a&64512)===55296&&o+1<d&&(s=e.charCodeAt(o+1),(s&64512)===56320&&(a=65536+(a-55296<<10)+(s-56320),o++)),a<128?i[h++]=a:a<2048?(i[h++]=192|a>>>6,i[h++]=128|a&63):a<65536?(i[h++]=224|a>>>12,i[h++]=128|a>>>6&63,i[h++]=128|a&63):(i[h++]=240|a>>>18,i[h++]=128|a>>>12&63,i[h++]=128|a>>>6&63,i[h++]=128|a&63);return i};const buf2binstring$1=(e,i)=>{if(i<65534&&e.subarray&&STR_APPLY_UIA_OK$1)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let a="";for(let s=0;s<i;s++)a+=String.fromCharCode(e[s]);return a};var buf2string$1=(e,i)=>{const a=i||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,i));let s,o;const h=new Array(a*2);for(o=0,s=0;s<a;){let d=e[s++];if(d<128){h[o++]=d;continue}let g=_utf8len$1[d];if(g>4){h[o++]=65533,s+=g-1;continue}for(d&=g===2?31:g===3?15:7;g>1&&s<a;)d=d<<6|e[s++]&63,g--;if(g>1){h[o++]=65533;continue}d<65536?h[o++]=d:(d-=65536,h[o++]=55296|d>>10&1023,h[o++]=56320|d&1023)}return buf2binstring$1(h,o)},utf8border$1=(e,i)=>{i=i||e.length,i>e.length&&(i=e.length);let a=i-1;for(;a>=0&&(e[a]&192)===128;)a--;return a<0||a===0?i:a+_utf8len$1[e[a]]>i?a:i},strings$2={string2buf:string2buf$1,buf2string:buf2string$1,utf8border:utf8border$1};function ZStream$1(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream$2=ZStream$1;const toString$1$1=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$1,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH:Z_FINISH$2,Z_OK:Z_OK$2,Z_STREAM_END:Z_STREAM_END$2,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED:Z_DEFLATED$1}=constants$2$1;function Deflate$1(e){this.options=common$2.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},e||{});let i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream$2,this.strm.avail_out=0;let a=deflate_1$2.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(a!==Z_OK$2)throw new Error(messages$2[a]);if(i.header&&deflate_1$2.deflateSetHeader(this.strm,i.header),i.dictionary){let s;if(typeof i.dictionary=="string"?s=strings$2.string2buf(i.dictionary):toString$1$1.call(i.dictionary)==="[object ArrayBuffer]"?s=new Uint8Array(i.dictionary):s=i.dictionary,a=deflate_1$2.deflateSetDictionary(this.strm,s),a!==Z_OK$2)throw new Error(messages$2[a]);this._dict_set=!0}}Deflate$1.prototype.push=function(e,i){const a=this.strm,s=this.options.chunkSize;let o,h;if(this.ended)return!1;for(i===~~i?h=i:h=i===!0?Z_FINISH$2:Z_NO_FLUSH$1,typeof e=="string"?a.input=strings$2.string2buf(e):toString$1$1.call(e)==="[object ArrayBuffer]"?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){if(a.avail_out===0&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),(h===Z_SYNC_FLUSH||h===Z_FULL_FLUSH)&&a.avail_out<=6){this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;continue}if(o=deflate_1$2.deflate(a,h),o===Z_STREAM_END$2)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),o=deflate_1$2.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===Z_OK$2;if(a.avail_out===0){this.onData(a.output);continue}if(h>0&&a.next_out>0){this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;continue}if(a.avail_in===0)break}return!0};Deflate$1.prototype.onData=function(e){this.chunks.push(e)};Deflate$1.prototype.onEnd=function(e){e===Z_OK$2&&(this.result=common$2.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function deflate$1$1(e,i){const a=new Deflate$1(i);if(a.push(e,!0),a.err)throw a.msg||messages$2[a.err];return a.result}var deflate_2=deflate$1$1,deflate_1$1={deflate:deflate_2};const BAD$1$1=16209,TYPE$1$1=16191;var inffast$2=function(e,i){let a,s,o,h,d,g,b,_,$,it,nt,tt,at,ut,ft,ht,dt,st,ct,wt,_t,gt,yt,bt;const vt=e.state;a=e.next_in,yt=e.input,s=a+(e.avail_in-5),o=e.next_out,bt=e.output,h=o-(i-e.avail_out),d=o+(e.avail_out-257),g=vt.dmax,b=vt.wsize,_=vt.whave,$=vt.wnext,it=vt.window,nt=vt.hold,tt=vt.bits,at=vt.lencode,ut=vt.distcode,ft=(1<<vt.lenbits)-1,ht=(1<<vt.distbits)-1;t:do{tt<15&&(nt+=yt[a++]<<tt,tt+=8,nt+=yt[a++]<<tt,tt+=8),dt=at[nt&ft];e:for(;;){if(st=dt>>>24,nt>>>=st,tt-=st,st=dt>>>16&255,st===0)bt[o++]=dt&65535;else if(st&16){ct=dt&65535,st&=15,st&&(tt<st&&(nt+=yt[a++]<<tt,tt+=8),ct+=nt&(1<<st)-1,nt>>>=st,tt-=st),tt<15&&(nt+=yt[a++]<<tt,tt+=8,nt+=yt[a++]<<tt,tt+=8),dt=ut[nt&ht];r:for(;;){if(st=dt>>>24,nt>>>=st,tt-=st,st=dt>>>16&255,st&16){if(wt=dt&65535,st&=15,tt<st&&(nt+=yt[a++]<<tt,tt+=8,tt<st&&(nt+=yt[a++]<<tt,tt+=8)),wt+=nt&(1<<st)-1,wt>g){e.msg="invalid distance too far back",vt.mode=BAD$1$1;break t}if(nt>>>=st,tt-=st,st=o-h,wt>st){if(st=wt-st,st>_&&vt.sane){e.msg="invalid distance too far back",vt.mode=BAD$1$1;break t}if(_t=0,gt=it,$===0){if(_t+=b-st,st<ct){ct-=st;do bt[o++]=it[_t++];while(--st);_t=o-wt,gt=bt}}else if($<st){if(_t+=b+$-st,st-=$,st<ct){ct-=st;do bt[o++]=it[_t++];while(--st);if(_t=0,$<ct){st=$,ct-=st;do bt[o++]=it[_t++];while(--st);_t=o-wt,gt=bt}}}else if(_t+=$-st,st<ct){ct-=st;do bt[o++]=it[_t++];while(--st);_t=o-wt,gt=bt}for(;ct>2;)bt[o++]=gt[_t++],bt[o++]=gt[_t++],bt[o++]=gt[_t++],ct-=3;ct&&(bt[o++]=gt[_t++],ct>1&&(bt[o++]=gt[_t++]))}else{_t=o-wt;do bt[o++]=bt[_t++],bt[o++]=bt[_t++],bt[o++]=bt[_t++],ct-=3;while(ct>2);ct&&(bt[o++]=bt[_t++],ct>1&&(bt[o++]=bt[_t++]))}}else if(st&64){e.msg="invalid distance code",vt.mode=BAD$1$1;break t}else{dt=ut[(dt&65535)+(nt&(1<<st)-1)];continue r}break}}else if(st&64)if(st&32){vt.mode=TYPE$1$1;break t}else{e.msg="invalid literal/length code",vt.mode=BAD$1$1;break t}else{dt=at[(dt&65535)+(nt&(1<<st)-1)];continue e}break}}while(a<s&&o<d);ct=tt>>3,a-=ct,tt-=ct<<3,nt&=(1<<tt)-1,e.next_in=a,e.next_out=o,e.avail_in=a<s?5+(s-a):5-(a-s),e.avail_out=o<d?257+(d-o):257-(o-d),vt.hold=nt,vt.bits=tt};const MAXBITS$1=15,ENOUGH_LENS$1$1=852,ENOUGH_DISTS$1$1=592,CODES$1$1=0,LENS$1$1=1,DISTS$1$1=2,lbase$1=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext$1=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase$1=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext$1=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table$1=(e,i,a,s,o,h,d,g)=>{const b=g.bits;let _=0,$=0,it=0,nt=0,tt=0,at=0,ut=0,ft=0,ht=0,dt=0,st,ct,wt,_t,gt,yt=null,bt;const vt=new Uint16Array(MAXBITS$1+1),Ct=new Uint16Array(MAXBITS$1+1);let Ht=null,Ft,qt,zt;for(_=0;_<=MAXBITS$1;_++)vt[_]=0;for($=0;$<s;$++)vt[i[a+$]]++;for(tt=b,nt=MAXBITS$1;nt>=1&&vt[nt]===0;nt--);if(tt>nt&&(tt=nt),nt===0)return o[h++]=1<<24|64<<16|0,o[h++]=1<<24|64<<16|0,g.bits=1,0;for(it=1;it<nt&&vt[it]===0;it++);for(tt<it&&(tt=it),ft=1,_=1;_<=MAXBITS$1;_++)if(ft<<=1,ft-=vt[_],ft<0)return-1;if(ft>0&&(e===CODES$1$1||nt!==1))return-1;for(Ct[1]=0,_=1;_<MAXBITS$1;_++)Ct[_+1]=Ct[_]+vt[_];for($=0;$<s;$++)i[a+$]!==0&&(d[Ct[i[a+$]]++]=$);if(e===CODES$1$1?(yt=Ht=d,bt=20):e===LENS$1$1?(yt=lbase$1,Ht=lext$1,bt=257):(yt=dbase$1,Ht=dext$1,bt=0),dt=0,$=0,_=it,gt=h,at=tt,ut=0,wt=-1,ht=1<<tt,_t=ht-1,e===LENS$1$1&&ht>ENOUGH_LENS$1$1||e===DISTS$1$1&&ht>ENOUGH_DISTS$1$1)return 1;for(;;){Ft=_-ut,d[$]+1<bt?(qt=0,zt=d[$]):d[$]>=bt?(qt=Ht[d[$]-bt],zt=yt[d[$]-bt]):(qt=96,zt=0),st=1<<_-ut,ct=1<<at,it=ct;do ct-=st,o[gt+(dt>>ut)+ct]=Ft<<24|qt<<16|zt|0;while(ct!==0);for(st=1<<_-1;dt&st;)st>>=1;if(st!==0?(dt&=st-1,dt+=st):dt=0,$++,--vt[_]===0){if(_===nt)break;_=i[a+d[$]]}if(_>tt&&(dt&_t)!==wt){for(ut===0&&(ut=tt),gt+=it,at=_-ut,ft=1<<at;at+ut<nt&&(ft-=vt[at+ut],!(ft<=0));)at++,ft<<=1;if(ht+=1<<at,e===LENS$1$1&&ht>ENOUGH_LENS$1$1||e===DISTS$1$1&&ht>ENOUGH_DISTS$1$1)return 1;wt=dt&_t,o[wt]=tt<<24|at<<16|gt-h|0}}return dt!==0&&(o[gt+dt]=_-ut<<24|64<<16|0),g.bits=tt,0};var inftrees$2=inflate_table$1;const CODES$2=0,LENS$2=1,DISTS$2=2,{Z_FINISH:Z_FINISH$1$1,Z_BLOCK:Z_BLOCK$2,Z_TREES:Z_TREES$1,Z_OK:Z_OK$1$1,Z_STREAM_END:Z_STREAM_END$1$1,Z_NEED_DICT:Z_NEED_DICT$1$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1$1,Z_DATA_ERROR:Z_DATA_ERROR$1$1,Z_MEM_ERROR:Z_MEM_ERROR$1$1,Z_BUF_ERROR:Z_BUF_ERROR$2,Z_DEFLATED:Z_DEFLATED$3}=constants$2$1,HEAD$1=16180,FLAGS$1=16181,TIME$1=16182,OS$1=16183,EXLEN$1=16184,EXTRA$1=16185,NAME$1=16186,COMMENT$1=16187,HCRC$1=16188,DICTID$1=16189,DICT$1=16190,TYPE$2=16191,TYPEDO$1=16192,STORED$1=16193,COPY_$1=16194,COPY$1=16195,TABLE$1=16196,LENLENS$1=16197,CODELENS$1=16198,LEN_$1=16199,LEN$1=16200,LENEXT$1=16201,DIST$1=16202,DISTEXT$1=16203,MATCH$1=16204,LIT$1=16205,CHECK$1=16206,LENGTH$1=16207,DONE$1=16208,BAD$2=16209,MEM$1=16210,SYNC$1=16211,ENOUGH_LENS$2=852,ENOUGH_DISTS$2=592,MAX_WBITS$2=15,DEF_WBITS$1=MAX_WBITS$2,zswap32$1=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function InflateState$1(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck$1=e=>{if(!e)return 1;const i=e.state;return!i||i.strm!==e||i.mode<HEAD$1||i.mode>SYNC$1?1:0},inflateResetKeep$1=e=>{if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;const i=e.state;return e.total_in=e.total_out=i.total=0,e.msg="",i.wrap&&(e.adler=i.wrap&1),i.mode=HEAD$1,i.last=0,i.havedict=0,i.flags=-1,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new Int32Array(ENOUGH_LENS$2),i.distcode=i.distdyn=new Int32Array(ENOUGH_DISTS$2),i.sane=1,i.back=-1,Z_OK$1$1},inflateReset$1=e=>{if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;const i=e.state;return i.wsize=0,i.whave=0,i.wnext=0,inflateResetKeep$1(e)},inflateReset2$1=(e,i)=>{let a;if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;const s=e.state;return i<0?(a=0,i=-i):(a=(i>>4)+5,i<48&&(i&=15)),i&&(i<8||i>15)?Z_STREAM_ERROR$1$1:(s.window!==null&&s.wbits!==i&&(s.window=null),s.wrap=a,s.wbits=i,inflateReset$1(e))},inflateInit2$1=(e,i)=>{if(!e)return Z_STREAM_ERROR$1$1;const a=new InflateState$1;e.state=a,a.strm=e,a.window=null,a.mode=HEAD$1;const s=inflateReset2$1(e,i);return s!==Z_OK$1$1&&(e.state=null),s},inflateInit$1=e=>inflateInit2$1(e,DEF_WBITS$1);let virgin$1=!0,lenfix$1,distfix$1;const fixedtables$1=e=>{if(virgin$1){lenfix$1=new Int32Array(512),distfix$1=new Int32Array(32);let i=0;for(;i<144;)e.lens[i++]=8;for(;i<256;)e.lens[i++]=9;for(;i<280;)e.lens[i++]=7;for(;i<288;)e.lens[i++]=8;for(inftrees$2(LENS$2,e.lens,0,288,lenfix$1,0,e.work,{bits:9}),i=0;i<32;)e.lens[i++]=5;inftrees$2(DISTS$2,e.lens,0,32,distfix$1,0,e.work,{bits:5}),virgin$1=!1}e.lencode=lenfix$1,e.lenbits=9,e.distcode=distfix$1,e.distbits=5},updatewindow$1=(e,i,a,s)=>{let o;const h=e.state;return h.window===null&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new Uint8Array(h.wsize)),s>=h.wsize?(h.window.set(i.subarray(a-h.wsize,a),0),h.wnext=0,h.whave=h.wsize):(o=h.wsize-h.wnext,o>s&&(o=s),h.window.set(i.subarray(a-s,a-s+o),h.wnext),s-=o,s?(h.window.set(i.subarray(a-s,a),0),h.wnext=s,h.whave=h.wsize):(h.wnext+=o,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=o))),0},inflate$2$1=(e,i)=>{let a,s,o,h,d,g,b,_,$,it,nt,tt,at,ut,ft=0,ht,dt,st,ct,wt,_t,gt,yt;const bt=new Uint8Array(4);let vt,Ct;const Ht=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck$1(e)||!e.output||!e.input&&e.avail_in!==0)return Z_STREAM_ERROR$1$1;a=e.state,a.mode===TYPE$2&&(a.mode=TYPEDO$1),d=e.next_out,o=e.output,b=e.avail_out,h=e.next_in,s=e.input,g=e.avail_in,_=a.hold,$=a.bits,it=g,nt=b,yt=Z_OK$1$1;t:for(;;)switch(a.mode){case HEAD$1:if(a.wrap===0){a.mode=TYPEDO$1;break}for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.wrap&2&&_===35615){a.wbits===0&&(a.wbits=15),a.check=0,bt[0]=_&255,bt[1]=_>>>8&255,a.check=crc32_1$2(a.check,bt,2,0),_=0,$=0,a.mode=FLAGS$1;break}if(a.head&&(a.head.done=!1),!(a.wrap&1)||(((_&255)<<8)+(_>>8))%31){e.msg="incorrect header check",a.mode=BAD$2;break}if((_&15)!==Z_DEFLATED$3){e.msg="unknown compression method",a.mode=BAD$2;break}if(_>>>=4,$-=4,gt=(_&15)+8,a.wbits===0&&(a.wbits=gt),gt>15||gt>a.wbits){e.msg="invalid window size",a.mode=BAD$2;break}a.dmax=1<<a.wbits,a.flags=0,e.adler=a.check=1,a.mode=_&512?DICTID$1:TYPE$2,_=0,$=0;break;case FLAGS$1:for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.flags=_,(a.flags&255)!==Z_DEFLATED$3){e.msg="unknown compression method",a.mode=BAD$2;break}if(a.flags&57344){e.msg="unknown header flags set",a.mode=BAD$2;break}a.head&&(a.head.text=_>>8&1),a.flags&512&&a.wrap&4&&(bt[0]=_&255,bt[1]=_>>>8&255,a.check=crc32_1$2(a.check,bt,2,0)),_=0,$=0,a.mode=TIME$1;case TIME$1:for(;$<32;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.head&&(a.head.time=_),a.flags&512&&a.wrap&4&&(bt[0]=_&255,bt[1]=_>>>8&255,bt[2]=_>>>16&255,bt[3]=_>>>24&255,a.check=crc32_1$2(a.check,bt,4,0)),_=0,$=0,a.mode=OS$1;case OS$1:for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.head&&(a.head.xflags=_&255,a.head.os=_>>8),a.flags&512&&a.wrap&4&&(bt[0]=_&255,bt[1]=_>>>8&255,a.check=crc32_1$2(a.check,bt,2,0)),_=0,$=0,a.mode=EXLEN$1;case EXLEN$1:if(a.flags&1024){for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.length=_,a.head&&(a.head.extra_len=_),a.flags&512&&a.wrap&4&&(bt[0]=_&255,bt[1]=_>>>8&255,a.check=crc32_1$2(a.check,bt,2,0)),_=0,$=0}else a.head&&(a.head.extra=null);a.mode=EXTRA$1;case EXTRA$1:if(a.flags&1024&&(tt=a.length,tt>g&&(tt=g),tt&&(a.head&&(gt=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(s.subarray(h,h+tt),gt)),a.flags&512&&a.wrap&4&&(a.check=crc32_1$2(a.check,s,tt,h)),g-=tt,h+=tt,a.length-=tt),a.length))break t;a.length=0,a.mode=NAME$1;case NAME$1:if(a.flags&2048){if(g===0)break t;tt=0;do gt=s[h+tt++],a.head&&gt&&a.length<65536&&(a.head.name+=String.fromCharCode(gt));while(gt&&tt<g);if(a.flags&512&&a.wrap&4&&(a.check=crc32_1$2(a.check,s,tt,h)),g-=tt,h+=tt,gt)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=COMMENT$1;case COMMENT$1:if(a.flags&4096){if(g===0)break t;tt=0;do gt=s[h+tt++],a.head&&gt&&a.length<65536&&(a.head.comment+=String.fromCharCode(gt));while(gt&&tt<g);if(a.flags&512&&a.wrap&4&&(a.check=crc32_1$2(a.check,s,tt,h)),g-=tt,h+=tt,gt)break t}else a.head&&(a.head.comment=null);a.mode=HCRC$1;case HCRC$1:if(a.flags&512){for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.wrap&4&&_!==(a.check&65535)){e.msg="header crc mismatch",a.mode=BAD$2;break}_=0,$=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=TYPE$2;break;case DICTID$1:for(;$<32;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}e.adler=a.check=zswap32$1(_),_=0,$=0,a.mode=DICT$1;case DICT$1:if(a.havedict===0)return e.next_out=d,e.avail_out=b,e.next_in=h,e.avail_in=g,a.hold=_,a.bits=$,Z_NEED_DICT$1$1;e.adler=a.check=1,a.mode=TYPE$2;case TYPE$2:if(i===Z_BLOCK$2||i===Z_TREES$1)break t;case TYPEDO$1:if(a.last){_>>>=$&7,$-=$&7,a.mode=CHECK$1;break}for(;$<3;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}switch(a.last=_&1,_>>>=1,$-=1,_&3){case 0:a.mode=STORED$1;break;case 1:if(fixedtables$1(a),a.mode=LEN_$1,i===Z_TREES$1){_>>>=2,$-=2;break t}break;case 2:a.mode=TABLE$1;break;case 3:e.msg="invalid block type",a.mode=BAD$2}_>>>=2,$-=2;break;case STORED$1:for(_>>>=$&7,$-=$&7;$<32;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if((_&65535)!==(_>>>16^65535)){e.msg="invalid stored block lengths",a.mode=BAD$2;break}if(a.length=_&65535,_=0,$=0,a.mode=COPY_$1,i===Z_TREES$1)break t;case COPY_$1:a.mode=COPY$1;case COPY$1:if(tt=a.length,tt){if(tt>g&&(tt=g),tt>b&&(tt=b),tt===0)break t;o.set(s.subarray(h,h+tt),d),g-=tt,h+=tt,b-=tt,d+=tt,a.length-=tt;break}a.mode=TYPE$2;break;case TABLE$1:for(;$<14;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.nlen=(_&31)+257,_>>>=5,$-=5,a.ndist=(_&31)+1,_>>>=5,$-=5,a.ncode=(_&15)+4,_>>>=4,$-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=BAD$2;break}a.have=0,a.mode=LENLENS$1;case LENLENS$1:for(;a.have<a.ncode;){for(;$<3;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.lens[Ht[a.have++]]=_&7,_>>>=3,$-=3}for(;a.have<19;)a.lens[Ht[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,vt={bits:a.lenbits},yt=inftrees$2(CODES$2,a.lens,0,19,a.lencode,0,a.work,vt),a.lenbits=vt.bits,yt){e.msg="invalid code lengths set",a.mode=BAD$2;break}a.have=0,a.mode=CODELENS$1;case CODELENS$1:for(;a.have<a.nlen+a.ndist;){for(;ft=a.lencode[_&(1<<a.lenbits)-1],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(st<16)_>>>=ht,$-=ht,a.lens[a.have++]=st;else{if(st===16){for(Ct=ht+2;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(_>>>=ht,$-=ht,a.have===0){e.msg="invalid bit length repeat",a.mode=BAD$2;break}gt=a.lens[a.have-1],tt=3+(_&3),_>>>=2,$-=2}else if(st===17){for(Ct=ht+3;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}_>>>=ht,$-=ht,gt=0,tt=3+(_&7),_>>>=3,$-=3}else{for(Ct=ht+7;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}_>>>=ht,$-=ht,gt=0,tt=11+(_&127),_>>>=7,$-=7}if(a.have+tt>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=BAD$2;break}for(;tt--;)a.lens[a.have++]=gt}}if(a.mode===BAD$2)break;if(a.lens[256]===0){e.msg="invalid code -- missing end-of-block",a.mode=BAD$2;break}if(a.lenbits=9,vt={bits:a.lenbits},yt=inftrees$2(LENS$2,a.lens,0,a.nlen,a.lencode,0,a.work,vt),a.lenbits=vt.bits,yt){e.msg="invalid literal/lengths set",a.mode=BAD$2;break}if(a.distbits=6,a.distcode=a.distdyn,vt={bits:a.distbits},yt=inftrees$2(DISTS$2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,vt),a.distbits=vt.bits,yt){e.msg="invalid distances set",a.mode=BAD$2;break}if(a.mode=LEN_$1,i===Z_TREES$1)break t;case LEN_$1:a.mode=LEN$1;case LEN$1:if(g>=6&&b>=258){e.next_out=d,e.avail_out=b,e.next_in=h,e.avail_in=g,a.hold=_,a.bits=$,inffast$2(e,nt),d=e.next_out,o=e.output,b=e.avail_out,h=e.next_in,s=e.input,g=e.avail_in,_=a.hold,$=a.bits,a.mode===TYPE$2&&(a.back=-1);break}for(a.back=0;ft=a.lencode[_&(1<<a.lenbits)-1],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(dt&&!(dt&240)){for(ct=ht,wt=dt,_t=st;ft=a.lencode[_t+((_&(1<<ct+wt)-1)>>ct)],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ct+ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}_>>>=ct,$-=ct,a.back+=ct}if(_>>>=ht,$-=ht,a.back+=ht,a.length=st,dt===0){a.mode=LIT$1;break}if(dt&32){a.back=-1,a.mode=TYPE$2;break}if(dt&64){e.msg="invalid literal/length code",a.mode=BAD$2;break}a.extra=dt&15,a.mode=LENEXT$1;case LENEXT$1:if(a.extra){for(Ct=a.extra;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.length+=_&(1<<a.extra)-1,_>>>=a.extra,$-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=DIST$1;case DIST$1:for(;ft=a.distcode[_&(1<<a.distbits)-1],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(!(dt&240)){for(ct=ht,wt=dt,_t=st;ft=a.distcode[_t+((_&(1<<ct+wt)-1)>>ct)],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ct+ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}_>>>=ct,$-=ct,a.back+=ct}if(_>>>=ht,$-=ht,a.back+=ht,dt&64){e.msg="invalid distance code",a.mode=BAD$2;break}a.offset=st,a.extra=dt&15,a.mode=DISTEXT$1;case DISTEXT$1:if(a.extra){for(Ct=a.extra;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.offset+=_&(1<<a.extra)-1,_>>>=a.extra,$-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=BAD$2;break}a.mode=MATCH$1;case MATCH$1:if(b===0)break t;if(tt=nt-b,a.offset>tt){if(tt=a.offset-tt,tt>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=BAD$2;break}tt>a.wnext?(tt-=a.wnext,at=a.wsize-tt):at=a.wnext-tt,tt>a.length&&(tt=a.length),ut=a.window}else ut=o,at=d-a.offset,tt=a.length;tt>b&&(tt=b),b-=tt,a.length-=tt;do o[d++]=ut[at++];while(--tt);a.length===0&&(a.mode=LEN$1);break;case LIT$1:if(b===0)break t;o[d++]=a.length,b--,a.mode=LEN$1;break;case CHECK$1:if(a.wrap){for(;$<32;){if(g===0)break t;g--,_|=s[h++]<<$,$+=8}if(nt-=b,e.total_out+=nt,a.total+=nt,a.wrap&4&&nt&&(e.adler=a.check=a.flags?crc32_1$2(a.check,o,nt,d-nt):adler32_1$2(a.check,o,nt,d-nt)),nt=b,a.wrap&4&&(a.flags?_:zswap32$1(_))!==a.check){e.msg="incorrect data check",a.mode=BAD$2;break}_=0,$=0}a.mode=LENGTH$1;case LENGTH$1:if(a.wrap&&a.flags){for(;$<32;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.wrap&4&&_!==(a.total&4294967295)){e.msg="incorrect length check",a.mode=BAD$2;break}_=0,$=0}a.mode=DONE$1;case DONE$1:yt=Z_STREAM_END$1$1;break t;case BAD$2:yt=Z_DATA_ERROR$1$1;break t;case MEM$1:return Z_MEM_ERROR$1$1;case SYNC$1:default:return Z_STREAM_ERROR$1$1}return e.next_out=d,e.avail_out=b,e.next_in=h,e.avail_in=g,a.hold=_,a.bits=$,(a.wsize||nt!==e.avail_out&&a.mode<BAD$2&&(a.mode<CHECK$1||i!==Z_FINISH$1$1))&&updatewindow$1(e,e.output,e.next_out,nt-e.avail_out),it-=e.avail_in,nt-=e.avail_out,e.total_in+=it,e.total_out+=nt,a.total+=nt,a.wrap&4&&nt&&(e.adler=a.check=a.flags?crc32_1$2(a.check,o,nt,e.next_out-nt):adler32_1$2(a.check,o,nt,e.next_out-nt)),e.data_type=a.bits+(a.last?64:0)+(a.mode===TYPE$2?128:0)+(a.mode===LEN_$1||a.mode===COPY_$1?256:0),(it===0&&nt===0||i===Z_FINISH$1$1)&&yt===Z_OK$1$1&&(yt=Z_BUF_ERROR$2),yt},inflateEnd$1=e=>{if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;let i=e.state;return i.window&&(i.window=null),e.state=null,Z_OK$1$1},inflateGetHeader$1=(e,i)=>{if(inflateStateCheck$1(e))return Z_STREAM_ERROR$1$1;const a=e.state;return a.wrap&2?(a.head=i,i.done=!1,Z_OK$1$1):Z_STREAM_ERROR$1$1},inflateSetDictionary$1=(e,i)=>{const a=i.length;let s,o,h;return inflateStateCheck$1(e)||(s=e.state,s.wrap!==0&&s.mode!==DICT$1)?Z_STREAM_ERROR$1$1:s.mode===DICT$1&&(o=1,o=adler32_1$2(o,i,a,0),o!==s.check)?Z_DATA_ERROR$1$1:(h=updatewindow$1(e,i,a,a),h?(s.mode=MEM$1,Z_MEM_ERROR$1$1):(s.havedict=1,Z_OK$1$1))};var inflateReset_1$1=inflateReset$1,inflateReset2_1$1=inflateReset2$1,inflateResetKeep_1$1=inflateResetKeep$1,inflateInit_1$1=inflateInit$1,inflateInit2_1$1=inflateInit2$1,inflate_2$1$1=inflate$2$1,inflateEnd_1$1=inflateEnd$1,inflateGetHeader_1$1=inflateGetHeader$1,inflateSetDictionary_1$1=inflateSetDictionary$1,inflateInfo$1="pako inflate (from Nodeca project)",inflate_1$2$1={inflateReset:inflateReset_1$1,inflateReset2:inflateReset2_1$1,inflateResetKeep:inflateResetKeep_1$1,inflateInit:inflateInit_1$1,inflateInit2:inflateInit2_1$1,inflate:inflate_2$1$1,inflateEnd:inflateEnd_1$1,inflateGetHeader:inflateGetHeader_1$1,inflateSetDictionary:inflateSetDictionary_1$1,inflateInfo:inflateInfo$1};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader$2=GZheader$1;const toString$2=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$3,Z_FINISH:Z_FINISH$4,Z_OK:Z_OK$4,Z_STREAM_END:Z_STREAM_END$4,Z_NEED_DICT:Z_NEED_DICT$2,Z_STREAM_ERROR:Z_STREAM_ERROR$3,Z_DATA_ERROR:Z_DATA_ERROR$3,Z_MEM_ERROR:Z_MEM_ERROR$2}=constants$2$1;function Inflate$1$1(e){this.options=common$2.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),i.windowBits>=0&&i.windowBits<16&&!(e&&e.windowBits)&&(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&!(i.windowBits&15)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream$2,this.strm.avail_out=0;let a=inflate_1$2$1.inflateInit2(this.strm,i.windowBits);if(a!==Z_OK$4)throw new Error(messages$2[a]);if(this.header=new gzheader$2,inflate_1$2$1.inflateGetHeader(this.strm,this.header),i.dictionary&&(typeof i.dictionary=="string"?i.dictionary=strings$2.string2buf(i.dictionary):toString$2.call(i.dictionary)==="[object ArrayBuffer]"&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(a=inflate_1$2$1.inflateSetDictionary(this.strm,i.dictionary),a!==Z_OK$4)))throw new Error(messages$2[a])}Inflate$1$1.prototype.push=function(e,i){const a=this.strm,s=this.options.chunkSize,o=this.options.dictionary;let h,d,g;if(this.ended)return!1;for(i===~~i?d=i:d=i===!0?Z_FINISH$4:Z_NO_FLUSH$3,toString$2.call(e)==="[object ArrayBuffer]"?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(a.avail_out===0&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),h=inflate_1$2$1.inflate(a,d),h===Z_NEED_DICT$2&&o&&(h=inflate_1$2$1.inflateSetDictionary(a,o),h===Z_OK$4?h=inflate_1$2$1.inflate(a,d):h===Z_DATA_ERROR$3&&(h=Z_NEED_DICT$2));a.avail_in>0&&h===Z_STREAM_END$4&&a.state.wrap>0&&e[a.next_in]!==0;)inflate_1$2$1.inflateReset(a),h=inflate_1$2$1.inflate(a,d);switch(h){case Z_STREAM_ERROR$3:case Z_DATA_ERROR$3:case Z_NEED_DICT$2:case Z_MEM_ERROR$2:return this.onEnd(h),this.ended=!0,!1}if(g=a.avail_out,a.next_out&&(a.avail_out===0||h===Z_STREAM_END$4))if(this.options.to==="string"){let b=strings$2.utf8border(a.output,a.next_out),_=a.next_out-b,$=strings$2.buf2string(a.output,b);a.next_out=_,a.avail_out=s-_,_&&a.output.set(a.output.subarray(b,b+_),0),this.onData($)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(!(h===Z_OK$4&&g===0)){if(h===Z_STREAM_END$4)return h=inflate_1$2$1.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,!0;if(a.avail_in===0)break}}return!0};Inflate$1$1.prototype.onData=function(e){this.chunks.push(e)};Inflate$1$1.prototype.onEnd=function(e){e===Z_OK$4&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common$2.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function inflate$1$2(e,i){const a=new Inflate$1$1(i);if(a.push(e),a.err)throw a.msg||messages$2[a.err];return a.result}var Inflate_1$1=Inflate$1$1,inflate_2$2=inflate$1$2,inflate_1$1$1={Inflate:Inflate_1$1,inflate:inflate_2$2};const{deflate:deflate$3}=deflate_1$1,{Inflate,inflate:inflate$4}=inflate_1$1$1;var deflate_1=deflate$3,Inflate_1=Inflate,inflate_1$3=inflate$4;const crcTable$1=[];for(let e=0;e<256;e++){let i=e;for(let a=0;a<8;a++)i&1?i=3988292384^i>>>1:i=i>>>1;crcTable$1[e]=i}const initialCrc=4294967295;function updateCrc(e,i,a){let s=e;for(let o=0;o<a;o++)s=crcTable$1[(s^i[o])&255]^s>>>8;return s}function crc(e,i){return(updateCrc(initialCrc,e,i)^initialCrc)>>>0}function checkCrc(e,i,a){const s=e.readUint32(),o=crc(new Uint8Array(e.buffer,e.byteOffset+e.offset-i-4,i),i);if(o!==s)throw new Error(`CRC mismatch for chunk ${a}. Expected ${s}, found ${o}`)}function writeCrc(e,i){e.writeUint32(crc(new Uint8Array(e.buffer,e.byteOffset+e.offset-i,i),i))}function unfilterNone(e,i,a){for(let s=0;s<a;s++)i[s]=e[s]}function unfilterSub(e,i,a,s){let o=0;for(;o<s;o++)i[o]=e[o];for(;o<a;o++)i[o]=e[o]+i[o-s]&255}function unfilterUp(e,i,a,s){let o=0;if(a.length===0)for(;o<s;o++)i[o]=e[o];else for(;o<s;o++)i[o]=e[o]+a[o]&255}function unfilterAverage(e,i,a,s,o){let h=0;if(a.length===0){for(;h<o;h++)i[h]=e[h];for(;h<s;h++)i[h]=e[h]+(i[h-o]>>1)&255}else{for(;h<o;h++)i[h]=e[h]+(a[h]>>1)&255;for(;h<s;h++)i[h]=e[h]+(i[h-o]+a[h]>>1)&255}}function unfilterPaeth(e,i,a,s,o){let h=0;if(a.length===0){for(;h<o;h++)i[h]=e[h];for(;h<s;h++)i[h]=e[h]+i[h-o]&255}else{for(;h<o;h++)i[h]=e[h]+a[h]&255;for(;h<s;h++)i[h]=e[h]+paethPredictor(i[h-o],a[h],a[h-o])&255}}function paethPredictor(e,i,a){const s=e+i-a,o=Math.abs(s-e),h=Math.abs(s-i),d=Math.abs(s-a);return o<=h&&o<=d?e:h<=d?i:a}const uint16=new Uint16Array([255]),uint8=new Uint8Array(uint16.buffer),osIsLittleEndian=uint8[0]===255,empty=new Uint8Array(0);function decodeInterlaceNull(e){const{data:i,width:a,height:s,channels:o,depth:h}=e,d=o*h/8,g=a*d,b=new Uint8Array(s*g);let _=empty,$=0,it,nt;for(let tt=0;tt<s;tt++){switch(it=i.subarray($+1,$+1+g),nt=b.subarray(tt*g,(tt+1)*g),i[$]){case 0:unfilterNone(it,nt,g);break;case 1:unfilterSub(it,nt,g,d);break;case 2:unfilterUp(it,nt,_,g);break;case 3:unfilterAverage(it,nt,_,g,d);break;case 4:unfilterPaeth(it,nt,_,g,d);break;default:throw new Error(`Unsupported filter: ${i[$]}`)}_=nt,$+=g+1}if(h===16){const tt=new Uint16Array(b.buffer);if(osIsLittleEndian)for(let at=0;at<tt.length;at++)tt[at]=swap16(tt[at]);return tt}else return b}function swap16(e){return(e&255)<<8|e>>8&255}const pngSignature=Uint8Array.of(137,80,78,71,13,10,26,10);function writeSignature(e){e.writeBytes(pngSignature)}function checkSignature(e){if(!hasPngSignature(e.readBytes(pngSignature.length)))throw new Error("wrong PNG signature")}function hasPngSignature(e){if(e.length<pngSignature.length)return!1;for(let i=0;i<pngSignature.length;i++)if(e[i]!==pngSignature[i])return!1;return!0}const textChunkName="tEXt",NULL=0,latin1Decoder=new TextDecoder("latin1");function validateKeyword(e){if(validateLatin1(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const latin1Regex=/^[\u0000-\u00FF]*$/;function validateLatin1(e){if(!latin1Regex.test(e))throw new Error("invalid latin1 text")}function decodetEXt(e,i,a){const s=readKeyword(i);e[s]=readLatin1(i,a-s.length-1)}function encodetEXt(e,i,a){validateKeyword(i),validateLatin1(a);const s=i.length+1+a.length;e.writeUint32(s),e.writeChars(textChunkName),e.writeChars(i),e.writeByte(NULL),e.writeChars(a),writeCrc(e,s+4)}function readKeyword(e){for(e.mark();e.readByte()!==NULL;);const i=e.offset;e.reset();const a=latin1Decoder.decode(e.readBytes(i-e.offset-1));return e.skip(1),validateKeyword(a),a}function readLatin1(e,i){return latin1Decoder.decode(e.readBytes(i))}const ColorType={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},CompressionMethod={UNKNOWN:-1,DEFLATE:0},FilterMethod={UNKNOWN:-1,ADAPTIVE:0},InterlaceMethod={UNKNOWN:-1,NO_INTERLACE:0};class PngDecoder extends IOBuffer{constructor(i,a={}){super(i),$e(this,"_checkCrc"),$e(this,"_inflator"),$e(this,"_png"),$e(this,"_end"),$e(this,"_hasPalette"),$e(this,"_palette"),$e(this,"_hasTransparency"),$e(this,"_transparency"),$e(this,"_compressionMethod"),$e(this,"_filterMethod"),$e(this,"_interlaceMethod"),$e(this,"_colorType");const{checkCrc:s=!1}=a;this._checkCrc=s,this._inflator=new Inflate_1,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=CompressionMethod.UNKNOWN,this._filterMethod=FilterMethod.UNKNOWN,this._interlaceMethod=InterlaceMethod.UNKNOWN,this._colorType=ColorType.UNKNOWN,this.setBigEndian()}decode(){for(checkSignature(this);!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeChunk(){const i=this.readUint32(),a=this.readChars(4),s=this.offset;switch(a){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(i);break;case"IDAT":this.decodeIDAT(i);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(i);break;case"iCCP":this.decodeiCCP(i);break;case textChunkName:decodetEXt(this._png.text,this,i);break;case"pHYs":this.decodepHYs();break;default:this.skip(i);break}if(this.offset-s!==i)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?checkCrc(this,i+4,a):this.skip(4)}decodeIHDR(){const i=this._png;i.width=this.readUint32(),i.height=this.readUint32(),i.depth=checkBitDepth(this.readUint8());const a=this.readUint8();this._colorType=a;let s;switch(a){case ColorType.GREYSCALE:s=1;break;case ColorType.TRUECOLOUR:s=3;break;case ColorType.INDEXED_COLOUR:s=1;break;case ColorType.GREYSCALE_ALPHA:s=2;break;case ColorType.TRUECOLOUR_ALPHA:s=4;break;case ColorType.UNKNOWN:default:throw new Error(`Unknown color type: ${a}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(i){if(i%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${i}`);const a=i/3;this._hasPalette=!0;const s=[];this._palette=s;for(let o=0;o<a;o++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(i){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,i)),this.skip(i)}decodetRNS(i){switch(this._colorType){case ColorType.GREYSCALE:case ColorType.TRUECOLOUR:{if(i%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${i}`);if(i/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${i/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(i/2);for(let a=0;a<i/2;a++)this._transparency[a]=this.readUint16();break}case ColorType.INDEXED_COLOUR:{if(i>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${i} vs ${this._palette.length})`);let a=0;for(;a<i;a++){const s=this.readByte();this._palette[a].push(s)}for(;a<this._palette.length;a++)this._palette[a].push(255);break}case ColorType.UNKNOWN:case ColorType.GREYSCALE_ALPHA:case ColorType.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(i){const a=readKeyword(this),s=this.readUint8();if(s!==CompressionMethod.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const o=this.readBytes(i-a.length-2);this._png.iccEmbeddedProfile={name:a,profile:inflate_1$3(o)}}decodepHYs(){const i=this.readUint32(),a=this.readUint32(),s=this.readByte();this._png.resolution={x:i,y:a,unit:s}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const i=this._inflator.result;if(this._filterMethod!==FilterMethod.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===InterlaceMethod.NO_INTERLACE)this._png.data=decodeInterlaceNull({data:i,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}}function checkBitDepth(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}const defaultZlibOptions={level:3};class PngEncoder extends IOBuffer{constructor(i,a={}){super(),$e(this,"_png"),$e(this,"_zlibOptions"),$e(this,"_colorType"),this._colorType=ColorType.UNKNOWN,this._zlibOptions={...defaultZlibOptions,...a.zlib},this._png=this._checkData(i),this.setBigEndian()}encode(){if(writeSignature(this),this.encodeIHDR(),this.encodeData(),this._png.text)for(const[i,a]of Object.entries(this._png.text))encodetEXt(this,i,a);return this.encodeIEND(),this.toArray()}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(CompressionMethod.DEFLATE),this.writeByte(FilterMethod.ADAPTIVE),this.writeByte(InterlaceMethod.NO_INTERLACE),writeCrc(this,17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),writeCrc(this,4)}encodeIDAT(i){this.writeUint32(i.length),this.writeChars("IDAT"),this.writeBytes(i),writeCrc(this,i.length+4)}encodeData(){const{width:i,height:a,channels:s,depth:o,data:h}=this._png,d=s*i,g=new IOBuffer().setBigEndian();let b=0;for(let it=0;it<a;it++)if(g.writeByte(0),o===8)b=writeDataBytes(h,g,d,b);else if(o===16)b=writeDataUint16(h,g,d,b);else throw new Error("unreachable");const _=g.toArray(),$=deflate_1(_,this._zlibOptions);this.encodeIDAT($)}_checkData(i){const{colorType:a,channels:s,depth:o}=getColorType(i),h={width:checkInteger(i.width,"width"),height:checkInteger(i.height,"height"),channels:s,data:i.data,depth:o,text:i.text};this._colorType=a;const d=h.width*h.height*s;if(h.data.length!==d)throw new RangeError(`wrong data size. Found ${h.data.length}, expected ${d}`);return h}}function checkInteger(e,i){if(Number.isInteger(e)&&e>0)return e;throw new TypeError(`${i} must be a positive integer`)}function getColorType(e){const{channels:i=4,depth:a=8}=e;if(i!==4&&i!==3&&i!==2&&i!==1)throw new RangeError(`unsupported number of channels: ${i}`);if(a!==8&&a!==16)throw new RangeError(`unsupported bit depth: ${a}`);const s={channels:i,depth:a,colorType:ColorType.UNKNOWN};switch(i){case 4:s.colorType=ColorType.TRUECOLOUR_ALPHA;break;case 3:s.colorType=ColorType.TRUECOLOUR;break;case 1:s.colorType=ColorType.GREYSCALE;break;case 2:s.colorType=ColorType.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return s}function writeDataBytes(e,i,a,s){for(let o=0;o<a;o++)i.writeByte(e[s++]);return s}function writeDataUint16(e,i,a,s){for(let o=0;o<a;o++)i.writeUint16(e[s++]);return s}var ResolutionUnitSpecifier;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(ResolutionUnitSpecifier||(ResolutionUnitSpecifier={}));function decodePng(e,i){return new PngDecoder(e,i).decode()}function encodePng$1(e,i){return new PngEncoder(e,i).encode()}var encoder={exports:{}},hasRequiredEncoder;function requireEncoder(){return hasRequiredEncoder||(hasRequiredEncoder=1,function(e){function i(s){var o=Math.floor,h=new Array(64),d=new Array(64),g=new Array(64),b=new Array(64),_,$,it,nt,tt=new Array(65535),at=new Array(65535),ut=new Array(64),ft=new Array(64),ht=[],dt=0,st=7,ct=new Array(64),wt=new Array(64),_t=new Array(64),gt=new Array(256),yt=new Array(2048),bt,vt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Ct=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Ht=[0,1,2,3,4,5,6,7,8,9,10,11],Ft=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],qt=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],zt=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Qt=[0,1,2,3,4,5,6,7,8,9,10,11],_e=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Gt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Jt(nr){for(var Dr=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],qr=0;qr<64;qr++){var Nr=o((Dr[qr]*nr+50)/100);Nr<1?Nr=1:Nr>255&&(Nr=255),h[vt[qr]]=Nr}for(var _r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],jr=0;jr<64;jr++){var Ar=o((_r[jr]*nr+50)/100);Ar<1?Ar=1:Ar>255&&(Ar=255),d[vt[jr]]=Ar}for(var $r=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Tr=0,Gr=0;Gr<8;Gr++)for(var xr=0;xr<8;xr++)g[Tr]=1/(h[vt[Tr]]*$r[Gr]*$r[xr]*8),b[Tr]=1/(d[vt[Tr]]*$r[Gr]*$r[xr]*8),Tr++}function or(nr,Dr){for(var qr=0,Nr=0,_r=new Array,jr=1;jr<=16;jr++){for(var Ar=1;Ar<=nr[jr];Ar++)_r[Dr[Nr]]=[],_r[Dr[Nr]][0]=qr,_r[Dr[Nr]][1]=jr,Nr++,qr++;qr*=2}return _r}function mr(){_=or(Ct,Ht),$=or(zt,Qt),it=or(Ft,qt),nt=or(_e,Gt)}function hr(){for(var nr=1,Dr=2,qr=1;qr<=15;qr++){for(var Nr=nr;Nr<Dr;Nr++)at[32767+Nr]=qr,tt[32767+Nr]=[],tt[32767+Nr][1]=qr,tt[32767+Nr][0]=Nr;for(var _r=-(Dr-1);_r<=-nr;_r++)at[32767+_r]=qr,tt[32767+_r]=[],tt[32767+_r][1]=qr,tt[32767+_r][0]=Dr-1+_r;nr<<=1,Dr<<=1}}function Lr(){for(var nr=0;nr<256;nr++)yt[nr]=19595*nr,yt[nr+256>>0]=38470*nr,yt[nr+512>>0]=7471*nr+32768,yt[nr+768>>0]=-11059*nr,yt[nr+1024>>0]=-21709*nr,yt[nr+1280>>0]=32768*nr+8421375,yt[nr+1536>>0]=-27439*nr,yt[nr+1792>>0]=-5329*nr}function Er(nr){for(var Dr=nr[0],qr=nr[1]-1;qr>=0;)Dr&1<<qr&&(dt|=1<<st),qr--,st--,st<0&&(dt==255?(Kt(255),Kt(0)):Kt(dt),st=7,dt=0)}function Kt(nr){ht.push(nr)}function fr(nr){Kt(nr>>8&255),Kt(nr&255)}function Rr(nr,Dr){var qr,Nr,_r,jr,Ar,$r,Tr,Gr,xr=0,Br,At=8,ur=64;for(Br=0;Br<At;++Br){qr=nr[xr],Nr=nr[xr+1],_r=nr[xr+2],jr=nr[xr+3],Ar=nr[xr+4],$r=nr[xr+5],Tr=nr[xr+6],Gr=nr[xr+7];var cr=qr+Gr,yr=qr-Gr,jt=Nr+Tr,lr=Nr-Tr,xt=_r+$r,pr=_r-$r,Yr=jr+Ar,mt=jr-Ar,er=cr+Yr,sr=cr-Yr,Mt=jt+xt,Ut=jt-xt;nr[xr]=er+Mt,nr[xr+4]=er-Mt;var tr=(Ut+sr)*.707106781;nr[xr+2]=sr+tr,nr[xr+6]=sr-tr,er=mt+pr,Mt=pr+lr,Ut=lr+yr;var zr=(er-Ut)*.382683433,lt=.5411961*er+zr,et=1.306562965*Ut+zr,j=Mt*.707106781,rt=yr+j,ot=yr-j;nr[xr+5]=ot+lt,nr[xr+3]=ot-lt,nr[xr+1]=rt+et,nr[xr+7]=rt-et,xr+=8}for(xr=0,Br=0;Br<At;++Br){qr=nr[xr],Nr=nr[xr+8],_r=nr[xr+16],jr=nr[xr+24],Ar=nr[xr+32],$r=nr[xr+40],Tr=nr[xr+48],Gr=nr[xr+56];var pt=qr+Gr,kt=qr-Gr,Et=Nr+Tr,Pt=Nr-Tr,Nt=_r+$r,Xt=_r-$r,Lt=jr+Ar,rr=jr-Ar,dr=pt+Lt,Wt=pt-Lt,ar=Et+Nt,Mr=Et-Nt;nr[xr]=dr+ar,nr[xr+32]=dr-ar;var Ot=(Mr+Wt)*.707106781;nr[xr+16]=Wt+Ot,nr[xr+48]=Wt-Ot,dr=rr+Xt,ar=Xt+Pt,Mr=Pt+kt;var br=(dr-Mr)*.382683433,Pr=.5411961*dr+br,Wr=1.306562965*Mr+br,Zr=ar*.707106781,en=kt+Zr,Xr=kt-Zr;nr[xr+40]=Xr+Pr,nr[xr+24]=Xr-Pr,nr[xr+8]=en+Wr,nr[xr+56]=en-Wr,xr++}var Kr;for(Br=0;Br<ur;++Br)Kr=nr[Br]*Dr[Br],ut[Br]=Kr>0?Kr+.5|0:Kr-.5|0;return ut}function gr(){fr(65504),fr(16),Kt(74),Kt(70),Kt(73),Kt(70),Kt(0),Kt(1),Kt(1),Kt(0),fr(1),fr(1),Kt(0),Kt(0)}function ir(nr){if(nr){fr(65505),nr[0]===69&&nr[1]===120&&nr[2]===105&&nr[3]===102?fr(nr.length+2):(fr(nr.length+5+2),Kt(69),Kt(120),Kt(105),Kt(102),Kt(0));for(var Dr=0;Dr<nr.length;Dr++)Kt(nr[Dr])}}function Vr(nr,Dr){fr(65472),fr(17),Kt(8),fr(Dr),fr(nr),Kt(3),Kt(1),Kt(17),Kt(0),Kt(2),Kt(17),Kt(1),Kt(3),Kt(17),Kt(1)}function Ur(){fr(65499),fr(132),Kt(0);for(var nr=0;nr<64;nr++)Kt(h[nr]);Kt(1);for(var Dr=0;Dr<64;Dr++)Kt(d[Dr])}function Fr(){fr(65476),fr(418),Kt(0);for(var nr=0;nr<16;nr++)Kt(Ct[nr+1]);for(var Dr=0;Dr<=11;Dr++)Kt(Ht[Dr]);Kt(16);for(var qr=0;qr<16;qr++)Kt(Ft[qr+1]);for(var Nr=0;Nr<=161;Nr++)Kt(qt[Nr]);Kt(1);for(var _r=0;_r<16;_r++)Kt(zt[_r+1]);for(var jr=0;jr<=11;jr++)Kt(Qt[jr]);Kt(17);for(var Ar=0;Ar<16;Ar++)Kt(_e[Ar+1]);for(var $r=0;$r<=161;$r++)Kt(Gt[$r])}function Sr(nr){typeof nr>"u"||nr.constructor!==Array||nr.forEach(Dr=>{if(typeof Dr=="string"){fr(65534);var qr=Dr.length;fr(qr+2);var Nr;for(Nr=0;Nr<qr;Nr++)Kt(Dr.charCodeAt(Nr))}})}function vr(){fr(65498),fr(12),Kt(3),Kt(1),Kt(0),Kt(2),Kt(17),Kt(3),Kt(17),Kt(0),Kt(63),Kt(0)}function Qr(nr,Dr,qr,Nr,_r){for(var jr=_r[0],Ar=_r[240],$r,Tr=16,Gr=63,xr=64,Br=Rr(nr,Dr),At=0;At<xr;++At)ft[vt[At]]=Br[At];var ur=ft[0]-qr;qr=ft[0],ur==0?Er(Nr[0]):($r=32767+ur,Er(Nr[at[$r]]),Er(tt[$r]));for(var cr=63;cr>0&&ft[cr]==0;cr--);if(cr==0)return Er(jr),qr;for(var yr=1,jt;yr<=cr;){for(var lr=yr;ft[yr]==0&&yr<=cr;++yr);var xt=yr-lr;if(xt>=Tr){jt=xt>>4;for(var pr=1;pr<=jt;++pr)Er(Ar);xt=xt&15}$r=32767+ft[yr],Er(_r[(xt<<4)+at[$r]]),Er(tt[$r]),yr++}return cr!=Gr&&Er(jr),qr}function Or(){for(var nr=String.fromCharCode,Dr=0;Dr<256;Dr++)gt[Dr]=nr(Dr)}this.encode=function(nr,Dr){new Date().getTime(),Dr&&Cr(Dr),ht=new Array,dt=0,st=7,fr(65496),gr(),Sr(nr.comments),ir(nr.exifBuffer),Ur(),Vr(nr.width,nr.height),Fr(),vr();var qr=0,Nr=0,_r=0;dt=0,st=7,this.encode.displayName="_encode_";for(var jr=nr.data,Ar=nr.width,$r=nr.height,Tr=Ar*4,Gr,xr=0,Br,At,ur,cr,yr,jt,lr,xt;xr<$r;){for(Gr=0;Gr<Tr;){for(cr=Tr*xr+Gr,yr=cr,jt=-1,lr=0,xt=0;xt<64;xt++)lr=xt>>3,jt=(xt&7)*4,yr=cr+lr*Tr+jt,xr+lr>=$r&&(yr-=Tr*(xr+1+lr-$r)),Gr+jt>=Tr&&(yr-=Gr+jt-Tr+4),Br=jr[yr++],At=jr[yr++],ur=jr[yr++],ct[xt]=(yt[Br]+yt[At+256>>0]+yt[ur+512>>0]>>16)-128,wt[xt]=(yt[Br+768>>0]+yt[At+1024>>0]+yt[ur+1280>>0]>>16)-128,_t[xt]=(yt[Br+1280>>0]+yt[At+1536>>0]+yt[ur+1792>>0]>>16)-128;qr=Qr(ct,g,qr,_,it),Nr=Qr(wt,b,Nr,$,nt),_r=Qr(_t,b,_r,$,nt),Gr+=32}xr+=8}if(st>=0){var pr=[];pr[1]=st+1,pr[0]=(1<<st+1)-1,Er(pr)}return fr(65497),Buffer.from(ht)};function Cr(nr){if(nr<=0&&(nr=1),nr>100&&(nr=100),bt!=nr){var Dr=0;nr<50?Dr=Math.floor(5e3/nr):Dr=Math.floor(200-nr*2),Jt(Dr),bt=nr}}function Hr(){var nr=new Date().getTime();s||(s=50),Or(),mr(),hr(),Lr(),Cr(s),new Date().getTime()-nr}Hr()}e.exports=a;function a(s,o){typeof o>"u"&&(o=50);var h=new i(o),d=h.encode(s,o);return{data:d,width:s.width,height:s.height}}}(encoder)),encoder.exports}var decoder={exports:{}},hasRequiredDecoder;function requireDecoder(){return hasRequiredDecoder||(hasRequiredDecoder=1,function(e){var i=function(){var s=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,h=799,d=3406,g=2276,b=1567,_=3784,$=5793,it=2896;function nt(){}function tt(ct,wt){for(var _t=0,gt=[],yt,bt,vt=16;vt>0&&!ct[vt-1];)vt--;gt.push({children:[],index:0});var Ct=gt[0],Ht;for(yt=0;yt<vt;yt++){for(bt=0;bt<ct[yt];bt++){for(Ct=gt.pop(),Ct.children[Ct.index]=wt[_t];Ct.index>0;){if(gt.length===0)throw new Error("Could not recreate Huffman Table");Ct=gt.pop()}for(Ct.index++,gt.push(Ct);gt.length<=yt;)gt.push(Ht={children:[],index:0}),Ct.children[Ct.index]=Ht.children,Ct=Ht;_t++}yt+1<vt&&(gt.push(Ht={children:[],index:0}),Ct.children[Ct.index]=Ht.children,Ct=Ht)}return gt[0].children}function at(ct,wt,_t,gt,yt,bt,vt,Ct,Ht,Ft){_t.precision,_t.samplesPerLine,_t.scanLines;var qt=_t.mcusPerLine,zt=_t.progressive;_t.maxH,_t.maxV;var Qt=wt,_e=0,Gt=0;function Jt(){if(Gt>0)return Gt--,_e>>Gt&1;if(_e=ct[wt++],_e==255){var Ar=ct[wt++];if(Ar)throw new Error("unexpected marker: "+(_e<<8|Ar).toString(16))}return Gt=7,_e>>>7}function or(Ar){for(var $r=Ar,Tr;(Tr=Jt())!==null;){if($r=$r[Tr],typeof $r=="number")return $r;if(typeof $r!="object")throw new Error("invalid huffman sequence")}return null}function mr(Ar){for(var $r=0;Ar>0;){var Tr=Jt();if(Tr===null)return;$r=$r<<1|Tr,Ar--}return $r}function hr(Ar){var $r=mr(Ar);return $r>=1<<Ar-1?$r:$r+(-1<<Ar)+1}function Lr(Ar,$r){var Tr=or(Ar.huffmanTableDC),Gr=Tr===0?0:hr(Tr);$r[0]=Ar.pred+=Gr;for(var xr=1;xr<64;){var Br=or(Ar.huffmanTableAC),At=Br&15,ur=Br>>4;if(At===0){if(ur<15)break;xr+=16;continue}xr+=ur;var cr=s[xr];$r[cr]=hr(At),xr++}}function Er(Ar,$r){var Tr=or(Ar.huffmanTableDC),Gr=Tr===0?0:hr(Tr)<<Ht;$r[0]=Ar.pred+=Gr}function Kt(Ar,$r){$r[0]|=Jt()<<Ht}var fr=0;function Rr(Ar,$r){if(fr>0){fr--;return}for(var Tr=bt,Gr=vt;Tr<=Gr;){var xr=or(Ar.huffmanTableAC),Br=xr&15,At=xr>>4;if(Br===0){if(At<15){fr=mr(At)+(1<<At)-1;break}Tr+=16;continue}Tr+=At;var ur=s[Tr];$r[ur]=hr(Br)*(1<<Ht),Tr++}}var gr=0,ir;function Vr(Ar,$r){for(var Tr=bt,Gr=vt,xr=0;Tr<=Gr;){var Br=s[Tr],At=$r[Br]<0?-1:1;switch(gr){case 0:var ur=or(Ar.huffmanTableAC),cr=ur&15,xr=ur>>4;if(cr===0)xr<15?(fr=mr(xr)+(1<<xr),gr=4):(xr=16,gr=1);else{if(cr!==1)throw new Error("invalid ACn encoding");ir=hr(cr),gr=xr?2:3}continue;case 1:case 2:$r[Br]?$r[Br]+=(Jt()<<Ht)*At:(xr--,xr===0&&(gr=gr==2?3:0));break;case 3:$r[Br]?$r[Br]+=(Jt()<<Ht)*At:($r[Br]=ir<<Ht,gr=0);break;case 4:$r[Br]&&($r[Br]+=(Jt()<<Ht)*At);break}Tr++}gr===4&&(fr--,fr===0&&(gr=0))}function Ur(Ar,$r,Tr,Gr,xr){var Br=Tr/qt|0,At=Tr%qt,ur=Br*Ar.v+Gr,cr=At*Ar.h+xr;Ar.blocks[ur]===void 0&&Ft.tolerantDecoding||$r(Ar,Ar.blocks[ur][cr])}function Fr(Ar,$r,Tr){var Gr=Tr/Ar.blocksPerLine|0,xr=Tr%Ar.blocksPerLine;Ar.blocks[Gr]===void 0&&Ft.tolerantDecoding||$r(Ar,Ar.blocks[Gr][xr])}var Sr=gt.length,vr,Qr,Or,Cr,Hr,nr;zt?bt===0?nr=Ct===0?Er:Kt:nr=Ct===0?Rr:Vr:nr=Lr;var Dr=0,qr,Nr;Sr==1?Nr=gt[0].blocksPerLine*gt[0].blocksPerColumn:Nr=qt*_t.mcusPerColumn,yt||(yt=Nr);for(var _r,jr;Dr<Nr;){for(Qr=0;Qr<Sr;Qr++)gt[Qr].pred=0;if(fr=0,Sr==1)for(vr=gt[0],Hr=0;Hr<yt;Hr++)Fr(vr,nr,Dr),Dr++;else for(Hr=0;Hr<yt;Hr++){for(Qr=0;Qr<Sr;Qr++)for(vr=gt[Qr],_r=vr.h,jr=vr.v,Or=0;Or<jr;Or++)for(Cr=0;Cr<_r;Cr++)Ur(vr,nr,Dr,Or,Cr);if(Dr++,Dr===Nr)break}if(Dr===Nr)do{if(ct[wt]===255&&ct[wt+1]!==0)break;wt+=1}while(wt<ct.length-2);if(Gt=0,qr=ct[wt]<<8|ct[wt+1],qr<65280)throw new Error("marker was not found");if(qr>=65488&&qr<=65495)wt+=2;else break}return wt-Qt}function ut(ct,wt){var _t=[],gt=wt.blocksPerLine,yt=wt.blocksPerColumn,bt=gt<<3,vt=new Int32Array(64),Ct=new Uint8Array(64);function Ht(mr,hr,Lr){var Er=wt.quantizationTable,Kt,fr,Rr,gr,ir,Vr,Ur,Fr,Sr,vr=Lr,Qr;for(Qr=0;Qr<64;Qr++)vr[Qr]=mr[Qr]*Er[Qr];for(Qr=0;Qr<8;++Qr){var Or=8*Qr;if(vr[1+Or]==0&&vr[2+Or]==0&&vr[3+Or]==0&&vr[4+Or]==0&&vr[5+Or]==0&&vr[6+Or]==0&&vr[7+Or]==0){Sr=$*vr[0+Or]+512>>10,vr[0+Or]=Sr,vr[1+Or]=Sr,vr[2+Or]=Sr,vr[3+Or]=Sr,vr[4+Or]=Sr,vr[5+Or]=Sr,vr[6+Or]=Sr,vr[7+Or]=Sr;continue}Kt=$*vr[0+Or]+128>>8,fr=$*vr[4+Or]+128>>8,Rr=vr[2+Or],gr=vr[6+Or],ir=it*(vr[1+Or]-vr[7+Or])+128>>8,Fr=it*(vr[1+Or]+vr[7+Or])+128>>8,Vr=vr[3+Or]<<4,Ur=vr[5+Or]<<4,Sr=Kt-fr+1>>1,Kt=Kt+fr+1>>1,fr=Sr,Sr=Rr*_+gr*b+128>>8,Rr=Rr*b-gr*_+128>>8,gr=Sr,Sr=ir-Ur+1>>1,ir=ir+Ur+1>>1,Ur=Sr,Sr=Fr+Vr+1>>1,Vr=Fr-Vr+1>>1,Fr=Sr,Sr=Kt-gr+1>>1,Kt=Kt+gr+1>>1,gr=Sr,Sr=fr-Rr+1>>1,fr=fr+Rr+1>>1,Rr=Sr,Sr=ir*g+Fr*d+2048>>12,ir=ir*d-Fr*g+2048>>12,Fr=Sr,Sr=Vr*h+Ur*o+2048>>12,Vr=Vr*o-Ur*h+2048>>12,Ur=Sr,vr[0+Or]=Kt+Fr,vr[7+Or]=Kt-Fr,vr[1+Or]=fr+Ur,vr[6+Or]=fr-Ur,vr[2+Or]=Rr+Vr,vr[5+Or]=Rr-Vr,vr[3+Or]=gr+ir,vr[4+Or]=gr-ir}for(Qr=0;Qr<8;++Qr){var Cr=Qr;if(vr[8+Cr]==0&&vr[16+Cr]==0&&vr[24+Cr]==0&&vr[32+Cr]==0&&vr[40+Cr]==0&&vr[48+Cr]==0&&vr[56+Cr]==0){Sr=$*Lr[Qr+0]+8192>>14,vr[0+Cr]=Sr,vr[8+Cr]=Sr,vr[16+Cr]=Sr,vr[24+Cr]=Sr,vr[32+Cr]=Sr,vr[40+Cr]=Sr,vr[48+Cr]=Sr,vr[56+Cr]=Sr;continue}Kt=$*vr[0+Cr]+2048>>12,fr=$*vr[32+Cr]+2048>>12,Rr=vr[16+Cr],gr=vr[48+Cr],ir=it*(vr[8+Cr]-vr[56+Cr])+2048>>12,Fr=it*(vr[8+Cr]+vr[56+Cr])+2048>>12,Vr=vr[24+Cr],Ur=vr[40+Cr],Sr=Kt-fr+1>>1,Kt=Kt+fr+1>>1,fr=Sr,Sr=Rr*_+gr*b+2048>>12,Rr=Rr*b-gr*_+2048>>12,gr=Sr,Sr=ir-Ur+1>>1,ir=ir+Ur+1>>1,Ur=Sr,Sr=Fr+Vr+1>>1,Vr=Fr-Vr+1>>1,Fr=Sr,Sr=Kt-gr+1>>1,Kt=Kt+gr+1>>1,gr=Sr,Sr=fr-Rr+1>>1,fr=fr+Rr+1>>1,Rr=Sr,Sr=ir*g+Fr*d+2048>>12,ir=ir*d-Fr*g+2048>>12,Fr=Sr,Sr=Vr*h+Ur*o+2048>>12,Vr=Vr*o-Ur*h+2048>>12,Ur=Sr,vr[0+Cr]=Kt+Fr,vr[56+Cr]=Kt-Fr,vr[8+Cr]=fr+Ur,vr[48+Cr]=fr-Ur,vr[16+Cr]=Rr+Vr,vr[40+Cr]=Rr-Vr,vr[24+Cr]=gr+ir,vr[32+Cr]=gr-ir}for(Qr=0;Qr<64;++Qr){var Hr=128+(vr[Qr]+8>>4);hr[Qr]=Hr<0?0:Hr>255?255:Hr}}st(bt*yt*8);for(var Ft,qt,zt=0;zt<yt;zt++){var Qt=zt<<3;for(Ft=0;Ft<8;Ft++)_t.push(new Uint8Array(bt));for(var _e=0;_e<gt;_e++){Ht(wt.blocks[zt][_e],Ct,vt);var Gt=0,Jt=_e<<3;for(qt=0;qt<8;qt++){var or=_t[Qt+qt];for(Ft=0;Ft<8;Ft++)or[Jt+Ft]=Ct[Gt++]}}}return _t}function ft(ct){return ct<0?0:ct>255?255:ct}nt.prototype={load:function(ct){var wt=new XMLHttpRequest;wt.open("GET",ct,!0),wt.responseType="arraybuffer",wt.onload=(function(){var _t=new Uint8Array(wt.response||wt.mozResponseArrayBuffer);this.parse(_t),this.onload&&this.onload()}).bind(this),wt.send(null)},parse:function(ct){var wt=this.opts.maxResolutionInMP*1e3*1e3,_t=0;ct.length;function gt(){var Br=ct[_t]<<8|ct[_t+1];return _t+=2,Br}function yt(){var Br=gt(),At=ct.subarray(_t,_t+Br-2);return _t+=At.length,At}function bt(Br){var At=1,ur=1,cr,yr;for(yr in Br.components)Br.components.hasOwnProperty(yr)&&(cr=Br.components[yr],At<cr.h&&(At=cr.h),ur<cr.v&&(ur=cr.v));var jt=Math.ceil(Br.samplesPerLine/8/At),lr=Math.ceil(Br.scanLines/8/ur);for(yr in Br.components)if(Br.components.hasOwnProperty(yr)){cr=Br.components[yr];var xt=Math.ceil(Math.ceil(Br.samplesPerLine/8)*cr.h/At),pr=Math.ceil(Math.ceil(Br.scanLines/8)*cr.v/ur),Yr=jt*cr.h,mt=lr*cr.v,er=mt*Yr,sr=[];st(er*256);for(var Mt=0;Mt<mt;Mt++){for(var Ut=[],tr=0;tr<Yr;tr++)Ut.push(new Int32Array(64));sr.push(Ut)}cr.blocksPerLine=xt,cr.blocksPerColumn=pr,cr.blocks=sr}Br.maxH=At,Br.maxV=ur,Br.mcusPerLine=jt,Br.mcusPerColumn=lr}var vt=null,Ct=null,Ht,Ft,qt=[],zt=[],Qt=[],_e=[],Gt=gt(),Jt=-1;if(this.comments=[],Gt!=65496)throw new Error("SOI not found");for(Gt=gt();Gt!=65497;){var or,mr;switch(Gt){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var hr=yt();if(Gt===65534){var Lr=String.fromCharCode.apply(null,hr);this.comments.push(Lr)}Gt===65504&&hr[0]===74&&hr[1]===70&&hr[2]===73&&hr[3]===70&&hr[4]===0&&(vt={version:{major:hr[5],minor:hr[6]},densityUnits:hr[7],xDensity:hr[8]<<8|hr[9],yDensity:hr[10]<<8|hr[11],thumbWidth:hr[12],thumbHeight:hr[13],thumbData:hr.subarray(14,14+3*hr[12]*hr[13])}),Gt===65505&&hr[0]===69&&hr[1]===120&&hr[2]===105&&hr[3]===102&&hr[4]===0&&(this.exifBuffer=hr.subarray(5,hr.length)),Gt===65518&&hr[0]===65&&hr[1]===100&&hr[2]===111&&hr[3]===98&&hr[4]===101&&hr[5]===0&&(Ct={version:hr[6],flags0:hr[7]<<8|hr[8],flags1:hr[9]<<8|hr[10],transformCode:hr[11]});break;case 65499:for(var Er=gt(),Kt=Er+_t-2;_t<Kt;){var fr=ct[_t++];st(256);var Rr=new Int32Array(64);if(fr>>4)if(fr>>4===1)for(mr=0;mr<64;mr++){var gr=s[mr];Rr[gr]=gt()}else throw new Error("DQT: invalid table spec");else for(mr=0;mr<64;mr++){var gr=s[mr];Rr[gr]=ct[_t++]}qt[fr&15]=Rr}break;case 65472:case 65473:case 65474:gt(),Ht={},Ht.extended=Gt===65473,Ht.progressive=Gt===65474,Ht.precision=ct[_t++],Ht.scanLines=gt(),Ht.samplesPerLine=gt(),Ht.components={},Ht.componentsOrder=[];var ir=Ht.scanLines*Ht.samplesPerLine;if(ir>wt){var Vr=Math.ceil((ir-wt)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${Vr}MP`)}var Ur=ct[_t++],Fr;for(or=0;or<Ur;or++){Fr=ct[_t];var Sr=ct[_t+1]>>4,vr=ct[_t+1]&15,Qr=ct[_t+2];if(Sr<=0||vr<=0)throw new Error("Invalid sampling factor, expected values above 0");Ht.componentsOrder.push(Fr),Ht.components[Fr]={h:Sr,v:vr,quantizationIdx:Qr},_t+=3}bt(Ht),zt.push(Ht);break;case 65476:var Or=gt();for(or=2;or<Or;){var Cr=ct[_t++],Hr=new Uint8Array(16),nr=0;for(mr=0;mr<16;mr++,_t++)nr+=Hr[mr]=ct[_t];st(16+nr);var Dr=new Uint8Array(nr);for(mr=0;mr<nr;mr++,_t++)Dr[mr]=ct[_t];or+=17+nr,(Cr>>4?Qt:_e)[Cr&15]=tt(Hr,Dr)}break;case 65501:gt(),Ft=gt();break;case 65500:gt(),gt();break;case 65498:gt();var qr=ct[_t++],Nr=[],_r;for(or=0;or<qr;or++){_r=Ht.components[ct[_t++]];var jr=ct[_t++];_r.huffmanTableDC=_e[jr>>4],_r.huffmanTableAC=Qt[jr&15],Nr.push(_r)}var Ar=ct[_t++],$r=ct[_t++],Tr=ct[_t++],Gr=at(ct,_t,Ht,Nr,Ft,Ar,$r,Tr>>4,Tr&15,this.opts);_t+=Gr;break;case 65535:ct[_t]!==255&&_t--;break;default:if(ct[_t-3]==255&&ct[_t-2]>=192&&ct[_t-2]<=254){_t-=3;break}else if(Gt===224||Gt==225){if(Jt!==-1)throw new Error(`first unknown JPEG marker at offset ${Jt.toString(16)}, second unknown JPEG marker ${Gt.toString(16)} at offset ${(_t-1).toString(16)}`);Jt=_t-1;const Br=gt();if(ct[_t+Br-2]===255){_t+=Br-2;break}}throw new Error("unknown JPEG marker "+Gt.toString(16))}Gt=gt()}if(zt.length!=1)throw new Error("only single frame JPEGs supported");for(var or=0;or<zt.length;or++){var xr=zt[or].components;for(var mr in xr)xr[mr].quantizationTable=qt[xr[mr].quantizationIdx],delete xr[mr].quantizationIdx}this.width=Ht.samplesPerLine,this.height=Ht.scanLines,this.jfif=vt,this.adobe=Ct,this.components=[];for(var or=0;or<Ht.componentsOrder.length;or++){var _r=Ht.components[Ht.componentsOrder[or]];this.components.push({lines:ut(Ht,_r),scaleX:_r.h/Ht.maxH,scaleY:_r.v/Ht.maxV})}},getData:function(ct,wt){var _t=this.width/ct,gt=this.height/wt,yt,bt,vt,Ct,Ht,Ft,qt,zt,Qt,_e,Gt=0,Jt,or,mr,hr,Lr,Er,Kt,fr,Rr,gr,ir,Vr=ct*wt*this.components.length;st(Vr);var Ur=new Uint8Array(Vr);switch(this.components.length){case 1:for(yt=this.components[0],_e=0;_e<wt;_e++)for(Ht=yt.lines[0|_e*yt.scaleY*gt],Qt=0;Qt<ct;Qt++)Jt=Ht[0|Qt*yt.scaleX*_t],Ur[Gt++]=Jt;break;case 2:for(yt=this.components[0],bt=this.components[1],_e=0;_e<wt;_e++)for(Ht=yt.lines[0|_e*yt.scaleY*gt],Ft=bt.lines[0|_e*bt.scaleY*gt],Qt=0;Qt<ct;Qt++)Jt=Ht[0|Qt*yt.scaleX*_t],Ur[Gt++]=Jt,Jt=Ft[0|Qt*bt.scaleX*_t],Ur[Gt++]=Jt;break;case 3:for(ir=!0,this.adobe&&this.adobe.transformCode?ir=!0:typeof this.opts.colorTransform<"u"&&(ir=!!this.opts.colorTransform),yt=this.components[0],bt=this.components[1],vt=this.components[2],_e=0;_e<wt;_e++)for(Ht=yt.lines[0|_e*yt.scaleY*gt],Ft=bt.lines[0|_e*bt.scaleY*gt],qt=vt.lines[0|_e*vt.scaleY*gt],Qt=0;Qt<ct;Qt++)ir?(Jt=Ht[0|Qt*yt.scaleX*_t],or=Ft[0|Qt*bt.scaleX*_t],mr=qt[0|Qt*vt.scaleX*_t],fr=ft(Jt+1.402*(mr-128)),Rr=ft(Jt-.3441363*(or-128)-.71413636*(mr-128)),gr=ft(Jt+1.772*(or-128))):(fr=Ht[0|Qt*yt.scaleX*_t],Rr=Ft[0|Qt*bt.scaleX*_t],gr=qt[0|Qt*vt.scaleX*_t]),Ur[Gt++]=fr,Ur[Gt++]=Rr,Ur[Gt++]=gr;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(ir=!1,this.adobe&&this.adobe.transformCode?ir=!0:typeof this.opts.colorTransform<"u"&&(ir=!!this.opts.colorTransform),yt=this.components[0],bt=this.components[1],vt=this.components[2],Ct=this.components[3],_e=0;_e<wt;_e++)for(Ht=yt.lines[0|_e*yt.scaleY*gt],Ft=bt.lines[0|_e*bt.scaleY*gt],qt=vt.lines[0|_e*vt.scaleY*gt],zt=Ct.lines[0|_e*Ct.scaleY*gt],Qt=0;Qt<ct;Qt++)ir?(Jt=Ht[0|Qt*yt.scaleX*_t],or=Ft[0|Qt*bt.scaleX*_t],mr=qt[0|Qt*vt.scaleX*_t],hr=zt[0|Qt*Ct.scaleX*_t],Lr=255-ft(Jt+1.402*(mr-128)),Er=255-ft(Jt-.3441363*(or-128)-.71413636*(mr-128)),Kt=255-ft(Jt+1.772*(or-128))):(Lr=Ht[0|Qt*yt.scaleX*_t],Er=Ft[0|Qt*bt.scaleX*_t],Kt=qt[0|Qt*vt.scaleX*_t],hr=zt[0|Qt*Ct.scaleX*_t]),Ur[Gt++]=255-Lr,Ur[Gt++]=255-Er,Ur[Gt++]=255-Kt,Ur[Gt++]=255-hr;break;default:throw new Error("Unsupported color mode")}return Ur},copyToImageData:function(ct,wt){var _t=ct.width,gt=ct.height,yt=ct.data,bt=this.getData(_t,gt),vt=0,Ct=0,Ht,Ft,qt,zt,Qt,_e,Gt,Jt,or;switch(this.components.length){case 1:for(Ft=0;Ft<gt;Ft++)for(Ht=0;Ht<_t;Ht++)qt=bt[vt++],yt[Ct++]=qt,yt[Ct++]=qt,yt[Ct++]=qt,wt&&(yt[Ct++]=255);break;case 3:for(Ft=0;Ft<gt;Ft++)for(Ht=0;Ht<_t;Ht++)Gt=bt[vt++],Jt=bt[vt++],or=bt[vt++],yt[Ct++]=Gt,yt[Ct++]=Jt,yt[Ct++]=or,wt&&(yt[Ct++]=255);break;case 4:for(Ft=0;Ft<gt;Ft++)for(Ht=0;Ht<_t;Ht++)Qt=bt[vt++],_e=bt[vt++],qt=bt[vt++],zt=bt[vt++],Gt=255-ft(Qt*(1-zt/255)+zt),Jt=255-ft(_e*(1-zt/255)+zt),or=255-ft(qt*(1-zt/255)+zt),yt[Ct++]=Gt,yt[Ct++]=Jt,yt[Ct++]=or,wt&&(yt[Ct++]=255);break;default:throw new Error("Unsupported color mode")}}};var ht=0,dt=0;function st(ct=0){var wt=ht+ct;if(wt>dt){var _t=Math.ceil((wt-dt)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${_t}MB`)}ht=wt}return nt.resetMaxMemoryUsage=function(ct){ht=0,dt=ct},nt.getBytesAllocated=function(){return ht},nt.requestMemoryAllocation=st,nt}();e.exports=a;function a(s,o={}){var h={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},d={...h,...o},g=new Uint8Array(s),b=new i;b.opts=d,i.resetMaxMemoryUsage(d.maxMemoryUsageInMB*1024*1024),b.parse(g);var _=d.formatAsRGBA?4:3,$=b.width*b.height*_;try{i.requestMemoryAllocation($);var it={width:b.width,height:b.height,exifBuffer:b.exifBuffer,data:d.useTArray?new Uint8Array($):Buffer.alloc($)};b.comments.length>0&&(it.comments=b.comments)}catch(nt){throw nt instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+$):nt instanceof ReferenceError&&nt.message==="Buffer is not defined"?new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true"):nt}return b.copyToImageData(it,d.formatAsRGBA),it}}(decoder)),decoder.exports}var jpegJs,hasRequiredJpegJs;function requireJpegJs(){if(hasRequiredJpegJs)return jpegJs;hasRequiredJpegJs=1;var e=requireEncoder(),i=requireDecoder();return jpegJs={encode:e,decode:i},jpegJs}var jpegJsExports=requireJpegJs();const jpeg=getDefaultExportFromCjs(jpegJsExports);let chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256);for(let e=0;e<chars.length;e++)lookup[chars.charCodeAt(e)]=e;function encode(e){let i,a=e.length,s="";for(i=0;i<a;i+=3)s+=chars[e[i]>>2],s+=chars[(e[i]&3)<<4|e[i+1]>>4],s+=chars[(e[i+1]&15)<<2|e[i+2]>>6],s+=chars[e[i+2]&63];return a%3===2?s=`${s.substring(0,s.length-1)}=`:a%3===1&&(s=`${s.substring(0,s.length-2)}==`),s}function decode$1(e){let i=e.length*.75,a=e.length,s=0,o,h,d,g;e[e.length-1]==="="&&(i--,e[e.length-2]==="="&&i--);const b=new Uint8Array(i);for(let _=0;_<a;_+=4)o=lookup[e.charCodeAt(_)],h=lookup[e.charCodeAt(_+1)],d=lookup[e.charCodeAt(_+2)],g=lookup[e.charCodeAt(_+3)],b[s++]=o<<2|h>>4,b[s++]=(h&15)<<4|d>>2,b[s++]=(d&3)<<6|g&63;return b}function toBase64URL(e,i){const a=encode(e);return`data:${i};base64,${a}`}const ImageData$1=self.ImageData,DOMImage=self.Image;function createCanvas(e,i){let a=self.document.createElement("canvas");return a.width=e,a.height=i,a}function fetchBinary(e,{withCredentials:i=!1}={}){return new Promise(function(a,s){let o=new self.XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.withCredentials=i,o.onload=function(h){this.status!==200?s(h):a(this.response)},o.onerror=s,o.send()})}function createWriteStream(){throw new Error("createWriteStream does not exist in the browser")}function writeFile(){throw new Error("writeFile does not exist in the browser")}function getType(e){return e.includes("/")||(e=`image/${e}`),e}function encodeJpeg(e,i={}){const a={width:e.width,height:e.height,data:e.getRGBAData()};return jpegJsExports.encode(a,i.quality).data}function encodePng(e,i){const a={width:e.width,height:e.height,channels:e.channels,depth:e.bitDepth,data:e.data};return(a.depth===1||a.depth===32)&&(a.depth=8,a.channels=4,a.data=e.getRGBAData()),encodePng$1(a,i)}const exportMethods={save(e,i={}){const{useCanvas:a=!1,encoder:s=void 0}=i;let{format:o}=i;if(!o){const h=/\.(?<format>[a-zA-Z]+)$/.exec(e);h&&(o=h.groups.format.toLowerCase())}if(!o)throw new Error("file format not provided");return new Promise((h,d)=>{let g,b;switch(o.toLowerCase()){case"png":{a?g=this.getCanvas().pngStream():b=encodePng(this,s);break}case"jpg":case"jpeg":a?g=this.getCanvas().jpegStream():b=encodeJpeg(this,s);break;case"bmp":b=srcExports$3.encode(this,s);break;default:throw new RangeError(`invalid output format: ${o}`)}if(g){let _=createWriteStream();_.on("finish",h),_.on("error",d),g.pipe(_)}else b&&writeFile()})},toDataURL(e="image/png",i={}){typeof e=="object"&&(i=e,e="image/png");const{useCanvas:a=!1,encoder:s=void 0}=i;e=getType(e);function o(h,d){const g=h(d,s);return toBase64URL(g,e)}return e==="image/bmp"?o(srcExports$3.encode,this):e==="image/png"&&!a?o(encodePng,this):e==="image/jpeg"&&!a?o(encodeJpeg,this):this.getCanvas().toDataURL(e)},toBuffer(e={}){const{format:i="png",encoder:a=void 0}=e;switch(i.toLowerCase()){case"png":return encodePng(this,a);case"jpeg":case"jpg":return encodeJpeg(this,a);case"bmp":return srcExports$3.encode(this,a);default:throw new RangeError(`invalid output format: ${i}`)}},toBase64(e="image/png",i={}){if(i.async)return this.toDataURL(e,i).then(function(a){return a.substring(a.indexOf(",")+1)});{const a=this.toDataURL(e,i);return a.substring(a.indexOf(",")+1)}},toBlob(e="image/png",i=.8){return canvasToBlob(this.getCanvas(),e,i)},getCanvas(){const e=new ImageData$1(this.getRGBAData({clamped:!0}),this.width,this.height);let i=createCanvas(this.width,this.height);return i.getContext("2d").putImageData(e,0,0),i}};function setExportMethods(e){for(const i in exportMethods)e.prototype[i]=exportMethods[i]}var hasOwn$1={exports:{}};const version="1.0.1",require$$0$2={version};var hasRequiredHasOwn;function requireHasOwn(){return hasRequiredHasOwn||(hasRequiredHasOwn=1,function(e,i){var a=Object.prototype.hasOwnProperty;e.exports=i=function(s,o){return a.call(o,s)},i.version=require$$0$2.version}(hasOwn$1,hasOwn$1.exports)),hasOwn$1.exports}var hasOwnExports=requireHasOwn();const hasOwn=getDefaultExportFromCjs(hasOwnExports);let computedPropertyDescriptor$1={configurable:!0,enumerable:!1,get:void 0};function extendMethod(e,i,a={}){let{inPlace:s=!1,returnThis:o=!0,partialArgs:h=[]}=a;return s?Image.prototype[e]=function(...d){this.computed=null;let g=i.apply(this,[...h,...d]);return o?this:g}:Image.prototype[e]=function(...d){return i.apply(this,[...h,...d])},Image}function extendProperty(e,i,a={}){let{partialArgs:s=[]}=a;return computedPropertyDescriptor$1.get=function(){if(this.computed===null)this.computed={};else if(hasOwn(e,this.computed))return this.computed[e];let o=i.apply(this,s);return this.computed[e]=o,o},Object.defineProperty(Image.prototype,e,computedPropertyDescriptor$1),Image}const GREY$1="GREY",RGB$1="RGB",HSL="HSL",HSV="HSV",CMYK$1="CMYK",ColorModel=Object.freeze(Object.defineProperty({__proto__:null,CMYK:CMYK$1,GREY:GREY$1,HSL,HSV,RGB:RGB$1},Symbol.toStringTag,{value:"Module"}));function getRGBAData(e={}){const{clamped:i}=e;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const a=this.width*this.height*4;let s=i?new Uint8ClampedArray(a):new Uint8Array(a);return this.bitDepth===1?fillDataFromBinary(this,s):this.bitDepth===32?(this.checkProcessable("getRGBAData",{alpha:0}),this.components===1?fillDataFromGrey32(this,s):this.components===3&&(this.checkProcessable("getRGBAData",{colorModel:[RGB$1]}),fillDataFromRGB32(this,s))):this.components===1?fillDataFromGrey(this,s):this.components===3&&(this.checkProcessable("getRGBAData",{colorModel:[RGB$1]}),fillDataFromRGB(this,s)),this.alpha===1?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),copyAlpha(this,s)):fillAlpha(this,s),s}function fillDataFromBinary(e,i){for(let a=0;a<e.size;a++){const s=e.getBit(a);i[a*4]=s*255,i[a*4+1]=s*255,i[a*4+2]=s*255}}function fillDataFromGrey32(e,i){const a=e.min[0],s=e.max[0]-a;for(let o=0;o<e.size;o++){const h=Math.floor(255*(e.data[o]-a)/s);i[o*4]=h,i[o*4+1]=h,i[o*4+2]=h}}function fillDataFromRGB32(e,i){const a=Math.min(...e.min),s=Math.max(...e.max)-a;for(let o=0;o<e.size;o++){const h=Math.floor(255*(e.data[o*3]-a)/s),d=Math.floor(255*(e.data[o*3+1]-a)/s),g=Math.floor(255*(e.data[o*3+2]-a)/s);i[o*4]=h,i[o*4+1]=d,i[o*4+2]=g}}function fillDataFromGrey(e,i){for(let a=0;a<e.size;a++)i[a*4]=e.data[a*e.channels]>>>e.bitDepth-8,i[a*4+1]=e.data[a*e.channels]>>>e.bitDepth-8,i[a*4+2]=e.data[a*e.channels]>>>e.bitDepth-8}function fillDataFromRGB(e,i){for(let a=0;a<e.size;a++)i[a*4]=e.data[a*e.channels]>>>e.bitDepth-8,i[a*4+1]=e.data[a*e.channels+1]>>>e.bitDepth-8,i[a*4+2]=e.data[a*e.channels+2]>>>e.bitDepth-8}function copyAlpha(e,i){for(let a=0;a<e.size;a++)i[a*4+3]=e.data[a*e.channels+e.components]>>e.bitDepth-8}function fillAlpha(e,i){for(let a=0;a<e.size;a++)i[a*4+3]=255}const BINARY="BINARY",GREY="GREY",GREYA="GREYA",RGB="RGB",RGBA="RGBA",CMYK="CMYK",CMYKA="CMYKA",kinds={};kinds[BINARY]={components:1,alpha:0,bitDepth:1,colorModel:GREY$1};kinds[GREYA]={components:1,alpha:1,bitDepth:8,colorModel:GREY$1};kinds[GREY]={components:1,alpha:0,bitDepth:8,colorModel:GREY$1};kinds[RGBA]={components:3,alpha:1,bitDepth:8,colorModel:RGB$1};kinds[RGB]={components:3,alpha:0,bitDepth:8,colorModel:RGB$1};kinds[CMYK]={components:4,alpha:0,bitDepth:8,colorModel:CMYK$1};kinds[CMYKA]={components:4,alpha:1,bitDepth:8,colorModel:CMYK$1};function getKind(e){const i=kinds[e];if(!i)throw new RangeError(`invalid image kind: ${e}`);return i}const validBitDepth=[1,8,16,32];function verifyKindDefinition(e){const{components:i,alpha:a,bitDepth:s,colorModel:o}=e;if(!Number.isInteger(i)||i<=0)throw new RangeError(`invalid components: ${i}. Must be a positive integer`);if(a!==0&&a!==1&&typeof a!="boolean")throw new TypeError(`invalid alpha: ${a}: must be a boolean, 0 or 1`);if(!validBitDepth.includes(s))throw new RangeError(`invalid bitDepth: ${s}. Must be one of ${validBitDepth.join(", ")}`);if(!ColorModel[o])throw new RangeError(`invalid colorModel: ${o}. Must be one of ${Object.keys(ColorModel).join(", ")}`)}function getTheoreticalPixelArraySize(e,i,a){let s=i*e;return a===1&&(s=Math.ceil(s/8)),s}function createPixelArray(e,i,a,s,o,h){const d=s*e;let g;switch(o){case 1:g=new Uint8Array(Math.ceil(d/8));break;case 8:g=new Uint8Array(d);break;case 16:g=new Uint16Array(d);break;case 32:g=new Float32Array(d);break;default:throw new Error(`Cannot create pixel array for bit depth ${o}`)}if(a)for(let b=i;b<g.length;b+=s)g[b]=h;return g}var src$4={},IOBuffer_1,hasRequiredIOBuffer;function requireIOBuffer(){if(hasRequiredIOBuffer)return IOBuffer_1;hasRequiredIOBuffer=1;const e=1024*8,i=[];class a{constructor(o,h){h=h||{},o===void 0&&(o=e),typeof o=="number"&&(o=new ArrayBuffer(o));let d=o.byteLength;const g=h.offset?h.offset>>>0:0;o.buffer&&(d=o.byteLength-g,o.byteLength!==o.buffer.byteLength?o=o.buffer.slice(o.byteOffset+g,o.byteOffset+o.byteLength):g?o=o.buffer.slice(g):o=o.buffer),this.buffer=o,this.length=d,this.byteLength=d,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=d||e,this._mark=0}available(o){return o===void 0&&(o=1),this.offset+o<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(o){o===void 0&&(o=1),this.offset+=o}seek(o){this.offset=o}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(o){if(o===void 0&&(o=1),!this.available(o)){const h=this._increment+this._increment;this._increment=h;const d=this.length+h,g=new Uint8Array(d);g.set(new Uint8Array(this.buffer)),this.buffer=g.buffer,this.length=d,this._data=new DataView(this.buffer)}}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(o){o===void 0&&(o=1);for(var h=new Uint8Array(o),d=0;d<o;d++)h[d]=this.readByte();return h}readInt16(){var o=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,o}readUint16(){var o=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,o}readInt32(){var o=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,o}readUint32(){var o=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,o}readFloat32(){var o=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,o}readFloat64(){var o=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,o}readChar(){return String.fromCharCode(this.readInt8())}readChars(o){o===void 0&&(o=1),i.length=o;for(var h=0;h<o;h++)i[h]=this.readChar();return i.join("")}writeBoolean(o){this.writeUint8(o?255:0)}writeInt8(o){this.ensureAvailable(1),this._data.setInt8(this.offset++,o)}writeUint8(o){this.ensureAvailable(1),this._data.setUint8(this.offset++,o)}writeByte(o){this.writeUint8(o)}writeBytes(o){this.ensureAvailable(o.length);for(var h=0;h<o.length;h++)this._data.setUint8(this.offset++,o[h])}writeInt16(o){this.ensureAvailable(2),this._data.setInt16(this.offset,o,this.littleEndian),this.offset+=2}writeUint16(o){this.ensureAvailable(2),this._data.setUint16(this.offset,o,this.littleEndian),this.offset+=2}writeInt32(o){this.ensureAvailable(4),this._data.setInt32(this.offset,o,this.littleEndian),this.offset+=4}writeUint32(o){this.ensureAvailable(4),this._data.setUint32(this.offset,o,this.littleEndian),this.offset+=4}writeFloat32(o){this.ensureAvailable(4),this._data.setFloat32(this.offset,o,this.littleEndian),this.offset+=4}writeFloat64(o){this.ensureAvailable(8),this._data.setFloat64(this.offset,o,this.littleEndian),this.offset+=8}writeChar(o){this.writeUint8(o.charCodeAt(0))}writeChars(o){for(var h=0;h<o.length;h++)this.writeUint8(o.charCodeAt(h))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}return IOBuffer_1=a,IOBuffer_1}var src$3={},standard$1,hasRequiredStandard;function requireStandard(){if(hasRequiredStandard)return standard$1;hasRequiredStandard=1;const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},i={};for(var a in e)i[e[a]]=a;return standard$1={tagsById:e,tagsByName:i},standard$1}var exif$1,hasRequiredExif;function requireExif(){if(hasRequiredExif)return exif$1;hasRequiredExif=1;const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},i={};for(var a in e)i[e[a]]=a;return exif$1={tagsById:e,tagsByName:i},exif$1}var gps$1,hasRequiredGps;function requireGps(){if(hasRequiredGps)return gps$1;hasRequiredGps=1;const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},i={};for(var a in e)i[e[a]]=a;return gps$1={tagsById:e,tagsByName:i},gps$1}var ifd,hasRequiredIfd;function requireIfd(){if(hasRequiredIfd)return ifd;hasRequiredIfd=1;const e={standard:requireStandard(),exif:requireExif(),gps:requireGps()};class i{constructor(s){if(!s)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=s,this._map=null}get(s){if(typeof s=="number")return this.fields.get(s);if(typeof s=="string")return this.fields.get(e[this.kind].tagsByName[s]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const o=e[this.kind].tagsById;for(var s of this.fields.keys())o[s]&&(this._map[o[s]]=this.fields.get(s))}return this._map}}return ifd=i,ifd}var tiffIfd,hasRequiredTiffIfd;function requireTiffIfd(){if(hasRequiredTiffIfd)return tiffIfd;hasRequiredTiffIfd=1;const e=requireIfd(),i=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class a extends e{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var h=new Date,d=i.exec(this.dateTime);return h.setFullYear(d[1],d[2]-1,d[3]),h.setHours(d[4],d[5],d[6]),h}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return s(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return s(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}function s(o){return typeof o=="number"?[o]:o}return tiffIfd=a,tiffIfd}var ifdValue={},hasRequiredIfdValue;function requireIfdValue(){if(hasRequiredIfdValue)return ifdValue;hasRequiredIfdValue=1;var e=new Map([[1,[1,i]],[2,[1,a]],[3,[2,s]],[4,[4,o]],[5,[8,h]],[6,[1,d]],[7,[1,i]],[8,[2,g]],[9,[4,b]],[10,[8,_]],[11,[4,$]],[12,[8,it]]]);ifdValue.getByteLength=function(nt,tt){return e.get(nt)[0]*tt},ifdValue.readData=function(nt,tt,at){return e.get(tt)[1](nt,at)};function i(nt,tt){if(tt===1)return nt.readUint8();for(var at=new Uint8Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readUint8();return at}function a(nt,tt){for(var at=[],ut="",ft=0;ft<tt;ft++){var ht=String.fromCharCode(nt.readUint8());ht==="\0"?(at.push(ut),ut=""):ut+=ht}return at.length===1?at[0]:at}function s(nt,tt){if(tt===1)return nt.readUint16();for(var at=new Uint16Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readUint16();return at}function o(nt,tt){if(tt===1)return nt.readUint32();for(var at=new Uint32Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readUint32();return at}function h(nt,tt){if(tt===1)return nt.readUint32()/nt.readUint32();for(var at=new Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readUint32()/nt.readUint32();return at}function d(nt,tt){if(tt===1)return nt.readInt8();for(var at=new Int8Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readInt8();return at}function g(nt,tt){if(tt===1)return nt.readInt16();for(var at=new Int16Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readInt16();return at}function b(nt,tt){if(tt===1)return nt.readInt32();for(var at=new Int32Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readInt32();return at}function _(nt,tt){if(tt===1)return nt.readInt32()/nt.readInt32();for(var at=new Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readInt32()/nt.readInt32();return at}function $(nt,tt){if(tt===1)return nt.readFloat32();for(var at=new Float32Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readFloat32();return at}function it(nt,tt){if(tt===1)return nt.readFloat64();for(var at=new Float64Array(tt),ut=0;ut<tt;ut++)at[ut]=nt.readFloat64();return at}return ifdValue}var tiffDecoder,hasRequiredTiffDecoder;function requireTiffDecoder(){if(hasRequiredTiffDecoder)return tiffDecoder;hasRequiredTiffDecoder=1;const e=requireIOBuffer(),i=requireIfd(),a=requireTiffIfd(),s=requireIfdValue(),o={ignoreImageData:!1,onlyFirst:!1};class h extends e{constructor(tt,at){super(tt,at),this._nextIFD=0}decode(tt){tt=Object.assign({},o,tt);const at=[];for(this.decodeHeader();this._nextIFD;)if(at.push(this.decodeIFD(tt)),tt.onlyFirst)return at[0];return at}decodeHeader(){let tt=this.readUint16();if(tt===18761)this.setLittleEndian();else if(tt===19789)this.setBigEndian();else throw new Error("invalid byte order: 0x"+tt.toString(16));if(tt=this.readUint16(),tt!==42)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(tt){this.seek(this._nextIFD);var at;tt.kind?at=new i(tt.kind):at=new a;const ut=this.readUint16();for(var ft=0;ft<ut;ft++)this.decodeIFDEntry(at);return tt.ignoreImageData||this.decodeImageData(at),this._nextIFD=this.readUint32(),at}decodeIFDEntry(tt){const at=this.offset,ut=this.readUint16(),ft=this.readUint16(),ht=this.readUint32();if(ft<1||ft>12){this.skip(4);return}s.getByteLength(ft,ht)>4&&this.seek(this.readUint32());const dt=s.readData(this,ft,ht);if(tt.fields.set(ut,dt),ut===34665||ut===34853){let st=this.offset,ct;ut===34665?ct="exif":ut===34853&&(ct="gps"),this._nextIFD=dt,tt[ct]=this.decodeIFD({kind:ct,ignoreImageData:!0}),this.offset=st}this.seek(at),this.skip(12)}decodeImageData(tt){const at=tt.orientation;switch(at&&at!==1&&$("orientation",at),tt.type){case 1:case 2:this.readStripData(tt);break;default:$("image type",tt.type);break}}readStripData(tt){const at=tt.width,ut=tt.height,ft=it(tt.bitsPerSample),ht=tt.sampleFormat;let dt=at*ut;const st=d(dt,1,ft,ht),ct=tt.compression,wt=tt.rowsPerStrip*at,_t=tt.stripOffsets,gt=tt.stripByteCounts;for(var yt=0,bt=0;bt<_t.length;bt++){var vt=this.getStripData(ct,_t[bt],gt[bt]),Ct=dt>wt?wt:dt;dt-=Ct,ft===8?yt=g(st,vt,yt,Ct):ft===16?yt=b(st,vt,yt,Ct,this.isLittleEndian()):ft===32&&ht===3?yt=_(st,vt,yt,Ct,this.isLittleEndian()):$("bitDepth",ft)}tt.data=st}getStripData(tt,at,ut){switch(tt){case 1:return new DataView(this.buffer,at,ut);case 2:case 32773:return $("Compression",tt);default:throw new Error("invalid compression: "+tt)}}}tiffDecoder=h;function d(nt,tt,at,ut){return at===8?new Uint8Array(nt*tt):at===16?new Uint16Array(nt*tt):at===32&&ut===3?new Float32Array(nt*tt):$("bit depth / sample format",at+" / "+ut)}function g(nt,tt,at,ut){for(var ft=0;ft<ut;ft++)nt[at++]=tt.getUint8(ft);return at}function b(nt,tt,at,ut,ft){for(var ht=0;ht<ut*2;ht+=2)nt[at++]=tt.getUint16(ht,ft);return at}function _(nt,tt,at,ut,ft){for(var ht=0;ht<ut*4;ht+=4)nt[at++]=tt.getFloat32(ht,ft);return at}function $(nt,tt){throw new Error("Unsupported "+nt+": "+tt)}function it(nt){if(nt.length){const at=nt;nt=at[0];for(var tt=0;tt<at.length;tt++)at[tt]!==nt&&$("bit depth",at)}return nt}return tiffDecoder}var decode,hasRequiredDecode$1;function requireDecode$1(){if(hasRequiredDecode$1)return decode;hasRequiredDecode$1=1;const e=requireTiffDecoder();return decode=function(i,a){return new e(i,a).decode(a)},decode}var hasRequiredSrc$4;function requireSrc$4(){return hasRequiredSrc$4||(hasRequiredSrc$4=1,src$3.decode=requireDecode$1()),src$3}var decode_1,hasRequiredDecode;function requireDecode(){if(hasRequiredDecode)return decode_1;hasRequiredDecode=1;const e=requireIOBuffer(),i=requireSrc$4();function a(s){const o=new e(s),h={};if(o.setBigEndian(),o.readUint16()!==65496)throw new Error("SOI marker not found. Not a valid JPEG file");if(o.readUint16()===65505){o.readUint16();const d=o.readBytes(6);if(d[0]===69&&d[1]===120&&d[2]===105&&d[3]===102&&d[4]===0&&d[5]===0){const g=i.decode(o,{onlyFirst:!0,ignoreImageData:!0,offset:o.offset});h.exif=g}}return h}return decode_1=a,decode_1}var hasRequiredSrc$3;function requireSrc$3(){return hasRequiredSrc$3||(hasRequiredSrc$3=1,src$4.decode=requireDecode()),src$4}var srcExports$2=requireSrc$3(),imageType$1={exports:{}},fileType={exports:{}},hasRequiredFileType;function requireFileType(){return hasRequiredFileType||(hasRequiredFileType=1,function(module){const toBytes=e=>[...e].map(i=>i.charCodeAt(0)),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(e,i=0){let a=e[i],s=1,o=0;for(;++o<8;)s*=256,a+=e[i+o]*s;return a}const fileType=e=>{if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const i=e instanceof Uint8Array?e:new Uint8Array(e);if(!(i&&i.length>1))return null;const a=(o,h)=>{h=Object.assign({offset:0},h);for(let d=0;d<o.length;d++)if(h.mask){if(o[d]!==(h.mask[d]&i[d+h.offset]))return!1}else if(o[d]!==i[d+h.offset])return!1;return!0},s=(o,h)=>a(toBytes(o),h);if(a([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(a([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(a([71,73,70]))return{ext:"gif",mime:"image/gif"};if(a([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(a([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((a([73,73,42,0])||a([77,77,0,42]))&&a([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(a([73,73,42,0])||a([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(a([66,77]))return{ext:"bmp",mime:"image/bmp"};if(a([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(a([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(a([80,75,3,4])){if(a([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(a(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(s("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(s("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(s("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const o=(b,_=0)=>b.findIndex(($,it,nt)=>it>=_&&nt[it]===80&&nt[it+1]===75&&nt[it+2]===3&&nt[it+3]===4);let h=0,d=!1,g=null;do{const b=h+30;if(d||(d=a(oxmlContentTypes,{offset:b})||a(oxmlRels,{offset:b})),g||(s("word/",{offset:b})?g={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:s("ppt/",{offset:b})?g={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:s("xl/",{offset:b})&&(g={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),d&&g)return g;h=o(i,b)}while(h>=0);if(g)return g}if(a([80,75])&&(i[2]===3||i[2]===5||i[2]===7)&&(i[3]===4||i[3]===6||i[3]===8))return{ext:"zip",mime:"application/zip"};if(a([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(a([82,97,114,33,26,7])&&(i[6]===0||i[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(a([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(a([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(a([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(a([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(a([51,103,112,53])||a([0,0,0])&&a([102,116,121,112],{offset:4})&&(a([109,112,52,49],{offset:8})||a([109,112,52,50],{offset:8})||a([105,115,111,109],{offset:8})||a([105,115,111,50],{offset:8})||a([109,109,112,52],{offset:8})||a([77,52,86],{offset:8})||a([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(a([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(a([26,69,223,163])){const o=i.subarray(4,4100),h=o.findIndex((d,g,b)=>b[g]===66&&b[g+1]===130);if(h!==-1){const d=h+3,g=b=>[...b].every((_,$)=>o[d+$]===_.charCodeAt(0));if(g("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(g("webm"))return{ext:"webm",mime:"video/webm"}}}if(a([0,0,0,20,102,116,121,112,113,116,32,32])||a([102,114,101,101],{offset:4})||a([102,116,121,112,113,116,32,32],{offset:4})||a([109,100,97,116],{offset:4})||a([109,111,111,118],{offset:4})||a([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(a([82,73,70,70])){if(a([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(a([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(a([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(a([48,38,178,117,142,102,207,17,166,217])){let o=30;do{const h=readUInt64LE(i,o+16);if(a([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:o})){if(a([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:o+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(a([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:o+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}o+=h}while(o+24<=i.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(a([0,0,1,186])||a([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(a([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let o=0;o<2&&o<i.length-16;o++){if(a([73,68,51],{offset:o})||a([255,226],{offset:o,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(a([255,228],{offset:o,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(a([255,248],{offset:o,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(a([255,240],{offset:o,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(a([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(a([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(a([79,103,103,83]))return a([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:a([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:a([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:a([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:a([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(a([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(a([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(a([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(a([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(a([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(a([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((i[0]===67||i[0]===70)&&a([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(a([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(a([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(a([119,79,70,70])&&(a([0,1,0,0],{offset:4})||a([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(a([119,79,70,50])&&(a([0,1,0,0],{offset:4})||a([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(a([76,80],{offset:34})&&(a([0,0,1],{offset:8})||a([1,0,2],{offset:8})||a([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(a([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(a([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(a([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(a([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(a([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(a([37,33]))return{ext:"ps",mime:"application/postscript"};if(a([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(a([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(a([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(a([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(a([77,83,67,70])||a([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(a([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(a([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(a([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(a([31,160])||a([31,157]))return{ext:"Z",mime:"application/x-compress"};if(a([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(a([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(a([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(a([71],{offset:4})&&(a([71],{offset:192})||a([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(a([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(a([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(a([0,0,0,12,106,80,32,32,13,10,135,10])){if(a([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(a([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(a([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(a([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(a([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(s("<?xml "))return{ext:"xml",mime:"application/xml"};if(a([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(a([102,116,121,112],{offset:4})){if(a([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(a([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(a([104,101,105,99],{offset:8})||a([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(a([104,101,118,99],{offset:8})||a([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return a([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:a([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:a([77,80,43])?{ext:"mpc",mime:"audio/x-musepack"}:a([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:a([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:a([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:a([212,195,178,161])||a([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",()=>{const e=new stream.PassThrough,i=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{e.fileType=fileType(i)}catch(a){reject(a)}readableStream.unshift(i),stream.pipeline?resolve(stream.pipeline(readableStream,e,()=>{})):resolve(readableStream.pipe(e))})})}(fileType)),fileType.exports}var hasRequiredImageType;function requireImageType(){if(hasRequiredImageType)return imageType$1.exports;hasRequiredImageType=1;const e=requireFileType(),i=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),a=s=>{const o=e(s);return i.has(o&&o.ext)?o:null};return imageType$1.exports=a,imageType$1.exports.default=a,Object.defineProperty(a,"minimumBytes",{value:e.minimumBytes}),imageType$1.exports}var imageTypeExports=requireImageType();const imageType=getDefaultExportFromCjs(imageTypeExports);function guessStripByteCounts(e){if(e.compression!==1)throw new Error("missing mandatory StripByteCounts field in compressed image");const i=e.rowsPerStrip*e.width*e.samplesPerPixel*(e.bitsPerSample/8);return new Array(e.stripOffsets.length).fill(i)}function applyHorizontalDifferencing8Bit(e,i,a){let s=0;for(;s<e.length;){for(let o=a;o<i*a;o+=a)for(let h=0;h<a;h++)e[s+o+h]=e[s+o+h]+e[s+o-(a-h)]&255;s+=i*a}}function applyHorizontalDifferencing16Bit(e,i,a){let s=0;for(;s<e.length;){for(let o=a;o<i*a;o+=a)for(let h=0;h<a;h++)e[s+o+h]=e[s+o+h]+e[s+o-(a-h)]&65535;s+=i*a}}const tagsById$2={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},tagsByName$2={};for(let e in tagsById$2)tagsByName$2[tagsById$2[e]]=Number(e);const exif=Object.freeze(Object.defineProperty({__proto__:null,tagsById:tagsById$2,tagsByName:tagsByName$2},Symbol.toStringTag,{value:"Module"})),tagsById$1={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},tagsByName$1={};for(let e in tagsById$1)tagsByName$1[tagsById$1[e]]=Number(e);const gps=Object.freeze(Object.defineProperty({__proto__:null,tagsById:tagsById$1,tagsByName:tagsByName$1},Symbol.toStringTag,{value:"Module"})),tagsById={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},tagsByName={};for(let e in tagsById)tagsByName[tagsById[e]]=Number(e);const standard=Object.freeze(Object.defineProperty({__proto__:null,tagsById,tagsByName},Symbol.toStringTag,{value:"Module"})),tags={standard,exif,gps};class IFD{constructor(i){if(!i)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=i,this._hasMap=!1,this._map={}}get(i){if(typeof i=="number")return this.fields.get(i);if(typeof i=="string")return this.fields.get(tags[this.kind].tagsByName[i]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const i=tags[this.kind].tagsById;for(let a of this.fields.keys())i[a]&&(this._map[i[a]]=this.fields.get(a));this._hasMap=!0}return this._map}}let types=new Map([[1,[1,readByte]],[2,[1,readASCII]],[3,[2,readShort]],[4,[4,readLong]],[5,[8,readRational]],[6,[1,readSByte]],[7,[1,readByte]],[8,[2,readSShort]],[9,[4,readSLong]],[10,[8,readSRational]],[11,[4,readFloat]],[12,[8,readDouble]]]);function getByteLength(e,i){const a=types.get(e);if(!a)throw new Error(`type not found: ${e}`);return a[0]*i}function readData(e,i,a){const s=types.get(i);if(!s)throw new Error(`type not found: ${i}`);return s[1](e,a)}function readByte(e,i){if(i===1)return e.readUint8();let a=new Uint8Array(i);for(let s=0;s<i;s++)a[s]=e.readUint8();return a}function readASCII(e,i){let a=[],s="";for(let o=0;o<i;o++){let h=String.fromCharCode(e.readUint8());h==="\0"?(a.push(s),s=""):s+=h}return a.length===1?a[0]:a}function readShort(e,i){if(i===1)return e.readUint16();let a=new Uint16Array(i);for(let s=0;s<i;s++)a[s]=e.readUint16();return a}function readLong(e,i){if(i===1)return e.readUint32();let a=new Uint32Array(i);for(let s=0;s<i;s++)a[s]=e.readUint32();return a}function readRational(e,i){if(i===1)return e.readUint32()/e.readUint32();let a=new Array(i);for(let s=0;s<i;s++)a[s]=e.readUint32()/e.readUint32();return a}function readSByte(e,i){if(i===1)return e.readInt8();let a=new Int8Array(i);for(let s=0;s<i;s++)a[s]=e.readInt8();return a}function readSShort(e,i){if(i===1)return e.readInt16();let a=new Int16Array(i);for(let s=0;s<i;s++)a[s]=e.readInt16();return a}function readSLong(e,i){if(i===1)return e.readInt32();let a=new Int32Array(i);for(let s=0;s<i;s++)a[s]=e.readInt32();return a}function readSRational(e,i){if(i===1)return e.readInt32()/e.readInt32();let a=new Array(i);for(let s=0;s<i;s++)a[s]=e.readInt32()/e.readInt32();return a}function readFloat(e,i){if(i===1)return e.readFloat32();let a=new Float32Array(i);for(let s=0;s<i;s++)a[s]=e.readFloat32();return a}function readDouble(e,i){if(i===1)return e.readFloat64();let a=new Float64Array(i);for(let s=0;s<i;s++)a[s]=e.readFloat64();return a}const CLEAR_CODE=256,EOI_CODE=257,TABLE_START=258,MIN_BIT_LENGTH=9;let stringTable=[];function initializeStringTable(){if(stringTable.length===0){for(let i=0;i<256;i++)stringTable.push([i]);const e=[];for(let i=256;i<4096;i++)stringTable.push(e)}}const andTable=[511,1023,2047,4095],bitJumps=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class LzwDecoder{constructor(i){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=TABLE_START,this.currentBitLength=MIN_BIT_LENGTH,this.stripArray=new Uint8Array(i.buffer,i.byteOffset,i.byteLength),this.outData=new IOBuffer(i.byteLength),this.initializeTable()}decode(){let i=0,a=0;for(;(i=this.getNextCode())!==EOI_CODE;)if(i===CLEAR_CODE){if(this.initializeTable(),i=this.getNextCode(),i===EOI_CODE)break;this.writeString(this.stringFromCode(i)),a=i}else if(this.isInTable(i))this.writeString(this.stringFromCode(i)),this.addStringToTable(this.stringFromCode(a).concat(this.stringFromCode(i)[0])),a=i;else{const o=this.stringFromCode(a).concat(this.stringFromCode(a)[0]);this.writeString(o),this.addStringToTable(o),a=i}const s=this.outData.toArray();return new DataView(s.buffer,s.byteOffset,s.byteLength)}initializeTable(){initializeStringTable(),this.tableLength=TABLE_START,this.currentBitLength=MIN_BIT_LENGTH}writeString(i){this.outData.writeBytes(i)}stringFromCode(i){return stringTable[i]}isInTable(i){return i<this.tableLength}addStringToTable(i){if(stringTable[this.tableLength++]=i,stringTable.length>4096)throw stringTable=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===bitJumps[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|this.stripArray[this.bytePointer++]&255,this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|this.stripArray[this.bytePointer++]&255,this.nextBits+=8);const i=this.nextData>>this.nextBits-this.currentBitLength&andTable[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:i}}function decompressLzw(e){return new LzwDecoder(e).decode()}const dateTimeRegex=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class TiffIfd extends IFD{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let i=new Date,a=dateTimeRegex.exec(this.dateTime);if(a===null)throw new Error(`invalid dateTime: ${this.dateTime}`);return i.setFullYear(Number(a[1]),Number(a[2])-1,Number(a[3])),i.setHours(Number(a[4]),Number(a[5]),Number(a[6])),i}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const i=this.get("BitsPerSample");return i&&typeof i!="number"?i[0]:i}get alpha(){const i=this.extraSamples;return i?i[0]!==0:!1}get associatedAlpha(){const i=this.extraSamples;return i?i[0]===1:!1}get extraSamples(){return alwaysArray(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return alwaysArray(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return alwaysArray(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const i=2**this.bitsPerSample,a=this.get("ColorMap");if(!a)return;if(a.length!==3*i)throw new Error(`ColorMap size must be ${i}`);const s=[];for(let o=0;o<i;o++)s.push([a[o],a[o+i],a[o+2*i]]);return s}}function alwaysArray(e){return typeof e=="number"?[e]:e}function zero$1(e){let i=e.length;for(;--i>=0;)e[i]=0}const MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);const adler32=(e,i,a,s)=>{let o=e&65535|0,h=e>>>16&65535|0,d=0;for(;a!==0;){d=a>2e3?2e3:a,a-=d;do o=o+i[s++]|0,h=h+o|0;while(--d);o%=65521,h%=65521}return o|h<<16|0};var adler32_1$1=adler32;const makeTable=()=>{let e,i=[];for(var a=0;a<256;a++){e=a;for(var s=0;s<8;s++)e=e&1?3988292384^e>>>1:e>>>1;i[a]=e}return i},crcTable=new Uint32Array(makeTable()),crc32=(e,i,a,s)=>{const o=crcTable,h=s+a;e^=-1;for(let d=s;d<h;d++)e=e>>>8^o[(e^i[d])&255];return e^-1};var crc32_1$1=crc32,messages$1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const _has=(e,i)=>Object.prototype.hasOwnProperty.call(e,i);var assign=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const a=i.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(const s in a)_has(a,s)&&(e[s]=a[s])}}return e},flattenChunks=e=>{let i=0;for(let s=0,o=e.length;s<o;s++)i+=e[s].length;const a=new Uint8Array(i);for(let s=0,o=0,h=e.length;s<h;s++){let d=e[s];a.set(d,o),o+=d.length}return a},common$1={assign,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let e=0;e<256;e++)_utf8len[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let i,a,s,o,h,d=e.length,g=0;for(o=0;o<d;o++)a=e.charCodeAt(o),(a&64512)===55296&&o+1<d&&(s=e.charCodeAt(o+1),(s&64512)===56320&&(a=65536+(a-55296<<10)+(s-56320),o++)),g+=a<128?1:a<2048?2:a<65536?3:4;for(i=new Uint8Array(g),h=0,o=0;h<g;o++)a=e.charCodeAt(o),(a&64512)===55296&&o+1<d&&(s=e.charCodeAt(o+1),(s&64512)===56320&&(a=65536+(a-55296<<10)+(s-56320),o++)),a<128?i[h++]=a:a<2048?(i[h++]=192|a>>>6,i[h++]=128|a&63):a<65536?(i[h++]=224|a>>>12,i[h++]=128|a>>>6&63,i[h++]=128|a&63):(i[h++]=240|a>>>18,i[h++]=128|a>>>12&63,i[h++]=128|a>>>6&63,i[h++]=128|a&63);return i};const buf2binstring=(e,i)=>{if(i<65534&&e.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let a="";for(let s=0;s<i;s++)a+=String.fromCharCode(e[s]);return a};var buf2string=(e,i)=>{const a=i||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,i));let s,o;const h=new Array(a*2);for(o=0,s=0;s<a;){let d=e[s++];if(d<128){h[o++]=d;continue}let g=_utf8len[d];if(g>4){h[o++]=65533,s+=g-1;continue}for(d&=g===2?31:g===3?15:7;g>1&&s<a;)d=d<<6|e[s++]&63,g--;if(g>1){h[o++]=65533;continue}d<65536?h[o++]=d:(d-=65536,h[o++]=55296|d>>10&1023,h[o++]=56320|d&1023)}return buf2binstring(h,o)},utf8border=(e,i)=>{i=i||e.length,i>e.length&&(i=e.length);let a=i-1;for(;a>=0&&(e[a]&192)===128;)a--;return a<0||a===0?i:a+_utf8len[e[a]]>i?a:i},strings$1={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream$1=ZStream;const BAD$1=16209,TYPE$1=16191;var inffast$1=function e(i,a){let s,o,h,d,g,b,_,$,it,nt,tt,at,ut,ft,ht,dt,st,ct,wt,_t,gt,yt,bt,vt;const Ct=i.state;s=i.next_in,bt=i.input,o=s+(i.avail_in-5),h=i.next_out,vt=i.output,d=h-(a-i.avail_out),g=h+(i.avail_out-257),b=Ct.dmax,_=Ct.wsize,$=Ct.whave,it=Ct.wnext,nt=Ct.window,tt=Ct.hold,at=Ct.bits,ut=Ct.lencode,ft=Ct.distcode,ht=(1<<Ct.lenbits)-1,dt=(1<<Ct.distbits)-1;t:do{at<15&&(tt+=bt[s++]<<at,at+=8,tt+=bt[s++]<<at,at+=8),st=ut[tt&ht];e:for(;;){if(ct=st>>>24,tt>>>=ct,at-=ct,ct=st>>>16&255,ct===0)vt[h++]=st&65535;else if(ct&16){wt=st&65535,ct&=15,ct&&(at<ct&&(tt+=bt[s++]<<at,at+=8),wt+=tt&(1<<ct)-1,tt>>>=ct,at-=ct),at<15&&(tt+=bt[s++]<<at,at+=8,tt+=bt[s++]<<at,at+=8),st=ft[tt&dt];r:for(;;){if(ct=st>>>24,tt>>>=ct,at-=ct,ct=st>>>16&255,ct&16){if(_t=st&65535,ct&=15,at<ct&&(tt+=bt[s++]<<at,at+=8,at<ct&&(tt+=bt[s++]<<at,at+=8)),_t+=tt&(1<<ct)-1,_t>b){i.msg="invalid distance too far back",Ct.mode=BAD$1;break t}if(tt>>>=ct,at-=ct,ct=h-d,_t>ct){if(ct=_t-ct,ct>$&&Ct.sane){i.msg="invalid distance too far back",Ct.mode=BAD$1;break t}if(gt=0,yt=nt,it===0){if(gt+=_-ct,ct<wt){wt-=ct;do vt[h++]=nt[gt++];while(--ct);gt=h-_t,yt=vt}}else if(it<ct){if(gt+=_+it-ct,ct-=it,ct<wt){wt-=ct;do vt[h++]=nt[gt++];while(--ct);if(gt=0,it<wt){ct=it,wt-=ct;do vt[h++]=nt[gt++];while(--ct);gt=h-_t,yt=vt}}}else if(gt+=it-ct,ct<wt){wt-=ct;do vt[h++]=nt[gt++];while(--ct);gt=h-_t,yt=vt}for(;wt>2;)vt[h++]=yt[gt++],vt[h++]=yt[gt++],vt[h++]=yt[gt++],wt-=3;wt&&(vt[h++]=yt[gt++],wt>1&&(vt[h++]=yt[gt++]))}else{gt=h-_t;do vt[h++]=vt[gt++],vt[h++]=vt[gt++],vt[h++]=vt[gt++],wt-=3;while(wt>2);wt&&(vt[h++]=vt[gt++],wt>1&&(vt[h++]=vt[gt++]))}}else if(ct&64){i.msg="invalid distance code",Ct.mode=BAD$1;break t}else{st=ft[(st&65535)+(tt&(1<<ct)-1)];continue r}break}}else if(ct&64)if(ct&32){Ct.mode=TYPE$1;break t}else{i.msg="invalid literal/length code",Ct.mode=BAD$1;break t}else{st=ut[(st&65535)+(tt&(1<<ct)-1)];continue e}break}}while(s<o&&h<g);wt=at>>3,s-=wt,at-=wt<<3,tt&=(1<<at)-1,i.next_in=s,i.next_out=h,i.avail_in=s<o?5+(o-s):5-(s-o),i.avail_out=h<g?257+(g-h):257-(h-g),Ct.hold=tt,Ct.bits=at};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(e,i,a,s,o,h,d,g)=>{const b=g.bits;let _=0,$=0,it=0,nt=0,tt=0,at=0,ut=0,ft=0,ht=0,dt=0,st,ct,wt,_t,gt,yt=null,bt;const vt=new Uint16Array(MAXBITS+1),Ct=new Uint16Array(MAXBITS+1);let Ht=null,Ft,qt,zt;for(_=0;_<=MAXBITS;_++)vt[_]=0;for($=0;$<s;$++)vt[i[a+$]]++;for(tt=b,nt=MAXBITS;nt>=1&&vt[nt]===0;nt--);if(tt>nt&&(tt=nt),nt===0)return o[h++]=1<<24|64<<16|0,o[h++]=1<<24|64<<16|0,g.bits=1,0;for(it=1;it<nt&&vt[it]===0;it++);for(tt<it&&(tt=it),ft=1,_=1;_<=MAXBITS;_++)if(ft<<=1,ft-=vt[_],ft<0)return-1;if(ft>0&&(e===CODES$1||nt!==1))return-1;for(Ct[1]=0,_=1;_<MAXBITS;_++)Ct[_+1]=Ct[_]+vt[_];for($=0;$<s;$++)i[a+$]!==0&&(d[Ct[i[a+$]]++]=$);if(e===CODES$1?(yt=Ht=d,bt=20):e===LENS$1?(yt=lbase,Ht=lext,bt=257):(yt=dbase,Ht=dext,bt=0),dt=0,$=0,_=it,gt=h,at=tt,ut=0,wt=-1,ht=1<<tt,_t=ht-1,e===LENS$1&&ht>ENOUGH_LENS$1||e===DISTS$1&&ht>ENOUGH_DISTS$1)return 1;for(;;){Ft=_-ut,d[$]+1<bt?(qt=0,zt=d[$]):d[$]>=bt?(qt=Ht[d[$]-bt],zt=yt[d[$]-bt]):(qt=96,zt=0),st=1<<_-ut,ct=1<<at,it=ct;do ct-=st,o[gt+(dt>>ut)+ct]=Ft<<24|qt<<16|zt|0;while(ct!==0);for(st=1<<_-1;dt&st;)st>>=1;if(st!==0?(dt&=st-1,dt+=st):dt=0,$++,--vt[_]===0){if(_===nt)break;_=i[a+d[$]]}if(_>tt&&(dt&_t)!==wt){for(ut===0&&(ut=tt),gt+=it,at=_-ut,ft=1<<at;at+ut<nt&&(ft-=vt[at+ut],!(ft<=0));)at++,ft<<=1;if(ht+=1<<at,e===LENS$1&&ht>ENOUGH_LENS$1||e===DISTS$1&&ht>ENOUGH_DISTS$1)return 1;wt=dt&_t,o[wt]=tt<<24|at<<16|gt-h|0}}return dt!==0&&(o[gt+dt]=_-ut<<24|64<<16|0),g.bits=tt,0};var inftrees$1=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=e=>{if(!e)return 1;const i=e.state;return!i||i.strm!==e||i.mode<HEAD||i.mode>SYNC?1:0},inflateResetKeep=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const i=e.state;return e.total_in=e.total_out=i.total=0,e.msg="",i.wrap&&(e.adler=i.wrap&1),i.mode=HEAD,i.last=0,i.havedict=0,i.flags=-1,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new Int32Array(ENOUGH_LENS),i.distcode=i.distdyn=new Int32Array(ENOUGH_DISTS),i.sane=1,i.back=-1,Z_OK$1},inflateReset=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const i=e.state;return i.wsize=0,i.whave=0,i.wnext=0,inflateResetKeep(e)},inflateReset2=(e,i)=>{let a;if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const s=e.state;return i<0?(a=0,i=-i):(a=(i>>4)+5,i<48&&(i&=15)),i&&(i<8||i>15)?Z_STREAM_ERROR$1:(s.window!==null&&s.wbits!==i&&(s.window=null),s.wrap=a,s.wbits=i,inflateReset(e))},inflateInit2=(e,i)=>{if(!e)return Z_STREAM_ERROR$1;const a=new InflateState;e.state=a,a.strm=e,a.window=null,a.mode=HEAD;const s=inflateReset2(e,i);return s!==Z_OK$1&&(e.state=null),s},inflateInit=e=>inflateInit2(e,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=e=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let i=0;for(;i<144;)e.lens[i++]=8;for(;i<256;)e.lens[i++]=9;for(;i<280;)e.lens[i++]=7;for(;i<288;)e.lens[i++]=8;for(inftrees$1(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),i=0;i<32;)e.lens[i++]=5;inftrees$1(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=(e,i,a,s)=>{let o;const h=e.state;return h.window===null&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new Uint8Array(h.wsize)),s>=h.wsize?(h.window.set(i.subarray(a-h.wsize,a),0),h.wnext=0,h.whave=h.wsize):(o=h.wsize-h.wnext,o>s&&(o=s),h.window.set(i.subarray(a-s,a-s+o),h.wnext),s-=o,s?(h.window.set(i.subarray(a-s,a),0),h.wnext=s,h.whave=h.wsize):(h.wnext+=o,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=o))),0},inflate$2=(e,i)=>{let a,s,o,h,d,g,b,_,$,it,nt,tt,at,ut,ft=0,ht,dt,st,ct,wt,_t,gt,yt;const bt=new Uint8Array(4);let vt,Ct;const Ht=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(e)||!e.output||!e.input&&e.avail_in!==0)return Z_STREAM_ERROR$1;a=e.state,a.mode===TYPE&&(a.mode=TYPEDO),d=e.next_out,o=e.output,b=e.avail_out,h=e.next_in,s=e.input,g=e.avail_in,_=a.hold,$=a.bits,it=g,nt=b,yt=Z_OK$1;t:for(;;)switch(a.mode){case HEAD:if(a.wrap===0){a.mode=TYPEDO;break}for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.wrap&2&&_===35615){a.wbits===0&&(a.wbits=15),a.check=0,bt[0]=_&255,bt[1]=_>>>8&255,a.check=crc32_1$1(a.check,bt,2,0),_=0,$=0,a.mode=FLAGS;break}if(a.head&&(a.head.done=!1),!(a.wrap&1)||(((_&255)<<8)+(_>>8))%31){e.msg="incorrect header check",a.mode=BAD;break}if((_&15)!==Z_DEFLATED){e.msg="unknown compression method",a.mode=BAD;break}if(_>>>=4,$-=4,gt=(_&15)+8,a.wbits===0&&(a.wbits=gt),gt>15||gt>a.wbits){e.msg="invalid window size",a.mode=BAD;break}a.dmax=1<<a.wbits,a.flags=0,e.adler=a.check=1,a.mode=_&512?DICTID:TYPE,_=0,$=0;break;case FLAGS:for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.flags=_,(a.flags&255)!==Z_DEFLATED){e.msg="unknown compression method",a.mode=BAD;break}if(a.flags&57344){e.msg="unknown header flags set",a.mode=BAD;break}a.head&&(a.head.text=_>>8&1),a.flags&512&&a.wrap&4&&(bt[0]=_&255,bt[1]=_>>>8&255,a.check=crc32_1$1(a.check,bt,2,0)),_=0,$=0,a.mode=TIME;case TIME:for(;$<32;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.head&&(a.head.time=_),a.flags&512&&a.wrap&4&&(bt[0]=_&255,bt[1]=_>>>8&255,bt[2]=_>>>16&255,bt[3]=_>>>24&255,a.check=crc32_1$1(a.check,bt,4,0)),_=0,$=0,a.mode=OS;case OS:for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.head&&(a.head.xflags=_&255,a.head.os=_>>8),a.flags&512&&a.wrap&4&&(bt[0]=_&255,bt[1]=_>>>8&255,a.check=crc32_1$1(a.check,bt,2,0)),_=0,$=0,a.mode=EXLEN;case EXLEN:if(a.flags&1024){for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.length=_,a.head&&(a.head.extra_len=_),a.flags&512&&a.wrap&4&&(bt[0]=_&255,bt[1]=_>>>8&255,a.check=crc32_1$1(a.check,bt,2,0)),_=0,$=0}else a.head&&(a.head.extra=null);a.mode=EXTRA;case EXTRA:if(a.flags&1024&&(tt=a.length,tt>g&&(tt=g),tt&&(a.head&&(gt=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(s.subarray(h,h+tt),gt)),a.flags&512&&a.wrap&4&&(a.check=crc32_1$1(a.check,s,tt,h)),g-=tt,h+=tt,a.length-=tt),a.length))break t;a.length=0,a.mode=NAME;case NAME:if(a.flags&2048){if(g===0)break t;tt=0;do gt=s[h+tt++],a.head&&gt&&a.length<65536&&(a.head.name+=String.fromCharCode(gt));while(gt&&tt<g);if(a.flags&512&&a.wrap&4&&(a.check=crc32_1$1(a.check,s,tt,h)),g-=tt,h+=tt,gt)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=COMMENT;case COMMENT:if(a.flags&4096){if(g===0)break t;tt=0;do gt=s[h+tt++],a.head&&gt&&a.length<65536&&(a.head.comment+=String.fromCharCode(gt));while(gt&&tt<g);if(a.flags&512&&a.wrap&4&&(a.check=crc32_1$1(a.check,s,tt,h)),g-=tt,h+=tt,gt)break t}else a.head&&(a.head.comment=null);a.mode=HCRC;case HCRC:if(a.flags&512){for(;$<16;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.wrap&4&&_!==(a.check&65535)){e.msg="header crc mismatch",a.mode=BAD;break}_=0,$=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=TYPE;break;case DICTID:for(;$<32;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}e.adler=a.check=zswap32(_),_=0,$=0,a.mode=DICT;case DICT:if(a.havedict===0)return e.next_out=d,e.avail_out=b,e.next_in=h,e.avail_in=g,a.hold=_,a.bits=$,Z_NEED_DICT$1;e.adler=a.check=1,a.mode=TYPE;case TYPE:if(i===Z_BLOCK||i===Z_TREES)break t;case TYPEDO:if(a.last){_>>>=$&7,$-=$&7,a.mode=CHECK;break}for(;$<3;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}switch(a.last=_&1,_>>>=1,$-=1,_&3){case 0:a.mode=STORED;break;case 1:if(fixedtables(a),a.mode=LEN_,i===Z_TREES){_>>>=2,$-=2;break t}break;case 2:a.mode=TABLE;break;case 3:e.msg="invalid block type",a.mode=BAD}_>>>=2,$-=2;break;case STORED:for(_>>>=$&7,$-=$&7;$<32;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if((_&65535)!==(_>>>16^65535)){e.msg="invalid stored block lengths",a.mode=BAD;break}if(a.length=_&65535,_=0,$=0,a.mode=COPY_,i===Z_TREES)break t;case COPY_:a.mode=COPY;case COPY:if(tt=a.length,tt){if(tt>g&&(tt=g),tt>b&&(tt=b),tt===0)break t;o.set(s.subarray(h,h+tt),d),g-=tt,h+=tt,b-=tt,d+=tt,a.length-=tt;break}a.mode=TYPE;break;case TABLE:for(;$<14;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.nlen=(_&31)+257,_>>>=5,$-=5,a.ndist=(_&31)+1,_>>>=5,$-=5,a.ncode=(_&15)+4,_>>>=4,$-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=BAD;break}a.have=0,a.mode=LENLENS;case LENLENS:for(;a.have<a.ncode;){for(;$<3;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.lens[Ht[a.have++]]=_&7,_>>>=3,$-=3}for(;a.have<19;)a.lens[Ht[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,vt={bits:a.lenbits},yt=inftrees$1(CODES,a.lens,0,19,a.lencode,0,a.work,vt),a.lenbits=vt.bits,yt){e.msg="invalid code lengths set",a.mode=BAD;break}a.have=0,a.mode=CODELENS;case CODELENS:for(;a.have<a.nlen+a.ndist;){for(;ft=a.lencode[_&(1<<a.lenbits)-1],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(st<16)_>>>=ht,$-=ht,a.lens[a.have++]=st;else{if(st===16){for(Ct=ht+2;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(_>>>=ht,$-=ht,a.have===0){e.msg="invalid bit length repeat",a.mode=BAD;break}gt=a.lens[a.have-1],tt=3+(_&3),_>>>=2,$-=2}else if(st===17){for(Ct=ht+3;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}_>>>=ht,$-=ht,gt=0,tt=3+(_&7),_>>>=3,$-=3}else{for(Ct=ht+7;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}_>>>=ht,$-=ht,gt=0,tt=11+(_&127),_>>>=7,$-=7}if(a.have+tt>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=BAD;break}for(;tt--;)a.lens[a.have++]=gt}}if(a.mode===BAD)break;if(a.lens[256]===0){e.msg="invalid code -- missing end-of-block",a.mode=BAD;break}if(a.lenbits=9,vt={bits:a.lenbits},yt=inftrees$1(LENS,a.lens,0,a.nlen,a.lencode,0,a.work,vt),a.lenbits=vt.bits,yt){e.msg="invalid literal/lengths set",a.mode=BAD;break}if(a.distbits=6,a.distcode=a.distdyn,vt={bits:a.distbits},yt=inftrees$1(DISTS,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,vt),a.distbits=vt.bits,yt){e.msg="invalid distances set",a.mode=BAD;break}if(a.mode=LEN_,i===Z_TREES)break t;case LEN_:a.mode=LEN;case LEN:if(g>=6&&b>=258){e.next_out=d,e.avail_out=b,e.next_in=h,e.avail_in=g,a.hold=_,a.bits=$,inffast$1(e,nt),d=e.next_out,o=e.output,b=e.avail_out,h=e.next_in,s=e.input,g=e.avail_in,_=a.hold,$=a.bits,a.mode===TYPE&&(a.back=-1);break}for(a.back=0;ft=a.lencode[_&(1<<a.lenbits)-1],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(dt&&!(dt&240)){for(ct=ht,wt=dt,_t=st;ft=a.lencode[_t+((_&(1<<ct+wt)-1)>>ct)],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ct+ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}_>>>=ct,$-=ct,a.back+=ct}if(_>>>=ht,$-=ht,a.back+=ht,a.length=st,dt===0){a.mode=LIT;break}if(dt&32){a.back=-1,a.mode=TYPE;break}if(dt&64){e.msg="invalid literal/length code",a.mode=BAD;break}a.extra=dt&15,a.mode=LENEXT;case LENEXT:if(a.extra){for(Ct=a.extra;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.length+=_&(1<<a.extra)-1,_>>>=a.extra,$-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=DIST;case DIST:for(;ft=a.distcode[_&(1<<a.distbits)-1],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(!(dt&240)){for(ct=ht,wt=dt,_t=st;ft=a.distcode[_t+((_&(1<<ct+wt)-1)>>ct)],ht=ft>>>24,dt=ft>>>16&255,st=ft&65535,!(ct+ht<=$);){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}_>>>=ct,$-=ct,a.back+=ct}if(_>>>=ht,$-=ht,a.back+=ht,dt&64){e.msg="invalid distance code",a.mode=BAD;break}a.offset=st,a.extra=dt&15,a.mode=DISTEXT;case DISTEXT:if(a.extra){for(Ct=a.extra;$<Ct;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}a.offset+=_&(1<<a.extra)-1,_>>>=a.extra,$-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=BAD;break}a.mode=MATCH;case MATCH:if(b===0)break t;if(tt=nt-b,a.offset>tt){if(tt=a.offset-tt,tt>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=BAD;break}tt>a.wnext?(tt-=a.wnext,at=a.wsize-tt):at=a.wnext-tt,tt>a.length&&(tt=a.length),ut=a.window}else ut=o,at=d-a.offset,tt=a.length;tt>b&&(tt=b),b-=tt,a.length-=tt;do o[d++]=ut[at++];while(--tt);a.length===0&&(a.mode=LEN);break;case LIT:if(b===0)break t;o[d++]=a.length,b--,a.mode=LEN;break;case CHECK:if(a.wrap){for(;$<32;){if(g===0)break t;g--,_|=s[h++]<<$,$+=8}if(nt-=b,e.total_out+=nt,a.total+=nt,a.wrap&4&&nt&&(e.adler=a.check=a.flags?crc32_1$1(a.check,o,nt,d-nt):adler32_1$1(a.check,o,nt,d-nt)),nt=b,a.wrap&4&&(a.flags?_:zswap32(_))!==a.check){e.msg="incorrect data check",a.mode=BAD;break}_=0,$=0}a.mode=LENGTH;case LENGTH:if(a.wrap&&a.flags){for(;$<32;){if(g===0)break t;g--,_+=s[h++]<<$,$+=8}if(a.wrap&4&&_!==(a.total&4294967295)){e.msg="incorrect length check",a.mode=BAD;break}_=0,$=0}a.mode=DONE;case DONE:yt=Z_STREAM_END$1;break t;case BAD:yt=Z_DATA_ERROR$1;break t;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return e.next_out=d,e.avail_out=b,e.next_in=h,e.avail_in=g,a.hold=_,a.bits=$,(a.wsize||nt!==e.avail_out&&a.mode<BAD&&(a.mode<CHECK||i!==Z_FINISH$1))&&updatewindow(e,e.output,e.next_out,nt-e.avail_out),it-=e.avail_in,nt-=e.avail_out,e.total_in+=it,e.total_out+=nt,a.total+=nt,a.wrap&4&&nt&&(e.adler=a.check=a.flags?crc32_1$1(a.check,o,nt,e.next_out-nt):adler32_1$1(a.check,o,nt,e.next_out-nt)),e.data_type=a.bits+(a.last?64:0)+(a.mode===TYPE?128:0)+(a.mode===LEN_||a.mode===COPY_?256:0),(it===0&&nt===0||i===Z_FINISH$1)&&yt===Z_OK$1&&(yt=Z_BUF_ERROR),yt},inflateEnd=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;let i=e.state;return i.window&&(i.window=null),e.state=null,Z_OK$1},inflateGetHeader=(e,i)=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const a=e.state;return a.wrap&2?(a.head=i,i.done=!1,Z_OK$1):Z_STREAM_ERROR$1},inflateSetDictionary=(e,i)=>{const a=i.length;let s,o,h;return inflateStateCheck(e)||(s=e.state,s.wrap!==0&&s.mode!==DICT)?Z_STREAM_ERROR$1:s.mode===DICT&&(o=1,o=adler32_1$1(o,i,a,0),o!==s.check)?Z_DATA_ERROR$1:(h=updatewindow(e,i,a,a),h?(s.mode=MEM,Z_MEM_ERROR$1):(s.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader$1=GZheader;const toString$1=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(e){this.options=common$1.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),i.windowBits>=0&&i.windowBits<16&&!(e&&e.windowBits)&&(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&!(i.windowBits&15)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream$1,this.strm.avail_out=0;let a=inflate_1$2.inflateInit2(this.strm,i.windowBits);if(a!==Z_OK)throw new Error(messages$1[a]);if(this.header=new gzheader$1,inflate_1$2.inflateGetHeader(this.strm,this.header),i.dictionary&&(typeof i.dictionary=="string"?i.dictionary=strings$1.string2buf(i.dictionary):toString$1.call(i.dictionary)==="[object ArrayBuffer]"&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(a=inflate_1$2.inflateSetDictionary(this.strm,i.dictionary),a!==Z_OK)))throw new Error(messages$1[a])}Inflate$1.prototype.push=function(e,i){const a=this.strm,s=this.options.chunkSize,o=this.options.dictionary;let h,d,g;if(this.ended)return!1;for(i===~~i?d=i:d=i===!0?Z_FINISH:Z_NO_FLUSH,toString$1.call(e)==="[object ArrayBuffer]"?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(a.avail_out===0&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),h=inflate_1$2.inflate(a,d),h===Z_NEED_DICT&&o&&(h=inflate_1$2.inflateSetDictionary(a,o),h===Z_OK?h=inflate_1$2.inflate(a,d):h===Z_DATA_ERROR&&(h=Z_NEED_DICT));a.avail_in>0&&h===Z_STREAM_END&&a.state.wrap>0&&e[a.next_in]!==0;)inflate_1$2.inflateReset(a),h=inflate_1$2.inflate(a,d);switch(h){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(h),this.ended=!0,!1}if(g=a.avail_out,a.next_out&&(a.avail_out===0||h===Z_STREAM_END))if(this.options.to==="string"){let b=strings$1.utf8border(a.output,a.next_out),_=a.next_out-b,$=strings$1.buf2string(a.output,b);a.next_out=_,a.avail_out=s-_,_&&a.output.set(a.output.subarray(b,b+_),0),this.onData($)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(!(h===Z_OK&&g===0)){if(h===Z_STREAM_END)return h=inflate_1$2.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,!0;if(a.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(e){this.chunks.push(e)};Inflate$1.prototype.onEnd=function(e){e===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function inflate$1$1(e,i){const a=new Inflate$1(i);if(a.push(e),a.err)throw a.msg||messages$1[a.err];return a.result}var inflate_2=inflate$1$1,inflate_1$1={inflate:inflate_2};const{inflate:inflate$3}=inflate_1$1;var inflate_1=inflate$3;function decompressZlib(e){const i=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=inflate_1(i);return new DataView(a.buffer,a.byteOffset,a.byteLength)}const defaultOptions$3={ignoreImageData:!1,onlyFirst:!1};class TIFFDecoder extends IOBuffer{constructor(i){super(i),this._nextIFD=0}get isMultiPage(){let i=0;for(this.decodeHeader();this._nextIFD;)if(i++,this.decodeIFD({ignoreImageData:!0},!0),i===2)return!0;if(i===1)return!1;throw unsupported("ifdCount",i)}get pageCount(){let i=0;for(this.decodeHeader();this._nextIFD;)i++,this.decodeIFD({ignoreImageData:!0},!0);if(i>0)return i;throw unsupported("ifdCount",i)}decode(i={}){i=Object.assign({},defaultOptions$3,i);const a=[];for(this.decodeHeader();this._nextIFD;)if(a.push(this.decodeIFD(i,!0)),i.onlyFirst)return[a[0]];return a}decodeHeader(){const i=this.readUint16();if(i===18761)this.setLittleEndian();else if(i===19789)this.setBigEndian();else throw new Error(`invalid byte order: 0x${i.toString(16)}`);if(this.readUint16()!==42)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(i,a){this.seek(this._nextIFD);let s;if(a)s=new TiffIfd;else{if(!i.kind)throw new Error("kind is missing");s=new IFD(i.kind)}const o=this.readUint16();for(let h=0;h<o;h++)this.decodeIFDEntry(s);if(!i.ignoreImageData){if(!(s instanceof TiffIfd))throw new Error("must be a tiff ifd");this.decodeImageData(s)}return this._nextIFD=this.readUint32(),s}decodeIFDEntry(i){const a=this.offset,s=this.readUint16(),o=this.readUint16(),h=this.readUint32();if(o<1||o>12){this.skip(4);return}getByteLength(o,h)>4&&this.seek(this.readUint32());const d=readData(this,o,h);if(i.fields.set(s,d),s===34665||s===34853){let g=this.offset,b="exif";s===34665?b="exif":s===34853&&(b="gps"),this._nextIFD=d,i[b]=this.decodeIFD({kind:b,ignoreImageData:!0},!1),this.offset=g}this.seek(a),this.skip(12)}decodeImageData(i){const a=i.orientation;if(a&&a!==1)throw unsupported("orientation",a);switch(i.type){case 0:case 1:case 2:case 3:this.readStripData(i);break;default:throw unsupported("image type",i.type)}if(this.applyPredictor(i),this.convertAlpha(i),i.type===0){const s=i.bitsPerSample,o=Math.pow(2,s)-1;for(let h=0;h<i.data.length;h++)i.data[h]=o-i.data[h]}}readStripData(i){const a=i.width,s=i.height,o=i.bitsPerSample,h=i.sampleFormat,d=a*s*i.samplesPerPixel,g=getDataArray(d,o,h),b=i.rowsPerStrip*a*i.samplesPerPixel,_=i.stripOffsets,$=i.stripByteCounts||guessStripByteCounts(i);let it=d,nt=0;for(let tt=0;tt<_.length;tt++){let at=new DataView(this.buffer,this.byteOffset+_[tt],$[tt]),ut=it>b?b:it;it-=ut;let ft=at;switch(i.compression){case 1:break;case 5:{ft=decompressLzw(at);break}case 8:{ft=decompressZlib(at);break}case 2:throw unsupported("Compression","CCITT Group 3");case 32773:throw unsupported("Compression","PackBits");default:throw unsupported("Compression",i.compression)}nt=this.fillUncompressed(o,h,g,ft,nt,ut)}i.data=g}fillUncompressed(i,a,s,o,h,d){if(i===8)return fill8bit(s,o,h,d);if(i===16)return fill16bit(s,o,h,d,this.isLittleEndian());if(i===32&&a===3)return fillFloat32(s,o,h,d,this.isLittleEndian());throw unsupported("bitDepth",i)}applyPredictor(i){const a=i.bitsPerSample;switch(i.predictor){case 1:break;case 2:{if(a===8)applyHorizontalDifferencing8Bit(i.data,i.width,i.components);else if(a===16)applyHorizontalDifferencing16Bit(i.data,i.width,i.components);else throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${a}`);break}default:throw new Error(`invalid predictor: ${i.predictor}`)}}convertAlpha(i){if(i.alpha&&i.associatedAlpha){const{data:a,components:s,maxSampleValue:o}=i;for(let h=0;h<a.length;h+=s){const d=a[h+s-1];for(let g=0;g<s-1;g++)a[h+g]=Math.round(a[h+g]*o/d)}}}}function getDataArray(e,i,a){if(i===8)return new Uint8Array(e);if(i===16)return new Uint16Array(e);if(i===32&&a===3)return new Float32Array(e);throw unsupported("bit depth / sample format",`${i} / ${a}`)}function fill8bit(e,i,a,s){for(let o=0;o<s;o++)e[a++]=i.getUint8(o);return a}function fill16bit(e,i,a,s,o){for(let h=0;h<s*2;h+=2)e[a++]=i.getUint16(h,o);return a}function fillFloat32(e,i,a,s,o){for(let h=0;h<s*4;h+=4)e[a++]=i.getFloat32(h,o);return a}function unsupported(e,i){return new Error(`Unsupported ${e}: ${i}`)}function decodeTIFF(e,i){return new TIFFDecoder(e).decode(i)}function matchAndCrop(e={}){let{algorithm:i="matchToPrevious",ignoreBorder:a=[0,0]}=e;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let s=i==="matchToPrevious",o=this[0],h=[];h[0]={position:[0,0],image:this[0]};let d=[0,0];for(let nt=1;nt<this.length;nt++){let tt=o.getBestMatch(this[nt],{border:a});h[nt]={position:[tt[0]+d[0],tt[1]+d[1]],image:this[nt]},s&&(d[0]+=tt[0],d[1]+=tt[1],o=this[nt])}let g=0,b=0,_=0,$=0;for(let nt=0;nt<h.length;nt++){let tt=h[nt];tt.position[0]>g&&(g=tt.position[0]),tt.position[0]<b&&(b=tt.position[0]),tt.position[1]>_&&(_=tt.position[1]),tt.position[1]<$&&($=tt.position[1])}b=0-b,$=0-$;for(let nt=0;nt<h.length;nt++){let tt=h[nt];tt.crop=tt.image.crop({x:g-tt.position[0],y:_-tt.position[1],width:o.width-b-g,height:o.height-$-_})}let it=[];for(let nt=0;nt<h.length;nt++)it[nt]=h[nt].crop;return new Stack(it)}function min$2(){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].min;for(let i=1;i<this.length;i++)for(let a=0;a<e.length;a++)e[a]=Math.min(e[a],this[i].min[a]);return e}function max$2(){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].max;for(let i=1;i<this.length;i++)for(let a=0;a<e.length;a++)e[a]=Math.max(e[a],this[i].max[a]);return e}function median$2(e){let i=e.reduce((d,g)=>d+g);if(i===0)throw new Error("unreachable");let a=0,s=0,o=i/2,h;for(;;){if(e[a]>0){if(h!==void 0)return(h+a)/2;if(s+=e[a],s>o)return a;s===o&&(h=a)}a++}}function mean$2(e){let i=0,a=0;for(let s=0;s<e.length;s++)i+=e[s],a+=e[s]*s;return i===0?0:a/i}function median$1(){this.checkProcessable("median",{bitDepth:[8,16]});let e=this.getHistograms({maxSlots:this[0].maxValue+1}),i=new Array(e.length);for(let a=0;a<e.length;a++){let s=e[a];i[a]=median$2(s)}return i}function histogram(e){this.checkProcessable("min",{bitDepth:[8,16]});let i=this[0].getHistogram(e);for(let a=1;a<this.length;a++){let s=this[a].getHistogram(e);for(let o=0;o<i.length;o++)i[o]+=s[o]}return i}function histograms(e){this.checkProcessable("min",{bitDepth:[8,16]});let i=this[0].getHistograms(e),a=i[0].length;for(let s=1;s<this.length;s++){let o=this[s].getHistograms(e);for(let h=0;h<i.length;h++)for(let d=0;d<a;d++)i[h][d]+=o[h][d]}return i}function averageImage(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let e=new Uint32Array(this[0].data.length);for(let s=0;s<this.length;s++){let o=this[s];for(let h=0;h<this[0].data.length;h++)e[h]+=o.data[h]}let i=Image.createFrom(this[0]),a=i.data;for(let s=0;s<this[0].data.length;s++)a[s]=e[s]/this.length;return i}function maxImage(){this.checkProcessable("max",{bitDepth:[8,16]});let e=Image.createFrom(this[0]);e.data.fill(0);for(const i of this)for(let a=0;a<e.data.length;a++)e.data[a]=Math.max(i.data[a],e.data[a]);return e}function minImage(){this.checkProcessable("max",{bitDepth:[8,16]});let e=Image.createFrom(this[0]);e.data.fill(e.maxValue);for(const i of this)for(let a=0;a<e.data.length;a++)e.data[a]=Math.min(i.data[a],e.data[a]);return e}function extend$2(e){e.extendMethod("matchAndCrop",matchAndCrop),e.extendMethod("getMin",min$2),e.extendMethod("getMax",max$2),e.extendMethod("getMedian",median$1),e.extendMethod("getHistogram",histogram),e.extendMethod("getHistograms",histograms),e.extendMethod("getAverage",averageImage),e.extendMethod("getAverageImage",averageImage),e.extendMethod("getMaxImage",maxImage),e.extendMethod("getMinImage",minImage)}let computedPropertyDescriptor={configurable:!0,enumerable:!1,get:void 0};class Stack extends Array{constructor(i){if(Array.isArray(i)){super(i.length);for(let a=0;a<i.length;a++)this[a]=i[a]}else typeof i=="number"?super(i):super();this.computed=null}static load(i){return Promise.all(i.map(Image.load)).then(a=>new Stack(a))}static extendMethod(i,a,s={}){let{inPlace:o=!1,returnThis:h=!0,partialArgs:d=[]}=s;return o?Stack.prototype[i]=function(...g){this.computed=null;let b=a.apply(this,[...d,...g]);return h?this:b}:Stack.prototype[i]=function(...g){return a.apply(this,[...d,...g])},Stack}static extendProperty(i,a,s={}){let{partialArgs:o=[]}=s;return computedPropertyDescriptor.get=function(){if(this.computed===null)this.computed={};else if(hasOwn(i,this.computed))return this.computed[i];let h=a.apply(this,o);return this.computed[i]=h,h},Object.defineProperty(Stack.prototype,i,computedPropertyDescriptor),Stack}checkProcessable(i,a={}){if(typeof i!="string")throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(this.size===0)throw new TypeError(`The process: ${i} can not be applied on an empty stack`);this[0].checkProcessable(i,a);for(let s=1;s<this.length;s++){if((a.sameSize===void 0||a.sameSize)&&this[0].width!==this[s].width)throw new TypeError(`The process: ${i} can not be applied if width is not identical in all images`);if((a.sameSize===void 0||a.sameSize)&&this[0].height!==this[s].height)throw new TypeError(`The process: ${i} can not be applied if height is not identical in all images`);if((a.sameAlpha===void 0||a.sameAlpha)&&this[0].alpha!==this[s].alpha)throw new TypeError(`The process: ${i} can not be applied if alpha is not identical in all images`);if((a.sameBitDepth===void 0||a.sameBitDepth)&&this[0].bitDepth!==this[s].bitDepth)throw new TypeError(`The process: ${i} can not be applied if bitDepth is not identical in all images`);if((a.sameColorModel===void 0||a.sameColorModel)&&this[0].colorModel!==this[s].colorModel)throw new TypeError(`The process: ${i} can not be applied if colorModel is not identical in all images`);if((a.sameNumberChannels===void 0||a.sameNumberChannels)&&this[0].channels!==this[s].channels)throw new TypeError(`The process: ${i} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(Stack.prototype.map=function(e,i){if(typeof e!="function")throw new TypeError(`${e} is not a function`);let a=new Stack(this.length);for(let s=0;s<this.length;s++)a[s]=e.call(i,this[s],s,this);return a});extend$2(Stack);const isDataURL=/^data:[a-z]+\/(?:[a-z]+);base64,/;function load(e,i){if(typeof e=="string")return loadURL(e,i);if(e instanceof ArrayBuffer)return Promise.resolve(loadBinary(new Uint8Array(e),void 0,i&&i.ignorePalette));if(e.buffer)return Promise.resolve(loadBinary(e,void 0,i&&i.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')}function loadBinary(e,i,a){const s=imageType(e);if(s)switch(s.mime){case"image/png":return loadPNG(e);case"image/jpeg":return loadJPEG(e);case"image/tiff":return loadTIFF(e,a);default:return loadGeneric(o(s.mime))}return loadGeneric(o("application/octet-stream"));function o(h){return i||toBase64URL(e,h)}}function loadURL(e,i){const a=e.slice(0,64).match(isDataURL);let s;return a!==null?s=Promise.resolve(decode$1(e.slice(a[0].length))):s=fetchBinary(e,i),s.then(o=>{const h=new Uint8Array(o);return loadBinary(h,a?e:void 0,i&&i.ignorePalette)})}function loadPNG(e){const i=decodePng(e);let a=i.channels,s,o=0;return a===2||a===4?(s=a-1,o=1):s=a,i.palette?loadPNGFromPalette(i):new Image(i.width,i.height,i.data,{components:s,alpha:o,bitDepth:i.depth,meta:{text:i.text}})}function loadPNGFromPalette(e){const i=e.width*e.height,a=e.palette[0].length,s=new Uint8Array(i*a),o=8/e.depth,h=e.depth<8?o:1,d=parseInt("1".repeat(e.depth),2),g=a===4;let b=0;for(let _=0;_<i;_++){const $=Math.floor(_/h);let it=e.data[$];e.depth<8&&(it=it>>>e.depth*(o-1-_%o)&d);const nt=e.palette[it];s[b++]=nt[0],s[b++]=nt[1],s[b++]=nt[2],g&&(s[b++]=nt[3])}return new Image(e.width,e.height,s,{components:3,alpha:g,bitDepth:8})}function loadJPEG(e){const i=srcExports$2.decode(e);let a;i.exif&&(a=getMetadata(i.exif));const s=jpegJsExports.decode(e,{useTArray:!0,maxMemoryUsageInMB:1024});let o=new Image(s.width,s.height,s.data,{meta:a});if(a&&a.tiff.tags.Orientation){const h=a.tiff.tags.Orientation;h>2&&(o=o.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[h])),[2,4,5,7].includes(h)&&(o=o.flipX())}return o}function loadTIFF(e,i){let a=decodeTIFF(e);return a.length===1?getImageFromIFD(a[0],i):new Stack(a.map(function(s){return getImageFromIFD(s,i)}))}function getMetadata(e){const i={tiff:{fields:e.fields,tags:e.map}};return e.exif&&(i.exif=e.exif),e.gps&&(i.gps=e.gps),i}function getImageFromIFD(e,i){if(!i&&e.type===3){const a=new Uint16Array(3*e.width*e.height),s=e.palette;let o=0;for(let h=0;h<e.data.length;h++){const d=e.data[h],g=s[d];a[o++]=g[0],a[o++]=g[1],a[o++]=g[2]}return new Image(e.width,e.height,a,{components:3,alpha:e.alpha,colorModel:RGB$1,bitDepth:16,meta:getMetadata(e)})}else return new Image(e.width,e.height,e.data,{components:e.type===2?3:1,alpha:e.alpha,colorModel:e.type===2?RGB$1:GREY$1,bitDepth:e.bitsPerSample.length?e.bitsPerSample[0]:e.bitsPerSample,meta:getMetadata(e)})}function loadGeneric(e,i){return i=i||{},new Promise(function(a,s){let o=new DOMImage;o.onload=function(){let h=o.width,d=o.height,g=createCanvas(h,d).getContext("2d");g.drawImage(o,0,0,h,d);let b=g.getImageData(0,0,h,d).data;a(new Image(h,d,b,i))},o.onerror=function(){s(new Error(`Could not load ${e}`))},o.src=e})}const valueMethods={getValueXY(e,i,a){return this.data[(i*this.width+e)*this.channels+a]},setValueXY(e,i,a,s){return this.data[(i*this.width+e)*this.channels+a]=s,this.computed=null,this},getValue(e,i){return this.data[e*this.channels+i]},setValue(e,i,a){return this.data[e*this.channels+i]=a,this.computed=null,this},getPixelXY(e,i){return this.getPixel(i*this.width+e)},setPixelXY(e,i,a){return this.setPixel(i*this.width+e,a)},getPixel(e){const i=new Array(this.channels),a=e*this.channels;for(let s=0;s<this.channels;s++)i[s]=this.data[a+s];return i},setPixel(e,i){const a=e*this.channels;for(let s=0;s<i.length;s++)this.data[a+s]=i[s];return this.computed=null,this}};function setValueMethods(e){for(const i in valueMethods)e.prototype[i]=valueMethods[i]}function getImageParameters(e){return{width:e.width,height:e.height,components:e.components,alpha:e.alpha,colorModel:e.colorModel,bitDepth:e.bitDepth}}function getOutputImage(e,i,a,s={}){const{out:o}=i;if(o===void 0)return s.copy?e.clone():Image.createFrom(e,a);{if(!Image.isImage(o))throw new TypeError("out must be an Image object");const h=Object.assign(getImageParameters(e),a);for(const d in h)if(o[d]!==h[d])throw new RangeError(`cannot use out. Its ${d} must be "${h[d]}" (found "${o[d]}")`);return o}}function getOutputImageOrInPlace(e,i,a){if(i.inPlace!==void 0&&typeof i.inPlace!="boolean")throw new TypeError("inPlace option must be a boolean");if(i.inPlace){if(i.out!==void 0)throw new TypeError("out option must not be set if inPlace option is true");return e}return getOutputImage(e,i,null,a)}function abs(e={}){this.checkProcessable("abs",{bitDepth:[32]});const i=getOutputImageOrInPlace(this,e);return absolute(this,i),i}function absolute(e,i){for(let a=0;a<e.data.length;a++)i.data[a]=Math.abs(e.data[a])}function copyAlphaChannel(e,i){if(e.alpha===1&&i.alpha===1)for(let a=0;a<e.size;a++)i.data[a*i.channels+i.components]=e.data[a*e.channels+e.components]}function invert(e={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const i=getOutputImageOrInPlace(this,e);return this.bitDepth===1?invertBinary(this,i):(invertColor(this,i),this!==i&&copyAlphaChannel(this,i)),i}function invertBinary(e,i){for(let a=0;a<e.data.length;a++)i.data[a]=~e.data[a]}function invertColor(e,i){for(let a=0;a<e.data.length;a+=e.channels)for(let s=0;s<e.components;s++)i.data[a+s]=e.maxValue-e.data[a+s]}function flipX(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let e=0;e<this.height;e++){let i=e*this.width*this.channels;for(let a=0;a<Math.floor(this.width/2);a++){let s=a*this.channels+i,o=(this.width-a-1)*this.channels+i;for(let h=0;h<this.channels;h++){let d=this.data[s+h];this.data[s+h]=this.data[o+h],this.data[o+h]=d}}}return this}function flipY(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let e=0;e<Math.floor(this.height/2);e++)for(let i=0;i<this.width;i++){let a=i*this.channels+e*this.width*this.channels,s=i*this.channels+(this.height-1-e)*this.channels*this.width;for(let o=0;o<this.channels;o++){let h=this.data[a+o];this.data[a+o]=this.data[s+o],this.data[s+o]=h}}return this}function blurFilter(e={}){const{radius:i=1}=e;if(i<1)throw new Error("radius must be greater than 1");const a=2*i+1,s=new Array(a);for(let o=0;o<a;o++){s[o]=new Array(a);for(let h=0;h<a;h++)s[o][h]=1/(a*a)}return this.convolution(s)}var medianQuickselect_min={exports:{}},hasRequiredMedianQuickselect_min;function requireMedianQuickselect_min(){return hasRequiredMedianQuickselect_min||(hasRequiredMedianQuickselect_min=1,function(e){(function(){function i(o){for(var h=0,d=o.length-1,g=void 0,b=void 0,_=void 0,$=s(h,d);;){if(d<=h)return o[$];if(d==h+1)return o[h]>o[d]&&a(o,h,d),o[$];for(g=s(h,d),o[g]>o[d]&&a(o,g,d),o[h]>o[d]&&a(o,h,d),o[g]>o[h]&&a(o,g,h),a(o,g,h+1),b=h+1,_=d;;){do b++;while(o[h]>o[b]);do _--;while(o[_]>o[h]);if(_<b)break;a(o,b,_)}a(o,h,_),_<=$&&(h=b),_>=$&&(d=_-1)}}var a=function(o,h,d){var g;return g=[o[d],o[h]],o[h]=g[0],o[d]=g[1],g},s=function(o,h){return~~((o+h)/2)};e.exports?e.exports=i:window.median=i})()}(medianQuickselect_min)),medianQuickselect_min.exports}var medianQuickselect_minExports=requireMedianQuickselect_min();const quickSelectMedian=getDefaultExportFromCjs(medianQuickselect_minExports);function validateArrayOfChannels(e,i={}){let{channels:a,allowAlpha:s,defaultAlpha:o}=i;return typeof s!="boolean"&&(s=!0),typeof a>"u"?allChannels(e,o):validateChannels(e,a,s)}function allChannels(e,i){let a=i?e.channels:e.components,s=new Array(a);for(let o=0;o<a;o++)s[o]=o;return s}function validateChannels(e,i,a){Array.isArray(i)||(i=[i]);for(let s=0;s<i.length;s++)i[s]=validateChannel(e,i[s],a);return i}function validateChannel(e,i,a=!0){if(i===void 0)throw new RangeError(`validateChannel : the channel has to be >=0 and <${e.channels}`);if(typeof i=="string"){switch(e.colorModel){case GREY$1:break;case RGB$1:if("rgb".includes(i))switch(i){case"r":i=0;break;case"g":i=1;break;case"b":i=2;break}break;case HSL:if("hsl".includes(i))switch(i){case"h":i=0;break;case"s":i=1;break;case"l":i=2;break}break;case HSV:if("hsv".includes(i))switch(i){case"h":i=0;break;case"s":i=1;break;case"v":i=2;break}break;case CMYK$1:if("cmyk".includes(i))switch(i){case"c":i=0;break;case"m":i=1;break;case"y":i=2;break;case"k":i=3;break}break;default:throw new Error(`Unexpected color model: ${e.colorModel}`)}if(i==="a"){if(!e.alpha)throw new Error("validateChannel : the image does not contain alpha channel");i=e.components}if(typeof i=="string")throw new Error(`validateChannel : undefined channel: ${i}`)}if(i>=e.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${e.channels}`);if(!a&&i>=e.components)throw new RangeError("validateChannel : alpha channel may not be selected");return i}function medianFilter(e={}){let{radius:i=1,border:a="copy",channels:s}=e;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),i<1)throw new Error("radius must be greater than 0");s=validateArrayOfChannels(this,s);let o=i,h=i,d=Image.createFrom(this),g=(o*2+1)*(h*2+1),b=new Array(g);for(let _=0;_<s.length;_++){let $=s[_];for(let it=h;it<this.height-h;it++)for(let nt=o;nt<this.width-o;nt++){let tt=0;for(let ut=-h;ut<=h;ut++)for(let ft=-o;ft<=o;ft++){let ht=((it+ut)*this.width+nt+ft)*this.channels+$;b[tt++]=this.data[ht]}let at=(it*this.width+nt)*this.channels+$;d.data[at]=quickSelectMedian(b)}}if(this.alpha&&!s.includes(this.channels))for(let _=this.components;_<this.data.length;_=_+this.channels)d.data[_]=this.data[_];return d.setBorder({size:[o,h],algorithm:a}),d}function gaussianFilter(e={}){let{radius:i=1,sigma:a,channels:s,border:o="copy"}=e;this.checkProcessable("gaussian",{bitDepth:[8,16]});const h=getKernel(i,a);return this.convolution([h,h],{border:o,channels:s,algorithm:"separable"})}function getKernel(e,i){const a=e*2+1,s=new Array(a),o=i||((a-1)*.5-1)*.3+.8,h=-.5/(o*o);let d=0;for(let g=0;g<a;g++){const b=g-e,_=Math.exp(h*b*b);s[g]=_,d+=_}for(let g=0;g<a;g++)s[g]/=d;return s}const SOBEL_X=[[-1,0,1],[-2,0,2],[-1,0,1]],SOBEL_Y=[[-1,-2,-1],[0,0,0],[1,2,1]],SCHARR_X=[[3,0,-3],[10,0,-10],[3,0,-3]],SCHARR_Y=[[3,10,3],[0,0,0],[-3,-10,-3]];var src$2={},fftlib={},hasRequiredFftlib;function requireFftlib(){return hasRequiredFftlib||(hasRequiredFftlib=1,function(e){(function(){var i;i=e;var a={release:"0.3.0",date:"2013-03"};i.toString=function(){return"version "+a.release+", released "+a.date};for(var s=0,o=null,h=null,d={init:function(_){if(_!==0&&!(_&_-1))s=_,d._initArray(),d._makeBitReversalTable(),d._makeCosSinTable();else throw new Error("init: radix-2 required")},fft1d:function(_,$){d.fft(_,$,1)},ifft1d:function(_,$){var it=1/s;d.fft(_,$,-1);for(var nt=0;nt<s;nt++)_[nt]*=it,$[nt]*=it},bt1d:function(_,$){d.fft(_,$,-1)},fft2d:function(_,$){for(var it=[],nt=[],tt=0,at=0;at<s;at++){tt=at*s;for(var ut=0;ut<s;ut++)it[ut]=_[ut+tt],nt[ut]=$[ut+tt];d.fft1d(it,nt);for(var ft=0;ft<s;ft++)_[ft+tt]=it[ft],$[ft+tt]=nt[ft]}for(var ht=0;ht<s;ht++){for(var dt=0;dt<s;dt++)tt=ht+dt*s,it[dt]=_[tt],nt[dt]=$[tt];d.fft1d(it,nt);for(var st=0;st<s;st++)tt=ht+st*s,_[tt]=it[st],$[tt]=nt[st]}},ifft2d:function(_,$){for(var it=[],nt=[],tt=0,at=0;at<s;at++){tt=at*s;for(var ut=0;ut<s;ut++)it[ut]=_[ut+tt],nt[ut]=$[ut+tt];d.ifft1d(it,nt);for(var ft=0;ft<s;ft++)_[ft+tt]=it[ft],$[ft+tt]=nt[ft]}for(var ht=0;ht<s;ht++){for(var dt=0;dt<s;dt++)tt=ht+dt*s,it[dt]=_[tt],nt[dt]=$[tt];d.ifft1d(it,nt);for(var st=0;st<s;st++)tt=ht+st*s,_[tt]=it[st],$[tt]=nt[st]}},fft:function(_,$,it){for(var nt,tt,at,ut,ft,ht,dt,st,ct,wt=s>>2,_t=0;_t<s;_t++)ut=o[_t],_t<ut&&(ft=_[_t],_[_t]=_[ut],_[ut]=ft,ft=$[_t],$[_t]=$[ut],$[ut]=ft);for(var gt=1;gt<s;gt<<=1){tt=0,nt=s/(gt<<1);for(var yt=0;yt<gt;yt++){ht=h[tt+wt],dt=it*h[tt];for(var bt=yt;bt<s;bt+=gt<<1)at=bt+gt,st=ht*_[at]+dt*$[at],ct=ht*$[at]-dt*_[at],_[at]=_[bt]-st,_[bt]+=st,$[at]=$[bt]-ct,$[bt]+=ct;tt+=nt}}},_initArray:function(){typeof Uint32Array<"u"?o=new Uint32Array(s):o=[],typeof Float64Array<"u"?h=new Float64Array(s*1.25):h=[]},_paddingZero:function(){},_makeBitReversalTable:function(){var _=0,$=0,it=0;for(o[0]=0;++_<s;){for(it=s>>1;it<=$;)$-=it,it>>=1;$+=it,o[_]=$}},_makeCosSinTable:function(){var _=s>>1,$=s>>2,it=s>>3,nt=_+$,tt=Math.sin(Math.PI/s),at=2*tt*tt,ut=Math.sqrt(at*(2-at)),ft=h[$]=1,ht=h[0]=0;tt=2*at;for(var dt=1;dt<it;dt++)ft-=at,at+=tt*ft,ht+=ut,ut-=tt*ht,h[dt]=ht,h[$-dt]=ft;it!==0&&(h[it]=Math.sqrt(.5));for(var st=0;st<$;st++)h[_-st]=h[st];for(var ct=0;ct<nt;ct++)h[ct+_]=-h[ct]}},g=["init","fft1d","ifft1d","fft2d","ifft2d"],b=0;b<g.length;b++)i[g[b]]=d[g[b]];return i.bt=d.bt1d,i.fft=d.fft1d,i.ifft=d.ifft1d,i}).call(fftlib)}(fftlib)),fftlib}var FFTUtils_1,hasRequiredFFTUtils;function requireFFTUtils(){if(hasRequiredFFTUtils)return FFTUtils_1;hasRequiredFFTUtils=1;var e=requireFftlib(),i={DEBUG:!1,ifft2DArray:function(a,s,o){var h=new Array(s*o),d=s/2,g=(o-1)*2;e.init(d);for(var b={re:new Array(d),im:new Array(d)},_=0;_<o;_++){for(var $=d-1;$>=0;$--)b.re[$]=a[$*2*o+_],b.im[$]=a[($*2+1)*o+_];e.bt(b.re,b.im);for(var $=d-1;$>=0;$--)h[$*2*o+_]=b.re[$],h[($*2+1)*o+_]=b.im[$]}var it=new Array(d*g);e.init(g);for(var nt={re:new Array(g),im:new Array(g)},tt=g*d,$=0;$<s;$+=2){nt.re[0]=h[$*o],nt.im[0]=h[($+1)*o];for(var _=1;_<o;_++)nt.re[_]=h[$*o+_],nt.im[_]=h[($+1)*o+_],nt.re[g-_]=h[$*o+_],nt.im[g-_]=-h[($+1)*o+_];e.bt(nt.re,nt.im);for(var at=$/2*g,_=g-1;_>=0;_--)it[at+_]=nt.re[_]/tt}return it},fft2DArray:function(a,s,o,h){Object.assign({},{inplace:!0});var d=o/2+1,g=s*2,b=new Array(g*d);e.init(o);for(var _={re:new Array(o),im:new Array(o)},$={re:new Array(o),im:new Array(o)},it={re:new Array(o),im:new Array(o)},nt,tt,at,ut,ft,ht=0;ht<s/2;ht++){nt=ht*2*o,_.re=a.slice(nt,nt+o),nt=(ht*2+1)*o,_.im=a.slice(nt,nt+o),e.fft1d(_.re,_.im),this.reconstructTwoRealFFT(_,$,it),tt=ht*4*d,at=(ht*4+1)*d,ut=(ht*4+2)*d,ft=(ht*4+3)*d;for(var dt=d-1;dt>=0;dt--)b[tt+dt]=$.re[dt],b[at+dt]=$.im[dt],b[ut+dt]=it.re[dt],b[ft+dt]=it.im[dt]}$=null,it=null;var st=new Array(g*d);e.init(s);for(var ct={re:new Array(s),im:new Array(s)},wt=d-1;wt>=0;wt--){for(var ht=s-1;ht>=0;ht--)ct.re[ht]=b[ht*2*d+wt],ct.im[ht]=b[(ht*2+1)*d+wt],isNaN(ct.re[ht])&&(ct.re[ht]=0),isNaN(ct.im[ht])&&(ct.im[ht]=0);e.fft1d(ct.re,ct.im);for(var ht=s-1;ht>=0;ht--)st[ht*2*d+wt]=ct.re[ht],st[(ht*2+1)*d+wt]=ct.im[ht]}return st},reconstructTwoRealFFT:function(a,s,o){var h=a.re.length;s.re[0]=a.re[0],s.im[0]=0,o.re[0]=a.im[0],o.im[0]=0;for(var d,g,b,_,$,it=h/2;it>0;it--)$=h-it,d=.5*(a.re[it]-a.re[$]),g=.5*(a.re[it]+a.re[$]),b=.5*(a.im[it]-a.im[$]),_=.5*(a.im[it]+a.im[$]),s.re[it]=g,s.im[it]=b,s.re[$]=g,s.im[$]=-b,o.re[it]=_,o.im[it]=-d,o.re[$]=_,o.im[$]=d},convolute2DI:function(a,s,o,h){for(var d,g,b=0;b<o/2;b++)for(var _=0;_<h;_++)d=a[b*2*h+_]*s[b*2*h+_]-a[(b*2+1)*h+_]*s[(b*2+1)*h+_],g=a[b*2*h+_]*s[(b*2+1)*h+_]+a[(b*2+1)*h+_]*s[b*2*h+_],a[b*2*h+_]=d,a[(b*2+1)*h+_]=g},convolute:function(a,s,o,h,d){for(var g=new Array(h*o),b=0;b<o*h;b++)g[b]=a[b];g=this.fft2DArray(g,o,h);for(var _=s.length,$=s[0].length,it=new Array(h*o),b=0;b<h*o;b++)it[b]=0;for(var nt,tt,at=Math.floor((_-1)/2),ut=Math.floor(($-1)/2),ft=0;ft<_;ft++){nt=(ft-at+o)%o;for(var ht=0;ht<$;ht++)tt=(ht-ut+h)%h,it[nt*h+tt]=s[ft][ht]}it=this.fft2DArray(it,o,h);var dt=o*2,st=h/2+1;return this.convolute2DI(g,it,dt,st),this.ifft2DArray(g,dt,st)},toRadix2:function(a,s,o){var h,d,g,b,_=o,$=s;if(!(o!==0&&!(o&o-1))){for(_=0;o>>++_;);_=1<<_}if(!(s!==0&&!(s&s-1))){for($=0;s>>++$;);$=1<<$}if($==s&&_==o)return{data:a,rows:s,cols:o};var it=new Array($*_),nt=Math.floor(($-s)/2)-s,tt=Math.floor((_-o)/2)-o;for(h=0;h<$;h++)for(g=h*_,b=(h-nt)%s*o,d=0;d<_;d++)it[g+d]=a[b+(d-tt)%o];return{data:it,rows:$,cols:_}},crop:function(a,s,o,h,d,g){if(s==h&&o==d)return a;Object.assign({},g);var b=new Array(d*h),_=Math.floor((s-h)/2),$=Math.floor((o-d)/2),it,nt,tt,at;for(tt=0;tt<h;tt++)for(it=tt*d,nt=(tt+_)*o,at=0;at<d;at++)b[it+at]=a[nt+(at+$)];return b}};return FFTUtils_1=i,FFTUtils_1}var hasRequiredSrc$2;function requireSrc$2(){return hasRequiredSrc$2||(hasRequiredSrc$2=1,src$2.FFTUtils=requireFFTUtils(),src$2.FFT=requireFftlib()),src$2}var src$1,hasRequiredSrc$1;function requireSrc$1(){if(hasRequiredSrc$1)return src$1;hasRequiredSrc$1=1;var e=requireSrc$2().FFTUtils;function i(h,d,g){var b=o(h),_=b.data,$=Object.assign({normalize:!1,divisor:1,rows:b.rows,cols:b.cols},g),it,nt;if($.rows&&$.cols)it=$.rows,nt=$.cols;else throw new Error("Invalid number of rows or columns "+it+" "+nt);var tt=$.divisor,at,ut,ft=d.length,ht=d[0].length;if($.normalize)for(tt=0,at=0;at<ft;at++)for(ut=0;ut<ht;ut++)tt+=d[at][ut];if(tt===0)throw new RangeError("convolution: The divisor is equal to zero");var dt=e.toRadix2(_,it,nt),st=e.convolute(dt.data,d,dt.rows,dt.cols);if(st=e.crop(st,dt.rows,dt.cols,it,nt),tt!=0&&tt!=1)for(at=0;at<st.length;at++)st[at]/=tt;return st}function a(h,d,g){var b=o(h),_=b.data,$=Object.assign({normalize:!1,divisor:1,rows:b.rows,cols:b.cols},g),it,nt;if($.rows&&$.cols)it=$.rows,nt=$.cols;else throw new Error("Invalid number of rows or columns "+it+" "+nt);var tt=$.divisor,at=d.length,ut=d[0].length,ft,ht,dt,st,ct,wt,_t,gt,yt;if($.normalize)for(tt=0,ft=0;ft<at;ft++)for(ht=0;ht<ut;ht++)tt+=d[ft][ht];if(tt===0)throw new RangeError("convolution: The divisor is equal to zero");var bt=new Array(it*nt),vt=Math.floor(at/2),Ct=Math.floor(ut/2);for(st=0;st<it;st++)for(dt=0;dt<nt;dt++){for(wt=0,ht=0;ht<at;ht++)for(ft=0;ft<ut;ft++)_t=d[at-ht-1][ut-ft-1],gt=(st+ht-vt+it)%it,yt=(dt+ft-Ct+nt)%nt,ct=gt*nt+yt,wt+=_[ct]*_t;ct=st*nt+dt,bt[ct]=wt/tt}return bt}function s(h,d,g){var b=1e3;g&&g.factor&&(b=g.factor);var _=new Array(d),$,it,nt,tt;b*=-1;var at=(d-1)/2,ut=2*h*h;for($=0;$<d;$++)for(_[$]=new Array(d),tt=($-at)*($-at),it=0;it<d;it++)nt=-((it-at)*(it-at)+tt)/ut,_[$][it]=Math.round(b*(1+nt)*Math.exp(nt));return _}function o(h){var d=h,g,b;if(typeof h[0]!="number"){g=h.length,b=h[0].length,d=new Array(g*b);for(var _=0;_<g;_++)for(var $=0;$<b;$++)d[_*b+$]=h[_][$]}else{var it=Math.sqrt(h.length);Number.isInteger(it)&&(g=it,b=it)}return{data:d,rows:g,cols:b}}return src$1={fft:i,direct:a,kernelFactory:{LoG:s},matrix2Array:o},src$1}var srcExports$1=requireSrc$1(),_isFinite,hasRequired_isFinite;function require_isFinite(){return hasRequired_isFinite||(hasRequired_isFinite=1,_isFinite=Number.isFinite||function(e){return!(typeof e!="number"||e!==e||e===1/0||e===-1/0)}),_isFinite}var isInteger$1,hasRequiredIsInteger;function requireIsInteger(){if(hasRequiredIsInteger)return isInteger$1;hasRequiredIsInteger=1;var e=require_isFinite();return isInteger$1=Number.isInteger||function(i){return typeof i=="number"&&e(i)&&Math.floor(i)===i},isInteger$1}var isIntegerExports=requireIsInteger();const isInteger=getDefaultExportFromCjs(isIntegerExports);function validateKernel(e){let i,a;if(Array.isArray(e))if(Array.isArray(e[0])){if(!(e.length&1)||!(e[0].length&1))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");i=Math.floor(e.length/2),a=Math.floor(e[0].length/2)}else{let s=Math.sqrt(e.length);if(isInteger(s))a=i=Math.floor(Math.sqrt(e.length)/2);else throw new RangeError("validateKernel: Kernel array should be a square");let o=new Array(s);for(let h=0;h<s;h++){o[h]=new Array(s);for(let d=0;d<s;d++)o[h][d]=e[h*s+d]}e=o}else throw new Error(`validateKernel: Invalid Kernel: ${e}`);return{kernel:e,kWidth:a,kHeight:i}}function clamp(e,i){return Math.round(Math.min(Math.max(e,0),i.maxValue))}function directConvolution(e,i,a){if(a===void 0){const h=e.length+i.length-1;a=new Array(h)}fill(a);for(var s=0;s<e.length;s++)for(var o=0;o<i.length;o++)a[s+o]+=e[s]*i[o];return a}function fill(e){for(var i=0;i<e.length;i++)e[i]=0}var fft,hasRequiredFft;function requireFft(){if(hasRequiredFft)return fft;hasRequiredFft=1;function e(i){if(this.size=i|0,this.size<=1||(this.size&this.size-1)!==0)throw new Error("FFT size must be a power of two and bigger than 1");this._csize=i<<1;for(var a=new Array(this.size*2),s=0;s<a.length;s+=2){const _=Math.PI*s/this.size;a[s]=Math.cos(_),a[s+1]=-Math.sin(_)}this.table=a;for(var o=0,h=1;this.size>h;h<<=1)o++;this._width=o%2===0?o-1:o,this._bitrev=new Array(1<<this._width);for(var d=0;d<this._bitrev.length;d++){this._bitrev[d]=0;for(var g=0;g<this._width;g+=2){var b=this._width-g-2;this._bitrev[d]|=(d>>>g&3)<<b}}this._out=null,this._data=null,this._inv=0}return fft=e,e.prototype.fromComplexArray=function(i,a){for(var s=a||new Array(i.length>>>1),o=0;o<i.length;o+=2)s[o>>>1]=i[o];return s},e.prototype.createComplexArray=function(){const i=new Array(this._csize);for(var a=0;a<i.length;a++)i[a]=0;return i},e.prototype.toComplexArray=function(i,a){for(var s=a||this.createComplexArray(),o=0;o<s.length;o+=2)s[o]=i[o>>>1],s[o+1]=0;return s},e.prototype.completeSpectrum=function(i){for(var a=this._csize,s=a>>>1,o=2;o<s;o+=2)i[a-o]=i[o],i[a-o+1]=-i[o+1]},e.prototype.transform=function(i,a){if(i===a)throw new Error("Input and output buffers must be different");this._out=i,this._data=a,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(i,a){if(i===a)throw new Error("Input and output buffers must be different");this._out=i,this._data=a,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(i,a){if(i===a)throw new Error("Input and output buffers must be different");this._out=i,this._data=a,this._inv=1,this._transform4();for(var s=0;s<i.length;s++)i[s]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var i=this._out,a=this._csize,s=this._width,o=1<<s,h=a/o<<1,d,g,b=this._bitrev;if(h===4)for(d=0,g=0;d<a;d+=h,g++){const ut=b[g];this._singleTransform2(d,ut,o)}else for(d=0,g=0;d<a;d+=h,g++){const ut=b[g];this._singleTransform4(d,ut,o)}var _=this._inv?-1:1,$=this.table;for(o>>=2;o>=2;o>>=2){h=a/o<<1;var it=h>>>2;for(d=0;d<a;d+=h)for(var nt=d+it,tt=d,at=0;tt<nt;tt+=2,at+=o){const ut=tt,ft=ut+it,ht=ft+it,dt=ht+it,st=i[ut],ct=i[ut+1],wt=i[ft],_t=i[ft+1],gt=i[ht],yt=i[ht+1],bt=i[dt],vt=i[dt+1],Ct=st,Ht=ct,Ft=$[at],qt=_*$[at+1],zt=wt*Ft-_t*qt,Qt=wt*qt+_t*Ft,_e=$[2*at],Gt=_*$[2*at+1],Jt=gt*_e-yt*Gt,or=gt*Gt+yt*_e,mr=$[3*at],hr=_*$[3*at+1],Lr=bt*mr-vt*hr,Er=bt*hr+vt*mr,Kt=Ct+Jt,fr=Ht+or,Rr=Ct-Jt,gr=Ht-or,ir=zt+Lr,Vr=Qt+Er,Ur=_*(zt-Lr),Fr=_*(Qt-Er),Sr=Kt+ir,vr=fr+Vr,Qr=Kt-ir,Or=fr-Vr,Cr=Rr+Fr,Hr=gr-Ur,nr=Rr-Fr,Dr=gr+Ur;i[ut]=Sr,i[ut+1]=vr,i[ft]=Cr,i[ft+1]=Hr,i[ht]=Qr,i[ht+1]=Or,i[dt]=nr,i[dt+1]=Dr}}},e.prototype._singleTransform2=function(i,a,s){const o=this._out,h=this._data,d=h[a],g=h[a+1],b=h[a+s],_=h[a+s+1],$=d+b,it=g+_,nt=d-b,tt=g-_;o[i]=$,o[i+1]=it,o[i+2]=nt,o[i+3]=tt},e.prototype._singleTransform4=function(i,a,s){const o=this._out,h=this._data,d=this._inv?-1:1,g=s*2,b=s*3,_=h[a],$=h[a+1],it=h[a+s],nt=h[a+s+1],tt=h[a+g],at=h[a+g+1],ut=h[a+b],ft=h[a+b+1],ht=_+tt,dt=$+at,st=_-tt,ct=$-at,wt=it+ut,_t=nt+ft,gt=d*(it-ut),yt=d*(nt-ft),bt=ht+wt,vt=dt+_t,Ct=st+yt,Ht=ct-gt,Ft=ht-wt,qt=dt-_t,zt=st-yt,Qt=ct+gt;o[i]=bt,o[i+1]=vt,o[i+2]=Ct,o[i+3]=Ht,o[i+4]=Ft,o[i+5]=qt,o[i+6]=zt,o[i+7]=Qt},e.prototype._realTransform4=function(){var i=this._out,a=this._csize,s=this._width,o=1<<s,h=a/o<<1,d,g,b=this._bitrev;if(h===4)for(d=0,g=0;d<a;d+=h,g++){const yr=b[g];this._singleRealTransform2(d,yr>>>1,o>>>1)}else for(d=0,g=0;d<a;d+=h,g++){const yr=b[g];this._singleRealTransform4(d,yr>>>1,o>>>1)}var _=this._inv?-1:1,$=this.table;for(o>>=2;o>=2;o>>=2){h=a/o<<1;var it=h>>>1,nt=it>>>1,tt=nt>>>1;for(d=0;d<a;d+=h)for(var at=0,ut=0;at<=tt;at+=2,ut+=o){var ft=d+at,ht=ft+nt,dt=ht+nt,st=dt+nt,ct=i[ft],wt=i[ft+1],_t=i[ht],gt=i[ht+1],yt=i[dt],bt=i[dt+1],vt=i[st],Ct=i[st+1],Ht=ct,Ft=wt,qt=$[ut],zt=_*$[ut+1],Qt=_t*qt-gt*zt,_e=_t*zt+gt*qt,Gt=$[2*ut],Jt=_*$[2*ut+1],or=yt*Gt-bt*Jt,mr=yt*Jt+bt*Gt,hr=$[3*ut],Lr=_*$[3*ut+1],Er=vt*hr-Ct*Lr,Kt=vt*Lr+Ct*hr,fr=Ht+or,Rr=Ft+mr,gr=Ht-or,ir=Ft-mr,Vr=Qt+Er,Ur=_e+Kt,Fr=_*(Qt-Er),Sr=_*(_e-Kt),vr=fr+Vr,Qr=Rr+Ur,Or=gr+Sr,Cr=ir-Fr;if(i[ft]=vr,i[ft+1]=Qr,i[ht]=Or,i[ht+1]=Cr,at===0){var Hr=fr-Vr,nr=Rr-Ur;i[dt]=Hr,i[dt+1]=nr;continue}if(at!==tt){var Dr=gr,qr=-ir,Nr=fr,_r=-Rr,jr=-_*Sr,Ar=-_*Fr,$r=-_*Ur,Tr=-_*Vr,Gr=Dr+jr,xr=qr+Ar,Br=Nr+Tr,At=_r-$r,ur=d+nt-at,cr=d+it-at;i[ur]=Gr,i[ur+1]=xr,i[cr]=Br,i[cr+1]=At}}}},e.prototype._singleRealTransform2=function(i,a,s){const o=this._out,h=this._data,d=h[a],g=h[a+s],b=d+g,_=d-g;o[i]=b,o[i+1]=0,o[i+2]=_,o[i+3]=0},e.prototype._singleRealTransform4=function(i,a,s){const o=this._out,h=this._data,d=this._inv?-1:1,g=s*2,b=s*3,_=h[a],$=h[a+s],it=h[a+g],nt=h[a+b],tt=_+it,at=_-it,ut=$+nt,ft=d*($-nt),ht=tt+ut,dt=at,st=-ft,ct=tt-ut,wt=at,_t=ft;o[i]=ht,o[i+1]=0,o[i+2]=dt,o[i+3]=st,o[i+4]=ct,o[i+5]=0,o[i+6]=wt,o[i+7]=_t},fft}requireFft();function convolutionSeparable(e,i,a,s){const o=new Array(e.length);let h,d,g,b;b=i[1],g=(b.length-1)/2,d=new Array(a+b.length-1),h=new Array(a);for(let _=0;_<s;_++){for(let $=0;$<a;$++)h[$]=e[_*a+$];directConvolution(h,b,d);for(let $=0;$<a;$++)o[_*a+$]=d[g+$]}b=i[0],g=(b.length-1)/2,d=new Array(s+b.length-1),h=new Array(s);for(let _=0;_<a;_++){for(let $=0;$<s;$++)h[$]=o[$*a+_];directConvolution(h,b,d);for(let $=0;$<s;$++)o[$*a+_]=d[g+$]}return o}var matrix$1={};const toString=Object.prototype.toString;function isAnyArray(e){const i=toString.call(e);return i.endsWith("Array]")&&!i.includes("Big")}const libEsm=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(libEsm);function max$1(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!isAnyArray(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var a=i.fromIndex,s=a===void 0?0:a,o=i.toIndex,h=o===void 0?e.length:o;if(s<0||s>=e.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(h<=s||h>e.length||!Number.isInteger(h))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var d=e[s],g=s+1;g<h;g++)e[g]>d&&(d=e[g]);return d}function min$1(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!isAnyArray(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var a=i.fromIndex,s=a===void 0?0:a,o=i.toIndex,h=o===void 0?e.length:o;if(s<0||s>=e.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(h<=s||h>e.length||!Number.isInteger(h))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var d=e[s],g=s+1;g<h;g++)e[g]<d&&(d=e[g]);return d}function rescale(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(isAnyArray(e)){if(e.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var a;if(i.output!==void 0){if(!isAnyArray(i.output))throw new TypeError("output option must be an array if specified");a=i.output}else a=new Array(e.length);var s=min$1(e),o=max$1(e);if(s===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=i.min,d=h===void 0?i.autoMinMax?s:0:h,g=i.max,b=g===void 0?i.autoMinMax?o:1:g;if(d>=b)throw new RangeError("min option must be smaller than max option");for(var _=(b-d)/(o-s),$=0;$<e.length;$++)a[$]=(e[$]-s)*_+d;return a}const libEs6=Object.freeze(Object.defineProperty({__proto__:null,default:rescale},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(libEs6);var hasRequiredMatrix;function requireMatrix(){var e,i,a;if(hasRequiredMatrix)return matrix$1;hasRequiredMatrix=1,Object.defineProperty(matrix$1,"__esModule",{value:!0});var s=require$$0$1,o=require$$1;const h=" ".repeat(2),d=" ".repeat(4);function g(){return b(this)}function b(lt,et={}){const{maxRows:j=15,maxColumns:rt=10,maxNumSize:ot=8,padMinus:pt="auto"}=et;return`${lt.constructor.name} {
${h}[
${d}${_(lt,j,rt,ot,pt)}
${h}]
${h}rows: ${lt.rows}
${h}columns: ${lt.columns}
}`}function _(lt,et,j,rt,ot){const{rows:pt,columns:kt}=lt,Et=Math.min(pt,et),Pt=Math.min(kt,j),Nt=[];if(ot==="auto"){ot=!1;t:for(let Xt=0;Xt<Et;Xt++)for(let Lt=0;Lt<Pt;Lt++)if(lt.get(Xt,Lt)<0){ot=!0;break t}}for(let Xt=0;Xt<Et;Xt++){let Lt=[];for(let rr=0;rr<Pt;rr++)Lt.push($(lt.get(Xt,rr),rt,ot));Nt.push(`${Lt.join(" ")}`)}return Pt!==kt&&(Nt[Nt.length-1]+=` ... ${kt-j} more columns`),Et!==pt&&Nt.push(`... ${pt-et} more rows`),Nt.join(`
${d}`)}function $(lt,et,j){return(lt>=0&&j?` ${it(lt,et-1)}`:it(lt,et)).padEnd(et)}function it(lt,et){let j=lt.toString();if(j.length<=et)return j;let rt=lt.toFixed(et);if(rt.length>et&&(rt=lt.toFixed(Math.max(0,et-(rt.length-et)))),rt.length<=et&&!rt.startsWith("0.000")&&!rt.startsWith("-0.000"))return rt;let ot=lt.toExponential(et);return ot.length>et&&(ot=lt.toExponential(Math.max(0,et-(ot.length-et)))),ot.slice(0)}function nt(lt,et){lt.prototype.add=function(j){return typeof j=="number"?this.addS(j):this.addM(j)},lt.prototype.addS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)+j);return this},lt.prototype.addM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)+j.get(rt,ot));return this},lt.add=function(j,rt){return new et(j).add(rt)},lt.prototype.sub=function(j){return typeof j=="number"?this.subS(j):this.subM(j)},lt.prototype.subS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)-j);return this},lt.prototype.subM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)-j.get(rt,ot));return this},lt.sub=function(j,rt){return new et(j).sub(rt)},lt.prototype.subtract=lt.prototype.sub,lt.prototype.subtractS=lt.prototype.subS,lt.prototype.subtractM=lt.prototype.subM,lt.subtract=lt.sub,lt.prototype.mul=function(j){return typeof j=="number"?this.mulS(j):this.mulM(j)},lt.prototype.mulS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)*j);return this},lt.prototype.mulM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)*j.get(rt,ot));return this},lt.mul=function(j,rt){return new et(j).mul(rt)},lt.prototype.multiply=lt.prototype.mul,lt.prototype.multiplyS=lt.prototype.mulS,lt.prototype.multiplyM=lt.prototype.mulM,lt.multiply=lt.mul,lt.prototype.div=function(j){return typeof j=="number"?this.divS(j):this.divM(j)},lt.prototype.divS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)/j);return this},lt.prototype.divM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)/j.get(rt,ot));return this},lt.div=function(j,rt){return new et(j).div(rt)},lt.prototype.divide=lt.prototype.div,lt.prototype.divideS=lt.prototype.divS,lt.prototype.divideM=lt.prototype.divM,lt.divide=lt.div,lt.prototype.mod=function(j){return typeof j=="number"?this.modS(j):this.modM(j)},lt.prototype.modS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)%j);return this},lt.prototype.modM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)%j.get(rt,ot));return this},lt.mod=function(j,rt){return new et(j).mod(rt)},lt.prototype.modulus=lt.prototype.mod,lt.prototype.modulusS=lt.prototype.modS,lt.prototype.modulusM=lt.prototype.modM,lt.modulus=lt.mod,lt.prototype.and=function(j){return typeof j=="number"?this.andS(j):this.andM(j)},lt.prototype.andS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)&j);return this},lt.prototype.andM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)&j.get(rt,ot));return this},lt.and=function(j,rt){return new et(j).and(rt)},lt.prototype.or=function(j){return typeof j=="number"?this.orS(j):this.orM(j)},lt.prototype.orS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)|j);return this},lt.prototype.orM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)|j.get(rt,ot));return this},lt.or=function(j,rt){return new et(j).or(rt)},lt.prototype.xor=function(j){return typeof j=="number"?this.xorS(j):this.xorM(j)},lt.prototype.xorS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)^j);return this},lt.prototype.xorM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)^j.get(rt,ot));return this},lt.xor=function(j,rt){return new et(j).xor(rt)},lt.prototype.leftShift=function(j){return typeof j=="number"?this.leftShiftS(j):this.leftShiftM(j)},lt.prototype.leftShiftS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)<<j);return this},lt.prototype.leftShiftM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)<<j.get(rt,ot));return this},lt.leftShift=function(j,rt){return new et(j).leftShift(rt)},lt.prototype.signPropagatingRightShift=function(j){return typeof j=="number"?this.signPropagatingRightShiftS(j):this.signPropagatingRightShiftM(j)},lt.prototype.signPropagatingRightShiftS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)>>j);return this},lt.prototype.signPropagatingRightShiftM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)>>j.get(rt,ot));return this},lt.signPropagatingRightShift=function(j,rt){return new et(j).signPropagatingRightShift(rt)},lt.prototype.rightShift=function(j){return typeof j=="number"?this.rightShiftS(j):this.rightShiftM(j)},lt.prototype.rightShiftS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)>>>j);return this},lt.prototype.rightShiftM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)>>>j.get(rt,ot));return this},lt.rightShift=function(j,rt){return new et(j).rightShift(rt)},lt.prototype.zeroFillRightShift=lt.prototype.rightShift,lt.prototype.zeroFillRightShiftS=lt.prototype.rightShiftS,lt.prototype.zeroFillRightShiftM=lt.prototype.rightShiftM,lt.zeroFillRightShift=lt.rightShift,lt.prototype.not=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,~this.get(j,rt));return this},lt.not=function(j){return new et(j).not()},lt.prototype.abs=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.abs(this.get(j,rt)));return this},lt.abs=function(j){return new et(j).abs()},lt.prototype.acos=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.acos(this.get(j,rt)));return this},lt.acos=function(j){return new et(j).acos()},lt.prototype.acosh=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.acosh(this.get(j,rt)));return this},lt.acosh=function(j){return new et(j).acosh()},lt.prototype.asin=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.asin(this.get(j,rt)));return this},lt.asin=function(j){return new et(j).asin()},lt.prototype.asinh=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.asinh(this.get(j,rt)));return this},lt.asinh=function(j){return new et(j).asinh()},lt.prototype.atan=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.atan(this.get(j,rt)));return this},lt.atan=function(j){return new et(j).atan()},lt.prototype.atanh=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.atanh(this.get(j,rt)));return this},lt.atanh=function(j){return new et(j).atanh()},lt.prototype.cbrt=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.cbrt(this.get(j,rt)));return this},lt.cbrt=function(j){return new et(j).cbrt()},lt.prototype.ceil=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.ceil(this.get(j,rt)));return this},lt.ceil=function(j){return new et(j).ceil()},lt.prototype.clz32=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.clz32(this.get(j,rt)));return this},lt.clz32=function(j){return new et(j).clz32()},lt.prototype.cos=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.cos(this.get(j,rt)));return this},lt.cos=function(j){return new et(j).cos()},lt.prototype.cosh=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.cosh(this.get(j,rt)));return this},lt.cosh=function(j){return new et(j).cosh()},lt.prototype.exp=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.exp(this.get(j,rt)));return this},lt.exp=function(j){return new et(j).exp()},lt.prototype.expm1=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.expm1(this.get(j,rt)));return this},lt.expm1=function(j){return new et(j).expm1()},lt.prototype.floor=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.floor(this.get(j,rt)));return this},lt.floor=function(j){return new et(j).floor()},lt.prototype.fround=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.fround(this.get(j,rt)));return this},lt.fround=function(j){return new et(j).fround()},lt.prototype.log=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.log(this.get(j,rt)));return this},lt.log=function(j){return new et(j).log()},lt.prototype.log1p=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.log1p(this.get(j,rt)));return this},lt.log1p=function(j){return new et(j).log1p()},lt.prototype.log10=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.log10(this.get(j,rt)));return this},lt.log10=function(j){return new et(j).log10()},lt.prototype.log2=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.log2(this.get(j,rt)));return this},lt.log2=function(j){return new et(j).log2()},lt.prototype.round=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.round(this.get(j,rt)));return this},lt.round=function(j){return new et(j).round()},lt.prototype.sign=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.sign(this.get(j,rt)));return this},lt.sign=function(j){return new et(j).sign()},lt.prototype.sin=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.sin(this.get(j,rt)));return this},lt.sin=function(j){return new et(j).sin()},lt.prototype.sinh=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.sinh(this.get(j,rt)));return this},lt.sinh=function(j){return new et(j).sinh()},lt.prototype.sqrt=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.sqrt(this.get(j,rt)));return this},lt.sqrt=function(j){return new et(j).sqrt()},lt.prototype.tan=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.tan(this.get(j,rt)));return this},lt.tan=function(j){return new et(j).tan()},lt.prototype.tanh=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.tanh(this.get(j,rt)));return this},lt.tanh=function(j){return new et(j).tanh()},lt.prototype.trunc=function(){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,Math.trunc(this.get(j,rt)));return this},lt.trunc=function(j){return new et(j).trunc()},lt.pow=function(j,rt){return new et(j).pow(rt)},lt.prototype.pow=function(j){return typeof j=="number"?this.powS(j):this.powM(j)},lt.prototype.powS=function(j){for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)**j);return this},lt.prototype.powM=function(j){if(j=et.checkMatrix(j),this.rows!==j.rows||this.columns!==j.columns)throw new RangeError("Matrices dimensions must be equal");for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.set(rt,ot,this.get(rt,ot)**j.get(rt,ot));return this}}function tt(lt,et,j){let rt=j?lt.rows:lt.rows-1;if(et<0||et>rt)throw new RangeError("Row index out of range")}function at(lt,et,j){let rt=j?lt.columns:lt.columns-1;if(et<0||et>rt)throw new RangeError("Column index out of range")}function ut(lt,et){if(et.to1DArray&&(et=et.to1DArray()),et.length!==lt.columns)throw new RangeError("vector size must be the same as the number of columns");return et}function ft(lt,et){if(et.to1DArray&&(et=et.to1DArray()),et.length!==lt.rows)throw new RangeError("vector size must be the same as the number of rows");return et}function ht(lt,et){if(!s.isAnyArray(et))throw new TypeError("row indices must be an array");for(let j=0;j<et.length;j++)if(et[j]<0||et[j]>=lt.rows)throw new RangeError("row indices are out of range")}function dt(lt,et){if(!s.isAnyArray(et))throw new TypeError("column indices must be an array");for(let j=0;j<et.length;j++)if(et[j]<0||et[j]>=lt.columns)throw new RangeError("column indices are out of range")}function st(lt,et,j,rt,ot){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(wt("startRow",et),wt("endRow",j),wt("startColumn",rt),wt("endColumn",ot),et>j||rt>ot||et<0||et>=lt.rows||j<0||j>=lt.rows||rt<0||rt>=lt.columns||ot<0||ot>=lt.columns)throw new RangeError("Submatrix indices are out of range")}function ct(lt,et=0){let j=[];for(let rt=0;rt<lt;rt++)j.push(et);return j}function wt(lt,et){if(typeof et!="number")throw new TypeError(`${lt} must be a number`)}function _t(lt){if(lt.isEmpty())throw new Error("Empty matrix has no elements to index")}function gt(lt){let et=ct(lt.rows);for(let j=0;j<lt.rows;++j)for(let rt=0;rt<lt.columns;++rt)et[j]+=lt.get(j,rt);return et}function yt(lt){let et=ct(lt.columns);for(let j=0;j<lt.rows;++j)for(let rt=0;rt<lt.columns;++rt)et[rt]+=lt.get(j,rt);return et}function bt(lt){let et=0;for(let j=0;j<lt.rows;j++)for(let rt=0;rt<lt.columns;rt++)et+=lt.get(j,rt);return et}function vt(lt){let et=ct(lt.rows,1);for(let j=0;j<lt.rows;++j)for(let rt=0;rt<lt.columns;++rt)et[j]*=lt.get(j,rt);return et}function Ct(lt){let et=ct(lt.columns,1);for(let j=0;j<lt.rows;++j)for(let rt=0;rt<lt.columns;++rt)et[rt]*=lt.get(j,rt);return et}function Ht(lt){let et=1;for(let j=0;j<lt.rows;j++)for(let rt=0;rt<lt.columns;rt++)et*=lt.get(j,rt);return et}function Ft(lt,et,j){const rt=lt.rows,ot=lt.columns,pt=[];for(let kt=0;kt<rt;kt++){let Et=0,Pt=0,Nt=0;for(let Xt=0;Xt<ot;Xt++)Nt=lt.get(kt,Xt)-j[kt],Et+=Nt,Pt+=Nt*Nt;et?pt.push((Pt-Et*Et/ot)/(ot-1)):pt.push((Pt-Et*Et/ot)/ot)}return pt}function qt(lt,et,j){const rt=lt.rows,ot=lt.columns,pt=[];for(let kt=0;kt<ot;kt++){let Et=0,Pt=0,Nt=0;for(let Xt=0;Xt<rt;Xt++)Nt=lt.get(Xt,kt)-j[kt],Et+=Nt,Pt+=Nt*Nt;et?pt.push((Pt-Et*Et/rt)/(rt-1)):pt.push((Pt-Et*Et/rt)/rt)}return pt}function zt(lt,et,j){const rt=lt.rows,ot=lt.columns,pt=rt*ot;let kt=0,Et=0,Pt=0;for(let Nt=0;Nt<rt;Nt++)for(let Xt=0;Xt<ot;Xt++)Pt=lt.get(Nt,Xt)-j,kt+=Pt,Et+=Pt*Pt;return et?(Et-kt*kt/pt)/(pt-1):(Et-kt*kt/pt)/pt}function Qt(lt,et){for(let j=0;j<lt.rows;j++)for(let rt=0;rt<lt.columns;rt++)lt.set(j,rt,lt.get(j,rt)-et[j])}function _e(lt,et){for(let j=0;j<lt.rows;j++)for(let rt=0;rt<lt.columns;rt++)lt.set(j,rt,lt.get(j,rt)-et[rt])}function Gt(lt,et){for(let j=0;j<lt.rows;j++)for(let rt=0;rt<lt.columns;rt++)lt.set(j,rt,lt.get(j,rt)-et)}function Jt(lt){const et=[];for(let j=0;j<lt.rows;j++){let rt=0;for(let ot=0;ot<lt.columns;ot++)rt+=lt.get(j,ot)**2/(lt.columns-1);et.push(Math.sqrt(rt))}return et}function or(lt,et){for(let j=0;j<lt.rows;j++)for(let rt=0;rt<lt.columns;rt++)lt.set(j,rt,lt.get(j,rt)/et[j])}function mr(lt){const et=[];for(let j=0;j<lt.columns;j++){let rt=0;for(let ot=0;ot<lt.rows;ot++)rt+=lt.get(ot,j)**2/(lt.rows-1);et.push(Math.sqrt(rt))}return et}function hr(lt,et){for(let j=0;j<lt.rows;j++)for(let rt=0;rt<lt.columns;rt++)lt.set(j,rt,lt.get(j,rt)/et[rt])}function Lr(lt){const et=lt.size-1;let j=0;for(let rt=0;rt<lt.columns;rt++)for(let ot=0;ot<lt.rows;ot++)j+=lt.get(ot,rt)**2/et;return Math.sqrt(j)}function Er(lt,et){for(let j=0;j<lt.rows;j++)for(let rt=0;rt<lt.columns;rt++)lt.set(j,rt,lt.get(j,rt)/et)}class Kt{static from1DArray(et,j,rt){if(et*j!==rt.length)throw new RangeError("data length does not match given dimensions");let ot=new ir(et,j);for(let pt=0;pt<et;pt++)for(let kt=0;kt<j;kt++)ot.set(pt,kt,rt[pt*j+kt]);return ot}static rowVector(et){let j=new ir(1,et.length);for(let rt=0;rt<et.length;rt++)j.set(0,rt,et[rt]);return j}static columnVector(et){let j=new ir(et.length,1);for(let rt=0;rt<et.length;rt++)j.set(rt,0,et[rt]);return j}static zeros(et,j){return new ir(et,j)}static ones(et,j){return new ir(et,j).fill(1)}static rand(et,j,rt={}){if(typeof rt!="object")throw new TypeError("options must be an object");const{random:ot=Math.random}=rt;let pt=new ir(et,j);for(let kt=0;kt<et;kt++)for(let Et=0;Et<j;Et++)pt.set(kt,Et,ot());return pt}static randInt(et,j,rt={}){if(typeof rt!="object")throw new TypeError("options must be an object");const{min:ot=0,max:pt=1e3,random:kt=Math.random}=rt;if(!Number.isInteger(ot))throw new TypeError("min must be an integer");if(!Number.isInteger(pt))throw new TypeError("max must be an integer");if(ot>=pt)throw new RangeError("min must be smaller than max");let Et=pt-ot,Pt=new ir(et,j);for(let Nt=0;Nt<et;Nt++)for(let Xt=0;Xt<j;Xt++){let Lt=ot+Math.round(kt()*Et);Pt.set(Nt,Xt,Lt)}return Pt}static eye(et,j,rt){j===void 0&&(j=et),rt===void 0&&(rt=1);let ot=Math.min(et,j),pt=this.zeros(et,j);for(let kt=0;kt<ot;kt++)pt.set(kt,kt,rt);return pt}static diag(et,j,rt){let ot=et.length;j===void 0&&(j=ot),rt===void 0&&(rt=j);let pt=Math.min(ot,j,rt),kt=this.zeros(j,rt);for(let Et=0;Et<pt;Et++)kt.set(Et,Et,et[Et]);return kt}static min(et,j){et=this.checkMatrix(et),j=this.checkMatrix(j);let rt=et.rows,ot=et.columns,pt=new ir(rt,ot);for(let kt=0;kt<rt;kt++)for(let Et=0;Et<ot;Et++)pt.set(kt,Et,Math.min(et.get(kt,Et),j.get(kt,Et)));return pt}static max(et,j){et=this.checkMatrix(et),j=this.checkMatrix(j);let rt=et.rows,ot=et.columns,pt=new this(rt,ot);for(let kt=0;kt<rt;kt++)for(let Et=0;Et<ot;Et++)pt.set(kt,Et,Math.max(et.get(kt,Et),j.get(kt,Et)));return pt}static checkMatrix(et){return Kt.isMatrix(et)?et:new ir(et)}static isMatrix(et){return et!=null&&et.klass==="Matrix"}get size(){return this.rows*this.columns}apply(et){if(typeof et!="function")throw new TypeError("callback must be a function");for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)et.call(this,j,rt);return this}to1DArray(){let et=[];for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)et.push(this.get(j,rt));return et}to2DArray(){let et=[];for(let j=0;j<this.rows;j++){et.push([]);for(let rt=0;rt<this.columns;rt++)et[j].push(this.get(j,rt))}return et}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let et=0;et<this.rows;et++)for(let j=0;j<=et;j++)if(this.get(et,j)!==this.get(j,et))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let et=0;et<this.rows;et++)if(this.get(et,et)!==0)return!1;return!0}isEchelonForm(){let et=0,j=0,rt=-1,ot=!0,pt=!1;for(;et<this.rows&&ot;){for(j=0,pt=!1;j<this.columns&&pt===!1;)this.get(et,j)===0?j++:this.get(et,j)===1&&j>rt?(pt=!0,rt=j):(ot=!1,pt=!0);et++}return ot}isReducedEchelonForm(){let et=0,j=0,rt=-1,ot=!0,pt=!1;for(;et<this.rows&&ot;){for(j=0,pt=!1;j<this.columns&&pt===!1;)this.get(et,j)===0?j++:this.get(et,j)===1&&j>rt?(pt=!0,rt=j):(ot=!1,pt=!0);for(let kt=j+1;kt<this.rows;kt++)this.get(et,kt)!==0&&(ot=!1);et++}return ot}echelonForm(){let et=this.clone(),j=0,rt=0;for(;j<et.rows&&rt<et.columns;){let ot=j;for(let pt=j;pt<et.rows;pt++)et.get(pt,rt)>et.get(ot,rt)&&(ot=pt);if(et.get(ot,rt)===0)rt++;else{et.swapRows(j,ot);let pt=et.get(j,rt);for(let kt=rt;kt<et.columns;kt++)et.set(j,kt,et.get(j,kt)/pt);for(let kt=j+1;kt<et.rows;kt++){let Et=et.get(kt,rt)/et.get(j,rt);et.set(kt,rt,0);for(let Pt=rt+1;Pt<et.columns;Pt++)et.set(kt,Pt,et.get(kt,Pt)-et.get(j,Pt)*Et)}j++,rt++}}return et}reducedEchelonForm(){let et=this.echelonForm(),j=et.columns,rt=et.rows,ot=rt-1;for(;ot>=0;)if(et.maxRow(ot)===0)ot--;else{let pt=0,kt=!1;for(;pt<rt&&kt===!1;)et.get(ot,pt)===1?kt=!0:pt++;for(let Et=0;Et<ot;Et++){let Pt=et.get(Et,pt);for(let Nt=pt;Nt<j;Nt++){let Xt=et.get(Et,Nt)-Pt*et.get(ot,Nt);et.set(Et,Nt,Xt)}}ot--}return et}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(et={}){if(typeof et!="object")throw new TypeError("options must be an object");const{rows:j=1,columns:rt=1}=et;if(!Number.isInteger(j)||j<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(rt)||rt<=0)throw new TypeError("columns must be a positive integer");let ot=new ir(this.rows*j,this.columns*rt);for(let pt=0;pt<j;pt++)for(let kt=0;kt<rt;kt++)ot.setSubMatrix(this,this.rows*pt,this.columns*kt);return ot}fill(et){for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,et);return this}neg(){return this.mulS(-1)}getRow(et){tt(this,et);let j=[];for(let rt=0;rt<this.columns;rt++)j.push(this.get(et,rt));return j}getRowVector(et){return ir.rowVector(this.getRow(et))}setRow(et,j){tt(this,et),j=ut(this,j);for(let rt=0;rt<this.columns;rt++)this.set(et,rt,j[rt]);return this}swapRows(et,j){tt(this,et),tt(this,j);for(let rt=0;rt<this.columns;rt++){let ot=this.get(et,rt);this.set(et,rt,this.get(j,rt)),this.set(j,rt,ot)}return this}getColumn(et){at(this,et);let j=[];for(let rt=0;rt<this.rows;rt++)j.push(this.get(rt,et));return j}getColumnVector(et){return ir.columnVector(this.getColumn(et))}setColumn(et,j){at(this,et),j=ft(this,j);for(let rt=0;rt<this.rows;rt++)this.set(rt,et,j[rt]);return this}swapColumns(et,j){at(this,et),at(this,j);for(let rt=0;rt<this.rows;rt++){let ot=this.get(rt,et);this.set(rt,et,this.get(rt,j)),this.set(rt,j,ot)}return this}addRowVector(et){et=ut(this,et);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,this.get(j,rt)+et[rt]);return this}subRowVector(et){et=ut(this,et);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,this.get(j,rt)-et[rt]);return this}mulRowVector(et){et=ut(this,et);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,this.get(j,rt)*et[rt]);return this}divRowVector(et){et=ut(this,et);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,this.get(j,rt)/et[rt]);return this}addColumnVector(et){et=ft(this,et);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,this.get(j,rt)+et[j]);return this}subColumnVector(et){et=ft(this,et);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,this.get(j,rt)-et[j]);return this}mulColumnVector(et){et=ft(this,et);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,this.get(j,rt)*et[j]);return this}divColumnVector(et){et=ft(this,et);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)this.set(j,rt,this.get(j,rt)/et[j]);return this}mulRow(et,j){tt(this,et);for(let rt=0;rt<this.columns;rt++)this.set(et,rt,this.get(et,rt)*j);return this}mulColumn(et,j){at(this,et);for(let rt=0;rt<this.rows;rt++)this.set(rt,et,this.get(rt,et)*j);return this}max(et){if(this.isEmpty())return NaN;switch(et){case"row":{const j=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.get(rt,ot)>j[rt]&&(j[rt]=this.get(rt,ot));return j}case"column":{const j=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.get(rt,ot)>j[ot]&&(j[ot]=this.get(rt,ot));return j}case void 0:{let j=this.get(0,0);for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.get(rt,ot)>j&&(j=this.get(rt,ot));return j}default:throw new Error(`invalid option: ${et}`)}}maxIndex(){_t(this);let et=this.get(0,0),j=[0,0];for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.get(rt,ot)>et&&(et=this.get(rt,ot),j[0]=rt,j[1]=ot);return j}min(et){if(this.isEmpty())return NaN;switch(et){case"row":{const j=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.get(rt,ot)<j[rt]&&(j[rt]=this.get(rt,ot));return j}case"column":{const j=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.get(rt,ot)<j[ot]&&(j[ot]=this.get(rt,ot));return j}case void 0:{let j=this.get(0,0);for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.get(rt,ot)<j&&(j=this.get(rt,ot));return j}default:throw new Error(`invalid option: ${et}`)}}minIndex(){_t(this);let et=this.get(0,0),j=[0,0];for(let rt=0;rt<this.rows;rt++)for(let ot=0;ot<this.columns;ot++)this.get(rt,ot)<et&&(et=this.get(rt,ot),j[0]=rt,j[1]=ot);return j}maxRow(et){if(tt(this,et),this.isEmpty())return NaN;let j=this.get(et,0);for(let rt=1;rt<this.columns;rt++)this.get(et,rt)>j&&(j=this.get(et,rt));return j}maxRowIndex(et){tt(this,et),_t(this);let j=this.get(et,0),rt=[et,0];for(let ot=1;ot<this.columns;ot++)this.get(et,ot)>j&&(j=this.get(et,ot),rt[1]=ot);return rt}minRow(et){if(tt(this,et),this.isEmpty())return NaN;let j=this.get(et,0);for(let rt=1;rt<this.columns;rt++)this.get(et,rt)<j&&(j=this.get(et,rt));return j}minRowIndex(et){tt(this,et),_t(this);let j=this.get(et,0),rt=[et,0];for(let ot=1;ot<this.columns;ot++)this.get(et,ot)<j&&(j=this.get(et,ot),rt[1]=ot);return rt}maxColumn(et){if(at(this,et),this.isEmpty())return NaN;let j=this.get(0,et);for(let rt=1;rt<this.rows;rt++)this.get(rt,et)>j&&(j=this.get(rt,et));return j}maxColumnIndex(et){at(this,et),_t(this);let j=this.get(0,et),rt=[0,et];for(let ot=1;ot<this.rows;ot++)this.get(ot,et)>j&&(j=this.get(ot,et),rt[0]=ot);return rt}minColumn(et){if(at(this,et),this.isEmpty())return NaN;let j=this.get(0,et);for(let rt=1;rt<this.rows;rt++)this.get(rt,et)<j&&(j=this.get(rt,et));return j}minColumnIndex(et){at(this,et),_t(this);let j=this.get(0,et),rt=[0,et];for(let ot=1;ot<this.rows;ot++)this.get(ot,et)<j&&(j=this.get(ot,et),rt[0]=ot);return rt}diag(){let et=Math.min(this.rows,this.columns),j=[];for(let rt=0;rt<et;rt++)j.push(this.get(rt,rt));return j}norm(et="frobenius"){switch(et){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${et}`)}}cumulativeSum(){let et=0;for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)et+=this.get(j,rt),this.set(j,rt,et);return this}dot(et){Kt.isMatrix(et)&&(et=et.to1DArray());let j=this.to1DArray();if(j.length!==et.length)throw new RangeError("vectors do not have the same size");let rt=0;for(let ot=0;ot<j.length;ot++)rt+=j[ot]*et[ot];return rt}mmul(et){et=ir.checkMatrix(et);let j=this.rows,rt=this.columns,ot=et.columns,pt=new ir(j,ot),kt=new Float64Array(rt);for(let Et=0;Et<ot;Et++){for(let Pt=0;Pt<rt;Pt++)kt[Pt]=et.get(Pt,Et);for(let Pt=0;Pt<j;Pt++){let Nt=0;for(let Xt=0;Xt<rt;Xt++)Nt+=this.get(Pt,Xt)*kt[Xt];pt.set(Pt,Et,Nt)}}return pt}mpow(et){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(et)||et<0)throw new RangeError("Exponent must be a non-negative integer");let j=ir.eye(this.rows),rt=this;for(let ot=et;ot>=1;ot/=2)ot&1&&(j=j.mmul(rt)),rt=rt.mmul(rt);return j}strassen2x2(et){et=ir.checkMatrix(et);let j=new ir(2,2);const rt=this.get(0,0),ot=et.get(0,0),pt=this.get(0,1),kt=et.get(0,1),Et=this.get(1,0),Pt=et.get(1,0),Nt=this.get(1,1),Xt=et.get(1,1),Lt=(rt+Nt)*(ot+Xt),rr=(Et+Nt)*ot,dr=rt*(kt-Xt),Wt=Nt*(Pt-ot),ar=(rt+pt)*Xt,Mr=(Et-rt)*(ot+kt),Ot=(pt-Nt)*(Pt+Xt),br=Lt+Wt-ar+Ot,Pr=dr+ar,Wr=rr+Wt,Zr=Lt-rr+dr+Mr;return j.set(0,0,br),j.set(0,1,Pr),j.set(1,0,Wr),j.set(1,1,Zr),j}strassen3x3(et){et=ir.checkMatrix(et);let j=new ir(3,3);const rt=this.get(0,0),ot=this.get(0,1),pt=this.get(0,2),kt=this.get(1,0),Et=this.get(1,1),Pt=this.get(1,2),Nt=this.get(2,0),Xt=this.get(2,1),Lt=this.get(2,2),rr=et.get(0,0),dr=et.get(0,1),Wt=et.get(0,2),ar=et.get(1,0),Mr=et.get(1,1),Ot=et.get(1,2),br=et.get(2,0),Pr=et.get(2,1),Wr=et.get(2,2),Zr=(rt+ot+pt-kt-Et-Xt-Lt)*Mr,en=(rt-kt)*(-dr+Mr),Xr=Et*(-rr+dr+ar-Mr-Ot-br+Wr),Kr=(-rt+kt+Et)*(rr-dr+Mr),rn=(kt+Et)*(-rr+dr),Vt=rt*rr,wr=(-rt+Nt+Xt)*(rr-Wt+Ot),Ir=(-rt+Nt)*(Wt-Ot),kr=(Nt+Xt)*(-rr+Wt),an=(rt+ot+pt-Et-Pt-Nt-Xt)*Ot,tn=Xt*(-rr+Wt+ar-Mr-Ot-br+Pr),nn=(-pt+Xt+Lt)*(Mr+br-Pr),sn=(pt-Lt)*(Mr-Pr),un=pt*br,dn=(Xt+Lt)*(-br+Pr),on=(-pt+Et+Pt)*(Ot+br-Wr),mn=(pt-Pt)*(Ot-Wr),pn=(Et+Pt)*(-br+Wr),Jr=ot*ar,hn=Pt*Pr,cn=kt*Wt,fn=Nt*dr,ln=Lt*Wr,bn=Vt+un+Jr,vn=Zr+Kr+rn+Vt+nn+un+dn,xn=Vt+wr+kr+an+un+on+pn,kn=en+Xr+Kr+Vt+un+on+mn,Sn=en+Kr+rn+Vt+hn,En=un+on+mn+pn+cn,Mn=Vt+wr+Ir+tn+nn+sn+un,Rn=nn+sn+un+dn+fn,An=Vt+wr+Ir+kr+ln;return j.set(0,0,bn),j.set(0,1,vn),j.set(0,2,xn),j.set(1,0,kn),j.set(1,1,Sn),j.set(1,2,En),j.set(2,0,Mn),j.set(2,1,Rn),j.set(2,2,An),j}mmulStrassen(et){et=ir.checkMatrix(et);let j=this.clone(),rt=j.rows,ot=j.columns,pt=et.rows,kt=et.columns;ot!==pt&&console.warn(`Multiplying ${rt} x ${ot} and ${pt} x ${kt} matrix: dimensions do not match.`);function Et(Lt,rr,dr){let Wt=Lt.rows,ar=Lt.columns;if(Wt===rr&&ar===dr)return Lt;{let Mr=Kt.zeros(rr,dr);return Mr=Mr.setSubMatrix(Lt,0,0),Mr}}let Pt=Math.max(rt,pt),Nt=Math.max(ot,kt);j=Et(j,Pt,Nt),et=Et(et,Pt,Nt);function Xt(Lt,rr,dr,Wt){if(dr<=512||Wt<=512)return Lt.mmul(rr);dr%2===1&&Wt%2===1?(Lt=Et(Lt,dr+1,Wt+1),rr=Et(rr,dr+1,Wt+1)):dr%2===1?(Lt=Et(Lt,dr+1,Wt),rr=Et(rr,dr+1,Wt)):Wt%2===1&&(Lt=Et(Lt,dr,Wt+1),rr=Et(rr,dr,Wt+1));let ar=parseInt(Lt.rows/2,10),Mr=parseInt(Lt.columns/2,10),Ot=Lt.subMatrix(0,ar-1,0,Mr-1),br=rr.subMatrix(0,ar-1,0,Mr-1),Pr=Lt.subMatrix(0,ar-1,Mr,Lt.columns-1),Wr=rr.subMatrix(0,ar-1,Mr,rr.columns-1),Zr=Lt.subMatrix(ar,Lt.rows-1,0,Mr-1),en=rr.subMatrix(ar,rr.rows-1,0,Mr-1),Xr=Lt.subMatrix(ar,Lt.rows-1,Mr,Lt.columns-1),Kr=rr.subMatrix(ar,rr.rows-1,Mr,rr.columns-1),rn=Xt(Kt.add(Ot,Xr),Kt.add(br,Kr),ar,Mr),Vt=Xt(Kt.add(Zr,Xr),br,ar,Mr),wr=Xt(Ot,Kt.sub(Wr,Kr),ar,Mr),Ir=Xt(Xr,Kt.sub(en,br),ar,Mr),kr=Xt(Kt.add(Ot,Pr),Kr,ar,Mr),an=Xt(Kt.sub(Zr,Ot),Kt.add(br,Wr),ar,Mr),tn=Xt(Kt.sub(Pr,Xr),Kt.add(en,Kr),ar,Mr),nn=Kt.add(rn,Ir);nn.sub(kr),nn.add(tn);let sn=Kt.add(wr,kr),un=Kt.add(Vt,Ir),dn=Kt.sub(rn,Vt);dn.add(wr),dn.add(an);let on=Kt.zeros(2*nn.rows,2*nn.columns);return on=on.setSubMatrix(nn,0,0),on=on.setSubMatrix(sn,nn.rows,0),on=on.setSubMatrix(un,0,nn.columns),on=on.setSubMatrix(dn,nn.rows,nn.columns),on.subMatrix(0,dr-1,0,Wt-1)}return Xt(j,et,Pt,Nt)}scaleRows(et={}){if(typeof et!="object")throw new TypeError("options must be an object");const{min:j=0,max:rt=1}=et;if(!Number.isFinite(j))throw new TypeError("min must be a number");if(!Number.isFinite(rt))throw new TypeError("max must be a number");if(j>=rt)throw new RangeError("min must be smaller than max");let ot=new ir(this.rows,this.columns);for(let pt=0;pt<this.rows;pt++){const kt=this.getRow(pt);kt.length>0&&o(kt,{min:j,max:rt,output:kt}),ot.setRow(pt,kt)}return ot}scaleColumns(et={}){if(typeof et!="object")throw new TypeError("options must be an object");const{min:j=0,max:rt=1}=et;if(!Number.isFinite(j))throw new TypeError("min must be a number");if(!Number.isFinite(rt))throw new TypeError("max must be a number");if(j>=rt)throw new RangeError("min must be smaller than max");let ot=new ir(this.rows,this.columns);for(let pt=0;pt<this.columns;pt++){const kt=this.getColumn(pt);kt.length&&o(kt,{min:j,max:rt,output:kt}),ot.setColumn(pt,kt)}return ot}flipRows(){const et=Math.ceil(this.columns/2);for(let j=0;j<this.rows;j++)for(let rt=0;rt<et;rt++){let ot=this.get(j,rt),pt=this.get(j,this.columns-1-rt);this.set(j,rt,pt),this.set(j,this.columns-1-rt,ot)}return this}flipColumns(){const et=Math.ceil(this.rows/2);for(let j=0;j<this.columns;j++)for(let rt=0;rt<et;rt++){let ot=this.get(rt,j),pt=this.get(this.rows-1-rt,j);this.set(rt,j,pt),this.set(this.rows-1-rt,j,ot)}return this}kroneckerProduct(et){et=ir.checkMatrix(et);let j=this.rows,rt=this.columns,ot=et.rows,pt=et.columns,kt=new ir(j*ot,rt*pt);for(let Et=0;Et<j;Et++)for(let Pt=0;Pt<rt;Pt++)for(let Nt=0;Nt<ot;Nt++)for(let Xt=0;Xt<pt;Xt++)kt.set(ot*Et+Nt,pt*Pt+Xt,this.get(Et,Pt)*et.get(Nt,Xt));return kt}kroneckerSum(et){if(et=ir.checkMatrix(et),!this.isSquare()||!et.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let j=this.rows,rt=et.rows,ot=this.kroneckerProduct(ir.eye(rt,rt)),pt=ir.eye(j,j).kroneckerProduct(et);return ot.add(pt)}transpose(){let et=new ir(this.columns,this.rows);for(let j=0;j<this.rows;j++)for(let rt=0;rt<this.columns;rt++)et.set(rt,j,this.get(j,rt));return et}sortRows(et=fr){for(let j=0;j<this.rows;j++)this.setRow(j,this.getRow(j).sort(et));return this}sortColumns(et=fr){for(let j=0;j<this.columns;j++)this.setColumn(j,this.getColumn(j).sort(et));return this}subMatrix(et,j,rt,ot){st(this,et,j,rt,ot);let pt=new ir(j-et+1,ot-rt+1);for(let kt=et;kt<=j;kt++)for(let Et=rt;Et<=ot;Et++)pt.set(kt-et,Et-rt,this.get(kt,Et));return pt}subMatrixRow(et,j,rt){if(j===void 0&&(j=0),rt===void 0&&(rt=this.columns-1),j>rt||j<0||j>=this.columns||rt<0||rt>=this.columns)throw new RangeError("Argument out of range");let ot=new ir(et.length,rt-j+1);for(let pt=0;pt<et.length;pt++)for(let kt=j;kt<=rt;kt++){if(et[pt]<0||et[pt]>=this.rows)throw new RangeError(`Row index out of range: ${et[pt]}`);ot.set(pt,kt-j,this.get(et[pt],kt))}return ot}subMatrixColumn(et,j,rt){if(j===void 0&&(j=0),rt===void 0&&(rt=this.rows-1),j>rt||j<0||j>=this.rows||rt<0||rt>=this.rows)throw new RangeError("Argument out of range");let ot=new ir(rt-j+1,et.length);for(let pt=0;pt<et.length;pt++)for(let kt=j;kt<=rt;kt++){if(et[pt]<0||et[pt]>=this.columns)throw new RangeError(`Column index out of range: ${et[pt]}`);ot.set(kt-j,pt,this.get(kt,et[pt]))}return ot}setSubMatrix(et,j,rt){if(et=ir.checkMatrix(et),et.isEmpty())return this;let ot=j+et.rows-1,pt=rt+et.columns-1;st(this,j,ot,rt,pt);for(let kt=0;kt<et.rows;kt++)for(let Et=0;Et<et.columns;Et++)this.set(j+kt,rt+Et,et.get(kt,Et));return this}selection(et,j){ht(this,et),dt(this,j);let rt=new ir(et.length,j.length);for(let ot=0;ot<et.length;ot++){let pt=et[ot];for(let kt=0;kt<j.length;kt++){let Et=j[kt];rt.set(ot,kt,this.get(pt,Et))}}return rt}trace(){let et=Math.min(this.rows,this.columns),j=0;for(let rt=0;rt<et;rt++)j+=this.get(rt,rt);return j}clone(){return this.constructor.copy(this,new ir(this.rows,this.columns))}static copy(et,j){for(const[rt,ot,pt]of et.entries())j.set(rt,ot,pt);return j}sum(et){switch(et){case"row":return gt(this);case"column":return yt(this);case void 0:return bt(this);default:throw new Error(`invalid option: ${et}`)}}product(et){switch(et){case"row":return vt(this);case"column":return Ct(this);case void 0:return Ht(this);default:throw new Error(`invalid option: ${et}`)}}mean(et){const j=this.sum(et);switch(et){case"row":{for(let rt=0;rt<this.rows;rt++)j[rt]/=this.columns;return j}case"column":{for(let rt=0;rt<this.columns;rt++)j[rt]/=this.rows;return j}case void 0:return j/this.size;default:throw new Error(`invalid option: ${et}`)}}variance(et,j={}){if(typeof et=="object"&&(j=et,et=void 0),typeof j!="object")throw new TypeError("options must be an object");const{unbiased:rt=!0,mean:ot=this.mean(et)}=j;if(typeof rt!="boolean")throw new TypeError("unbiased must be a boolean");switch(et){case"row":{if(!s.isAnyArray(ot))throw new TypeError("mean must be an array");return Ft(this,rt,ot)}case"column":{if(!s.isAnyArray(ot))throw new TypeError("mean must be an array");return qt(this,rt,ot)}case void 0:{if(typeof ot!="number")throw new TypeError("mean must be a number");return zt(this,rt,ot)}default:throw new Error(`invalid option: ${et}`)}}standardDeviation(et,j){typeof et=="object"&&(j=et,et=void 0);const rt=this.variance(et,j);if(et===void 0)return Math.sqrt(rt);for(let ot=0;ot<rt.length;ot++)rt[ot]=Math.sqrt(rt[ot]);return rt}center(et,j={}){if(typeof et=="object"&&(j=et,et=void 0),typeof j!="object")throw new TypeError("options must be an object");const{center:rt=this.mean(et)}=j;switch(et){case"row":{if(!s.isAnyArray(rt))throw new TypeError("center must be an array");return Qt(this,rt),this}case"column":{if(!s.isAnyArray(rt))throw new TypeError("center must be an array");return _e(this,rt),this}case void 0:{if(typeof rt!="number")throw new TypeError("center must be a number");return Gt(this,rt),this}default:throw new Error(`invalid option: ${et}`)}}scale(et,j={}){if(typeof et=="object"&&(j=et,et=void 0),typeof j!="object")throw new TypeError("options must be an object");let rt=j.scale;switch(et){case"row":{if(rt===void 0)rt=Jt(this);else if(!s.isAnyArray(rt))throw new TypeError("scale must be an array");return or(this,rt),this}case"column":{if(rt===void 0)rt=mr(this);else if(!s.isAnyArray(rt))throw new TypeError("scale must be an array");return hr(this,rt),this}case void 0:{if(rt===void 0)rt=Lr(this);else if(typeof rt!="number")throw new TypeError("scale must be a number");return Er(this,rt),this}default:throw new Error(`invalid option: ${et}`)}}toString(et){return b(this,et)}[Symbol.iterator](){return this.entries()}*entries(){for(let et=0;et<this.rows;et++)for(let j=0;j<this.columns;j++)yield[et,j,this.get(et,j)]}*values(){for(let et=0;et<this.rows;et++)for(let j=0;j<this.columns;j++)yield this.get(et,j)}}Kt.prototype.klass="Matrix",typeof Symbol<"u"&&(Kt.prototype[Symbol.for("nodejs.util.inspect.custom")]=g);function fr(lt,et){return lt-et}function Rr(lt){return lt.every(et=>typeof et=="number")}Kt.random=Kt.rand,Kt.randomInt=Kt.randInt,Kt.diagonal=Kt.diag,Kt.prototype.diagonal=Kt.prototype.diag,Kt.identity=Kt.eye,Kt.prototype.negate=Kt.prototype.neg,Kt.prototype.tensorProduct=Kt.prototype.kroneckerProduct;const gr=class _n extends Kt{constructor(et,j){if(super(),It(this,e),$e(this,"data"),_n.isMatrix(et))$t(this,e,i).call(this,et.rows,et.columns),_n.copy(et,this);else if(Number.isInteger(et)&&et>=0)$t(this,e,i).call(this,et,j);else if(s.isAnyArray(et)){const rt=et;if(et=rt.length,j=et?rt[0].length:0,typeof j!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let ot=0;ot<et;ot++){if(rt[ot].length!==j)throw new RangeError("Inconsistent array dimensions");if(!Rr(rt[ot]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(rt[ot]))}this.rows=et,this.columns=j}else throw new TypeError("First argument must be a positive number or an array")}set(et,j,rt){return this.data[et][j]=rt,this}get(et,j){return this.data[et][j]}removeRow(et){return tt(this,et),this.data.splice(et,1),this.rows-=1,this}addRow(et,j){return j===void 0&&(j=et,et=this.rows),tt(this,et,!0),j=Float64Array.from(ut(this,j)),this.data.splice(et,0,j),this.rows+=1,this}removeColumn(et){at(this,et);for(let j=0;j<this.rows;j++){const rt=new Float64Array(this.columns-1);for(let ot=0;ot<et;ot++)rt[ot]=this.data[j][ot];for(let ot=et+1;ot<this.columns;ot++)rt[ot-1]=this.data[j][ot];this.data[j]=rt}return this.columns-=1,this}addColumn(et,j){typeof j>"u"&&(j=et,et=this.columns),at(this,et,!0),j=ft(this,j);for(let rt=0;rt<this.rows;rt++){const ot=new Float64Array(this.columns+1);let pt=0;for(;pt<et;pt++)ot[pt]=this.data[rt][pt];for(ot[pt++]=j[rt];pt<this.columns+1;pt++)ot[pt]=this.data[rt][pt-1];this.data[rt]=ot}return this.columns+=1,this}};e=new WeakSet,i=function(lt,et){if(this.data=[],Number.isInteger(et)&&et>=0)for(let j=0;j<lt;j++)this.data.push(new Float64Array(et));else throw new TypeError("nColumns must be a positive integer");this.rows=lt,this.columns=et};let ir=gr;nt(Kt,ir);const Vr=class wn extends Kt{constructor(et){if(super(),It(this,a),ir.isMatrix(et)){if(!et.isSymmetric())throw new TypeError("not symmetric data");Dt(this,a,ir.copy(et,new ir(et.rows,et.rows)))}else if(Number.isInteger(et)&&et>=0)Dt(this,a,new ir(et,et));else if(Dt(this,a,new ir(et)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return St(this,a).size}get rows(){return St(this,a).rows}get columns(){return St(this,a).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(et){return ir.isMatrix(et)&&et.klassType==="SymmetricMatrix"}static zeros(et){return new this(et)}static ones(et){return new this(et).fill(1)}clone(){const et=new wn(this.diagonalSize);for(const[j,rt,ot]of this.upperRightEntries())et.set(j,rt,ot);return et}toMatrix(){return new ir(this)}get(et,j){return St(this,a).get(et,j)}set(et,j,rt){return St(this,a).set(et,j,rt),St(this,a).set(j,et,rt),this}removeCross(et){return St(this,a).removeRow(et),St(this,a).removeColumn(et),this}addCross(et,j){j===void 0&&(j=et,et=this.diagonalSize);const rt=j.slice();return rt.splice(et,1),St(this,a).addRow(et,rt),St(this,a).addColumn(et,j),this}applyMask(et){if(et.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const j=[];for(const[rt,ot]of et.entries())ot||j.push(rt);j.reverse();for(const rt of j)this.removeCross(rt);return this}toCompact(){const{diagonalSize:et}=this,j=new Array(et*(et+1)/2);for(let rt=0,ot=0,pt=0;pt<j.length;pt++)j[pt]=this.get(ot,rt),++rt>=et&&(rt=++ot);return j}static fromCompact(et){const j=et.length,rt=(Math.sqrt(8*j+1)-1)/2;if(!Number.isInteger(rt))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(et)}`);const ot=new wn(rt);for(let pt=0,kt=0,Et=0;Et<j;Et++)ot.set(pt,kt,et[Et]),++pt>=rt&&(pt=++kt);return ot}*upperRightEntries(){for(let et=0,j=0;et<this.diagonalSize;void 0){const rt=this.get(et,j);yield[et,j,rt],++j>=this.diagonalSize&&(j=++et)}}*upperRightValues(){for(let et=0,j=0;et<this.diagonalSize;void 0)yield this.get(et,j),++j>=this.diagonalSize&&(j=++et)}};a=new WeakMap;let Ur=Vr;Ur.prototype.klassType="SymmetricMatrix";class Fr extends Ur{static isDistanceMatrix(et){return Ur.isSymmetricMatrix(et)&&et.klassSubType==="DistanceMatrix"}constructor(et){if(super(et),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(et,j,rt){return et===j&&(rt=0),super.set(et,j,rt)}addCross(et,j){return j===void 0&&(j=et,et=this.diagonalSize),j=j.slice(),j[et]=0,super.addCross(et,j)}toSymmetricMatrix(){return new Ur(this)}clone(){const et=new Fr(this.diagonalSize);for(const[j,rt,ot]of this.upperRightEntries())j!==rt&&et.set(j,rt,ot);return et}toCompact(){const{diagonalSize:et}=this,j=(et-1)*et/2,rt=new Array(j);for(let ot=1,pt=0,kt=0;kt<rt.length;kt++)rt[kt]=this.get(pt,ot),++ot>=et&&(ot=++pt+1);return rt}static fromCompact(et){const j=et.length;if(j===0)return new this(0);const rt=(Math.sqrt(8*j+1)+1)/2;if(!Number.isInteger(rt))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(et)}`);const ot=new this(rt);for(let pt=1,kt=0,Et=0;Et<j;Et++)ot.set(pt,kt,et[Et]),++pt>=rt&&(pt=++kt+1);return ot}}Fr.prototype.klassSubType="DistanceMatrix";class Sr extends Kt{constructor(et,j,rt){super(),this.matrix=et,this.rows=j,this.columns=rt}}class vr extends Sr{constructor(et,j){at(et,j),super(et,et.rows,1),this.column=j}set(et,j,rt){return this.matrix.set(et,this.column,rt),this}get(et){return this.matrix.get(et,this.column)}}class Qr extends Sr{constructor(et,j){dt(et,j),super(et,et.rows,j.length),this.columnIndices=j}set(et,j,rt){return this.matrix.set(et,this.columnIndices[j],rt),this}get(et,j){return this.matrix.get(et,this.columnIndices[j])}}class Or extends Sr{constructor(et){super(et,et.rows,et.columns)}set(et,j,rt){return this.matrix.set(et,this.columns-j-1,rt),this}get(et,j){return this.matrix.get(et,this.columns-j-1)}}class Cr extends Sr{constructor(et){super(et,et.rows,et.columns)}set(et,j,rt){return this.matrix.set(this.rows-et-1,j,rt),this}get(et,j){return this.matrix.get(this.rows-et-1,j)}}class Hr extends Sr{constructor(et,j){tt(et,j),super(et,1,et.columns),this.row=j}set(et,j,rt){return this.matrix.set(this.row,j,rt),this}get(et,j){return this.matrix.get(this.row,j)}}class nr extends Sr{constructor(et,j){ht(et,j),super(et,j.length,et.columns),this.rowIndices=j}set(et,j,rt){return this.matrix.set(this.rowIndices[et],j,rt),this}get(et,j){return this.matrix.get(this.rowIndices[et],j)}}class Dr extends Sr{constructor(et,j,rt){ht(et,j),dt(et,rt),super(et,j.length,rt.length),this.rowIndices=j,this.columnIndices=rt}set(et,j,rt){return this.matrix.set(this.rowIndices[et],this.columnIndices[j],rt),this}get(et,j){return this.matrix.get(this.rowIndices[et],this.columnIndices[j])}}class qr extends Sr{constructor(et,j,rt,ot,pt){st(et,j,rt,ot,pt),super(et,rt-j+1,pt-ot+1),this.startRow=j,this.startColumn=ot}set(et,j,rt){return this.matrix.set(this.startRow+et,this.startColumn+j,rt),this}get(et,j){return this.matrix.get(this.startRow+et,this.startColumn+j)}}class Nr extends Sr{constructor(et){super(et,et.columns,et.rows)}set(et,j,rt){return this.matrix.set(j,et,rt),this}get(et,j){return this.matrix.get(j,et)}}class _r extends Kt{constructor(et,j={}){const{rows:rt=1}=j;if(et.length%rt!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=rt,this.columns=et.length/rt,this.data=et}set(et,j,rt){let ot=this._calculateIndex(et,j);return this.data[ot]=rt,this}get(et,j){let rt=this._calculateIndex(et,j);return this.data[rt]}_calculateIndex(et,j){return et*this.columns+j}}class jr extends Kt{constructor(et){super(),this.data=et,this.rows=et.length,this.columns=et[0].length}set(et,j,rt){return this.data[et][j]=rt,this}get(et,j){return this.data[et][j]}}function Ar(lt,et){if(s.isAnyArray(lt))return lt[0]&&s.isAnyArray(lt[0])?new jr(lt):new _r(lt,et);throw new Error("the argument is not an array")}class $r{constructor(et){et=jr.checkMatrix(et);let j=et.clone(),rt=j.rows,ot=j.columns,pt=new Float64Array(rt),kt=1,Et,Pt,Nt,Xt,Lt,rr,dr,Wt,ar;for(Et=0;Et<rt;Et++)pt[Et]=Et;for(Wt=new Float64Array(rt),Pt=0;Pt<ot;Pt++){for(Et=0;Et<rt;Et++)Wt[Et]=j.get(Et,Pt);for(Et=0;Et<rt;Et++){for(ar=Math.min(Et,Pt),Lt=0,Nt=0;Nt<ar;Nt++)Lt+=j.get(Et,Nt)*Wt[Nt];Wt[Et]-=Lt,j.set(Et,Pt,Wt[Et])}for(Xt=Pt,Et=Pt+1;Et<rt;Et++)Math.abs(Wt[Et])>Math.abs(Wt[Xt])&&(Xt=Et);if(Xt!==Pt){for(Nt=0;Nt<ot;Nt++)rr=j.get(Xt,Nt),j.set(Xt,Nt,j.get(Pt,Nt)),j.set(Pt,Nt,rr);dr=pt[Xt],pt[Xt]=pt[Pt],pt[Pt]=dr,kt=-kt}if(Pt<rt&&j.get(Pt,Pt)!==0)for(Et=Pt+1;Et<rt;Et++)j.set(Et,Pt,j.get(Et,Pt)/j.get(Pt,Pt))}this.LU=j,this.pivotVector=pt,this.pivotSign=kt}isSingular(){let et=this.LU,j=et.columns;for(let rt=0;rt<j;rt++)if(et.get(rt,rt)===0)return!0;return!1}solve(et){et=ir.checkMatrix(et);let j=this.LU;if(j.rows!==et.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let rt=et.columns,ot=et.subMatrixRow(this.pivotVector,0,rt-1),pt=j.columns,kt,Et,Pt;for(Pt=0;Pt<pt;Pt++)for(kt=Pt+1;kt<pt;kt++)for(Et=0;Et<rt;Et++)ot.set(kt,Et,ot.get(kt,Et)-ot.get(Pt,Et)*j.get(kt,Pt));for(Pt=pt-1;Pt>=0;Pt--){for(Et=0;Et<rt;Et++)ot.set(Pt,Et,ot.get(Pt,Et)/j.get(Pt,Pt));for(kt=0;kt<Pt;kt++)for(Et=0;Et<rt;Et++)ot.set(kt,Et,ot.get(kt,Et)-ot.get(Pt,Et)*j.get(kt,Pt))}return ot}get determinant(){let et=this.LU;if(!et.isSquare())throw new Error("Matrix must be square");let j=this.pivotSign,rt=et.columns;for(let ot=0;ot<rt;ot++)j*=et.get(ot,ot);return j}get lowerTriangularMatrix(){let et=this.LU,j=et.rows,rt=et.columns,ot=new ir(j,rt);for(let pt=0;pt<j;pt++)for(let kt=0;kt<rt;kt++)pt>kt?ot.set(pt,kt,et.get(pt,kt)):pt===kt?ot.set(pt,kt,1):ot.set(pt,kt,0);return ot}get upperTriangularMatrix(){let et=this.LU,j=et.rows,rt=et.columns,ot=new ir(j,rt);for(let pt=0;pt<j;pt++)for(let kt=0;kt<rt;kt++)pt<=kt?ot.set(pt,kt,et.get(pt,kt)):ot.set(pt,kt,0);return ot}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Tr(lt,et){let j=0;return Math.abs(lt)>Math.abs(et)?(j=et/lt,Math.abs(lt)*Math.sqrt(1+j*j)):et!==0?(j=lt/et,Math.abs(et)*Math.sqrt(1+j*j)):0}class Gr{constructor(et){et=jr.checkMatrix(et);let j=et.clone(),rt=et.rows,ot=et.columns,pt=new Float64Array(ot),kt,Et,Pt,Nt;for(Pt=0;Pt<ot;Pt++){let Xt=0;for(kt=Pt;kt<rt;kt++)Xt=Tr(Xt,j.get(kt,Pt));if(Xt!==0){for(j.get(Pt,Pt)<0&&(Xt=-Xt),kt=Pt;kt<rt;kt++)j.set(kt,Pt,j.get(kt,Pt)/Xt);for(j.set(Pt,Pt,j.get(Pt,Pt)+1),Et=Pt+1;Et<ot;Et++){for(Nt=0,kt=Pt;kt<rt;kt++)Nt+=j.get(kt,Pt)*j.get(kt,Et);for(Nt=-Nt/j.get(Pt,Pt),kt=Pt;kt<rt;kt++)j.set(kt,Et,j.get(kt,Et)+Nt*j.get(kt,Pt))}}pt[Pt]=-Xt}this.QR=j,this.Rdiag=pt}solve(et){et=ir.checkMatrix(et);let j=this.QR,rt=j.rows;if(et.rows!==rt)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let ot=et.columns,pt=et.clone(),kt=j.columns,Et,Pt,Nt,Xt;for(Nt=0;Nt<kt;Nt++)for(Pt=0;Pt<ot;Pt++){for(Xt=0,Et=Nt;Et<rt;Et++)Xt+=j.get(Et,Nt)*pt.get(Et,Pt);for(Xt=-Xt/j.get(Nt,Nt),Et=Nt;Et<rt;Et++)pt.set(Et,Pt,pt.get(Et,Pt)+Xt*j.get(Et,Nt))}for(Nt=kt-1;Nt>=0;Nt--){for(Pt=0;Pt<ot;Pt++)pt.set(Nt,Pt,pt.get(Nt,Pt)/this.Rdiag[Nt]);for(Et=0;Et<Nt;Et++)for(Pt=0;Pt<ot;Pt++)pt.set(Et,Pt,pt.get(Et,Pt)-pt.get(Nt,Pt)*j.get(Et,Nt))}return pt.subMatrix(0,kt-1,0,ot-1)}isFullRank(){let et=this.QR.columns;for(let j=0;j<et;j++)if(this.Rdiag[j]===0)return!1;return!0}get upperTriangularMatrix(){let et=this.QR,j=et.columns,rt=new ir(j,j),ot,pt;for(ot=0;ot<j;ot++)for(pt=0;pt<j;pt++)ot<pt?rt.set(ot,pt,et.get(ot,pt)):ot===pt?rt.set(ot,pt,this.Rdiag[ot]):rt.set(ot,pt,0);return rt}get orthogonalMatrix(){let et=this.QR,j=et.rows,rt=et.columns,ot=new ir(j,rt),pt,kt,Et,Pt;for(Et=rt-1;Et>=0;Et--){for(pt=0;pt<j;pt++)ot.set(pt,Et,0);for(ot.set(Et,Et,1),kt=Et;kt<rt;kt++)if(et.get(Et,Et)!==0){for(Pt=0,pt=Et;pt<j;pt++)Pt+=et.get(pt,Et)*ot.get(pt,kt);for(Pt=-Pt/et.get(Et,Et),pt=Et;pt<j;pt++)ot.set(pt,kt,ot.get(pt,kt)+Pt*et.get(pt,Et))}}return ot}}class xr{constructor(et,j={}){if(et=jr.checkMatrix(et),et.isEmpty())throw new Error("Matrix must be non-empty");let rt=et.rows,ot=et.columns;const{computeLeftSingularVectors:pt=!0,computeRightSingularVectors:kt=!0,autoTranspose:Et=!1}=j;let Pt=!!pt,Nt=!!kt,Xt=!1,Lt;if(rt<ot)if(!Et)Lt=et.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{Lt=et.transpose(),rt=Lt.rows,ot=Lt.columns,Xt=!0;let Vt=Pt;Pt=Nt,Nt=Vt}else Lt=et.clone();let rr=Math.min(rt,ot),dr=Math.min(rt+1,ot),Wt=new Float64Array(dr),ar=new ir(rt,rr),Mr=new ir(ot,ot),Ot=new Float64Array(ot),br=new Float64Array(rt),Pr=new Float64Array(dr);for(let Vt=0;Vt<dr;Vt++)Pr[Vt]=Vt;let Wr=Math.min(rt-1,ot),Zr=Math.max(0,Math.min(ot-2,rt)),en=Math.max(Wr,Zr);for(let Vt=0;Vt<en;Vt++){if(Vt<Wr){Wt[Vt]=0;for(let wr=Vt;wr<rt;wr++)Wt[Vt]=Tr(Wt[Vt],Lt.get(wr,Vt));if(Wt[Vt]!==0){Lt.get(Vt,Vt)<0&&(Wt[Vt]=-Wt[Vt]);for(let wr=Vt;wr<rt;wr++)Lt.set(wr,Vt,Lt.get(wr,Vt)/Wt[Vt]);Lt.set(Vt,Vt,Lt.get(Vt,Vt)+1)}Wt[Vt]=-Wt[Vt]}for(let wr=Vt+1;wr<ot;wr++){if(Vt<Wr&&Wt[Vt]!==0){let Ir=0;for(let kr=Vt;kr<rt;kr++)Ir+=Lt.get(kr,Vt)*Lt.get(kr,wr);Ir=-Ir/Lt.get(Vt,Vt);for(let kr=Vt;kr<rt;kr++)Lt.set(kr,wr,Lt.get(kr,wr)+Ir*Lt.get(kr,Vt))}Ot[wr]=Lt.get(Vt,wr)}if(Pt&&Vt<Wr)for(let wr=Vt;wr<rt;wr++)ar.set(wr,Vt,Lt.get(wr,Vt));if(Vt<Zr){Ot[Vt]=0;for(let wr=Vt+1;wr<ot;wr++)Ot[Vt]=Tr(Ot[Vt],Ot[wr]);if(Ot[Vt]!==0){Ot[Vt+1]<0&&(Ot[Vt]=0-Ot[Vt]);for(let wr=Vt+1;wr<ot;wr++)Ot[wr]/=Ot[Vt];Ot[Vt+1]+=1}if(Ot[Vt]=-Ot[Vt],Vt+1<rt&&Ot[Vt]!==0){for(let wr=Vt+1;wr<rt;wr++)br[wr]=0;for(let wr=Vt+1;wr<rt;wr++)for(let Ir=Vt+1;Ir<ot;Ir++)br[wr]+=Ot[Ir]*Lt.get(wr,Ir);for(let wr=Vt+1;wr<ot;wr++){let Ir=-Ot[wr]/Ot[Vt+1];for(let kr=Vt+1;kr<rt;kr++)Lt.set(kr,wr,Lt.get(kr,wr)+Ir*br[kr])}}if(Nt)for(let wr=Vt+1;wr<ot;wr++)Mr.set(wr,Vt,Ot[wr])}}let Xr=Math.min(ot,rt+1);if(Wr<ot&&(Wt[Wr]=Lt.get(Wr,Wr)),rt<Xr&&(Wt[Xr-1]=0),Zr+1<Xr&&(Ot[Zr]=Lt.get(Zr,Xr-1)),Ot[Xr-1]=0,Pt){for(let Vt=Wr;Vt<rr;Vt++){for(let wr=0;wr<rt;wr++)ar.set(wr,Vt,0);ar.set(Vt,Vt,1)}for(let Vt=Wr-1;Vt>=0;Vt--)if(Wt[Vt]!==0){for(let wr=Vt+1;wr<rr;wr++){let Ir=0;for(let kr=Vt;kr<rt;kr++)Ir+=ar.get(kr,Vt)*ar.get(kr,wr);Ir=-Ir/ar.get(Vt,Vt);for(let kr=Vt;kr<rt;kr++)ar.set(kr,wr,ar.get(kr,wr)+Ir*ar.get(kr,Vt))}for(let wr=Vt;wr<rt;wr++)ar.set(wr,Vt,-ar.get(wr,Vt));ar.set(Vt,Vt,1+ar.get(Vt,Vt));for(let wr=0;wr<Vt-1;wr++)ar.set(wr,Vt,0)}else{for(let wr=0;wr<rt;wr++)ar.set(wr,Vt,0);ar.set(Vt,Vt,1)}}if(Nt)for(let Vt=ot-1;Vt>=0;Vt--){if(Vt<Zr&&Ot[Vt]!==0)for(let wr=Vt+1;wr<ot;wr++){let Ir=0;for(let kr=Vt+1;kr<ot;kr++)Ir+=Mr.get(kr,Vt)*Mr.get(kr,wr);Ir=-Ir/Mr.get(Vt+1,Vt);for(let kr=Vt+1;kr<ot;kr++)Mr.set(kr,wr,Mr.get(kr,wr)+Ir*Mr.get(kr,Vt))}for(let wr=0;wr<ot;wr++)Mr.set(wr,Vt,0);Mr.set(Vt,Vt,1)}let Kr=Xr-1,rn=Number.EPSILON;for(;Xr>0;){let Vt,wr;for(Vt=Xr-2;Vt>=-1&&Vt!==-1;Vt--){const Ir=Number.MIN_VALUE+rn*Math.abs(Wt[Vt]+Math.abs(Wt[Vt+1]));if(Math.abs(Ot[Vt])<=Ir||Number.isNaN(Ot[Vt])){Ot[Vt]=0;break}}if(Vt===Xr-2)wr=4;else{let Ir;for(Ir=Xr-1;Ir>=Vt&&Ir!==Vt;Ir--){let kr=(Ir!==Xr?Math.abs(Ot[Ir]):0)+(Ir!==Vt+1?Math.abs(Ot[Ir-1]):0);if(Math.abs(Wt[Ir])<=rn*kr){Wt[Ir]=0;break}}Ir===Vt?wr=3:Ir===Xr-1?wr=1:(wr=2,Vt=Ir)}switch(Vt++,wr){case 1:{let Ir=Ot[Xr-2];Ot[Xr-2]=0;for(let kr=Xr-2;kr>=Vt;kr--){let an=Tr(Wt[kr],Ir),tn=Wt[kr]/an,nn=Ir/an;if(Wt[kr]=an,kr!==Vt&&(Ir=-nn*Ot[kr-1],Ot[kr-1]=tn*Ot[kr-1]),Nt)for(let sn=0;sn<ot;sn++)an=tn*Mr.get(sn,kr)+nn*Mr.get(sn,Xr-1),Mr.set(sn,Xr-1,-nn*Mr.get(sn,kr)+tn*Mr.get(sn,Xr-1)),Mr.set(sn,kr,an)}break}case 2:{let Ir=Ot[Vt-1];Ot[Vt-1]=0;for(let kr=Vt;kr<Xr;kr++){let an=Tr(Wt[kr],Ir),tn=Wt[kr]/an,nn=Ir/an;if(Wt[kr]=an,Ir=-nn*Ot[kr],Ot[kr]=tn*Ot[kr],Pt)for(let sn=0;sn<rt;sn++)an=tn*ar.get(sn,kr)+nn*ar.get(sn,Vt-1),ar.set(sn,Vt-1,-nn*ar.get(sn,kr)+tn*ar.get(sn,Vt-1)),ar.set(sn,kr,an)}break}case 3:{const Ir=Math.max(Math.abs(Wt[Xr-1]),Math.abs(Wt[Xr-2]),Math.abs(Ot[Xr-2]),Math.abs(Wt[Vt]),Math.abs(Ot[Vt])),kr=Wt[Xr-1]/Ir,an=Wt[Xr-2]/Ir,tn=Ot[Xr-2]/Ir,nn=Wt[Vt]/Ir,sn=Ot[Vt]/Ir,un=((an+kr)*(an-kr)+tn*tn)/2,dn=kr*tn*(kr*tn);let on=0;(un!==0||dn!==0)&&(un<0?on=0-Math.sqrt(un*un+dn):on=Math.sqrt(un*un+dn),on=dn/(un+on));let mn=(nn+kr)*(nn-kr)+on,pn=nn*sn;for(let Jr=Vt;Jr<Xr-1;Jr++){let hn=Tr(mn,pn);hn===0&&(hn=Number.MIN_VALUE);let cn=mn/hn,fn=pn/hn;if(Jr!==Vt&&(Ot[Jr-1]=hn),mn=cn*Wt[Jr]+fn*Ot[Jr],Ot[Jr]=cn*Ot[Jr]-fn*Wt[Jr],pn=fn*Wt[Jr+1],Wt[Jr+1]=cn*Wt[Jr+1],Nt)for(let ln=0;ln<ot;ln++)hn=cn*Mr.get(ln,Jr)+fn*Mr.get(ln,Jr+1),Mr.set(ln,Jr+1,-fn*Mr.get(ln,Jr)+cn*Mr.get(ln,Jr+1)),Mr.set(ln,Jr,hn);if(hn=Tr(mn,pn),hn===0&&(hn=Number.MIN_VALUE),cn=mn/hn,fn=pn/hn,Wt[Jr]=hn,mn=cn*Ot[Jr]+fn*Wt[Jr+1],Wt[Jr+1]=-fn*Ot[Jr]+cn*Wt[Jr+1],pn=fn*Ot[Jr+1],Ot[Jr+1]=cn*Ot[Jr+1],Pt&&Jr<rt-1)for(let ln=0;ln<rt;ln++)hn=cn*ar.get(ln,Jr)+fn*ar.get(ln,Jr+1),ar.set(ln,Jr+1,-fn*ar.get(ln,Jr)+cn*ar.get(ln,Jr+1)),ar.set(ln,Jr,hn)}Ot[Xr-2]=mn;break}case 4:{if(Wt[Vt]<=0&&(Wt[Vt]=Wt[Vt]<0?-Wt[Vt]:0,Nt))for(let Ir=0;Ir<=Kr;Ir++)Mr.set(Ir,Vt,-Mr.get(Ir,Vt));for(;Vt<Kr&&!(Wt[Vt]>=Wt[Vt+1]);){let Ir=Wt[Vt];if(Wt[Vt]=Wt[Vt+1],Wt[Vt+1]=Ir,Nt&&Vt<ot-1)for(let kr=0;kr<ot;kr++)Ir=Mr.get(kr,Vt+1),Mr.set(kr,Vt+1,Mr.get(kr,Vt)),Mr.set(kr,Vt,Ir);if(Pt&&Vt<rt-1)for(let kr=0;kr<rt;kr++)Ir=ar.get(kr,Vt+1),ar.set(kr,Vt+1,ar.get(kr,Vt)),ar.set(kr,Vt,Ir);Vt++}Xr--;break}}}if(Xt){let Vt=Mr;Mr=ar,ar=Vt}this.m=rt,this.n=ot,this.s=Wt,this.U=ar,this.V=Mr}solve(et){let j=et,rt=this.threshold,ot=this.s.length,pt=ir.zeros(ot,ot);for(let rr=0;rr<ot;rr++)Math.abs(this.s[rr])<=rt?pt.set(rr,rr,0):pt.set(rr,rr,1/this.s[rr]);let kt=this.U,Et=this.rightSingularVectors,Pt=Et.mmul(pt),Nt=Et.rows,Xt=kt.rows,Lt=ir.zeros(Nt,Xt);for(let rr=0;rr<Nt;rr++)for(let dr=0;dr<Xt;dr++){let Wt=0;for(let ar=0;ar<ot;ar++)Wt+=Pt.get(rr,ar)*kt.get(dr,ar);Lt.set(rr,dr,Wt)}return Lt.mmul(j)}solveForDiagonal(et){return this.solve(ir.diag(et))}inverse(){let et=this.V,j=this.threshold,rt=et.rows,ot=et.columns,pt=new ir(rt,this.s.length);for(let Xt=0;Xt<rt;Xt++)for(let Lt=0;Lt<ot;Lt++)Math.abs(this.s[Lt])>j&&pt.set(Xt,Lt,et.get(Xt,Lt)/this.s[Lt]);let kt=this.U,Et=kt.rows,Pt=kt.columns,Nt=new ir(rt,Et);for(let Xt=0;Xt<rt;Xt++)for(let Lt=0;Lt<Et;Lt++){let rr=0;for(let dr=0;dr<Pt;dr++)rr+=pt.get(Xt,dr)*kt.get(Lt,dr);Nt.set(Xt,Lt,rr)}return Nt}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let et=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,j=0,rt=this.s;for(let ot=0,pt=rt.length;ot<pt;ot++)rt[ot]>et&&j++;return j}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return ir.diag(this.s)}}function Br(lt,et=!1){return lt=jr.checkMatrix(lt),et?new xr(lt).inverse():At(lt,ir.eye(lt.rows))}function At(lt,et,j=!1){return lt=jr.checkMatrix(lt),et=jr.checkMatrix(et),j?new xr(lt).solve(et):lt.isSquare()?new $r(lt).solve(et):new Gr(lt).solve(et)}function ur(lt){if(lt=ir.checkMatrix(lt),lt.isSquare()){if(lt.columns===0)return 1;let et,j,rt,ot;if(lt.columns===2)return et=lt.get(0,0),j=lt.get(0,1),rt=lt.get(1,0),ot=lt.get(1,1),et*ot-j*rt;if(lt.columns===3){let pt,kt,Et;return pt=new Dr(lt,[1,2],[1,2]),kt=new Dr(lt,[1,2],[0,2]),Et=new Dr(lt,[1,2],[0,1]),et=lt.get(0,0),j=lt.get(0,1),rt=lt.get(0,2),et*ur(pt)-j*ur(kt)+rt*ur(Et)}else return new $r(lt).determinant}else throw Error("determinant can only be calculated for a square matrix")}function cr(lt,et){let j=[];for(let rt=0;rt<lt;rt++)rt!==et&&j.push(rt);return j}function yr(lt,et,j,rt=1e-9,ot=1e-9){if(lt>ot)return new Array(et.rows+1).fill(0);{let pt=et.addRow(j,[0]);for(let kt=0;kt<pt.rows;kt++)Math.abs(pt.get(kt,0))<rt&&pt.set(kt,0,0);return pt.to1DArray()}}function jt(lt,et={}){const{thresholdValue:j=1e-9,thresholdError:rt=1e-9}=et;lt=ir.checkMatrix(lt);let ot=lt.rows,pt=new ir(ot,ot);for(let kt=0;kt<ot;kt++){let Et=ir.columnVector(lt.getRow(kt)),Pt=lt.subMatrixRow(cr(ot,kt)).transpose(),Nt=new xr(Pt).solve(Et),Xt=ir.sub(Et,Pt.mmul(Nt)).abs().max();pt.setRow(kt,yr(Xt,Nt,kt,j,rt))}return pt}function lr(lt,et=Number.EPSILON){if(lt=ir.checkMatrix(lt),lt.isEmpty())return lt.transpose();let j=new xr(lt,{autoTranspose:!0}),rt=j.leftSingularVectors,ot=j.rightSingularVectors,pt=j.diagonal;for(let kt=0;kt<pt.length;kt++)Math.abs(pt[kt])>et?pt[kt]=1/pt[kt]:pt[kt]=0;return ot.mmul(ir.diag(pt).mmul(rt.transpose()))}function xt(lt,et=lt,j={}){lt=new ir(lt);let rt=!1;if(typeof et=="object"&&!ir.isMatrix(et)&&!s.isAnyArray(et)?(j=et,et=lt,rt=!0):et=new ir(et),lt.rows!==et.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:ot=!0}=j;ot&&(lt=lt.center("column"),rt||(et=et.center("column")));const pt=lt.transpose().mmul(et);for(let kt=0;kt<pt.rows;kt++)for(let Et=0;Et<pt.columns;Et++)pt.set(kt,Et,pt.get(kt,Et)*(1/(lt.rows-1)));return pt}function pr(lt,et=lt,j={}){lt=new ir(lt);let rt=!1;if(typeof et=="object"&&!ir.isMatrix(et)&&!s.isAnyArray(et)?(j=et,et=lt,rt=!0):et=new ir(et),lt.rows!==et.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:ot=!0,scale:pt=!0}=j;ot&&(lt.center("column"),rt||et.center("column")),pt&&(lt.scale("column"),rt||et.scale("column"));const kt=lt.standardDeviation("column",{unbiased:!0}),Et=rt?kt:et.standardDeviation("column",{unbiased:!0}),Pt=lt.transpose().mmul(et);for(let Nt=0;Nt<Pt.rows;Nt++)for(let Xt=0;Xt<Pt.columns;Xt++)Pt.set(Nt,Xt,Pt.get(Nt,Xt)*(1/(kt[Nt]*Et[Xt]))*(1/(lt.rows-1)));return Pt}class Yr{constructor(et,j={}){const{assumeSymmetric:rt=!1}=j;if(et=jr.checkMatrix(et),!et.isSquare())throw new Error("Matrix is not a square matrix");if(et.isEmpty())throw new Error("Matrix must be non-empty");let ot=et.columns,pt=new ir(ot,ot),kt=new Float64Array(ot),Et=new Float64Array(ot),Pt=et,Nt,Xt,Lt=!1;if(rt?Lt=!0:Lt=et.isSymmetric(),Lt){for(Nt=0;Nt<ot;Nt++)for(Xt=0;Xt<ot;Xt++)pt.set(Nt,Xt,Pt.get(Nt,Xt));mt(ot,Et,kt,pt),er(ot,Et,kt,pt)}else{let rr=new ir(ot,ot),dr=new Float64Array(ot);for(Xt=0;Xt<ot;Xt++)for(Nt=0;Nt<ot;Nt++)rr.set(Nt,Xt,Pt.get(Nt,Xt));sr(ot,rr,dr,pt),Mt(ot,Et,kt,pt,rr)}this.n=ot,this.e=Et,this.d=kt,this.V=pt}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let et=this.n,j=this.e,rt=this.d,ot=new ir(et,et),pt,kt;for(pt=0;pt<et;pt++){for(kt=0;kt<et;kt++)ot.set(pt,kt,0);ot.set(pt,pt,rt[pt]),j[pt]>0?ot.set(pt,pt+1,j[pt]):j[pt]<0&&ot.set(pt,pt-1,j[pt])}return ot}}function mt(lt,et,j,rt){let ot,pt,kt,Et,Pt,Nt,Xt,Lt;for(Pt=0;Pt<lt;Pt++)j[Pt]=rt.get(lt-1,Pt);for(Et=lt-1;Et>0;Et--){for(Lt=0,kt=0,Nt=0;Nt<Et;Nt++)Lt=Lt+Math.abs(j[Nt]);if(Lt===0)for(et[Et]=j[Et-1],Pt=0;Pt<Et;Pt++)j[Pt]=rt.get(Et-1,Pt),rt.set(Et,Pt,0),rt.set(Pt,Et,0);else{for(Nt=0;Nt<Et;Nt++)j[Nt]/=Lt,kt+=j[Nt]*j[Nt];for(ot=j[Et-1],pt=Math.sqrt(kt),ot>0&&(pt=-pt),et[Et]=Lt*pt,kt=kt-ot*pt,j[Et-1]=ot-pt,Pt=0;Pt<Et;Pt++)et[Pt]=0;for(Pt=0;Pt<Et;Pt++){for(ot=j[Pt],rt.set(Pt,Et,ot),pt=et[Pt]+rt.get(Pt,Pt)*ot,Nt=Pt+1;Nt<=Et-1;Nt++)pt+=rt.get(Nt,Pt)*j[Nt],et[Nt]+=rt.get(Nt,Pt)*ot;et[Pt]=pt}for(ot=0,Pt=0;Pt<Et;Pt++)et[Pt]/=kt,ot+=et[Pt]*j[Pt];for(Xt=ot/(kt+kt),Pt=0;Pt<Et;Pt++)et[Pt]-=Xt*j[Pt];for(Pt=0;Pt<Et;Pt++){for(ot=j[Pt],pt=et[Pt],Nt=Pt;Nt<=Et-1;Nt++)rt.set(Nt,Pt,rt.get(Nt,Pt)-(ot*et[Nt]+pt*j[Nt]));j[Pt]=rt.get(Et-1,Pt),rt.set(Et,Pt,0)}}j[Et]=kt}for(Et=0;Et<lt-1;Et++){if(rt.set(lt-1,Et,rt.get(Et,Et)),rt.set(Et,Et,1),kt=j[Et+1],kt!==0){for(Nt=0;Nt<=Et;Nt++)j[Nt]=rt.get(Nt,Et+1)/kt;for(Pt=0;Pt<=Et;Pt++){for(pt=0,Nt=0;Nt<=Et;Nt++)pt+=rt.get(Nt,Et+1)*rt.get(Nt,Pt);for(Nt=0;Nt<=Et;Nt++)rt.set(Nt,Pt,rt.get(Nt,Pt)-pt*j[Nt])}}for(Nt=0;Nt<=Et;Nt++)rt.set(Nt,Et+1,0)}for(Pt=0;Pt<lt;Pt++)j[Pt]=rt.get(lt-1,Pt),rt.set(lt-1,Pt,0);rt.set(lt-1,lt-1,1),et[0]=0}function er(lt,et,j,rt){let ot,pt,kt,Et,Pt,Nt,Xt,Lt,rr,dr,Wt,ar,Mr,Ot,br,Pr;for(kt=1;kt<lt;kt++)et[kt-1]=et[kt];et[lt-1]=0;let Wr=0,Zr=0,en=Number.EPSILON;for(Nt=0;Nt<lt;Nt++){for(Zr=Math.max(Zr,Math.abs(j[Nt])+Math.abs(et[Nt])),Xt=Nt;Xt<lt&&!(Math.abs(et[Xt])<=en*Zr);)Xt++;if(Xt>Nt)do{for(ot=j[Nt],Lt=(j[Nt+1]-ot)/(2*et[Nt]),rr=Tr(Lt,1),Lt<0&&(rr=-rr),j[Nt]=et[Nt]/(Lt+rr),j[Nt+1]=et[Nt]*(Lt+rr),dr=j[Nt+1],pt=ot-j[Nt],kt=Nt+2;kt<lt;kt++)j[kt]-=pt;for(Wr=Wr+pt,Lt=j[Xt],Wt=1,ar=Wt,Mr=Wt,Ot=et[Nt+1],br=0,Pr=0,kt=Xt-1;kt>=Nt;kt--)for(Mr=ar,ar=Wt,Pr=br,ot=Wt*et[kt],pt=Wt*Lt,rr=Tr(Lt,et[kt]),et[kt+1]=br*rr,br=et[kt]/rr,Wt=Lt/rr,Lt=Wt*j[kt]-br*ot,j[kt+1]=pt+br*(Wt*ot+br*j[kt]),Pt=0;Pt<lt;Pt++)pt=rt.get(Pt,kt+1),rt.set(Pt,kt+1,br*rt.get(Pt,kt)+Wt*pt),rt.set(Pt,kt,Wt*rt.get(Pt,kt)-br*pt);Lt=-br*Pr*Mr*Ot*et[Nt]/dr,et[Nt]=br*Lt,j[Nt]=Wt*Lt}while(Math.abs(et[Nt])>en*Zr);j[Nt]=j[Nt]+Wr,et[Nt]=0}for(kt=0;kt<lt-1;kt++){for(Pt=kt,Lt=j[kt],Et=kt+1;Et<lt;Et++)j[Et]<Lt&&(Pt=Et,Lt=j[Et]);if(Pt!==kt)for(j[Pt]=j[kt],j[kt]=Lt,Et=0;Et<lt;Et++)Lt=rt.get(Et,kt),rt.set(Et,kt,rt.get(Et,Pt)),rt.set(Et,Pt,Lt)}}function sr(lt,et,j,rt){let ot=0,pt=lt-1,kt,Et,Pt,Nt,Xt,Lt,rr;for(Lt=ot+1;Lt<=pt-1;Lt++){for(rr=0,Nt=Lt;Nt<=pt;Nt++)rr=rr+Math.abs(et.get(Nt,Lt-1));if(rr!==0){for(Pt=0,Nt=pt;Nt>=Lt;Nt--)j[Nt]=et.get(Nt,Lt-1)/rr,Pt+=j[Nt]*j[Nt];for(Et=Math.sqrt(Pt),j[Lt]>0&&(Et=-Et),Pt=Pt-j[Lt]*Et,j[Lt]=j[Lt]-Et,Xt=Lt;Xt<lt;Xt++){for(kt=0,Nt=pt;Nt>=Lt;Nt--)kt+=j[Nt]*et.get(Nt,Xt);for(kt=kt/Pt,Nt=Lt;Nt<=pt;Nt++)et.set(Nt,Xt,et.get(Nt,Xt)-kt*j[Nt])}for(Nt=0;Nt<=pt;Nt++){for(kt=0,Xt=pt;Xt>=Lt;Xt--)kt+=j[Xt]*et.get(Nt,Xt);for(kt=kt/Pt,Xt=Lt;Xt<=pt;Xt++)et.set(Nt,Xt,et.get(Nt,Xt)-kt*j[Xt])}j[Lt]=rr*j[Lt],et.set(Lt,Lt-1,rr*Et)}}for(Nt=0;Nt<lt;Nt++)for(Xt=0;Xt<lt;Xt++)rt.set(Nt,Xt,Nt===Xt?1:0);for(Lt=pt-1;Lt>=ot+1;Lt--)if(et.get(Lt,Lt-1)!==0){for(Nt=Lt+1;Nt<=pt;Nt++)j[Nt]=et.get(Nt,Lt-1);for(Xt=Lt;Xt<=pt;Xt++){for(Et=0,Nt=Lt;Nt<=pt;Nt++)Et+=j[Nt]*rt.get(Nt,Xt);for(Et=Et/j[Lt]/et.get(Lt,Lt-1),Nt=Lt;Nt<=pt;Nt++)rt.set(Nt,Xt,rt.get(Nt,Xt)+Et*j[Nt])}}}function Mt(lt,et,j,rt,ot){let pt=lt-1,kt=0,Et=lt-1,Pt=Number.EPSILON,Nt=0,Xt=0,Lt=0,rr=0,dr=0,Wt=0,ar=0,Mr=0,Ot,br,Pr,Wr,Zr,en,Xr,Kr,rn,Vt,wr,Ir,kr,an,tn;for(Ot=0;Ot<lt;Ot++)for((Ot<kt||Ot>Et)&&(j[Ot]=ot.get(Ot,Ot),et[Ot]=0),br=Math.max(Ot-1,0);br<lt;br++)Xt=Xt+Math.abs(ot.get(Ot,br));for(;pt>=kt;){for(Wr=pt;Wr>kt&&(Wt=Math.abs(ot.get(Wr-1,Wr-1))+Math.abs(ot.get(Wr,Wr)),Wt===0&&(Wt=Xt),!(Math.abs(ot.get(Wr,Wr-1))<Pt*Wt));)Wr--;if(Wr===pt)ot.set(pt,pt,ot.get(pt,pt)+Nt),j[pt]=ot.get(pt,pt),et[pt]=0,pt--,Mr=0;else if(Wr===pt-1){if(Xr=ot.get(pt,pt-1)*ot.get(pt-1,pt),Lt=(ot.get(pt-1,pt-1)-ot.get(pt,pt))/2,rr=Lt*Lt+Xr,ar=Math.sqrt(Math.abs(rr)),ot.set(pt,pt,ot.get(pt,pt)+Nt),ot.set(pt-1,pt-1,ot.get(pt-1,pt-1)+Nt),Kr=ot.get(pt,pt),rr>=0){for(ar=Lt>=0?Lt+ar:Lt-ar,j[pt-1]=Kr+ar,j[pt]=j[pt-1],ar!==0&&(j[pt]=Kr-Xr/ar),et[pt-1]=0,et[pt]=0,Kr=ot.get(pt,pt-1),Wt=Math.abs(Kr)+Math.abs(ar),Lt=Kr/Wt,rr=ar/Wt,dr=Math.sqrt(Lt*Lt+rr*rr),Lt=Lt/dr,rr=rr/dr,br=pt-1;br<lt;br++)ar=ot.get(pt-1,br),ot.set(pt-1,br,rr*ar+Lt*ot.get(pt,br)),ot.set(pt,br,rr*ot.get(pt,br)-Lt*ar);for(Ot=0;Ot<=pt;Ot++)ar=ot.get(Ot,pt-1),ot.set(Ot,pt-1,rr*ar+Lt*ot.get(Ot,pt)),ot.set(Ot,pt,rr*ot.get(Ot,pt)-Lt*ar);for(Ot=kt;Ot<=Et;Ot++)ar=rt.get(Ot,pt-1),rt.set(Ot,pt-1,rr*ar+Lt*rt.get(Ot,pt)),rt.set(Ot,pt,rr*rt.get(Ot,pt)-Lt*ar)}else j[pt-1]=Kr+Lt,j[pt]=Kr+Lt,et[pt-1]=ar,et[pt]=-ar;pt=pt-2,Mr=0}else{if(Kr=ot.get(pt,pt),rn=0,Xr=0,Wr<pt&&(rn=ot.get(pt-1,pt-1),Xr=ot.get(pt,pt-1)*ot.get(pt-1,pt)),Mr===10){for(Nt+=Kr,Ot=kt;Ot<=pt;Ot++)ot.set(Ot,Ot,ot.get(Ot,Ot)-Kr);Wt=Math.abs(ot.get(pt,pt-1))+Math.abs(ot.get(pt-1,pt-2)),Kr=rn=.75*Wt,Xr=-.4375*Wt*Wt}if(Mr===30&&(Wt=(rn-Kr)/2,Wt=Wt*Wt+Xr,Wt>0)){for(Wt=Math.sqrt(Wt),rn<Kr&&(Wt=-Wt),Wt=Kr-Xr/((rn-Kr)/2+Wt),Ot=kt;Ot<=pt;Ot++)ot.set(Ot,Ot,ot.get(Ot,Ot)-Wt);Nt+=Wt,Kr=rn=Xr=.964}for(Mr=Mr+1,Zr=pt-2;Zr>=Wr&&(ar=ot.get(Zr,Zr),dr=Kr-ar,Wt=rn-ar,Lt=(dr*Wt-Xr)/ot.get(Zr+1,Zr)+ot.get(Zr,Zr+1),rr=ot.get(Zr+1,Zr+1)-ar-dr-Wt,dr=ot.get(Zr+2,Zr+1),Wt=Math.abs(Lt)+Math.abs(rr)+Math.abs(dr),Lt=Lt/Wt,rr=rr/Wt,dr=dr/Wt,!(Zr===Wr||Math.abs(ot.get(Zr,Zr-1))*(Math.abs(rr)+Math.abs(dr))<Pt*(Math.abs(Lt)*(Math.abs(ot.get(Zr-1,Zr-1))+Math.abs(ar)+Math.abs(ot.get(Zr+1,Zr+1))))));)Zr--;for(Ot=Zr+2;Ot<=pt;Ot++)ot.set(Ot,Ot-2,0),Ot>Zr+2&&ot.set(Ot,Ot-3,0);for(Pr=Zr;Pr<=pt-1&&(an=Pr!==pt-1,Pr!==Zr&&(Lt=ot.get(Pr,Pr-1),rr=ot.get(Pr+1,Pr-1),dr=an?ot.get(Pr+2,Pr-1):0,Kr=Math.abs(Lt)+Math.abs(rr)+Math.abs(dr),Kr!==0&&(Lt=Lt/Kr,rr=rr/Kr,dr=dr/Kr)),Kr!==0);Pr++)if(Wt=Math.sqrt(Lt*Lt+rr*rr+dr*dr),Lt<0&&(Wt=-Wt),Wt!==0){for(Pr!==Zr?ot.set(Pr,Pr-1,-Wt*Kr):Wr!==Zr&&ot.set(Pr,Pr-1,-ot.get(Pr,Pr-1)),Lt=Lt+Wt,Kr=Lt/Wt,rn=rr/Wt,ar=dr/Wt,rr=rr/Lt,dr=dr/Lt,br=Pr;br<lt;br++)Lt=ot.get(Pr,br)+rr*ot.get(Pr+1,br),an&&(Lt=Lt+dr*ot.get(Pr+2,br),ot.set(Pr+2,br,ot.get(Pr+2,br)-Lt*ar)),ot.set(Pr,br,ot.get(Pr,br)-Lt*Kr),ot.set(Pr+1,br,ot.get(Pr+1,br)-Lt*rn);for(Ot=0;Ot<=Math.min(pt,Pr+3);Ot++)Lt=Kr*ot.get(Ot,Pr)+rn*ot.get(Ot,Pr+1),an&&(Lt=Lt+ar*ot.get(Ot,Pr+2),ot.set(Ot,Pr+2,ot.get(Ot,Pr+2)-Lt*dr)),ot.set(Ot,Pr,ot.get(Ot,Pr)-Lt),ot.set(Ot,Pr+1,ot.get(Ot,Pr+1)-Lt*rr);for(Ot=kt;Ot<=Et;Ot++)Lt=Kr*rt.get(Ot,Pr)+rn*rt.get(Ot,Pr+1),an&&(Lt=Lt+ar*rt.get(Ot,Pr+2),rt.set(Ot,Pr+2,rt.get(Ot,Pr+2)-Lt*dr)),rt.set(Ot,Pr,rt.get(Ot,Pr)-Lt),rt.set(Ot,Pr+1,rt.get(Ot,Pr+1)-Lt*rr)}}}if(Xt!==0){for(pt=lt-1;pt>=0;pt--)if(Lt=j[pt],rr=et[pt],rr===0)for(Wr=pt,ot.set(pt,pt,1),Ot=pt-1;Ot>=0;Ot--){for(Xr=ot.get(Ot,Ot)-Lt,dr=0,br=Wr;br<=pt;br++)dr=dr+ot.get(Ot,br)*ot.get(br,pt);if(et[Ot]<0)ar=Xr,Wt=dr;else if(Wr=Ot,et[Ot]===0?ot.set(Ot,pt,Xr!==0?-dr/Xr:-dr/(Pt*Xt)):(Kr=ot.get(Ot,Ot+1),rn=ot.get(Ot+1,Ot),rr=(j[Ot]-Lt)*(j[Ot]-Lt)+et[Ot]*et[Ot],en=(Kr*Wt-ar*dr)/rr,ot.set(Ot,pt,en),ot.set(Ot+1,pt,Math.abs(Kr)>Math.abs(ar)?(-dr-Xr*en)/Kr:(-Wt-rn*en)/ar)),en=Math.abs(ot.get(Ot,pt)),Pt*en*en>1)for(br=Ot;br<=pt;br++)ot.set(br,pt,ot.get(br,pt)/en)}else if(rr<0)for(Wr=pt-1,Math.abs(ot.get(pt,pt-1))>Math.abs(ot.get(pt-1,pt))?(ot.set(pt-1,pt-1,rr/ot.get(pt,pt-1)),ot.set(pt-1,pt,-(ot.get(pt,pt)-Lt)/ot.get(pt,pt-1))):(tn=Ut(0,-ot.get(pt-1,pt),ot.get(pt-1,pt-1)-Lt,rr),ot.set(pt-1,pt-1,tn[0]),ot.set(pt-1,pt,tn[1])),ot.set(pt,pt-1,0),ot.set(pt,pt,1),Ot=pt-2;Ot>=0;Ot--){for(Vt=0,wr=0,br=Wr;br<=pt;br++)Vt=Vt+ot.get(Ot,br)*ot.get(br,pt-1),wr=wr+ot.get(Ot,br)*ot.get(br,pt);if(Xr=ot.get(Ot,Ot)-Lt,et[Ot]<0)ar=Xr,dr=Vt,Wt=wr;else if(Wr=Ot,et[Ot]===0?(tn=Ut(-Vt,-wr,Xr,rr),ot.set(Ot,pt-1,tn[0]),ot.set(Ot,pt,tn[1])):(Kr=ot.get(Ot,Ot+1),rn=ot.get(Ot+1,Ot),Ir=(j[Ot]-Lt)*(j[Ot]-Lt)+et[Ot]*et[Ot]-rr*rr,kr=(j[Ot]-Lt)*2*rr,Ir===0&&kr===0&&(Ir=Pt*Xt*(Math.abs(Xr)+Math.abs(rr)+Math.abs(Kr)+Math.abs(rn)+Math.abs(ar))),tn=Ut(Kr*dr-ar*Vt+rr*wr,Kr*Wt-ar*wr-rr*Vt,Ir,kr),ot.set(Ot,pt-1,tn[0]),ot.set(Ot,pt,tn[1]),Math.abs(Kr)>Math.abs(ar)+Math.abs(rr)?(ot.set(Ot+1,pt-1,(-Vt-Xr*ot.get(Ot,pt-1)+rr*ot.get(Ot,pt))/Kr),ot.set(Ot+1,pt,(-wr-Xr*ot.get(Ot,pt)-rr*ot.get(Ot,pt-1))/Kr)):(tn=Ut(-dr-rn*ot.get(Ot,pt-1),-Wt-rn*ot.get(Ot,pt),ar,rr),ot.set(Ot+1,pt-1,tn[0]),ot.set(Ot+1,pt,tn[1]))),en=Math.max(Math.abs(ot.get(Ot,pt-1)),Math.abs(ot.get(Ot,pt))),Pt*en*en>1)for(br=Ot;br<=pt;br++)ot.set(br,pt-1,ot.get(br,pt-1)/en),ot.set(br,pt,ot.get(br,pt)/en)}for(Ot=0;Ot<lt;Ot++)if(Ot<kt||Ot>Et)for(br=Ot;br<lt;br++)rt.set(Ot,br,ot.get(Ot,br));for(br=lt-1;br>=kt;br--)for(Ot=kt;Ot<=Et;Ot++){for(ar=0,Pr=kt;Pr<=Math.min(br,Et);Pr++)ar=ar+rt.get(Ot,Pr)*ot.get(Pr,br);rt.set(Ot,br,ar)}}}function Ut(lt,et,j,rt){let ot,pt;return Math.abs(j)>Math.abs(rt)?(ot=rt/j,pt=j+ot*rt,[(lt+ot*et)/pt,(et-ot*lt)/pt]):(ot=j/rt,pt=rt+ot*j,[(ot*lt+et)/pt,(ot*et-lt)/pt])}class tr{constructor(et){if(et=jr.checkMatrix(et),!et.isSymmetric())throw new Error("Matrix is not symmetric");let j=et,rt=j.rows,ot=new ir(rt,rt),pt=!0,kt,Et,Pt;for(Et=0;Et<rt;Et++){let Nt=0;for(Pt=0;Pt<Et;Pt++){let Xt=0;for(kt=0;kt<Pt;kt++)Xt+=ot.get(Pt,kt)*ot.get(Et,kt);Xt=(j.get(Et,Pt)-Xt)/ot.get(Pt,Pt),ot.set(Et,Pt,Xt),Nt=Nt+Xt*Xt}for(Nt=j.get(Et,Et)-Nt,pt&&(pt=Nt>0),ot.set(Et,Et,Math.sqrt(Math.max(Nt,0))),Pt=Et+1;Pt<rt;Pt++)ot.set(Et,Pt,0)}this.L=ot,this.positiveDefinite=pt}isPositiveDefinite(){return this.positiveDefinite}solve(et){et=jr.checkMatrix(et);let j=this.L,rt=j.rows;if(et.rows!==rt)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let ot=et.columns,pt=et.clone(),kt,Et,Pt;for(Pt=0;Pt<rt;Pt++)for(Et=0;Et<ot;Et++){for(kt=0;kt<Pt;kt++)pt.set(Pt,Et,pt.get(Pt,Et)-pt.get(kt,Et)*j.get(Pt,kt));pt.set(Pt,Et,pt.get(Pt,Et)/j.get(Pt,Pt))}for(Pt=rt-1;Pt>=0;Pt--)for(Et=0;Et<ot;Et++){for(kt=Pt+1;kt<rt;kt++)pt.set(Pt,Et,pt.get(Pt,Et)-pt.get(kt,Et)*j.get(kt,Pt));pt.set(Pt,Et,pt.get(Pt,Et)/j.get(Pt,Pt))}return pt}get lowerTriangularMatrix(){return this.L}}class zr{constructor(et,j={}){et=jr.checkMatrix(et);let{Y:rt}=j;const{scaleScores:ot=!1,maxIterations:pt=1e3,terminationCriteria:kt=1e-10}=j;let Et;if(rt){if(s.isAnyArray(rt)&&typeof rt[0]=="number"?rt=ir.columnVector(rt):rt=jr.checkMatrix(rt),rt.rows!==et.rows)throw new Error("Y should have the same number of rows as X");Et=rt.getColumnVector(0)}else Et=et.getColumnVector(0);let Pt=1,Nt,Xt,Lt,rr;for(let dr=0;dr<pt&&Pt>kt;dr++)Lt=et.transpose().mmul(Et).div(Et.transpose().mmul(Et).get(0,0)),Lt=Lt.div(Lt.norm()),Nt=et.mmul(Lt).div(Lt.transpose().mmul(Lt).get(0,0)),dr>0&&(Pt=Nt.clone().sub(rr).pow(2).sum()),rr=Nt.clone(),rt?(Xt=rt.transpose().mmul(Nt).div(Nt.transpose().mmul(Nt).get(0,0)),Xt=Xt.div(Xt.norm()),Et=rt.mmul(Xt).div(Xt.transpose().mmul(Xt).get(0,0))):Et=Nt;if(rt){let dr=et.transpose().mmul(Nt).div(Nt.transpose().mmul(Nt).get(0,0));dr=dr.div(dr.norm());let Wt=et.clone().sub(Nt.clone().mmul(dr.transpose())),ar=Et.transpose().mmul(Nt).div(Nt.transpose().mmul(Nt).get(0,0)),Mr=rt.clone().sub(Nt.clone().mulS(ar.get(0,0)).mmul(Xt.transpose()));this.t=Nt,this.p=dr.transpose(),this.w=Lt.transpose(),this.q=Xt,this.u=Et,this.s=Nt.transpose().mmul(Nt),this.xResidual=Wt,this.yResidual=Mr,this.betas=ar}else this.w=Lt.transpose(),this.s=Nt.transpose().mmul(Nt).sqrt(),ot?this.t=Nt.clone().div(this.s.get(0,0)):this.t=Nt,this.xResidual=et.sub(Nt.mmul(Lt.transpose()))}}return matrix$1.AbstractMatrix=Kt,matrix$1.CHO=tr,matrix$1.CholeskyDecomposition=tr,matrix$1.DistanceMatrix=Fr,matrix$1.EVD=Yr,matrix$1.EigenvalueDecomposition=Yr,matrix$1.LU=$r,matrix$1.LuDecomposition=$r,matrix$1.Matrix=ir,matrix$1.MatrixColumnSelectionView=Qr,matrix$1.MatrixColumnView=vr,matrix$1.MatrixFlipColumnView=Or,matrix$1.MatrixFlipRowView=Cr,matrix$1.MatrixRowSelectionView=nr,matrix$1.MatrixRowView=Hr,matrix$1.MatrixSelectionView=Dr,matrix$1.MatrixSubView=qr,matrix$1.MatrixTransposeView=Nr,matrix$1.NIPALS=zr,matrix$1.Nipals=zr,matrix$1.QR=Gr,matrix$1.QrDecomposition=Gr,matrix$1.SVD=xr,matrix$1.SingularValueDecomposition=xr,matrix$1.SymmetricMatrix=Ur,matrix$1.WrapperMatrix1D=_r,matrix$1.WrapperMatrix2D=jr,matrix$1.correlation=pr,matrix$1.covariance=xt,matrix$1.default=ir,matrix$1.determinant=ur,matrix$1.inverse=Br,matrix$1.linearDependencies=jt,matrix$1.pseudoInverse=lr,matrix$1.solve=At,matrix$1.wrap=Ar,matrix$1}var matrixExports=requireMatrix();const matrix=getDefaultExportFromCjs(matrixExports),Matrix$1=matrixExports.Matrix,SVD=matrixExports.SVD,SingularValueDecomposition=matrixExports.SingularValueDecomposition;matrix.Matrix?matrix.Matrix:matrixExports.Matrix;const inverse=matrixExports.inverse,solve=matrixExports.solve;function getSeparatedKernel(e){const i=new SVD(e,{autoTranspose:!0});if(i.rank!==1)return null;const a=Math.sqrt(i.s[0]),s=i.U.to2DArray().map(h=>h[0]*a),o=i.V.to2DArray().map(h=>h[0]*a);return[s,o]}function convolution(e,i={}){let{channels:a,bitDepth:s,normalize:o=!1,divisor:h=1,border:d="copy",algorithm:g="auto"}=i,b={};s&&(b.bitDepth=s);let _=Image.createFrom(this,b);if(a=validateArrayOfChannels(this,a),g!=="separable")({kernel:e}=validateKernel(e));else if(!Array.isArray(e)||e.length!==2)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if(g==="auto"){let ct=getSeparatedKernel(e);ct!==null?(g="separable",e=ct):(e.length>9||e[0].length>9)&&this.width<=4096&&this.height<=4096?g="fft":g="direct"}let $,it;g==="separable"?($=Math.floor(e[0].length/2),it=Math.floor(e[1].length/2)):($=Math.floor(e.length/2),it=Math.floor(e[0].length/2));let nt=_.isClamped,tt=new Array(this.height*this.width),at,ut,ft,ht,dt,st;for(ht=0;ht<a.length;ht++){for(dt=a[ht],ft=0;ft<this.height;ft++)for(ut=0;ut<this.width;ut++)at=ft*this.width+ut,tt[at]=this.data[at*this.channels+dt];if(g==="direct")st=srcExports$1.direct(tt,e,{rows:this.height,cols:this.width,normalize:o,divisor:h});else if(g==="separable"){if(st=convolutionSeparable(tt,e,this.width,this.height),o){h=0;for(let ct=0;ct<e[0].length;ct++)for(let wt=0;wt<e[1].length;wt++)h+=e[0][ct]*e[1][wt]}if(h!==1)for(let ct=0;ct<st.length;ct++)st[ct]/=h}else st=srcExports$1.fft(tt,e,{rows:this.height,cols:this.width,normalize:o,divisor:h});for(ft=0;ft<this.height;ft++)for(ut=0;ut<this.width;ut++)at=ft*this.width+ut,nt?_.data[at*this.channels+dt]=clamp(st[at],_):_.data[at*this.channels+dt]=st[at]}if(this.alpha&&!a.includes(this.channels))for(ut=this.components;ut<this.data.length;ut=ut+this.channels)_.data[ut]=this.data[ut];return d!=="periodic"&&_.setBorder({size:[it,$],algorithm:d}),_}function gradientFilter(e={}){let{direction:i="xy",border:a="copy",kernelX:s,kernelY:o,channels:h,bitDepth:d=this.bitDepth}=e;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),i){case"x":if(!s)throw new Error("kernelX option is missing");return convolution.call(this,s,{channels:h,border:a,bitDepth:d});case"y":if(!o)throw new Error("kernelY option is missing");return convolution.call(this,o,{channels:h,border:a,bitDepth:d});case"xy":{if(!s)throw new Error("kernelX option is missing");if(!o)throw new Error("kernelY option is missing");const g=convolution.call(this,s,{channels:h,border:a,bitDepth:32}),b=convolution.call(this,o,{channels:h,border:a,bitDepth:32});return g.hypotenuse(b,{bitDepth:d,channels:h})}default:throw new Error(`Unknown parameter direction: ${i}`)}}function sobelFilter(e){return gradientFilter.call(this,Object.assign({},e,{kernelX:SOBEL_X,kernelY:SOBEL_Y}))}function scharrFilter(e){return gradientFilter.call(this,Object.assign({},e,{kernelX:SCHARR_X,kernelY:SCHARR_Y}))}var newArray_1,hasRequiredNewArray;function requireNewArray(){if(hasRequiredNewArray)return newArray_1;hasRequiredNewArray=1,newArray_1=e;function e(i,a){i=i||0;for(var s=new Array(i),o=0;o<i;o++)s[o]=a;return s}return newArray_1}var newArrayExports=requireNewArray();const newArray=getDefaultExportFromCjs(newArrayExports);function level(e={}){let{algorithm:i="range",channels:a,min:s=this.min,max:o=this.max}=e;switch(this.checkProcessable("level",{bitDepth:[8,16,32]}),a=validateArrayOfChannels(this,{channels:a}),a.length!==this.channel&&(Array.isArray(s)&&s.length===this.channels&&(s=s.filter((h,d)=>a.includes(d))),Array.isArray(o)&&o.length===this.channels&&(o=o.filter((h,d)=>a.includes(d)))),i){case"range":s<0&&(s=0),o>this.maxValue&&(o=this.maxValue),Array.isArray(s)||(s=newArray(a.length,s)),Array.isArray(o)||(o=newArray(a.length,o)),processImage(this,s,o,a);break;default:throw new Error(`level: algorithm not implement: ${i}`)}return this}function processImage(e,i,a,s){let o=1e-5,h=new Array(s.length);for(let d=0;d<s.length;d++)i[d]===0&&a[d]===e.maxValue||a[d]===i[d]?h[d]=0:h[d]=(e.maxValue+1-o)/(a[d]-i[d]),i[d]+=(.5-o/2)/h[d];for(let d=0;d<s.length;d++){let g=s[d];if(h[d]!==0)for(let b=0;b<e.data.length;b+=e.channels)e.data[b+g]=Math.min(Math.max(0,(e.data[b+g]-i[d])*h[d]+.5|0),e.maxValue)}}var isArrayType,hasRequiredIsArrayType;function requireIsArrayType(){if(hasRequiredIsArrayType)return isArrayType;hasRequiredIsArrayType=1;var e=Object.prototype.toString;return isArrayType=function(i){return e.call(i).substr(-6,5)==="Array"},isArrayType}var isArrayTypeExports=requireIsArrayType();const isArray=getDefaultExportFromCjs(isArrayTypeExports);function checkNumberArray(e){if(isNaN(e)){if(e instanceof Image)return e.data;if(!isArray(e))throw new Error("checkNumberArray: the value should be either a number, array or Image");return e}else{if(e<=0)throw new Error("checkNumberArray: the value must be greater than 0");return e}}function add(e,i={}){let{channels:a}=i;if(this.checkProcessable("add",{bitDepth:[8,16]}),a=validateArrayOfChannels(this,{channels:a}),e=checkNumberArray(e),isNaN(e)){if(this.data.length!==e.length)throw new Error("add: the data size is different");for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,Math.min(this.maxValue,this.data[h+o]+e[h+o]>>0))}}else for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.min(this.maxValue,this.data[h+o]+e>>0)}return this}function subtract(e,i={}){let{channels:a}=i;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),a=validateArrayOfChannels(this,{channels:a}),e=checkNumberArray(e),isNaN(e)){if(this.data.length!==e.length)throw new Error("subtract: the data size is different");for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,Math.min(this.maxValue,this.data[h+o]-e[h+o]>>0))}}else for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,this.data[h+o]-e>>0)}return this}function subtractImage(e,i={}){let{channels:a,absolute:s=!1}=i;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==e.width||this.height!==e.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==e.alpha||this.bitDepth!==e.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==e.channels)throw new Error("subtractImage: both images must have the same number of channels");let o=this.clone();a=validateArrayOfChannels(this,{channels:a});for(let h=0;h<a.length;h++){let d=a[h];for(let g=d;g<this.data.length;g+=this.channels){let b=this.data[g]-e.data[g];s?o.data[g]=Math.abs(b):o.data[g]=Math.max(b,0)}}return o}function hypotenuse(e,i={}){let{bitDepth:a=this.bitDepth,channels:s}=i;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==e.width||this.height!==e.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==e.alpha||this.bitDepth!==e.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==e.channels)throw new Error("hypotenuse: both images must have the same number of channels");let o=Image.createFrom(this,{bitDepth:a});s=validateArrayOfChannels(this,{channels:s});let h=o.isClamped;for(let d=0;d<s.length;d++){let g=s[d];for(let b=g;b<this.data.length;b+=this.channels){let _=Math.hypot(this.data[b],e.data[b]);h?o.data[b]=Math.min(Math.max(Math.round(_),0),o.maxValue):o.data[b]=_}}return o}function multiply(e,i={}){let{channels:a}=i;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),e<=0)throw new Error("multiply: the value must be greater than 0");if(a=validateArrayOfChannels(this,{channels:a}),e=checkNumberArray(e),isNaN(e)){if(this.data.length!==e.length)throw new Error("multiply: the data size is different");for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,Math.min(this.maxValue,this.data[h+o]*e[h+o]>>0))}}else for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.min(this.maxValue,this.data[h+o]*e>>0)}return this}function divide(e,i={}){let{channels:a}=i;if(this.checkProcessable("divide",{bitDepth:[8,16]}),a=validateArrayOfChannels(this,{channels:a}),e=checkNumberArray(e),isNaN(e)){if(this.data.length!==e.length)throw new Error("divide: the: the data size is different");for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.max(0,Math.min(this.maxValue,this.data[h+o]/e[h+o]>>0))}}else for(let s=0;s<a.length;s++){let o=a[s];for(let h=0;h<this.data.length;h+=this.channels)this.data[h+o]=Math.min(this.maxValue,this.data[h+o]/e>>0)}return this}class BaseRegression{constructor(){if(new.target===BaseRegression)throw new Error("BaseRegression must be subclassed")}predict(i){if(typeof i=="number")return this._predict(i);if(isAnyArray(i)){const a=[];for(let s=0;s<i.length;s++)a.push(this._predict(i[s]));return a}else throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(i,a){if(!isAnyArray(i)||!isAnyArray(a)||i.length!==a.length)throw new Error("x and y must be arrays of the same length");const s=i.length,o=new Array(s);for(let tt=0;tt<s;tt++)o[tt]=this._predict(i[tt]);let h=0,d=0,g=0,b=0,_=0,$=0,it=0;for(let tt=0;tt<s;tt++)h+=o[tt],d+=a[tt],_+=o[tt]*o[tt],$+=a[tt]*a[tt],it+=o[tt]*a[tt],a[tt]!==0&&(g+=(a[tt]-o[tt])*(a[tt]-o[tt])/a[tt]),b+=(a[tt]-o[tt])*(a[tt]-o[tt]);const nt=(s*it-h*d)/Math.sqrt((s*_-h*h)*(s*$-d*d));return{r:nt,r2:nt*nt,chi2:g,rmsd:Math.sqrt(b/s)}}}function squaredEuclidean(e,i){let a=0;for(let s=0;s<e.length;s++)a+=(e[s]-i[s])*(e[s]-i[s]);return a}function euclidean(e,i){return Math.sqrt(squaredEuclidean(e,i))}const euclidean$1=Object.freeze(Object.defineProperty({__proto__:null,euclidean,squaredEuclidean},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(euclidean$1);var gaussianKernel,hasRequiredGaussianKernel;function requireGaussianKernel(){if(hasRequiredGaussianKernel)return gaussianKernel;hasRequiredGaussianKernel=1;const{squaredEuclidean:e}=require$$0,i={sigma:1};class a{constructor(o){o=Object.assign({},i,o),this.sigma=o.sigma,this.divisor=2*o.sigma*o.sigma}compute(o,h){const d=e(o,h);return Math.exp(-d/this.divisor)}}return gaussianKernel=a,gaussianKernel}var polynomialKernel,hasRequiredPolynomialKernel;function requirePolynomialKernel(){if(hasRequiredPolynomialKernel)return polynomialKernel;hasRequiredPolynomialKernel=1;const e={degree:1,constant:1,scale:1};class i{constructor(s){s=Object.assign({},e,s),this.degree=s.degree,this.constant=s.constant,this.scale=s.scale}compute(s,o){for(var h=0,d=0;d<s.length;d++)h+=s[d]*o[d];return Math.pow(this.scale*h+this.constant,this.degree)}}return polynomialKernel=i,polynomialKernel}var sigmoidKernel,hasRequiredSigmoidKernel;function requireSigmoidKernel(){if(hasRequiredSigmoidKernel)return sigmoidKernel;hasRequiredSigmoidKernel=1;const e={alpha:.01,constant:-Math.E};class i{constructor(s){s=Object.assign({},e,s),this.alpha=s.alpha,this.constant=s.constant}compute(s,o){for(var h=0,d=0;d<s.length;d++)h+=s[d]*o[d];return Math.tanh(this.alpha*h+this.constant)}}return sigmoidKernel=i,sigmoidKernel}var anovaKernel,hasRequiredAnovaKernel;function requireAnovaKernel(){if(hasRequiredAnovaKernel)return anovaKernel;hasRequiredAnovaKernel=1;const e={sigma:1,degree:1};class i{constructor(s){s=Object.assign({},e,s),this.sigma=s.sigma,this.degree=s.degree}compute(s,o){for(var h=0,d=Math.min(s.length,o.length),g=1;g<=d;++g)h+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(s[g-1],g)-Math.pow(o[g-1],g),2)),this.degree);return h}}return anovaKernel=i,anovaKernel}var cauchyKernel,hasRequiredCauchyKernel;function requireCauchyKernel(){if(hasRequiredCauchyKernel)return cauchyKernel;hasRequiredCauchyKernel=1;const{squaredEuclidean:e}=require$$0,i={sigma:1};class a{constructor(o){o=Object.assign({},i,o),this.sigma=o.sigma}compute(o,h){return 1/(1+e(o,h)/(this.sigma*this.sigma))}}return cauchyKernel=a,cauchyKernel}var exponentialKernel,hasRequiredExponentialKernel;function requireExponentialKernel(){if(hasRequiredExponentialKernel)return exponentialKernel;hasRequiredExponentialKernel=1;const{euclidean:e}=require$$0,i={sigma:1};class a{constructor(o){o=Object.assign({},i,o),this.sigma=o.sigma,this.divisor=2*o.sigma*o.sigma}compute(o,h){const d=e(o,h);return Math.exp(-d/this.divisor)}}return exponentialKernel=a,exponentialKernel}var histogramIntersectionKernel,hasRequiredHistogramIntersectionKernel;function requireHistogramIntersectionKernel(){if(hasRequiredHistogramIntersectionKernel)return histogramIntersectionKernel;hasRequiredHistogramIntersectionKernel=1;class e{compute(a,s){for(var o=Math.min(a.length,s.length),h=0,d=0;d<o;++d)h+=Math.min(a[d],s[d]);return h}}return histogramIntersectionKernel=e,histogramIntersectionKernel}var laplacianKernel,hasRequiredLaplacianKernel;function requireLaplacianKernel(){if(hasRequiredLaplacianKernel)return laplacianKernel;hasRequiredLaplacianKernel=1;const{euclidean:e}=require$$0,i={sigma:1};class a{constructor(o){o=Object.assign({},i,o),this.sigma=o.sigma}compute(o,h){const d=e(o,h);return Math.exp(-d/this.sigma)}}return laplacianKernel=a,laplacianKernel}var multiquadraticKernel,hasRequiredMultiquadraticKernel;function requireMultiquadraticKernel(){if(hasRequiredMultiquadraticKernel)return multiquadraticKernel;hasRequiredMultiquadraticKernel=1;const{squaredEuclidean:e}=require$$0,i={constant:1};class a{constructor(o){o=Object.assign({},i,o),this.constant=o.constant}compute(o,h){return Math.sqrt(e(o,h)+this.constant*this.constant)}}return multiquadraticKernel=a,multiquadraticKernel}var rationalQuadraticKernel,hasRequiredRationalQuadraticKernel;function requireRationalQuadraticKernel(){if(hasRequiredRationalQuadraticKernel)return rationalQuadraticKernel;hasRequiredRationalQuadraticKernel=1;const{squaredEuclidean:e}=require$$0,i={constant:1};class a{constructor(o){o=Object.assign({},i,o),this.constant=o.constant}compute(o,h){const d=e(o,h);return 1-d/(d+this.constant)}}return rationalQuadraticKernel=a,rationalQuadraticKernel}var kernel,hasRequiredKernel;function requireKernel(){if(hasRequiredKernel)return kernel;hasRequiredKernel=1;const{Matrix:e,MatrixTransposeView:i}=requireMatrix(),a=requireGaussianKernel(),s=requirePolynomialKernel(),o=requireSigmoidKernel(),h=requireAnovaKernel(),d=requireCauchyKernel(),g=requireExponentialKernel(),b=requireHistogramIntersectionKernel(),_=requireLaplacianKernel(),$=requireMultiquadraticKernel(),it=requireRationalQuadraticKernel(),nt={gaussian:a,rbf:a,polynomial:s,poly:s,anova:h,cauchy:d,exponential:g,histogram:b,min:b,laplacian:_,multiquadratic:$,rational:it,sigmoid:o,mlp:o};class tt{constructor(ut,ft){if(this.kernelType=ut,ut!=="linear")if(typeof ut=="string"){ut=ut.toLowerCase();var ht=nt[ut];if(ht)this.kernelFunction=new ht(ft);else throw new Error(`unsupported kernel type: ${ut}`)}else if(typeof ut=="object"&&typeof ut.compute=="function")this.kernelFunction=ut;else throw new TypeError("first argument must be a valid kernel type or instance")}compute(ut,ft){if(ut=e.checkMatrix(ut),ft===void 0?ft=ut:ft=e.checkMatrix(ft),this.kernelType==="linear")return ut.mmul(new i(ft));const ht=new e(ut.rows,ft.rows);if(ut===ft)for(let dt=0;dt<ut.rows;dt++)for(let st=dt;st<ut.rows;st++){const ct=this.kernelFunction.compute(ut.getRow(dt),ut.getRow(st));ht.set(dt,st,ct),ht.set(st,dt,ct)}else for(let dt=0;dt<ut.rows;dt++)for(let st=0;st<ft.rows;st++)ht.set(dt,st,this.kernelFunction.compute(ut.getRow(dt),ft.getRow(st)));return ht}}return kernel=tt,kernel}var kernelExports=requireKernel();const Kernel=getDefaultExportFromCjs(kernelExports),defaultOptions$2={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class KernelRidgeRegression extends BaseRegression{constructor(i,a,s){if(super(),i===!0)this.alpha=a.alpha,this.inputs=a.inputs,this.kernelType=a.kernelType,this.kernelOptions=a.kernelOptions,this.kernel=new Kernel(a.kernelType,a.kernelOptions);else{i=Matrix$1.checkMatrix(i),s=Object.assign({},defaultOptions$2,s);const o=new Kernel(s.kernelType,s.kernelOptions),h=o.compute(i),d=i.rows;h.add(Matrix$1.eye(d,d).mul(s.lambda)),this.alpha=solve(h,a),this.inputs=i,this.kernelType=s.kernelType,this.kernelOptions=s.kernelOptions,this.kernel=o}}_predict(i){return this.kernel.compute([i],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(i){if(i.name!=="kernelRidgeRegression")throw new TypeError("not a KRR model");return new KernelRidgeRegression(!0,i)}}function background$1(e,i,a){const s=new KernelRidgeRegression(e,i,a),o=new Array(this.size);for(let g=0;g<this.width;g++)for(let b=0;b<this.height;b++)o[b*this.width+g]=[g,b];const h=s.predict(o),d=Image.createFrom(this);for(let g=0;g<this.size;g++)d.data[g]=Math.min(this.maxValue,Math.max(0,h[g][0]));return d}function dilate(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let s=!0;t:for(const h of i)for(const d of h)if(d!==1){s=!1;break t}let o=this;for(let h=0;h<a;h++)if(this.bitDepth===1)if(s){const d=o.clone();o=dilateOnceBinaryOnlyOnes(o,d,i.length,i[0].length)}else{const d=Image.createFrom(o);o=dilateOnceBinary(o,d,i)}else if(s){const d=Image.createFrom(o);o=dilateOnceGreyOnlyOnes(o,d,i.length,i[0].length)}else{const d=Image.createFrom(o);o=dilateOnceGrey(o,d,i)}return o}function dilateOnceGrey(e,i,a){const s=a.length,o=a[0].length;let h=(s-1)/2,d=(o-1)/2;for(let g=0;g<e.height;g++)for(let b=0;b<e.width;b++){let _=0;for(let $=0;$<o;$++)for(let it=0;it<s;it++){if(a[it][$]!==1)continue;let nt=it-h+b,tt=$-d+g;if(nt<0||tt<0||nt>=e.width||tt>=e.height)continue;const at=e.getValueXY(nt,tt,0);at>_&&(_=at)}i.setValueXY(b,g,0,_)}return i}function dilateOnceGreyOnlyOnes(e,i,a,s){const o=(a-1)/2,h=(s-1)/2,d=[];for(let g=0;g<e.width;g++)d.push(0);for(let g=0;g<e.height;g++){for(let b=0;b<e.width;b++){let _=0;for(let $=Math.max(0,g-h);$<Math.min(e.height,g+h+1);$++){const it=e.getValueXY(b,$,0);it>_&&(_=it)}d[b]=_}for(let b=0;b<e.width;b++){let _=0;for(let $=Math.max(0,b-o);$<Math.min(e.width,b+o+1);$++)d[$]>_&&(_=d[$]);i.setValueXY(b,g,0,_)}}return i}function dilateOnceBinary(e,i,a){const s=a.length,o=a[0].length;let h=(s-1)/2,d=(o-1)/2;for(let g=0;g<e.height;g++)for(let b=0;b<e.width;b++){let _=0;t:for(let $=0;$<o;$++)for(let it=0;it<s;it++){if(a[it][$]!==1)continue;let nt=it-h+b,tt=$-d+g;if(!(tt<0||nt<0||nt>=e.width||tt>=e.height)&&e.getBitXY(nt,tt)===1){_=1;break t}}_===1&&i.setBitXY(b,g)}return i}function dilateOnceBinaryOnlyOnes(e,i,a,s){const o=(a-1)/2,h=(s-1)/2,d=[];for(let g=0;g<e.width;g++)d.push(1);for(let g=0;g<e.height;g++){for(let b=0;b<e.width;b++){d[b]=0;for(let _=Math.max(0,g-h);_<Math.min(e.height,g+h+1);_++)if(e.getBitXY(b,_)===1){d[b]=1;break}}for(let b=0;b<e.width;b++)if(i.getBitXY(b,g)!==1){for(let _=Math.max(0,b-o);_<Math.min(e.width,b+o+1);_++)if(d[_]===1){i.setBitXY(b,g);break}}}return i}function erode(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let s=!0;t:for(const h of i)for(const d of h)if(d!==1){s=!1;break t}let o=this;for(let h=0;h<a;h++)if(this.bitDepth===1)if(s){const d=o.clone();o=erodeOnceBinaryOnlyOnes(o,d,i.length,i[0].length)}else{const d=Image.createFrom(o);o=erodeOnceBinary(o,d,i)}else if(s){const d=Image.createFrom(o);o=erodeOnceGreyOnlyOnes(o,d,i.length,i[0].length)}else{const d=Image.createFrom(o);o=erodeOnceGrey(o,d,i)}return o}function erodeOnceGrey(e,i,a){const s=a.length,o=a[0].length;let h=(s-1)/2,d=(o-1)/2;for(let g=0;g<e.height;g++)for(let b=0;b<e.width;b++){let _=e.maxValue;for(let $=0;$<o;$++)for(let it=0;it<s;it++){if(a[it][$]!==1)continue;let nt=it-h+b,tt=$-d+g;if(nt<0||tt<0||nt>=e.width||tt>=e.height)continue;const at=e.getValueXY(nt,tt,0);at<_&&(_=at)}i.setValueXY(b,g,0,_)}return i}function erodeOnceGreyOnlyOnes(e,i,a,s){const o=(a-1)/2,h=(s-1)/2,d=[];for(let g=0;g<e.width;g++)d.push(0);for(let g=0;g<e.height;g++){for(let b=0;b<e.width;b++){let _=e.maxValue;for(let $=Math.max(0,g-h);$<Math.min(e.height,g+h+1);$++){const it=e.getValueXY(b,$,0);it<_&&(_=it)}d[b]=_}for(let b=0;b<e.width;b++){let _=e.maxValue;for(let $=Math.max(0,b-o);$<Math.min(e.width,b+o+1);$++)d[$]<_&&(_=d[$]);i.setValueXY(b,g,0,_)}}return i}function erodeOnceBinary(e,i,a){const s=a.length,o=a[0].length;let h=(s-1)/2,d=(o-1)/2;for(let g=0;g<e.height;g++)for(let b=0;b<e.width;b++){let _=1;t:for(let $=0;$<o;$++)for(let it=0;it<s;it++){if(a[it][$]!==1)continue;let nt=it-h+b,tt=$-d+g;if(!(tt<0||nt<0||nt>=e.width||tt>=e.height)&&e.getBitXY(nt,tt)===0){_=0;break t}}_===1&&i.setBitXY(b,g)}return i}function erodeOnceBinaryOnlyOnes(e,i,a,s){const o=(a-1)/2,h=(s-1)/2,d=[];for(let g=0;g<e.width;g++)d.push(0);for(let g=0;g<e.height;g++){for(let b=0;b<e.width;b++){d[b]=1;for(let _=Math.max(0,g-h);_<Math.min(e.height,g+h+1);_++)if(e.getBitXY(b,_)===0){d[b]=0;break}}for(let b=0;b<e.width;b++)if(i.getBitXY(b,g)!==0){for(let _=Math.max(0,b-o);_<Math.min(e.width,b+o+1);_++)if(d[_]===0){i.clearBitXY(b,g);break}}}return i}function open(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++)s=s.erode({kernel:i}),s=s.dilate({kernel:i});return s}function close(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++)s=s.dilate({kernel:i}).erode({kernel:i});return s}function topHat(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),i.length%2===0||i[0].length%2===0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++)s=s.open({kernel:i}).subtractImage(s,{absolute:!0});return s}function blackHat(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++)s=s.close({kernel:i}).subtractImage(s,{absolute:!0});return s}function morphologicalGradient(e={}){let{kernel:i=[[1,1,1],[1,1,1],[1,1,1]],iterations:a=1}=e;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),i.columns%2===0||i.rows%2===0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let s=this;for(let o=0;o<a;o++){let h=s.dilate({kernel:i}),d=s.erode({kernel:i});s=h.subtractImage(d,{absolute:!0})}return s}function order4Points(e){let i=0,a=0,s=0,o=0,h=e[0][0],d=0;for(let _=1;_<e.length;_++)e[_][0]<h&&(h=e[_][0],d=_);let g=e[(d+1)%e.length][0],b=(d+1)%e.length;for(let _=1;_<e.length;_++)e[_][0]<g&&_!==d&&(g=e[_][0],b=_);return e[b][1]<e[d][1]?(i=e[b],o=e[d],d!==(b+1)%4?(a=e[(b+1)%4],s=e[(b+2)%4]):(a=e[(b+2)%4],s=e[(b+3)%4])):(o=e[b],i=e[d],b!==(d+1)%4?(a=e[(d+1)%4],s=e[(d+2)%4]):(a=e[(d+2)%4],s=e[(d+3)%4])),[i,a,s,o]}function distance2Points(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function crossVect(e,i){return[e[1]*i[2]-e[2]*i[1],e[2]*i[0]-e[0]*i[2],e[0]*i[1]-e[1]*i[0]]}function dotVect(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]}function computeWidthAndHeigth(e,i,a,s,o,h){let d=Math.max(distance2Points(e,i),distance2Points(s,a)),g=Math.max(distance2Points(e,s),distance2Points(i,a)),b=0,_=0,$=Math.ceil(o/2),it=Math.ceil(h/2),nt=d/g,tt=[e[0],e[1],1],at=[i[0],i[1],1],ut=[s[0],s[1],1],ft=[a[0],a[1],1],ht=dotVect(crossVect(tt,ft),ut)/dotVect(crossVect(at,ft),ut),dt=dotVect(crossVect(tt,ft),at)/dotVect(crossVect(ut,ft),at),st=[ht*at[0]-tt[0],ht*at[1]-tt[1],ht*at[2]-tt[2]],ct=[dt*ut[0]-tt[0],dt*ut[1]-tt[1],dt*ut[2]-tt[2]],wt=st[0],_t=st[1],gt=st[2],yt=ct[0],bt=ct[1],vt=ct[2],Ct=1/(gt*vt)*(wt*yt-(wt*vt+gt*yt)*$+gt*vt*$*$+(_t*bt-(_t*vt+gt*bt)*it+gt*vt*it*it));Ct>=0?Ct=Math.sqrt(Ct):Ct=Math.sqrt(-Ct);let Ht=new Matrix$1([[Ct,0,$],[0,Ct,it],[0,0,1]]),Ft=Ht.transpose(),qt=inverse(Ft),zt=inverse(Ht),Qt=Matrix$1.rowVector(st),_e=Matrix$1.rowVector(ct),Gt=Math.sqrt(dotVect(Qt.mmul(qt).mmul(zt).to1DArray(),st)/dotVect(_e.mmul(qt).mmul(zt).to1DArray(),ct));return Gt===0||nt===0?(b=Math.ceil(d),_=Math.ceil(g)):Gt<nt?(b=Math.ceil(d),_=Math.ceil(b/Gt)):(_=Math.ceil(g),b=Math.ceil(Gt*_)),[b,_]}function projectionPoint(e,i,a,s,o,h,d,g,b,_,$,it){let[nt,tt]=[(a*e+s*i+o)/(b*e+_*i+1),(h*e+d*i+g)/(b*e+_*i+1)];return $.getValueXY(Math.floor(nt),Math.floor(tt),it)}function warpingFourPoints(e,i={}){let{calculateRatio:a=!0}=i;if(e.length!==4)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${e.length} elements`);let[s,o,h,d]=e,g=[s,o,h,d],[b,_,$,it]=order4Points(g),nt,tt;a?[nt,tt]=computeWidthAndHeigth(b,_,$,it,this.width,this.height):(nt=Math.ceil(Math.max(distance2Points(b,_),distance2Points(it,$))),tt=Math.ceil(Math.max(distance2Points(b,it),distance2Points(_,$))));let at=Image.createFrom(this,{width:nt,height:tt}),[ut,ft]=b,[ht,dt]=_,[st,ct]=$,[wt,_t]=it,[gt,yt]=[0,0],[bt,vt]=[0,nt-1],[Ct,Ht]=[tt-1,nt-1],[Ft,qt]=[tt-1,0],zt=new Matrix$1([[gt,yt,1,0,0,0,-gt*ut,-yt*ut],[bt,vt,1,0,0,0,-bt*ht,-vt*ht],[Ct,Ht,1,0,0,0,-Ct*st,-yt*st],[Ft,qt,1,0,0,0,-Ft*wt,-qt*wt],[0,0,0,gt,yt,1,-gt*ft,-yt*ft],[0,0,0,bt,vt,1,-bt*dt,-vt*dt],[0,0,0,Ct,Ht,1,-Ct*ct,-Ht*ct],[0,0,0,Ft,qt,1,-Ft*_t,-qt*_t]]),Qt=Matrix$1.columnVector([ut,ht,st,wt,ft,dt,ct,_t]),_e=new SingularValueDecomposition(zt).solve(Qt),[Gt,Jt,or,mr,hr,Lr,Er,Kt]=_e.to1DArray(),fr=new Matrix$1(tt,nt);for(let Rr=0;Rr<this.channels;Rr++){for(let gr=0;gr<tt;gr++)for(let ir=0;ir<nt;ir++)fr.set(gr,ir,projectionPoint(gr,ir,Gt,Jt,or,mr,hr,Lr,Er,Kt,this,Rr));at.setMatrix(fr,{channel:Rr})}return at}function crop(e={}){let{x:i=0,y:a=0,width:s=this.width-i,height:o=this.height-a}=e;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),i=Math.round(i),a=Math.round(a),s=Math.round(s),o=Math.round(o),i>this.width-1||a>this.height-1)throw new RangeError(`crop: origin (x:${i}, y:${a}) out of range (${this.width-1}; ${this.height-1})`);if(s<=0||o<=0)throw new RangeError(`crop: width and height (width:${s}; height:${o}) must be positive numbers`);if(i<0||a<0)throw new RangeError(`crop: x and y (x:${i}, y:${a}) must be positive numbers`);if(s>this.width-i||o>this.height-a)throw new RangeError(`crop: (x: ${i}, y:${a}, width:${s}, height:${o}) size is out of range`);let h=this;if(this.bitDepth===1){const d=new Image(s,o,{kind:"BINARY",parent:this});h=cropBinary(this,d,i,a,s,o)}else{const d=Image.createFrom(this,{width:s,height:o,position:[i,a]});h=cropDefault(this,d,i,a,s,o)}return h}function cropDefault(e,i,a,s,o,h){let d=o*e.channels,g=s+h,b=0,_=a*e.channels;for(let $=s;$<g;$++){let it=$*e.width*e.channels+_,nt=it+d;for(;it<nt;it++)i.data[b++]=e.data[it]}return i}function cropBinary(e,i,a,s,o,h){let d=o*e.channels,g=s+h,b=0,_=a*e.channels;for(let $=s;$<g;$++){let it=$*e.width*e.channels+_,nt=it+d;for(;it<nt;it++)e.getBit(it)&&i.setBit(b),++b}return i}function cropAlpha(e={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:i=this.maxValue}=e;let a=findLeft(this,i,this.components);if(a===-1)throw new Error("Could not find new dimensions. Threshold may be too high.");let s=findTop(this,i,this.components,a),o=findBottom(this,i,this.components,a),h=findRight(this,i,this.components,a,s,o);return this.crop({x:a,y:s,width:h-a+1,height:o-s+1})}function findLeft(e,i,a){for(let s=0;s<e.width;s++)for(let o=0;o<e.height;o++)if(e.getValueXY(s,o,a)>=i)return s;return-1}function findTop(e,i,a,s){for(let o=0;o<e.height;o++)for(let h=s;h<e.width;h++)if(e.getValueXY(h,o,a)>=i)return o;return-1}function findBottom(e,i,a,s){for(let o=e.height-1;o>=0;o--)for(let h=s;h<e.width;h++)if(e.getValueXY(h,o,a)>=i)return o;return-1}function findRight(e,i,a,s,o,h){for(let d=e.width-1;d>=s;d--)for(let g=o;g<=h;g++)if(e.getValueXY(d,g,a)>=i)return d;return-1}function getFactor(e){if(typeof e=="string"){const i=e[e.length-1];e=parseFloat(e),i==="%"&&(e/=100)}return e}function getThreshold$1(e,i){if(!i)throw Error("getThreshold : the maxValue should be specified");if(typeof e=="string"){if(e[e.length-1]!=="%")throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(e)/100*i}else{if(typeof e=="number")return e<1?e*i:e;throw Error("getThreshold : the value is not valid")}}function factorDimensions(e,i,a){e=getFactor(e);let s=Math.round(e*i),o=Math.round(e*a);return s<=0&&(s=1),o<=0&&(o=1),{width:s,height:o}}function checkRow(e,i){if(i<0||i>=e.height)throw new RangeError(`row must be included between 0 and ${e.height-1}. Current value: ${i}`)}function checkColumn(e,i){if(i<0||i>=e.width)throw new RangeError(`column must be included between 0 and ${e.width-1}. Current value: ${i}`)}function checkChannel(e,i){if(i<0||i>=e.channels)throw new RangeError(`channel must be included between 0 and ${e.channels-1}. Current value: ${i}`)}const validInterpolations={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function checkInterpolation(e){if(typeof e!="string")throw new TypeError("interpolation must be a string");if(e=e.toLowerCase(),!validInterpolations[e])throw new RangeError(`invalid interpolation algorithm: ${e}`);return validInterpolations[e]}function nearestNeighbor(e,i,a){const s=this.width/i,o=this.height/a;if(this.bitDepth>1)for(let h=0;h<i;h++){const d=Math.floor((h+.5)*s);for(let g=0;g<a;g++){const b=Math.floor((g+.5)*o);for(let _=0;_<this.channels;_++)e.setValueXY(h,g,_,this.getValueXY(d,b,_))}}else for(let h=0;h<i;h++){const d=Math.floor((h+.5)*s);for(let g=0;g<a;g++){const b=Math.floor((g+.5)*o);this.getBitXY(d,b)&&e.setBitXY(h,g)}}}function resize(e={}){const{factor:i=1,interpolation:a=validInterpolations.nearestneighbor,preserveAspectRatio:s=!0}=e,o=checkInterpolation(a);let h=e.width,d=e.height;if(h||(d&&s?h=Math.round(d*(this.width/this.height)):h=this.width),d||(s?d=Math.round(h*(this.height/this.width)):d=this.height),{width:h,height:d}=factorDimensions(i,h,d),h===this.width&&d===this.height){const $=this.clone();return $.position=[0,0],$}let g=Math.round((this.width-h)/2),b=Math.round((this.height-d)/2);const _=Image.createFrom(this,{width:h,height:d,position:[g,b]});switch(o){case validInterpolations.nearestneighbor:nearestNeighbor.call(this,_,h,d);break;default:throw new Error(`unsupported resize interpolation: ${o}`)}return _}function hsv(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let e=Image.createFrom(this,{colorModel:HSV}),i=0,a=this.data;for(let s=0;s<a.length;s+=this.channels){let o=a[s],h=a[s+1],d=a[s+2],g=Math.min(o,h,d),b=Math.max(o,h,d),_=b-g,$=0,it=b===0?0:_/b,nt=b;if(b!==g){switch(b){case o:$=(h-d)/_+(h<d?6:0);break;case h:$=(d-o)/_+2;break;case d:$=(o-h)/_+4;break;default:throw new Error("unreachable")}$/=6}e.data[i++]=$*this.maxValue,e.data[i++]=it*this.maxValue,e.data[i++]=nt,this.alpha&&(e.data[i++]=a[s+3])}return e}function hsl$1(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let e=Image.createFrom(this,{colorModel:HSL}),i=Math.floor(this.maxValue/2),a=0,s=this.data;for(let o=0;o<s.length;o+=this.channels){let h=s[o],d=s[o+1],g=s[o+2],b=Math.max(h,d,g),_=Math.min(h,d,g),$=0,it=0,nt=(b+_)/2;if(b!==_){let tt=b-_;switch(it=nt>i?tt/(2-b-_):tt/(b+_),b){case h:$=(d-g)/tt+(d<g?6:0);break;case d:$=(g-h)/tt+2;break;case g:$=(h-d)/tt+4;break;default:throw new Error("unreachable")}$/=6}e.data[a++]=$*this.maxValue,e.data[a++]=it*this.maxValue,e.data[a++]=nt,this.alpha&&(e.data[a++]=s[o+3])}return e}function cmyk(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[RGB$1]});let e=Image.createFrom(this,{components:4,colorModel:CMYK$1}),i=0,a=this.data;for(let s=0;s<a.length;s+=this.channels){let o=a[s],h=a[s+1],d=a[s+2],g=Math.min(this.maxValue-o,this.maxValue-h,this.maxValue-d),b=(this.maxValue-o-g)/(1-g/this.maxValue),_=(this.maxValue-h-g)/(1-g/this.maxValue),$=(this.maxValue-d-g)/(1-g/this.maxValue);e.data[i++]=Math.round(b),e.data[i++]=Math.round(_),e.data[i++]=Math.round($),e.data[i++]=Math.round(g),this.alpha&&(e.data[i++]=a[s+3])}return e}function rgba8(){return new Image(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const methods$1={luma709(e,i,a){return e*6966+i*23436+a*2366>>15},luma601(e,i,a){return e*9798+i*19235+a*3735>>15},maximum(e,i,a){return Math.max(e,i,a)},minimum(e,i,a){return Math.min(e,i,a)},average(e,i,a){return(e+i+a)/3>>0},minmax(e,i,a){return(Math.max(e,i,a)+Math.min(e,i,a))/2},red(e){return e},green(e,i){return i},blue(e,i,a){return a},cyan(e,i,a,s){let o=methods$1.black(e,i,a,s);return(s.maxValue-e-o)/(1-o/s.maxValue)>>0},magenta(e,i,a,s){let o=methods$1.black(e,i,a,s);return(s.maxValue-i-o)/(1-o/s.maxValue)>>0},yellow(e,i,a,s){let o=methods$1.black(e,i,a,s);return(s.maxValue-a-o)/(1-o/s.maxValue)>>0},black(e,i,a,s){return Math.min(s.maxValue-e,s.maxValue-i,s.maxValue-a)},hue(e,i,a,s){let o=methods$1.min(e,i,a),h=methods$1.max(e,i,a);if(h===o)return 0;let d=0,g=h-o;switch(h){case e:d=(i-a)/g+(i<a?6:0);break;case i:d=(a-e)/g+2;break;case a:d=(e-i)/g+4;break;default:throw new Error("unreachable")}return d/6*s.maxValue>>0},saturation(e,i,a,s){let o=methods$1.min(e,i,a),h=methods$1.max(e,i,a),d=h-o;return h===0?0:d/h*s.maxValue},lightness(e,i,a){let s=methods$1.min(e,i,a);return(methods$1.max(e,i,a)+s)/2}};Object.defineProperty(methods$1,"luminosity",{enumerable:!1,value:methods$1.lightness});Object.defineProperty(methods$1,"luminance",{enumerable:!1,value:methods$1.lightness});Object.defineProperty(methods$1,"min",{enumerable:!1,value:methods$1.minimum});Object.defineProperty(methods$1,"max",{enumerable:!1,value:methods$1.maximum});Object.defineProperty(methods$1,"brightness",{enumerable:!1,value:methods$1.maximum});Object.keys(methods$1).forEach(e=>{});function grey(e={}){let{algorithm:i="luma709",keepAlpha:a=!1,mergeAlpha:s=!0}=e;if(typeof i!="string"&&typeof i!="function")throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),this.components===1&&(i="red"),a&=this.alpha,s&=this.alpha,a&&(s=!1);let o=getOutputImage(this,e,{components:1,alpha:a,colorModel:GREY$1}),h;if(typeof i=="function")h=i;else if(h=methods$1[i.toLowerCase()],!h)throw new Error(`unsupported grey algorithm: ${i}`);let d=0;for(let g=0;g<this.data.length;g+=this.channels)s?o.data[d++]=clamp(h(this.data[g],this.data[g+1],this.data[g+2],this)*this.data[g+this.components]/this.maxValue,this):(o.data[d++]=clamp(h(this.data[g],this.data[g+1],this.data[g+2],this),this),o.alpha&&(o.data[d++]=this.data[g+this.components]));return o}function huang(e){let i=0;for(let $=0;$<e.length;$++)if(e[$]!==0){i=$;break}let a=e.length-1;for(let $=e.length-1;$>=i;$--)if(e[$]!==0){a=$;break}let s=1/(a-i),o=new Array(e.length),h=0,d=0;for(let $=i;$<e.length;$++)h+=$*e[$],d+=e[$],o[$]=h/d;let g=new Array(e.length);h=d=0;for(let $=a;$>0;$--)h+=$*e[$],d+=e[$],g[$-1]=h/d;let b=-1,_=Number.MAX_VALUE;for(let $=0;$<e.length;$++){let it=0,nt;for(let tt=0;tt<=$;tt++)nt=1/(1+s*Math.abs(tt-o[$])),nt<1e-6||nt>.999999||(it+=e[tt]*(-nt*Math.log(nt)-(1-nt)*Math.log(1-nt)));for(let tt=$+1;tt<e.length;tt++)nt=1/(1+s*Math.abs(tt-g[$])),nt<1e-6||nt>.999999||(it+=e[tt]*(-nt*Math.log(nt)-(1-nt)*Math.log(1-nt)));it<_&&(_=it,b=$)}return b}function intermodes(e){let i=e.slice(),a=0;for(;!bimodalTest$1(i);){let o=0,h=0,d=i[0];for(let g=0;g<e.length-1;g++)o=h,h=d,d=i[g+1],i[g]=(o+h+d)/3;if(i[e.length-1]=(h+d)/3,a++,a>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let s=0;for(let o=1;o<e.length-1;o++)i[o-1]<i[o]&&i[o+1]<i[o]&&(s+=o);return Math.floor(s/2)}function bimodalTest$1(e){let i=!1,a=0;for(let s=1;s<e.length-1;s++)if(e[s-1]<e[s]&&e[s+1]<e[s]&&(a++,a>2))return!1;return a===2&&(i=!0),i}function isodata(e){let i,a,s,o,h=0;for(let d=1;d<e.length;d++)if(e[d]>0){h=d+1;break}for(;;){i=0,s=0;for(let d=0;d<h;d++)s=s+e[d],i=i+e[d]*d;o=0,a=0;for(let d=h+1;d<e.length;d++)a+=e[d],o+=e[d]*d;if(s>0&&a>0&&(i/=s,o/=a,h===Math.round((i+o)/2)))break;if(h++,h>e.length-2)throw new Error("Threshold not found")}return h}function li(e,i){let a,s,o,h,d,g,b,_,$,it,nt,tt;nt=.5,it=0;for(let at=0;at<e.length;at++)it+=at*e[at];it/=i,b=it;do{g=b,a=g+.5|0,s=0,h=0;for(let at=0;at<=a;at++)s+=at*e[at],h+=e[at];_=h===0?0:s/h,o=0,d=0;for(let at=a+1;at<e.length;at++)o+=at*e[at],d+=e[at];$=d===0?0:o/d,tt=(_-$)/(Math.log(_)-Math.log($)),tt<-Number.EPSILON?b=tt-.5|0:b=tt+.5|0}while(Math.abs(b-g)>nt);return a}function maxEntropy(e,i){let a=new Array(e.length);for(let nt=0;nt<e.length;nt++)a[nt]=e[nt]/i;let s=new Array(e.length),o=new Array(e.length);s[0]=a[0],o[0]=1-s[0];for(let nt=1;nt<e.length;nt++)s[nt]=s[nt-1]+a[nt],o[nt]=1-s[nt];let h=0;for(let nt=0;nt<e.length;nt++)if(Math.abs(s[nt])>=Number.EPSILON){h=nt;break}let d=e.length-1;for(let nt=e.length-1;nt>=h;nt--)if(Math.abs(o[nt])>=Number.EPSILON){d=nt;break}let g=-1,b,_=Number.MIN_VALUE,$,it;for(let nt=h;nt<=d;nt++){$=0;for(let tt=0;tt<=nt;tt++)e[tt]!==0&&($-=a[tt]/s[nt]*Math.log(a[tt]/s[nt]));it=0;for(let tt=nt+1;tt<e.length;tt++)e[tt]!==0&&(it-=a[tt]/o[nt]*Math.log(a[tt]/o[nt]));b=$+it,_<b&&(_=b,g=nt)}return g}function mean$1(e,i){let a=0;for(let s=0;s<e.length;s++)a+=s*e[s];return Math.floor(a/i)}function minError(e,i){let a,s=-2,o,h,d,g,b,_,$,it,nt,tt,at,ut=0;for(let ft=0;ft<e.length;ft++)ut+=ft*e[ft];for(ut/=i,a=ut;a!==s;){let ft=sumA(e,a),ht=sumA(e,e.length-1),dt=sumB(e,a),st=sumB(e,e.length-1),ct=sumC(e,a),wt=sumC(e,e.length-1);if(o=dt/ft,h=(st-dt)/(ht-ft),d=ft/ht,g=(ht-ft)/ht,b=ct/ft-o*o,_=(wt-ct)/(ht-ft)-h*h,$=1/b-1/_,it=o/b-h/_,nt=o*o/b-h*h/_+Math.log10(b*(g*g)/(_*(d*d))),tt=it*it-$*nt,tt<0)return a;s=a,at=(it+Math.sqrt(tt))/$,isNaN(at)?a=s:a=Math.floor(at)}return a}function sumA(e,i){let a=0;for(let s=0;s<=i;s++)a+=e[s];return a}function sumB(e,i){let a=0;for(let s=0;s<=i;s++)a+=s*e[s];return a}function sumC(e,i){let a=0;for(let s=0;s<=i;s++)a+=s*s*e[s];return a}function minimum(e){if(e.length<2)return 0;let i=0,a=-1,s=-1,o=new Array(e.length);for(let h=0;h<e.length;h++)o[h]=e[h],e[h]>0&&(s=h);for(;!bimodalTest(o);)if(o=smoothed(o),i++,i>1e4)return a;return a=minimumBetweenPeeks(o,s),a}function smoothed(e){let i=new Array(e.length);for(let a=1;a<e.length-1;a++)i[a]=(e[a-1]+e[a]+e[a+1])/3;return i[0]=(e[0]+e[1])/3,i[e.length-1]=(e[e.length-2]+e[e.length-1])/3,i}function minimumBetweenPeeks(e,i){let a;for(let s=1;s<i;s++)if(e[s-1]>e[s]&&e[s+1]>=e[s]){a=s;break}return a}function bimodalTest(e){let i=e.length,a=!1,s=0;for(let o=1;o<i-1;o++)if(e[o-1]<e[o]&&e[o+1]<e[o]&&(s++,s>2))return!1;return s===2&&(a=!0),a}function moments(e,i){let a=1,s=0,o=0,h=0,d=0,g,b,_,$,it,nt,tt=-1,at=e.length,ut=new Array(at);for(let ft=0;ft<at;ft++)ut[ft]=e[ft]/i;for(let ft=0;ft<at;ft++)s+=ft*ut[ft],o+=ft*ft*ut[ft],h+=ft*ft*ft*ut[ft];b=a*o-s*s,_=(-o*o+s*h)/b,$=(a*-h+o*s)/b,it=.5*(-$-Math.sqrt($*$-4*_)),nt=.5*(-$+Math.sqrt($*$-4*_)),g=(nt-s)/(nt-it);for(let ft=0;ft<at;ft++)if(d+=ut[ft],d>g){tt=ft;break}return tt}function otsu(e,i){let a=0,s=0,o=0,h=0,d=0;for(let g=0;g<e.length;g++)d+=g*e[g];for(let g=0;g<e.length;g++){s=s+e[g];const b=i-s;if(s===0||b===0)continue;a=a+g*e[g];const _=(d-a)/b,$=s*b*(a/s-_)*(a/s-_);$>=o&&(h=g,o=$)}return h}function percentile(e){let i=-1,a=.5,s=new Array(e.length),o=partialSum(e,e.length-1),h=1;for(let d=0;d<e.length;d++)s[d]=Math.abs(partialSum(e,d)/o-a),s[d]<h&&(h=s[d],i=d);return i}function partialSum(e,i){let a=0;for(let s=0;s<=i;s++)a+=e[s];return a}function renyiEntropy(e,i){let a,s,o,h=new Array(e.length),d=new Array(e.length),g=new Array(e.length),b=0,_=0,$=0,it=0,nt=0,tt=0,at=1/(1-.5),ut=1/-1;for(let st=0;st<e.length;st++)h[st]=e[st]/i;d[0]=h[0],g[0]=1-d[0];for(let st=1;st<e.length;st++)d[st]=d[st-1]+h[st],g[st]=1-d[st];s=0;for(let st=0;st<e.length;st++)if(Math.abs(d[st])>=Number.EPSILON){s=st;break}o=e.length-1;for(let st=e.length-1;st>=s;st--)if(Math.abs(g[st])>=Number.EPSILON){o=st;break}for(let st=s;st<=o;st++){let ct=0,wt=0,_t=0;for(let Ft=0;Ft<=st;Ft++)e[Ft]!==0&&(ct-=h[Ft]/d[st]*Math.log(h[Ft]/d[st])),wt+=Math.sqrt(h[Ft]/d[st]),_t+=h[Ft]*h[Ft]/(d[st]*d[st]);let gt=0,yt=0,bt=0;for(let Ft=st+1;Ft<e.length;Ft++)e[Ft]!==0&&(gt-=h[Ft]/g[st]*Math.log(h[Ft]/g[st])),yt+=Math.sqrt(h[Ft]/g[st]),bt+=h[Ft]*h[Ft]/(g[st]*g[st]);let vt=ct+gt,Ct=at*(wt*yt>0?Math.log(wt*yt):0),Ht=ut*(_t*bt>0?Math.log(_t*bt):0);vt>it&&(it=vt,b=st),Ct>nt&&(nt=Ct,_=st),Ht>tt&&(tt=Ht,$=st)}let ft=[b,_,$];ft.sort((st,ct)=>st-ct);let ht;Math.abs(ft[0]-ft[1])<=5?Math.abs(ft[1]-ft[2])<=5?ht=[1,2,1]:ht=[0,1,3]:Math.abs(ft[1]-ft[2])<=5?ht=[3,1,0]:ht=[1,2,1];let dt=d[ft[2]]-d[ft[0]];return a=Math.round(ft[0]*(d[ft[0]]+.25*dt*ht[0])+.25*ft[1]*dt*ht[1]+ft[2]*(g[ft[2]]+.25*dt*ht[2])),a}function shanbhag(e,i){let a=new Array(e.length);for(let tt=0;tt<e.length;tt++)a[tt]=e[tt]/i;let s=new Array(e.length),o=new Array(e.length);s[0]=a[0],o[0]=1-s[0];for(let tt=1;tt<e.length;tt++)s[tt]=s[tt-1]+a[tt],o[tt]=1-s[tt];let h=0;for(let tt=0;tt<e.length;tt++)if(Math.abs(s[tt])>=Number.EPSILON){h=tt;break}let d=e.length-1;for(let tt=e.length-1;tt>=h;tt--)if(Math.abs(o[tt])>=Number.EPSILON){d=tt;break}let g=-1,b=Number.MAX_VALUE,_,$,it,nt;for(let tt=h;tt<=d;tt++){it=0,_=.5/s[tt];for(let at=1;at<=tt;at++)it-=a[at]*Math.log(1-_*s[at-1]);it*=_,nt=0,_=.5/o[tt];for(let at=tt+1;at<e.length;at++)nt-=a[at]*Math.log(1-_*o[at]);nt*=_,$=Math.abs(it-nt),$<b&&(b=$,g=tt)}return g}function triangle$1(e){let i=0,a=0,s=0,o=0;for(let it=0;it<e.length;it++)if(e[it]>0){i=it;break}i>0&&i--;for(let it=e.length-1;it>0;it--)if(e[it]>0){o=it;break}o<e.length-1&&o++;for(let it=0;it<e.length;it++)e[it]>a&&(s=it,a=e[it]);let h=!1;if(s-i<o-s){h=!0;let it=0,nt=e.length-1;for(;it<nt;){let tt=e[it];e[it]=e[nt],e[nt]=tt,it++,nt--}i=e.length-1-o,s=e.length-1-s}if(i===s)return i;let d,g,b;d=e[s],g=i-s,b=Math.sqrt(d*d+g*g),d/=b,g/=b,b=d*i+g*e[i];let _=i,$=0;for(let it=i+1;it<=s;it++){let nt=d*it+g*e[it]-b;nt>$&&(_=it,$=nt)}if(_--,h){let it=0,nt=e.length-1;for(;it<nt;){let tt=e[it];e[it]=e[nt],e[nt]=tt,it++,nt--}return e.length-1-_}else return _}function yen(e,i){let a=new Array(e.length);for(let _=0;_<e.length;_++)a[_]=e[_]/i;let s=new Array(e.length);s[0]=a[0];for(let _=1;_<e.length;_++)s[_]=s[_-1]+a[_];let o=new Array(e.length);o[0]=a[0]*a[0];for(let _=1;_<e.length;_++)o[_]=o[_-1]+a[_]*a[_];let h=new Array(e.length);h[e.length-1]=0;for(let _=e.length-2;_>=0;_--)h[_]=h[_+1]+a[_+1]*a[_+1];let d=-1,g=Number.MIN_VALUE,b;for(let _=0;_<e.length;_++)b=-1*(o[_]*h[_]>0?Math.log(o[_]*h[_]):0)+2*(s[_]*(1-s[_])>0?Math.log(s[_]*(1-s[_])):0),b>g&&(g=b,d=_);return d}const methods={huang,intermodes,isodata,li,maxentropy:maxEntropy,mean:mean$1,minerror:minError,minimum,moments,otsu,percentile,renyientropy:renyiEntropy,shanbhag,triangle:triangle$1,yen},names={};Object.keys(methods).forEach(e=>{names[e]=e});function getThreshold(e={}){let{algorithm:i=names.otsu}=e;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let a=methods[i.toLowerCase()];if(a){let s=this.getHistogram();return a(s,this.size)}else throw new Error(`unknown thresholding algorithm: ${i}`)}const THRESHOLD="threshold";function mask(e={}){let{algorithm:i=THRESHOLD,threshold:a=.5,useAlpha:s=!0,invert:o=!1}=e;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),i===THRESHOLD?a=getThreshold$1(a,this.maxValue):a=getThreshold.call(this,e);let h=new Image(this.width,this.height,{kind:"BINARY",parent:this}),d=0;if(this.alpha&&s)for(let g=0;g<this.data.length;g+=this.channels){let b=this.data[g]+(this.maxValue-this.data[g])*(this.maxValue-this.data[g+1])/this.maxValue;(o&&b<=a||!o&&b>=a)&&h.setBit(d),d++}else for(let g=0;g<this.data.length;g+=this.channels)(o&&this.data[g]<=a||!o&&this.data[g]>=a)&&h.setBit(d),d++;return h}function copyImage(e,i,a,s){let o=e.width,h=e.height,d=i.width,g=e.channels;for(let b=0;b<o;b++)for(let _=0;_<h;_++)for(let $=0;$<g;$++){let it=(_*o+b)*g+$,nt=((s+_)*d+a+b)*g+$;i.data[nt]=e.data[it]}}function pad(e={}){let{size:i=0,algorithm:a="copy",color:s}=e;if(this.checkProcessable("pad",{bitDepth:[8,16]}),a==="set"){if(s.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let b=0;b<s.length;b++)s[b]===0&&(s[b]=.001)}else s=newArray(this.channels,null);Array.isArray(i)||(i=[i,i]);let o=this.width+i[0]*2,h=this.height+i[1]*2,d=this.channels,g=Image.createFrom(this,{width:o,height:h});copyImage(this,g,i[0],i[1]);for(let b=i[0];b<o-i[0];b++)for(let _=0;_<d;_++){let $=s[_]||g.data[(i[1]*o+b)*d+_];for(let it=0;it<i[1];it++)g.data[(it*o+b)*d+_]=$;$=s[_]||g.data[((h-i[1]-1)*o+b)*d+_];for(let it=h-i[1];it<h;it++)g.data[(it*o+b)*d+_]=$}for(let b=0;b<h;b++)for(let _=0;_<d;_++){let $=s[_]||g.data[(b*o+i[0])*d+_];for(let it=0;it<i[0];it++)g.data[(b*o+it)*d+_]=$;$=s[_]||g.data[(b*o+o-i[0]-1)*d+_];for(let it=o-i[0];it<o;it++)g.data[(b*o+it)*d+_]=$}return g}function colorDepth(e=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(e))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===e)return this.clone();let i=Image.createFrom(this,{bitDepth:e});switch(e){case 8:if(this.bitDepth===1)for(let a=0;a<this.size;a++)this.getBit(a)&&(i.data[a]=255);else for(let a=0;a<this.data.length;a++)i.data[a]=this.data[a]>>8;break;case 16:if(this.bitDepth===1)for(let a=0;a<this.size;a++)this.getBit(a)&&(i.data[a]=65535);else for(let a=0;a<this.data.length;a++)i.data[a]=this.data[a]<<8|this.data[a];break;default:throw new Error("colorDepth conversion unexpected case")}return i}function rotateFree(e,i={}){const{interpolation:a=validInterpolations.nearestneighbor,width:s=this.width,height:o=this.height}=i;if(typeof e!="number")throw new TypeError("degrees must be a number");const h=checkInterpolation(a),d=e*Math.PI/180,g=Math.floor(Math.abs(s*Math.cos(d))+Math.abs(o*Math.sin(d))),b=Math.floor(Math.abs(o*Math.cos(d))+Math.abs(s*Math.sin(d))),_=Math.cos(-d),$=Math.sin(-d);let it=g/2,nt=b/2;g%2===0?(it=it-.5,b%2===0?nt=nt-.5:nt=Math.floor(nt)):(it=Math.floor(it),b%2===0?nt=nt-.5:nt=Math.floor(nt));const tt=Math.floor(s/2-it),at=Math.floor(o/2-nt);if(this.bitDepth===1){const ut=new Image(g,b,{kind:"BINARY",parent:this});switch(h){case validInterpolations.nearestneighbor:return rotateBinaryNearestNeighbor(this,ut,tt,at,it,nt,_,$);case validInterpolations.bilinear:return rotateBinaryBilinear(this,ut,tt,at,it,nt,_,$);default:throw new Error(`unsupported rotate interpolation: ${h}`)}}else{const ut=Image.createFrom(this,{width:g,height:b});switch(h){case validInterpolations.nearestneighbor:return rotateNearestNeighbor(this,ut,tt,at,it,nt,_,$);case validInterpolations.bilinear:return rotateBilinear(this,ut,tt,at,it,nt,_,$);default:throw new Error(`unsupported rotate interpolation: ${h}`)}}}function rotateNearestNeighbor(e,i,a,s,o,h,d,g){for(let b=0;b<i.width;b+=1)for(let _=0;_<i.height;_+=1)for(let $=0;$<e.channels;$++){let it=Math.round((b-o)*d-(_-h)*g+o)+a,nt=Math.round((_-h)*d+(b-o)*g+h)+s;it<0||it>=e.width||nt<0||nt>=e.height?e.alpha===1&&$===e.channels-1?i.setValueXY(b,_,$,0):i.setValueXY(b,_,$,e.maxValue):i.setValueXY(b,_,$,e.getValueXY(it,nt,$))}return i}function rotateBinaryNearestNeighbor(e,i,a,s,o,h,d,g){for(let b=0;b<i.width;b+=1)for(let _=0;_<i.height;_+=1){let $=Math.round((b-o)*d-(_-h)*g+o)+a,it=Math.round((_-h)*d+(b-o)*g+h)+s;($<0||$>=e.width||it<0||it>=e.height||e.getBitXY($,it))&&i.setBitXY(b,_)}return i}function rotateBilinear(e,i,a,s,o,h,d,g){let b=e.width*e.channels;for(let _=0;_<i.height;_++)for(let $=0;$<i.width;$++){let it=($-o)*d-(_-h)*g+o+a,nt=(_-h)*d+($-o)*g+h+s,tt=it|0,at=nt|0,ut=it-tt,ft=nt-at;for(let ht=0;ht<e.channels;ht++)if(it<0||it>=e.width||nt<0||nt>=e.height)e.alpha===1&&ht===e.channels-1?i.setValueXY($,_,ht,0):i.setValueXY($,_,ht,e.maxValue);else{let dt=(at*e.width+tt)*e.channels+ht,st=e.data[dt],ct=e.data[dt+e.channels],wt=e.data[dt+b],_t=e.data[dt+b+e.channels],gt=st+ut*(ct-st)+ft*(wt-st)+ut*ft*(st-ct-wt+_t)|0;i.setValueXY($,_,ht,gt)}}return i}function rotateBinaryBilinear(e,i,a,s,o,h,d,g){let b=e.width;for(let _=0;_<i.height;_++)for(let $=0;$<i.width;$++){let it=($-o)*d-(_-h)*g+o+a,nt=(_-h)*d+($-o)*g+h+s,tt=it|0,at=nt|0,ut=it-tt,ft=nt-at;if(it<0||it>=e.width||nt<0||nt>=e.height)i.setBitXY($,_);else{let ht=at*e.width+tt,dt=e.getBit(ht),st=e.getBit(ht+1),ct=e.getBit(ht+b),wt=e.getBit(ht+1+b);(dt|ut&st-dt|ft&ct-dt|ut&ft&dt-st-ct+wt)>0&&i.setBitXY($,_)}}return i}function rotate$1(e,i){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),typeof e!="number")throw new TypeError("angle must be a number");switch(e<0&&(e=Math.ceil(-e/360)*360+e),e%360){case 0:return this.clone();case 90:return rotateRight.call(this);case 180:return rotate180.call(this);case 270:return rotateLeft.call(this);default:return rotateFree.call(this,e,i)}}function rotateLeft(){if(this.bitDepth===1){const e=new Image(this.height,this.width,{kind:"BINARY",parent:this}),i=e.height-1;for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++)this.getBitXY(s,a)&&e.setBitXY(a,i-s);return e}else{const e=Image.createFrom(this,{width:this.height,height:this.width}),i=e.height-1;for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++)for(let o=0;o<this.channels;o++)e.setValueXY(a,i-s,o,this.getValueXY(s,a,o));return e}}function rotateRight(){if(this.bitDepth===1){const e=new Image(this.height,this.width,{kind:"BINARY",parent:this}),i=e.width-1;for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++)this.getBitXY(s,a)&&e.setBitXY(i-a,s);return e}else{const e=Image.createFrom(this,{width:this.height,height:this.width}),i=e.width-1;for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++)for(let o=0;o<this.channels;o++)e.setValueXY(i-a,s,o,this.getValueXY(s,a,o));return e}}function rotate180(){if(this.bitDepth===1){const e=new Image(this.width,this.height,{kind:"BINARY",parent:this}),i=e.width-1,a=e.height-1;for(let s=0;s<this.height;s++)for(let o=0;o<this.width;o++)this.getBitXY(o,s)&&e.setBitXY(i-o,a-s);return e}else{const e=Image.createFrom(this),i=e.width-1,a=e.height-1;for(let s=0;s<this.height;s++)for(let o=0;o<this.width;o++)for(let h=0;h<this.channels;h++)e.setValueXY(i-o,a-s,h,this.getValueXY(o,s,h));return e}}function insert(e,i={}){const a=getImageParameters(e);this.checkProcessable("insert",a);let{x:s=0,y:o=0}=i;const h=getOutputImageOrInPlace(this,i,{copy:!0}),d=Math.min(h.height,o+e.height),g=Math.min(h.width,s+e.width);if(h.bitDepth===1)for(let b=o;b<d;b++)for(let _=s;_<g;_++)e.getBitXY(_-s,b-o)?h.setBitXY(_,b):h.clearBitXY(_,b);else for(let b=o;b<d;b++)for(let _=s;_<g;_++)h.setPixelXY(_,b,e.getPixelXY(_-s,b-o));return h}function setBorder(e={}){let{size:i=0,algorithm:a="copy",color:s}=e;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),a==="set"){if(s.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let g=0;g<s.length;g++)s[g]===0&&(s[g]=.001)}else s=newArray(this.channels,null);Array.isArray(i)||(i=[i,i]);let o=i[0],h=i[1],d=this.channels;for(let g=o;g<this.width-o;g++)for(let b=0;b<d;b++){let _=s[b]||this.data[(g+this.width*h)*d+b];for(let $=0;$<h;$++)this.data[($*this.width+g)*d+b]=_;_=s[b]||this.data[(g+this.width*(this.height-h-1))*d+b];for(let $=this.height-h;$<this.height;$++)this.data[($*this.width+g)*d+b]=_}for(let g=0;g<this.height;g++)for(let b=0;b<d;b++){let _=s[b]||this.data[(g*this.width+o)*d+b];for(let $=0;$<o;$++)this.data[(g*this.width+$)*d+b]=_;_=s[b]||this.data[(g*this.width+this.width-o-1)*d+b];for(let $=this.width-o;$<this.width;$++)this.data[(g*this.width+$)*d+b]=_}return this}function split(e={}){let{preserveAlpha:i=!0}=e;if(this.checkProcessable("split",{bitDepth:[8,16]}),this.components===1)return new Stack([this.clone()]);let a=new Stack,s=this.data;if(this.alpha&&i)for(let o=0;o<this.components;o++){let h=Image.createFrom(this,{components:1,alpha:!0,colorModel:GREY$1}),d=0;for(let g=0;g<s.length;g+=this.channels)h.data[d++]=s[g+o],h.data[d++]=s[g+this.components];a.push(h)}else for(let o=0;o<this.channels;o++){let h=Image.createFrom(this,{components:1,alpha:!1,colorModel:GREY$1}),d=0;for(let g=0;g<s.length;g+=this.channels)h.data[d++]=s[g+o];a.push(h)}return a}function getChannel(e,i={}){let{keepAlpha:a=!1,mergeAlpha:s=!1}=i;a&=this.alpha,s&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),e=validateChannel(this,e);let o=Image.createFrom(this,{components:1,alpha:a,colorModel:GREY$1}),h=0;for(let d=0;d<this.data.length;d+=this.channels)s?o.data[h++]=this.data[d+e]*this.data[d+this.components]/this.maxValue:(o.data[h++]=this.data[d+e],a&&(o.data[h++]=this.data[d+this.components]));return o}function combineChannels(e=defaultCombineMethod,i={}){let{mergeAlpha:a=!1,keepAlpha:s=!1}=i;a&=this.alpha,s&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let o=Image.createFrom(this,{components:1,alpha:s,colorModel:GREY$1}),h=0;for(let d=0;d<this.size;d++){let g=e(this.getPixel(d));a?o.data[h++]=g*this.data[d*this.channels+this.components]/this.maxValue:(o.data[h++]=g,s&&(o.data[h++]=this.data[d*this.channels+this.components]))}return o}function defaultCombineMethod(e){return(e[0]+e[1]+e[2])/3}function setChannel(e,i){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),i.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),i.width!==this.width||i.height!==this.height)throw new Error("Images must have exactly the same width and height");e=validateChannel(this,e);let a=e;for(let s=0;s<i.data.length;s++)this.data[a]=i.data[s],a+=this.channels;return this}function getSimilarity(e,i={}){let{shift:a=[0,0],average:s,channels:o,defaultAlpha:h,normalize:d,border:g=[0,0]}=i;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(g)||(g=[g,g]),o=validateArrayOfChannels(this,{channels:o,defaultAlpha:h}),this.bitDepth!==e.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==e.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==e.colorModel)throw new Error("Both images must have the same colorModel");typeof s>"u"&&(s=!0);let b=Math.max(g[0],-a[0]),_=Math.min(this.width-g[0],this.width-a[0]),$=Math.max(g[1],-a[1]),it=Math.min(this.height-g[1],this.height-a[1]),nt=newArray(o.length,0);for(let tt=0;tt<o.length;tt++){let at=o[tt],ut=d?this.sum[at]:Math.max(this.sum[at],e.sum[at]),ft=d?e.sum[at]:Math.max(this.sum[at],e.sum[at]);if(ut!==0&&ft!==0)for(let ht=b;ht<_;ht++)for(let dt=$;dt<it;dt++){let st=ht*this.multiplierX+dt*this.multiplierY+at,ct=st+a[0]*this.multiplierX+a[1]*this.multiplierY;nt[tt]+=Math.min(this.data[st]/ut,e.data[ct]/ft)}}return s?nt.reduce((tt,at)=>tt+at)/nt.length:nt}function getPixelsGrid(e={}){let{sampling:i=[10,10],painted:a=!1,mask:s}=e;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(i)||(i=[i,i]);const o=i[0],h=i[1],d=[],g=[],b=this.width/o,_=this.height/h;let $=Math.floor(b/2);for(let nt=0;nt<o;nt++){let tt=Math.floor(_/2);for(let at=0;at<h;at++){let ut=Math.round($),ft=Math.round(tt);(!s||s.getBitXY(ut,ft))&&(d.push([ut,ft]),g.push(this.getPixelXY(ut,ft))),tt+=_}$+=b}const it={xyS:d,zS:g};return a&&(it.painted=this.rgba8().paintPoints(d)),it}function Matrix(e,i,a){const s=new Array(e);for(let o=0;o<e;o++)s[o]=new Array(i);if(a)for(let o=0;o<e;o++)for(let h=0;h<i;h++)s[o][h]=a;return s.width=e,s.height=i,Object.setPrototypeOf(s,Matrix.prototype),s}Matrix.prototype.localMin=function(e,i){let a=this[e][i],s=[e,i];for(let o=Math.max(0,e-1);o<Math.min(this.length,e+2);o++)for(let h=Math.max(0,i-1);h<Math.min(this[0].length,i+2);h++)this[o][h]<a&&(a=this[o][h],s=[o,h]);return{position:s,value:a}};Matrix.prototype.localMax=function(e,i){let a=this[e][i],s=[e,i];for(let o=Math.max(0,e-1);o<Math.min(this.length,e+2);o++)for(let h=Math.max(0,i-1);h<Math.min(this[0].length,i+2);h++)this[o][h]>a&&(a=this[o][h],s=[o,h]);return{position:s,value:a}};Matrix.prototype.localSearch=function(e,i,a){let s=[];for(let o=Math.max(0,e-1);o<Math.min(this.length,e+2);o++)for(let h=Math.max(0,i-1);h<Math.min(this[0].length,i+2);h++)this[o][h]===a&&s.push([o,h]);return s};function getBestMatch(e,i={}){let{border:a}=i;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==e.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==e.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==e.colorModel)throw new Error("Both images must have the same colorModel");let s=new Matrix(e.width,e.height,-1/0),o=Math.floor(e.width/2),h=Math.floor(e.height/2),d=o,g=h,b=!1;for(;!b;){let _=s.localSearch(o,h,-1/0);for(let it=0;it<_.length;it++){let nt=_[it],tt=this.getSimilarity(e,{border:a,shift:[d-nt[0],g-nt[1]]});s[nt[0]][nt[1]]=tt}let $=s.localMax(o,h);$.position[0]!==o||$.position[1]!==h?(o=$.position[0],h=$.position[1]):b=!0}return[o-d,h-g]}function getRow(e,i=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),checkRow(this,e),checkChannel(this,i);let a=new Array(this.width),s=0,o=e*this.width*this.channels+i,h=o+this.width*this.channels;for(let d=o;d<h;d+=this.channels)a[s++]=this.data[d];return a}function getColumn(e,i=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),checkColumn(this,e),checkChannel(this,i);let a=new Array(this.height),s=0,o=this.width*this.channels;for(let h=i+e*this.channels;h<this.data.length;h+=o)a[s++]=this.data[h];return a}function getMatrix(e={}){let{channel:i}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),i===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");i=0}let a=new Matrix$1(this.height,this.width);for(let s=0;s<this.height;s++)for(let o=0;o<this.width;o++)a.set(s,o,this.getValueXY(o,s,i));return a}function setMatrix(e,i={}){e=new Matrix$1(e);let{channel:a}=i;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),a===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");a=0}if(this.width!==e.columns||this.height!==e.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let s=0;s<this.height;s++)for(let o=0;o<this.width;o++)this.setValueXY(o,s,a,e.get(s,o));return this}function getPixelsArray(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let e=new Array(this.size),i=0;for(let a=0;a<this.data.length;a+=this.channels){let s=new Array(this.components);for(let o=0;o<this.components;o++)s[o]=this.data[a+o];e[i++]=s}return e}function getIntersection(e){let i=this,a=i.getClosestCommonParent(e),s=i.getRelativePosition(a,{defaultFurther:!0}),o=getRelativePositionForAllPixels(i,s),h=e.getRelativePosition(a,{defaultFurther:!0}),d=getRelativePositionForAllPixels(e,h),g=getCommonSurface(o,d),b={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let _=0;_<g.length;_++){let $=g[_],it=[$[0]-s[0],$[1]-s[1]],nt=[$[0]-h[0],$[1]-h[1]],tt=i.getBitXY(it[0],it[1]),at=e.getBitXY(nt[0],nt[1]);tt===1&&at===1&&b.commonWhitePixels.push($)}for(let _=0;_<o.length;_++){let $,it;_!==0&&($=Math.floor(_/i.width),it=_%i.width),i.getBitXY($,it)===1&&b.whitePixelsMask1.push(o[_])}for(let _=0;_<d.length;_++){let $=0,it=0;_!==0&&($=Math.floor(_/e.width),it=_%e.width),e.getBitXY($,it)===1&&b.whitePixelsMask2.push(d[_])}return b}function getRelativePositionForAllPixels(e,i){let a=[];for(let s=0;s<e.height;s++)for(let o=0;o<e.width;o++){let h=[s,o];a.push([h[0]+i[0],h[1]+i[1]])}return a}function getCommonSurface(e,i){let a=0,s=0,o=[];for(;a<e.length&&s<i.length;)e[a][0]===i[s][0]&&e[a][1]===i[s][1]?(o.push(e[a]),a++,s++):e[a][0]<i[s][0]||e[a][0]===i[s][0]&&e[a][1]<i[s][1]?a++:s++;return o}function getClosestCommonParent(e){let i=getDepth(this),a=getDepth(e),s;if(i>=a?s=getFurthestParent(this,i):s=getFurthestParent(e,a),i===0||a===0)return s;let o=this,h=e;for(;i!==a;)if(i>a){if(o=o.parent,o===null)return s;i=i-1}else{if(h=h.parent,h===null)return s;a=a-1}for(;o!==h&&o!==null&&h!==null;)if(o=o.parent,h=h.parent,o===null||h===null)return s;return o!==h?s:o}function getDepth(e){let i=0,a=e;for(;a.parent!=null;)a=a.parent,i++;return i}function getFurthestParent(e,i){let a=e;for(;i>0;)a=a.parent,i=i-1;return a}const defaultOptions$1={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Gx=[[-1,0,1],[-2,0,2],[-1,0,1]],Gy=[[-1,-2,-1],[0,0,0],[1,2,1]],convOptions={bitDepth:32,mode:"periodic"};function cannyEdgeDetector(e,i){e.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),i=Object.assign({},defaultOptions$1,i);const a=e.width,s=e.height,o=e.maxValue,h={sigma:i.gaussianBlur,radius:3},d=e.gaussianFilter(h),g=d.convolution(Gy,convOptions),b=d.convolution(Gx,convOptions),_=b.hypotenuse(g),$=e.constructor,it=new $(a,s,{kind:"GREY",bitDepth:32}),nt=new $(a,s,{kind:"GREY",bitDepth:32}),tt=new $(a,s,{kind:"GREY"});for(var at=1;at<a-1;at++)for(var ut=1;ut<s-1;ut++){var ft=(Math.round(Math.atan2(b.getValueXY(at,ut,0),g.getValueXY(at,ut,0))*(5/Math.PI))+5)%5;ft===0&&(_.getValueXY(at,ut,0)<=_.getValueXY(at,ut-1,0)||_.getValueXY(at,ut,0)<=_.getValueXY(at,ut+1,0))||ft===1&&(_.getValueXY(at,ut,0)<=_.getValueXY(at-1,ut+1,0)||_.getValueXY(at,ut,0)<=_.getValueXY(at+1,ut-1,0))||ft===2&&(_.getValueXY(at,ut,0)<=_.getValueXY(at-1,ut,0)||_.getValueXY(at,ut,0)<=_.getValueXY(at+1,ut,0))||ft===3&&(_.getValueXY(at,ut,0)<=_.getValueXY(at-1,ut-1,0)||_.getValueXY(at,ut,0)<=_.getValueXY(at+1,ut+1,0))||it.setValueXY(at,ut,0,_.getValueXY(at,ut,0))}for(at=0;at<a*s;++at){var ht=it.data[at],dt=0;ht>i.highThreshold&&(dt++,tt.data[at]=o),ht>i.lowThreshold&&dt++,nt.data[at]=dt}var st=[];for(at=1;at<a-1;++at)for(ut=1;ut<s-1;++ut)if(nt.getValueXY(at,ut,0)===1){t:for(var ct=at-1;ct<at+2;++ct)for(var wt=ut-1;wt<ut+2;++wt)if(nt.getValueXY(ct,wt,0)===2){st.push([at,ut]),tt.setValueXY(at,ut,0,o);break t}}for(;st.length>0;){var _t=[];for(at=0;at<st.length;++at)for(ut=-1;ut<2;++ut)for(ct=-1;ct<2;++ct)if(!(ut===0&&ct===0)){var gt=st[at][0]+ut,yt=st[at][1]+ct;nt.getValueXY(gt,yt,0)===1&&tt.getValueXY(gt,yt,0)===0&&(_t.push([gt,yt]),tt.setValueXY(gt,yt,0,o))}st=_t}return tt}function cannyEdge(e){return cannyEdgeDetector(this,e)}function extract(e,i={}){let{position:a}=i;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!a&&(a=e.getRelativePosition(this),!a))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let s=Image.createFrom(this,{width:e.width,height:e.height,alpha:1,position:a,parent:this});for(let o=0;o<e.width;o++)for(let h=0;h<e.height;h++){for(let d=0;d<this.channels;d++){let g=this.getValueXY(o+a[0],h+a[1],d);s.setValueXY(o,h,d,g)}e.getBitXY(o,h)||s.setValueXY(o,h,this.components,0)}return s}else{let s=Image.createFrom(this,{width:e.width,height:e.height,position:a,parent:this});for(let o=0;o<e.height;o++)for(let h=0;h<e.width;h++)e.getBitXY(h,o)&&this.getBitXY(h+a[0],o+a[1])&&s.setBitXY(h,o);return s}}var fastList={exports:{}},hasRequiredFastList;function requireFastList(){return hasRequiredFastList||(hasRequiredFastList=1,function(e,i){(function(){function a(o,h,d){this.next=d,d&&(d.prev=this),this.prev=h,h&&(h.next=this),this.data=o}function s(){if(!(this instanceof s))return new s;this._head=null,this._tail=null,this.length=0}s.prototype={push:function(o){this._tail=new a(o,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(this.length!==0){var o=this._tail;return this._tail=o.prev,o.prev&&(o.prev=this._tail.next=null),this.length--,this.length===1?this._head=this._tail:this.length===0&&(this._head=this._tail=null),o.data}},unshift:function(o){this._head=new a(o,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(this.length!==0){var o=this._head;return this._head=o.next,o.next&&(o.next=this._head.prev=null),this.length--,this.length===1?this._tail=this._head:this.length===0&&(this._head=this._tail=null),o.data}},item:function(o){o<0&&(o=this.length+o);for(var h=this._head;o-- >0&&h;)h=h.next;return h?h.data:void 0},slice:function(o,h){if(o||(o=0),h||(h=this.length),h<0&&(h=this.length+h),o<0&&(o=this.length+o),h===o)return[];if(h<o)throw new Error("invalid offset: "+o+","+h+" (length="+this.length+")");for(var d=h-o,g=new Array(d),b=0,_=this._head;o-- >0&&_;)_=_.next;for(;b<d&&_;)g[b++]=_.data,_=_.next;return g},drop:function(){s.call(this)},forEach:function(o,h){for(var d=this._head,g=0,b=this.length;g<b&&d;)o.call(h||this,d.data,g,this),d=d.next,g++},map:function(o,h){var d=new s;return this.forEach(function(g,b,_){d.push(o.call(h||_,g,b,_))}),d},filter:function(o,h){var d=new s;return this.forEach(function(g,b,_){o.call(h||_,g,b,_)&&d.push(g)}),d},reduce:function(o,h,d){var g=0,b=this._head,_=this.length;for(h||(g=1,h=b&&b.data,b=b&&b.next);g<_&&b;)h=o.call(d||this,h,b.data,this),g++,b=b.next;return h}},e.exports=s})()}(fastList)),fastList.exports}var fastListExports=requireFastList();const LinkedList=getDefaultExportFromCjs(fastListExports);function floodFill(e={}){const{x:i=0,y:a=0,inPlace:s=!0}=e,o=s?this:Image.createFrom(this);if(this.checkProcessable("floodFill",{bitDepth:1}),this.getBitXY(i,a))return o;const h=new LinkedList;for(h.push(new Node(i,a));h.length>0;){const d=h.shift();o.setBitXY(d.x,d.y);for(let g=d.x+1;g<this.width&&!o.getBitXY(g,d.y)&&!this.getBitXY(g,d.y);g++)o.setBitXY(g,d.y),d.y+1<this.height&&!this.getBitXY(g,d.y+1)&&h.push(new Node(g,d.y+1)),d.y-1>=0&&!this.getBitXY(g,d.y-1)&&h.push(new Node(g,d.y-1));for(let g=d.x-1;g>=0&&!o.getBitXY(g,d.y)&&!this.getBitXY(g,d.y);g++)o.setBitXY(g,d.y),d.y+1<this.height&&!this.getBitXY(g,d.y+1)&&h.push(new Node(g,d.y+1)),d.y-1>=0&&!this.getBitXY(g,d.y-1)&&h.push(new Node(g,d.y-1))}return o}function Node(e,i){this.x=e,this.y=i}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},_extends.apply(null,arguments)}function hsv2rgb(e,i,a){i=i/100,a=a/100;var s=[],o=a*i,h=e/60,d=o*(1-Math.abs(h%2-1)),g=a-o;return h>=0&&h<1?s=[o,d,0]:h>=1&&h<2?s=[d,o,0]:h>=2&&h<3?s=[0,o,d]:e>=3&&h<4?s=[0,d,o]:e>=4&&h<5?s=[d,0,o]:e>=5&&h<=6?s=[o,0,d]:s=[0,0,0],{r:Math.round(255*(s[0]+g)),g:Math.round(255*(s[1]+g)),b:Math.round(255*(s[2]+g))}}function hsl2hsv(e,i,a){return i*=(a<50?a:100-a)/100,{h:e,s:2*i/(a+i)*100,v:a+i}}function hsl2rgb$1(e,i,a){var s=hsl2hsv(e,i,a);return hsv2rgb(s.h,s.s,s.v)}var colors={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function parse(e){return named(e)||hex3(e)||hex6(e)||rgb(e)||rgba$1(e)||hsl(e)||hsla(e)}function named(e){var i=colors[e.toLowerCase()];if(i)return{r:i[0],g:i[1],b:i[2],a:100}}function rgb(e){var i=e.match(/rgb\(([^)]+)\)/);if(i){var a=i[1].split(/ *, */).map(Number);return{r:a[0],g:a[1],b:a[2],a:100}}}function rgba$1(e){var i=e.match(/rgba\(([^)]+)\)/);if(i){var a=i[1].split(/ *, */).map(Number);return{r:a[0],g:a[1],b:a[2],a:a[3]*100}}}function hex6(e){if(e[0]==="#"&&e.length===7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:100}}function hex3(e){if(e[0]==="#"&&e.length===4)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:100}}function hsl(e){var i=e.match(/hsl\(([^)]+)\)/);if(i){var a=i[1].split(/ *, */),s=parseInt(a[0],10),o=parseInt(a[1],10),h=parseInt(a[2],10),d=hsl2rgb$1(s,o,h);return _extends({},d,{a:100})}}function hsla(e){var i=e.match(/hsla\(([^)]+)\)/);if(i){var a=i[1].split(/ *, */),s=parseInt(a[0],10),o=parseInt(a[1],10),h=parseInt(a[2],10),d=parseInt(parseFloat(a[3])*100,10),g=hsl2rgb$1(s,o,h);return _extends({},g,{a:d})}}function css2array(e){let i=parse(e);return[i.r,i.g,i.b,Math.round(i.a*255/100)]}function hue2rgb(e,i,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(i-e)*6*a:a<1/2?i:a<2/3?e+(i-e)*(2/3-a)*6:e}function hsl2rgb(e,i,a){let s,o,h,d,g,b;return i/=100,a/=100,i===0?d=g=b=a*255:(a<=.5?o=a*(i+1):o=a+i-a*i,s=a*2-o,h=e/360,d=hue2rgb(s,o,h+1/3),g=hue2rgb(s,o,h),b=hue2rgb(s,o,h-1/3)),{r:d,g,b}}function getDistinctColors(e){let i=new Array(e),a=0;for(let s=0;s<360;s+=360/e){a++;let o=hsl2rgb(s,100,30+a%4*15);i[a-1]=[Math.round(o.r*255),Math.round(o.g*255),Math.round(o.b*255)]}return i}function getRandomColor(){return[Math.floor(Math.random()*256),Math.floor(Math.random()*256),Math.floor(Math.random()*256)]}function getColors(e){let{color:i,colors:a,randomColors:s,numberColors:o=50}=e;if(i&&!Array.isArray(i)&&(i=css2array(i)),i)return[i];if(a)return a=a.map(function(h){return Array.isArray(h)?h:css2array(h)}),a;if(s){a=new Array(o);for(let h=0;h<o;h++)a[h]=getRandomColor()}return getDistinctColors(o)}function paintLabels(e,i,a={}){let{color:s="blue",colors:o,font:h="12px Helvetica",rotate:d=0}=a;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:RGB$1}),!Array.isArray(e))throw Error("paintLabels: labels must be an array");if(!Array.isArray(i))throw Error("paintLabels: positions must be an array");if(s&&!Array.isArray(s)&&(s=css2array(s)),o?o=o.map(function(b){return Array.isArray(b)?b:css2array(b)}):o=[s],e.length!==i.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(h)||(h=[h]),Array.isArray(d)||(d=[d]);let g=this.getCanvas().getContext("2d");for(let b=0;b<e.length;b++){g.save();let _=o[b%o.length];g.fillStyle=`rgba(${_[0]},${_[1]},${_[2]},${_[3]/this.maxValue})`,g.font=h[b%h.length];let $=i[b];g.translate($[0],$[1]),g.rotate(d[b%d.length]/180*Math.PI),g.fillText(e[b],0,0),g.restore()}return this.data=Uint8Array.from(g.getImageData(0,0,this.width,this.height).data),this}function paintMasks(e,i={}){let{alpha:a=255,labels:s=[],labelsPosition:o=[],labelColor:h="blue",labelFont:d="12px Helvetica"}=i;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:RGB$1});let g=getColors(Object.assign({},i,{numberColors:e.length}));Array.isArray(e)||(e=[e]);for(let b=0;b<e.length;b++){let _=e[b],$=g[b%g.length];for(let it=0;it<_.width;it++)for(let nt=0;nt<_.height;nt++)if(_.getBitXY(it,nt))for(let tt=0;tt<Math.min(this.components,$.length);tt++)if(a===255)this.setValueXY(it+_.position[0],nt+_.position[1],tt,$[tt]);else{let at=this.getValueXY(it+_.position[0],nt+_.position[1],tt);at=Math.round((at*(255-a)+$[tt]*a)/255),this.setValueXY(it+_.position[0],nt+_.position[1],tt,at)}}if(Array.isArray(s)&&s.length>0){let b=this.getCanvas().getContext("2d");b.fillStyle=h,b.font=d;for(let _=0;_<Math.min(e.length,s.length);_++){let $=o[_]?o[_]:e[_].position;b.fillText(s[_],$[0],$[1])}this.data=Uint8Array.from(b.getImageData(0,0,this.width,this.height).data)}return this}function zerosMatrix(e,i){let a=new Array(e);for(let s=0;s<e;s++)a[s]=new Array(i).fill(0);return a}const cross=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],smallCross=[[0,1,0],[1,1,1],[0,1,0]];class Shape{constructor(i={}){let{kind:a="cross",shape:s,size:o,width:h,height:d,filled:g=!0}=i;if(o&&(h=o,d=o),s)switch(s.toLowerCase()){case"square":case"rectangle":this.matrix=rectangle(h,d,{filled:g});break;case"circle":case"ellipse":this.matrix=ellipse(h,d,{filled:g});break;case"triangle":this.matrix=triangle(h,d,{filled:g});break;default:throw new Error(`Shape: unexpected shape: ${s}`)}else if(a)switch(a.toLowerCase()){case"cross":this.matrix=cross;break;case"smallcross":this.matrix=smallCross;break;default:throw new Error(`Shape: unexpected kind: ${a}`)}else throw new Error("Shape: expected a kind or a shape option");this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){let i=this.matrix,a=[];for(let s=0;s<i.length;s++)for(let o=0;o<i[0].length;o++)i[s][o]&&a.push([o-this.halfWidth,s-this.halfHeight]);return a}getMask(){let i=new Image(this.width,this.height,{kind:BINARY});for(let a=0;a<this.matrix.length;a++)for(let s=0;s<this.matrix[0].length;s++)this.matrix[a][s]&&i.setBitXY(s,a);return i}}function rectangle(e,i,a){const s=zerosMatrix(i,e);if(a.filled)for(let o=0;o<i;o++)for(let h=0;h<e;h++)s[o][h]=1;else{for(let o of[0,i-1])for(let h=0;h<e;h++)s[o][h]=1;for(let o=0;o<i;o++)for(let h of[0,e-1])s[o][h]=1}return s}function ellipse(e,i,a){const s=zerosMatrix(i,e);let o=1-i%2,h=1-e%2,d=Math.floor((e-1)/2),g=Math.floor((i-1)/2),b=d*d,_=g*g;if(a.filled)for(let $=0;$<=g;$++){let it=Math.floor(Math.sqrt(b-b*$*$/_));for(let nt=d-it;nt<=d;nt++)s[g-$][nt]=1,s[g+$+o][nt]=1,s[g-$][e-nt-1]=1,s[g+$+o][e-nt-1]=1}else{for(let $=0;$<=g;$++){let it=Math.floor(Math.sqrt(b-b*$*$/_)),nt=d-it;s[g-$][nt]=1,s[g+$+o][nt]=1,s[g-$][e-nt-1]=1,s[g+$+o][e-nt-1]=1}for(let $=0;$<=d;$++){let it=Math.floor(Math.sqrt(_-_*$*$/b)),nt=g-it;s[nt][d-$]=1,s[nt][d+$+h]=1,s[i-nt-1][d-$]=1,s[i-nt-1][d+$+h]=1}}return s}function triangle(e,i,a){if(!a.filled)throw new Error("Non filled triangle is not implemented");const s=zerosMatrix(i,e);for(let o=0;o<i;o++){let h=Math.floor((1-o/i)*e/2);for(let d=h;d<e-h;d++)s[o][d]=1}return s}function paintPoints(e,i={}){let{shape:a}=i;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let s=getColors(Object.assign({},i,{numberColors:e.length})),o=new Shape(a).getPoints(),h=Math.min(this.channels,s[0].length);for(let d=0;d<e.length;d++){let g=s[d%s.length],b=e[d][0],_=e[d][1];for(let $=0;$<o.length;$++){let it=o[$][0],nt=o[$][1];if(b+it>=0&&_+nt>=0&&b+it<this.width&&_+nt<this.height){let tt=(b+it+(_+nt)*this.width)*this.channels;for(let at=0;at<h;at++)this.data[tt+at]=g[at]}}}return this}function paintPolyline(e,i={}){let{color:a=[this.maxValue,0,0],closed:s=!1}=i;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let o=Math.min(this.channels,a.length);for(let h=0;h<e.length-1+s;h++){let d=e[h],g=e[(h+1)%e.length],b=g[0]-d[0],_=g[1]-d[1],$=Math.max(Math.abs(b),Math.abs(_)),it=b/$,nt=_/$,tt=d[0],at=d[1];for(let ut=0;ut<=$;ut++){let ft=Math.round(tt),ht=Math.round(at);if(ft>=0&&ht>=0&&ft<this.width&&ht<this.height)if(this.bitDepth===1)this.setBitXY(ft,ht);else{let dt=(ft+ht*this.width)*this.channels;for(let st=0;st<o;st++)this.data[dt+st]=a[st]}tt=tt+it,at=at+nt}}return this}function paintPolylines(e,i={}){let a=Object.assign({},i);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let s=getColors(Object.assign({},i,{numberColors:e.length}));for(let o=0;o<e.length;o++)a.color=s[o%s.length],this.paintPolyline(e[o],a);return this}function paintPolygon(e,i={}){let{color:a=[this.maxValue,0,0],filled:s=!1}=i;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),i.closed=!0;let o=deleteDouble(e);if(s===!1)return this.paintPolyline(e,i);{let h=Array(this.height);for(let d=0;d<this.height;d++){h[d]=[];for(let g=0;g<this.width;g++)h[d].push(0)}for(let d=0;d<o.length;d++){const g=lineBetweenTwoPoints(o[d],o[(d+1)%o.length]);for(let b=0;b<this.height;b++)for(let _=0;_<this.width;_++)isAtTheRightOfTheLine(_,b,g,this.height)&&(h[b][_]=h[b][_]===0?1:0)}for(let d=0;d<this.height;d++)for(let g=0;g<this.width;g++)if(h[d][g]===1)if(this.bitDepth===1)this.setBitXY(g,d);else{let b=Math.min(this.channels,a.length),_=(g+d*this.width)*this.channels;for(let $=0;$<b;$++)this.data[_+$]=a[$]}return this.paintPolyline(e,i)}}function deleteDouble(e){let i=[];for(let a=0;a<e.length;a++)if(!(e[a][0]===e[(a+1)%e.length][0]&&e[a][1]===e[(a+1)%e.length][1])){if(e[a][0]===e[(a-1+e.length)%e.length][0]&&e[a][1]===e[(a-1+e.length)%e.length][1]||e[(a+1)%e.length][0]===e[(a-1+e.length)%e.length][0]&&e[(a-1+e.length)%e.length][1]===e[(a+1)%e.length][1])continue;i.push(e[a])}return i}function lineBetweenTwoPoints(e,i){if(e[0]===i[0])return{a:0,b:e[0],vertical:!0};{const a=(i[1]-e[1])/(i[0]-e[0]),s=e[1]-a*e[0];return{a,b:s,vertical:!1}}}function isAtTheRightOfTheLine(e,i,a,s){if(a.vertical===!0)return a.b<=e;if(a.a===0)return!1;{const o=(i-a.b)/a.a;return o<e&&o>=0&&o<=s}}function paintPolygons(e,i={}){let a=Object.assign({},i);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let s=getColors(Object.assign({},i,{numberColors:e.length}));for(let o=0;o<e.length;o++)a.color=s[o%s.length],this.paintPolygon(e[o],a);return this}function getHistogram(e={}){let{maxSlots:i=256,channel:a,useAlpha:s=!0}=e;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),a===void 0){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");a=0}return getChannelHistogram.call(this,a,{useAlpha:s,maxSlots:i})}function getHistograms(e={}){const{maxSlots:i=256,useAlpha:a=!0}=e;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let s=new Array(a?this.components:this.channels);for(let o=0;o<s.length;o++)s[o]=getChannelHistogram.call(this,o,{useAlpha:a,maxSlots:i});return s}function getChannelHistogram(e,i){let{useAlpha:a,maxSlots:s}=i;if(this.bitDepth===1){let b=[0,0];for(let _=0;_<this.height;_++)for(let $=0;$<this.width;$++){let it=this.getBitXY(_,$);it===0?b[0]+=1:it===1&&(b[1]+=1)}return b}let o=Math.log2(s);if(!isInteger(o))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let h=0;this.bitDepth>o&&(h=this.bitDepth-o);let d=this.data,g=newArray(Math.pow(2,Math.min(this.bitDepth,o)),0);if(a&&this.alpha){let b=this.channels-e-1;for(let _=e;_<d.length;_+=this.channels)g[d[_]>>h]+=d[_+b]/this.maxValue}else for(let b=e;b<d.length;b+=this.channels)g[d[b]>>h]++;return g}function getColorHistogram(e={}){let{useAlpha:i=!0,nbSlots:a=512}=e;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let s=Math.log(a)/Math.log(8);if(s!==Math.floor(s))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let o=this.bitDepth-s,h=this.data,d=newArray(Math.pow(8,s),0),g=Math.pow(2,s*2),b=Math.pow(2,s);for(let _=0;_<h.length;_+=this.channels){let $=(h[_]>>o)*g+(h[_+1]>>o)*b+(h[_+2]>>o);i&&this.alpha?d[$]+=h[_+this.channels-1]/this.maxValue:d[$]++}return d}function min(){this.checkProcessable("min",{bitDepth:[8,16,32]});let e=newArray(this.channels,1/0);for(let i=0;i<this.data.length;i+=this.channels)for(let a=0;a<this.channels;a++)this.data[i+a]<e[a]&&(e[a]=this.data[i+a]);return e}function max(){this.checkProcessable("max",{bitDepth:[8,16,32]});let e=newArray(this.channels,-1/0);for(let i=0;i<this.data.length;i+=this.channels)for(let a=0;a<this.channels;a++)this.data[i+a]>e[a]&&(e[a]=this.data[i+a]);return e}function sum(){this.checkProcessable("sum",{bitDepth:[8,16]});let e=newArray(this.channels,0);for(let i=0;i<this.data.length;i+=this.channels)for(let a=0;a<this.channels;a++)e[a]+=this.data[i+a];return e}function getMoment(e=0,i=0){this.checkProcessable("getMoment",{bitDepth:[1]});let a=0;for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++)this.getBitXY(s,o)===1&&(a+=s**e*o**i);return a}function localMaxima(e={}){let{mask:i,region:a=3,removeClosePoints:s=0,invert:o=!1,maxEquals:h=2}=e,d=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),a*=4;let g=o?0:1,b=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],_=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],$=a<=8?1:2,it=[];for(let nt=$;nt<d.height-$;nt++)for(let tt=$;tt<d.width-$;tt++){if(i&&i.getBitXY(tt,nt)!==g)continue;let at=0,ut=0,ft=d.data[tt+nt*d.width];for(let ht=0;ht<a;ht++)o?d.data[tt+b[ht]+(nt+_[ht])*d.width]>ft&&at++:d.data[tt+b[ht]+(nt+_[ht])*d.width]<ft&&at++,d.data[tt+b[ht]+(nt+_[ht])*d.width]===ft&&ut++;at+ut===a&&ut<=h&&it.push([tt,nt])}if(s>0)for(let nt=0;nt<it.length;nt++)for(let tt=nt+1;tt<it.length;tt++)Math.sqrt(Math.pow(it[nt][0]-it[tt][0],2)+Math.pow(it[nt][1]-it[tt][1],2))<s&&(it[nt][0]=it[nt][0]+it[tt][0]>>1,it[nt][1]=it[nt][1]+it[tt][1]>>1,it.splice(tt,1),tt--);return it}function mean(){let e=this.getHistograms({maxSlots:this.maxValue+1}),i=new Array(e.length);for(let a=0;a<e.length;a++){let s=e[a];i[a]=mean$2(s)}return i}function median(){let e=this.getHistograms({maxSlots:this.maxValue+1}),i=new Array(e.length);for(let a=0;a<e.length;a++){let s=e[a];i[a]=median$2(s)}return i}function points(){this.checkProcessable("points",{bitDepth:[1]});const e=[];for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++)this.getBitXY(i,a)===1&&e.push([i,a]);return e}function extendedPoints(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const e=[];for(let i=0;i<this.height;i++)for(let a=0;a<this.width;a++)if(this.getBitXY(a,i)===1)for(e.push([a,i]),this.getBitXY(a+1,i)!==1?(e.push([a+1,i]),e.push([a+1,i+1]),this.getBitXY(a,i+1)!==1&&e.push([a,i+1])):this.getBitXY(a,i+1)!==1&&(e.push([a,i+1]),e.push([a+1,i+1]));a<this.width-2&&this.getBitXY(a+1,i)===1&&this.getBitXY(a+2,i)===1;)a++;return e}function getRelativePosition(e,i={}){if(this===e)return[0,0];let a=[0,0],s=this;for(;s;){if(s===e)return a;s.position&&(a[0]+=s.position[0],a[1]+=s.position[1]),s=s.parent}return i.defaultFurther?a:!1}function countAlphaPixels(e={}){let{alpha:i=1}=e;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let a=0;if(i!==void 0){for(let s=this.components;s<this.data.length;s+=this.channels)this.data[s]===i&&a++;return a}else return this.size}function monotoneChainConvexHull$1(e,i={}){const{sorted:a}=i;a||(e=e.slice().sort(byXThenY));const s=e.length,o=new Array(s*2);let h=0;for(let g=0;g<s;g++){const b=e[g];for(;h>=2&&cw(o[h-2],o[h-1],b)<=0;)h--;o[h++]=b}const d=h+1;for(let g=s-2;g>=0;g--){const b=e[g];for(;h>=d&&cw(o[h-2],o[h-1],b)<=0;)h--;o[h++]=b}return o.slice(0,h-1)}function cw(e,i,a){return(i[1]-e[1])*(a[0]-e[0])-(i[0]-e[0])*(a[1]-e[1])}function byXThenY(e,i){return e[0]===i[0]?e[1]-i[1]:e[0]-i[0]}function monotoneChainConvexHull(){return monotoneChainConvexHull$1(this.extendedPoints,{sorted:!1})}function round(e){for(let i=0;i<e.length;i++)e[i][0]=Math.round(e[i][0]),e[i][1]=Math.round(e[i][1]);return e}function difference(e,i){return[e[0]-i[0],e[1]-i[1]]}function normalize(e){let i=Math.sqrt(e[0]**2+e[1]**2);return[e[0]/i,e[1]/i]}function rotate(e,i,a){a===void 0&&(a=new Array(i.length));let s=Math.cos(e),o=Math.sin(e);for(let h=0;h<a.length;++h)a[h]=[s*i[h][0]-o*i[h][1],o*i[h][0]+s*i[h][1]];return a}function perimeter(e){let i=0;for(let a=0;a<e.length;a++){let s=e[a][0],o=e[a][1],h=e[a===e.length-1?0:a+1][0],d=e[a===e.length-1?0:a+1][1];i+=Math.sqrt((h-s)**2+(d-o)**2)}return i}function surface(e){let i=0;for(let a=0;a<e.length;a++){let s=e[a][0],o=e[a===e.length-1?0:a+1][1],h=e[a===e.length-1?0:a+1][0],d=e[a][1];i+=s*o*.5,i-=h*d*.5}return Math.abs(i)}function minMax(e){let i=1/0,a=1/0,s=-1/0,o=-1/0;for(let h=0;h<e.length;h++)e[h][0]<i&&(i=e[h][0]),e[h][0]>s&&(s=e[h][0]),e[h][1]<a&&(a=e[h][1]),e[h][1]>o&&(o=e[h][1]);return[[i,a],[s,o]]}function moveToZeroZero(e,i){i===void 0&&(i=new Array(e.length).fill(0).map(()=>[]));let a=minMax(e),s=a[0][0],o=a[0][1];for(let h=0;h<e.length;h++)i[h][0]=e[h][0]-s,i[h][1]=e[h][1]-o;return i}function minimalBoundingRectangle(e={}){const{originalPoints:i=monotoneChainConvexHull.call(this)}=e;if(i.length===0)return[];if(i.length===1)return[i[0],i[0],i[0],i[0]];const a=new Array(i.length);let s=1/0,o=0,h;for(let d=0;d<a.length;d++){let g=getAngle$1(i[d],i[(d+1)%a.length]);rotate(-g,i,a);let b=a[d][0],_=a[d][1],$=a[(d+1)%a.length][0],it=a[(d+1)%a.length][1],nt=!0,tt=0,at=0,ut=0;for(let st=0;st<a.length;st++){let ct=a[st][0],wt=a[st][1],_t=(ct-b)/($-b);nt===!0?(nt=!1,tt=_t,at=_t):(_t<tt&&(tt=_t),_t>at&&(at=_t));let gt=(-($-b)*wt+$*_-it*b)/($-b);Math.abs(gt)>Math.abs(ut)&&(ut=gt)}let ft=[b+tt*($-b),_],ht=[b+at*($-b),_],dt=Math.abs(ut*(tt-at)*($-b));dt<s&&(o=g,s=dt,h=[ft,ht,[ht[0],ht[1]-ut],[ft[0],ft[1]-ut]])}return rotate(o,h,h),h}function getAngle$1(e,i){let a=difference(i,e),s=normalize(a),o=Math.acos(s[0]);return s[1]<0?-o:o}function extend$1(e){let i={inPlace:!0};e.extendMethod("invert",invert),e.extendMethod("abs",abs),e.extendMethod("level",level,i),e.extendMethod("add",add,i),e.extendMethod("subtract",subtract,i),e.extendMethod("subtractImage",subtractImage),e.extendMethod("multiply",multiply,i),e.extendMethod("divide",divide,i),e.extendMethod("hypotenuse",hypotenuse),e.extendMethod("background",background$1),e.extendMethod("flipX",flipX),e.extendMethod("flipY",flipY),e.extendMethod("blurFilter",blurFilter),e.extendMethod("medianFilter",medianFilter),e.extendMethod("gaussianFilter",gaussianFilter),e.extendMethod("sobelFilter",sobelFilter),e.extendMethod("gradientFilter",gradientFilter),e.extendMethod("scharrFilter",scharrFilter),e.extendMethod("dilate",dilate),e.extendMethod("erode",erode),e.extendMethod("open",open),e.extendMethod("close",close),e.extendMethod("topHat",topHat),e.extendMethod("blackHat",blackHat),e.extendMethod("morphologicalGradient",morphologicalGradient),e.extendMethod("warpingFourPoints",warpingFourPoints),e.extendMethod("crop",crop),e.extendMethod("cropAlpha",cropAlpha),e.extendMethod("resize",resize).extendMethod("scale",resize),e.extendMethod("hsv",hsv),e.extendMethod("hsl",hsl$1),e.extendMethod("cmyk",cmyk),e.extendMethod("rgba8",rgba8),e.extendMethod("grey",grey).extendMethod("gray",grey),e.extendMethod("mask",mask),e.extendMethod("pad",pad),e.extendMethod("colorDepth",colorDepth),e.extendMethod("setBorder",setBorder,i),e.extendMethod("rotate",rotate$1),e.extendMethod("rotateLeft",rotateLeft),e.extendMethod("rotateRight",rotateRight),e.extendMethod("insert",insert),e.extendMethod("getRow",getRow),e.extendMethod("getColumn",getColumn),e.extendMethod("getMatrix",getMatrix),e.extendMethod("setMatrix",setMatrix),e.extendMethod("getPixelsArray",getPixelsArray),e.extendMethod("getIntersection",getIntersection),e.extendMethod("getClosestCommonParent",getClosestCommonParent),e.extendMethod("getThreshold",getThreshold),e.extendMethod("split",split),e.extendMethod("getChannel",getChannel),e.extendMethod("combineChannels",combineChannels),e.extendMethod("setChannel",setChannel),e.extendMethod("getSimilarity",getSimilarity),e.extendMethod("getPixelsGrid",getPixelsGrid),e.extendMethod("getBestMatch",getBestMatch),e.extendMethod("cannyEdge",cannyEdge),e.extendMethod("convolution",convolution),e.extendMethod("extract",extract),e.extendMethod("floodFill",floodFill),e.extendMethod("paintLabels",paintLabels,i),e.extendMethod("paintMasks",paintMasks,i),e.extendMethod("paintPoints",paintPoints,i),e.extendMethod("paintPolyline",paintPolyline,i),e.extendMethod("paintPolylines",paintPolylines,i),e.extendMethod("paintPolygon",paintPolygon,i),e.extendMethod("paintPolygons",paintPolygons,i),e.extendMethod("countAlphaPixels",countAlphaPixels),e.extendMethod("monotoneChainConvexHull",monotoneChainConvexHull),e.extendMethod("minimalBoundingRectangle",minimalBoundingRectangle),e.extendMethod("getHistogram",getHistogram).extendProperty("histogram",getHistogram),e.extendMethod("getHistograms",getHistograms).extendProperty("histograms",getHistograms),e.extendMethod("getColorHistogram",getColorHistogram).extendProperty("colorHistogram",getColorHistogram),e.extendMethod("getMin",min).extendProperty("min",min),e.extendMethod("getMax",max).extendProperty("max",max),e.extendMethod("getSum",sum).extendProperty("sum",sum),e.extendMethod("getMoment",getMoment).extendProperty("moment",getMoment),e.extendMethod("getLocalMaxima",localMaxima),e.extendMethod("getMedian",median).extendProperty("median",median),e.extendMethod("getMean",mean).extendProperty("mean",mean),e.extendMethod("getPoints",points).extendProperty("points",points),e.extendMethod("getExtendedPoints",extendedPoints).extendProperty("extendedPoints",extendedPoints),e.extendMethod("getRelativePosition",getRelativePosition)}var quantities$1={exports:{}},quantities=quantities$1.exports,hasRequiredQuantities;function requireQuantities(){return hasRequiredQuantities||(hasRequiredQuantities=1,function(e,i){(function(a,s){e.exports=s()})(quantities,function(){function a(lt){return typeof lt=="string"||lt instanceof String}var s=Number.isFinite||window.isFinite;function o(lt){return s(lt)}function h(lt){return lt}function d(lt){var et={};return lt.filter(function(j){return et.hasOwnProperty(j)?!1:et[j]=!0})}function g(lt,et){if(et.length!==lt.length)return!1;for(var j=0;j<lt.length;j++)if(et[j].compareArray&&!et[j].compareArray(lt[j])||et[j]!==lt[j])return!1;return!0}function b(lt,et){Object.keys(et).forEach(function(j){lt[j]=et[j]})}function _(){for(var lt=1,et=0,j=0;j<arguments.length;j++){var rt=arguments[j];et=et+nt(rt),lt*=rt}return et!==0?it(lt,et):lt}function $(lt,et){if(et===0)throw new Error("Divide by zero");var j=Math.pow(10,nt(et)),rt=j/(j*et);return _(lt,rt)}function it(lt,et){return Math.round(lt*Math.pow(10,et))/Math.pow(10,et)}function nt(lt){if(!isFinite(lt))return 0;for(var et=0;lt%1!==0;)lt*=10,et++;return et}function tt(){var lt;if(!this)return lt=Object.create(tt.prototype),tt.apply(lt,arguments),lt;lt=Error.apply(this,arguments),this.name="QtyError",this.message=lt.message,this.stack=lt.stack}tt.prototype=Object.create(Error.prototype,{constructor:{value:tt}});function at(lt,et){throw new tt("Incompatible units: "+lt+" and "+et)}var ut={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","μ","µ","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],3600*24,"time",["<second>"]],"<week>":[["wk","week","weeks"],7*3600*24,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","Ω","Ω"],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},ft=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],ht="<1>",dt=[ht];function st(lt,et){var j=et[1],rt=et[3]||[],ot=et[4]||[];if(!o(j))throw new tt(lt+": Invalid unit definition. 'scalar' must be a number");rt.forEach(function(pt){if(ut[pt]===void 0)throw new tt(lt+": Invalid unit definition. Unit "+pt+" in 'numerator' is not recognized")}),ot.forEach(function(pt){if(ut[pt]===void 0)throw new tt(lt+": Invalid unit definition. Unit "+pt+" in 'denominator' is not recognized")})}var ct={},wt={},_t={},gt={},yt={};for(var bt in ut)if(ut.hasOwnProperty(bt)){var vt=ut[bt];if(vt[2]==="prefix"){ct[bt]=vt[1];for(var Ct=0;Ct<vt[0].length;Ct++)wt[vt[0][Ct]]=bt}else{st(bt,vt),_t[bt]={scalar:vt[1],numerator:vt[3],denominator:vt[4]};for(var Ht=0;Ht<vt[0].length;Ht++)gt[vt[0][Ht]]=bt}yt[bt]=vt[0][0]}function Ft(lt){var et,j=[],rt=Object.keys(ut);if(typeof lt>"u")for(et=0;et<rt.length;et++)["","prefix"].indexOf(ut[rt[et]][2])===-1&&j.push(rt[et].substr(1,rt[et].length-2));else{if(this.getKinds().indexOf(lt)===-1)throw new tt("Kind not recognized");for(et=0;et<rt.length;et++)ut[rt[et]][2]===lt&&j.push(rt[et].substr(1,rt[et].length-2))}return j.sort(function(ot,pt){return ot.toLowerCase()<pt.toLowerCase()?-1:ot.toLowerCase()>pt.toLowerCase()?1:0})}function qt(lt){if(!gt[lt])throw new tt("Unit not recognized");return ut[gt[lt]][0]}var zt=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function Qt(){if(this.signature)return this.signature;for(var lt=_e.call(this),et=0;et<lt.length;et++)lt[et]*=Math.pow(20,et);return lt.reduce(function(j,rt){return j+rt},0)}function _e(){if(!this.isBase())return _e.call(this.toBase());for(var lt=new Array(zt.length),et=0;et<lt.length;et++)lt[et]=0;for(var j,rt,ot=0;ot<this.numerator.length;ot++)(j=ut[this.numerator[ot]])&&(rt=zt.indexOf(j[2]),rt>=0&&(lt[rt]=lt[rt]+1));for(var pt=0;pt<this.denominator.length;pt++)(j=ut[this.denominator[pt]])&&(rt=zt.indexOf(j[2]),rt>=0&&(lt[rt]=lt[rt]-1));return lt}var Gt="[+-]",Jt="\\d+",or=Gt+"?"+Jt,mr="\\."+Jt,hr="(?:"+Jt+"(?:"+mr+")?)|(?:"+mr+")",Lr="[Ee]"+or,Er="(?:"+hr+")(?:"+Lr+")?",Kt=Gt+"?\\s*"+Er,fr="("+Kt+")?\\s*([^/]*)(?:/(.+))?",Rr=new RegExp("^"+fr+"$"),gr="\\^|\\*{2}",ir="[01234]",Vr=new RegExp("([^ \\*\\d]+?)(?:"+gr+")?(-?"+ir+"(?![a-zA-Z]))"),Ur=new RegExp("([^ \\*\\d]+?)(?:"+gr+")?("+ir+"(?![a-zA-Z]))");function Fr(lt){a(lt)||(lt=lt.toString()),lt=lt.trim();var et=Rr.exec(lt);if(!et)throw new tt(lt+": Quantity not recognized");var j=et[1];j?(j=j.replace(/\s/g,""),this.scalar=parseFloat(j)):this.scalar=1;for(var rt=et[2],ot=et[3],pt,kt,Et;et=Vr.exec(rt);){if(pt=parseFloat(et[2]),isNaN(pt))throw new tt("Unit exponent is not a number");if(pt===0&&!Cr.test(et[1]))throw new tt("Unit not recognized");kt=et[1]+" ",Et="";for(var Pt=0;Pt<Math.abs(pt);Pt++)Et+=kt;pt>=0?rt=rt.replace(et[0],Et):(ot=ot?ot+Et:Et,rt=rt.replace(et[0],""))}for(;et=Ur.exec(ot);){if(pt=parseFloat(et[2]),isNaN(pt))throw new tt("Unit exponent is not a number");if(pt===0&&!Cr.test(et[1]))throw new tt("Unit not recognized");kt=et[1]+" ",Et="";for(var Nt=0;Nt<pt;Nt++)Et+=kt;ot=ot.replace(et[0],Et)}rt&&(this.numerator=Dr(rt.trim())),ot&&(this.denominator=Dr(ot.trim()))}var Sr=Object.keys(wt).sort(function(lt,et){return et.length-lt.length}).join("|"),vr=Object.keys(gt).sort(function(lt,et){return et.length-lt.length}).join("|"),Qr="\\b|$",Or="("+Sr+")??("+vr+")(?:"+Qr+")",Cr=new RegExp("^\\s*("+Or+"[\\s\\*]*)+$"),Hr=new RegExp(Or,"g"),nr={};function Dr(lt){var et=nr[lt];if(et)return et;var j,rt=[];if(!Cr.test(lt))throw new tt("Unit not recognized");for(;j=Hr.exec(lt);)rt.push(j.slice(1));return rt=rt.map(function(ot){return wt[ot[0]]?[wt[ot[0]],gt[ot[1]]]:[gt[ot[1]]]}),rt=rt.reduce(function(ot,pt){return ot.concat(pt)},[]),rt=rt.filter(function(ot){return ot}),nr[lt]=rt,rt}function qr(lt){if(!a(lt))throw new tt("Argument should be a string");try{return this(lt)}catch{return null}}function Nr(lt){return lt instanceof _r}function _r(lt,et){if(jr.apply(null,arguments),!Nr(this))return new _r(lt,et);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=dt,this.denominator=dt,Ar(lt)?(this.scalar=lt.scalar,this.numerator=lt.numerator&&lt.numerator.length!==0?lt.numerator:dt,this.denominator=lt.denominator&&lt.denominator.length!==0?lt.denominator:dt):et?(Fr.call(this,et),this.scalar=lt):Fr.call(this,lt),this.denominator.join("*").indexOf("temp")>=0)throw new tt("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new tt("Cannot multiply by temperatures");if(!g(this.denominator,dt))throw new tt("Cannot divide with temperatures")}if(this.initValue=lt,$r.call(this),this.isTemperature()&&this.baseScalar<0)throw new tt("Temperatures must not be less than absolute zero")}_r.prototype={constructor:_r};function jr(lt,et){if(et){if(!(o(lt)&&a(et)))throw new tt("Only number accepted as initialization value when units are explicitly provided")}else if(!(a(lt)||o(lt)||Nr(lt)||Ar(lt)))throw new tt("Only string, number or quantity accepted as single initialization value")}function Ar(lt){return lt&&typeof lt=="object"&&lt.hasOwnProperty("scalar")}function $r(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=Qt.call(this);else{var lt=this.toBase();this.baseScalar=lt.scalar,this.signature=lt.signature}}var Tr={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency","25599999980":"information_rate","25600000000":"information","511999999980":"angular_velocity","512000000000":"angle"};function Gr(){return d(Object.keys(Tr).map(function(lt){return Tr[lt]}))}_r.prototype.kind=function(){return Tr[this.signature.toString()]},b(_r.prototype,{isDegrees:function(){return(this.signature===null||this.signature===400)&&this.numerator.length===1&&g(this.denominator,dt)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}});function xr(lt,et){var j=lt.units(),rt=et.to(j),ot=_r(ur(j));return _r({scalar:lt.scalar-rt.scalar,numerator:ot.numerator,denominator:ot.denominator})}function Br(lt,et){var j=et.to(ur(lt.units()));return _r({scalar:lt.scalar-j.scalar,numerator:lt.numerator,denominator:lt.denominator})}function At(lt,et){var j=et.to(ur(lt.units()));return _r({scalar:lt.scalar+j.scalar,numerator:lt.numerator,denominator:lt.denominator})}function ur(lt){if(lt==="tempK")return"degK";if(lt==="tempC")return"degC";if(lt==="tempF")return"degF";if(lt==="tempR")return"degR";throw new tt("Unknown type for temp conversion from: "+lt)}function cr(lt,et){var j=yr(lt),rt=et.units(),ot;if(rt==="degK")ot=j.scalar;else if(rt==="degC")ot=j.scalar;else if(rt==="degF")ot=j.scalar*9/5;else if(rt==="degR")ot=j.scalar*9/5;else throw new tt("Unknown type for degree conversion to: "+rt);return _r({scalar:ot,numerator:et.numerator,denominator:et.denominator})}function yr(lt){var et=lt.units(),j;if(et.match(/(deg)[CFRK]/))j=lt.baseScalar;else if(et==="tempK")j=lt.scalar;else if(et==="tempC")j=lt.scalar;else if(et==="tempF")j=lt.scalar*5/9;else if(et==="tempR")j=lt.scalar*5/9;else throw new tt("Unknown type for temp conversion from: "+et);return _r({scalar:j,numerator:["<kelvin>"],denominator:dt})}function jt(lt,et){var j=et.units(),rt;if(j==="tempK")rt=lt.baseScalar;else if(j==="tempC")rt=lt.baseScalar-273.15;else if(j==="tempF")rt=lt.baseScalar*9/5-459.67;else if(j==="tempR")rt=lt.baseScalar*9/5;else throw new tt("Unknown type for temp conversion to: "+j);return _r({scalar:rt,numerator:et.numerator,denominator:et.denominator})}function lr(lt){var et=lt.units(),j;if(et.match(/(deg)[CFRK]/))j=lt.baseScalar;else if(et==="tempK")j=lt.scalar;else if(et==="tempC")j=lt.scalar+273.15;else if(et==="tempF")j=(lt.scalar+459.67)*5/9;else if(et==="tempR")j=lt.scalar*5/9;else throw new tt("Unknown type for temp conversion from: "+et);return _r({scalar:j,numerator:["<temp-K>"],denominator:dt})}b(_r.prototype,{to:function(lt){var et,j;if(lt==null)return this;if(!a(lt))return this.to(lt.units());if(et=this._conversionCache[lt],et)return et;if(j=_r(lt),j.units()===this.units())return this;if(!this.isCompatible(j))this.isInverse(j)?j=this.inverse().to(lt):at(this.units(),j.units());else if(j.isTemperature())j=jt(this,j);else if(j.isDegrees())j=cr(this,j);else{var rt=$(this.baseScalar,j.baseScalar);j=_r({scalar:rt,numerator:j.numerator,denominator:j.denominator})}return this._conversionCache[lt]=j,j},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return lr(this);var lt=pr[this.units()];return lt||(lt=Yr(this.numerator,this.denominator),pr[this.units()]=lt),lt.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new tt("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(lt){if(a(lt)&&(lt=_r(lt)),o(lt)&&(lt=_r(lt+" "+this.units())),this.isUnitless()?lt.isUnitless()||at(this.units(),lt.units()):lt=lt.to(this.units()),lt.scalar===0)throw new tt("Divide by zero");var et=_(Math.round(this.scalar/lt.scalar),lt.scalar);return _r(et+this.units())}});function xt(lt,et){var j=_r(lt),rt=_r(et);if(j.eq(rt))return h;var ot;return j.isTemperature()?ot=function(pt){return j.mul(pt).to(rt).scalar}:ot=function(pt){return pt*j.baseScalar/rt.baseScalar},function(pt){var kt,Et,Pt;if(Array.isArray(pt)){for(Et=pt.length,Pt=[],kt=0;kt<Et;kt++)Pt.push(ot(pt[kt]));return Pt}else return ot(pt)}}var pr={};function Yr(lt,et){for(var j=[],rt=[],ot=1,pt,kt=0;kt<lt.length;kt++)pt=lt[kt],ct[pt]?ot=_(ot,ct[pt]):_t[pt]&&(ot*=_t[pt].scalar,_t[pt].numerator&&j.push(_t[pt].numerator),_t[pt].denominator&&rt.push(_t[pt].denominator));for(var Et=0;Et<et.length;Et++)pt=et[Et],ct[pt]?ot/=ct[pt]:_t[pt]&&(ot/=_t[pt].scalar,_t[pt].numerator&&rt.push(_t[pt].numerator),_t[pt].denominator&&j.push(_t[pt].denominator));return j=j.reduce(function(Pt,Nt){return Pt.concat(Nt)},[]),rt=rt.reduce(function(Pt,Nt){return Pt.concat(Nt)},[]),_r({scalar:ot,numerator:j,denominator:rt})}_r.parse=qr,_r.getUnits=Ft,_r.getAliases=qt,_r.mulSafe=_,_r.divSafe=$,_r.getKinds=Gr,_r.swiftConverter=xt,_r.Error=tt,b(_r.prototype,{add:function(lt){if(a(lt)&&(lt=_r(lt)),this.isCompatible(lt)||at(this.units(),lt.units()),this.isTemperature()&&lt.isTemperature())throw new tt("Cannot add two temperatures");return this.isTemperature()?At(this,lt):lt.isTemperature()?At(lt,this):_r({scalar:this.scalar+lt.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(lt){if(a(lt)&&(lt=_r(lt)),this.isCompatible(lt)||at(this.units(),lt.units()),this.isTemperature()&&lt.isTemperature())return xr(this,lt);if(this.isTemperature())return Br(this,lt);if(lt.isTemperature())throw new tt("Cannot subtract a temperature from a differential degree unit");return _r({scalar:this.scalar-lt.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(lt){if(o(lt))return _r({scalar:_(this.scalar,lt),numerator:this.numerator,denominator:this.denominator});if(a(lt)&&(lt=_r(lt)),(this.isTemperature()||lt.isTemperature())&&!(this.isUnitless()||lt.isUnitless()))throw new tt("Cannot multiply by temperatures");var et=this,j=lt;et.isCompatible(j)&&et.signature!==400&&(j=j.to(et));var rt=mt(et.numerator,et.denominator,j.numerator,j.denominator);return _r({scalar:_(et.scalar,j.scalar,rt[2]),numerator:rt[0],denominator:rt[1]})},div:function(lt){if(o(lt)){if(lt===0)throw new tt("Divide by zero");return _r({scalar:this.scalar/lt,numerator:this.numerator,denominator:this.denominator})}else a(lt)&&(lt=_r(lt));if(lt.scalar===0)throw new tt("Divide by zero");if(lt.isTemperature())throw new tt("Cannot divide with temperatures");if(this.isTemperature()&&!lt.isUnitless())throw new tt("Cannot divide with temperatures");var et=this,j=lt;et.isCompatible(j)&&et.signature!==400&&(j=j.to(et));var rt=mt(et.numerator,et.denominator,j.denominator,j.numerator);return _r({scalar:_(et.scalar,rt[2])/j.scalar,numerator:rt[0],denominator:rt[1]})},inverse:function(){if(this.isTemperature())throw new tt("Cannot divide with temperatures");if(this.scalar===0)throw new tt("Divide by zero");return _r({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}});function mt(lt,et,j,rt){function ot(dr){return dr!==ht}lt=lt.filter(ot),j=j.filter(ot),et=et.filter(ot),rt=rt.filter(ot);var pt={};function kt(dr,Wt){for(var ar,Mr,Ot,br=0;br<dr.length;br++)if(ct[dr[br]]?(ar=dr[br+1],Mr=dr[br],Ot=ct[Mr],br++):(ar=dr[br],Mr=null,Ot=1),ar&&ar!==ht)if(pt[ar]){pt[ar][0]+=Wt;var Pr=pt[ar][2]?ct[pt[ar][2]]:1;pt[ar][Wt===1?3:4]*=$(Ot,Pr)}else pt[ar]=[Wt,ar,Mr,1,1]}kt(lt,1),kt(et,-1),kt(j,1),kt(rt,-1);var Et=[],Pt=[],Nt=1;for(var Xt in pt)if(pt.hasOwnProperty(Xt)){var Lt=pt[Xt],rr;if(Lt[0]>0)for(rr=0;rr<Lt[0];rr++)Et.push(Lt[2]===null?Lt[1]:[Lt[2],Lt[1]]);else if(Lt[0]<0)for(rr=0;rr<-Lt[0];rr++)Pt.push(Lt[2]===null?Lt[1]:[Lt[2],Lt[1]]);Nt*=$(Lt[3],Lt[4])}return Et.length===0&&(Et=dt),Pt.length===0&&(Pt=dt),Et=Et.reduce(function(dr,Wt){return dr.concat(Wt)},[]),Pt=Pt.reduce(function(dr,Wt){return dr.concat(Wt)},[]),[Et,Pt,Nt]}b(_r.prototype,{eq:function(lt){return this.compareTo(lt)===0},lt:function(lt){return this.compareTo(lt)===-1},lte:function(lt){return this.eq(lt)||this.lt(lt)},gt:function(lt){return this.compareTo(lt)===1},gte:function(lt){return this.eq(lt)||this.gt(lt)},compareTo:function(lt){if(a(lt))return this.compareTo(_r(lt));if(this.isCompatible(lt)||at(this.units(),lt.units()),this.baseScalar<lt.baseScalar)return-1;if(this.baseScalar===lt.baseScalar)return 0;if(this.baseScalar>lt.baseScalar)return 1},same:function(lt){return this.scalar===lt.scalar&&this.units()===lt.units()}}),b(_r.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every(function(lt){return g(lt,dt)})},isCompatible:function(lt){return a(lt)?this.isCompatible(_r(lt)):Nr(lt)&&lt.signature!==void 0?this.signature===lt.signature:!1},isInverse:function(lt){return this.inverse().isCompatible(lt)},isBase:function(){return this._isBase!==void 0?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach(function(lt){lt!==ht&&ft.indexOf(lt)===-1&&(this._isBase=!1)},this),this._isBase===!1?this._isBase:(this._isBase=!0,this._isBase))}});function er(){}er.prototype.get=function(lt){return arguments.length>1&&(lt=Array.apply(null,arguments)),lt.reduce(function(et,j,rt){if(et){var ot=et[j];return rt===lt.length-1?ot?ot.data:void 0:ot}},this)},er.prototype.set=function(lt,et){return arguments.length>2&&(lt=Array.prototype.slice.call(arguments,0,-1),et=arguments[arguments.length-1]),lt.reduce(function(j,rt,ot){var pt=j[rt];return pt===void 0&&(pt=j[rt]={}),ot===lt.length-1?(pt.data=et,et):pt},this)};function sr(lt,et){return(lt+" "+et).trim()}_r.formatter=sr,b(_r.prototype,{units:function(){if(this._units!==void 0)return this._units;var lt=g(this.numerator,dt),et=g(this.denominator,dt);if(lt&&et)return this._units="",this._units;var j=Ut(this.numerator),rt=Ut(this.denominator);return this._units=j+(et?"":"/"+rt),this._units},toString:function(lt,et){var j;if(o(lt))j=this.units(),et=lt;else if(a(lt))j=lt;else if(Nr(lt))return this.toPrec(lt).toString(et);var rt=this.to(j),ot=et!==void 0?it(rt.scalar,et):rt.scalar;return rt=(ot+" "+rt.units()).trim(),rt},format:function(lt,et){arguments.length===1&&typeof lt=="function"&&(et=lt,lt=void 0),et=et||_r.formatter;var j=this.to(lt);return et.call(this,j.scalar,j.units())}});var Mt=new er;function Ut(lt){var et=Mt.get(lt);if(et)return et;var j=g(lt,dt);return j?et="1":et=zr(tr(lt)).join("*"),Mt.set(lt,et),et}function tr(lt){for(var et=[],j,rt,ot=0;ot<lt.length;ot++)j=lt[ot],rt=lt[ot+1],ct[j]?(et.push(yt[j]+yt[rt]),ot++):et.push(yt[j]);return et}function zr(lt){var et=lt.reduce(function(j,rt){var ot=j[rt];return ot||j.push(ot=j[rt]=[rt,0]),ot[1]++,j},[]);return et.map(function(j){return j[0]+(j[1]>1?j[1]:"")})}return _r.version="1.8.0",_r})}(quantities$1)),quantities$1.exports}var quantitiesExports=requireQuantities();const Qty=getDefaultExportFromCjs(quantitiesExports);function deepValue(e,i=""){let a=i.split(".");for(let s of a){if(e[s]===void 0)return;e=e[s]}return e}var orientation={exports:{}},twoProduct_1,hasRequiredTwoProduct;function requireTwoProduct(){if(hasRequiredTwoProduct)return twoProduct_1;hasRequiredTwoProduct=1,twoProduct_1=i;var e=+(Math.pow(2,27)+1);function i(a,s,o){var h=a*s,d=e*a,g=d-a,b=d-g,_=a-b,$=e*s,it=$-s,nt=$-it,tt=s-nt,at=h-b*nt,ut=at-_*nt,ft=ut-b*tt,ht=_*tt-ft;return o?(o[0]=ht,o[1]=h,o):[ht,h]}return twoProduct_1}var robustSum,hasRequiredRobustSum;function requireRobustSum(){if(hasRequiredRobustSum)return robustSum;hasRequiredRobustSum=1,robustSum=i;function e(a,s){var o=a+s,h=o-a,d=o-h,g=s-h,b=a-d,_=b+g;return _?[_,o]:[o]}function i(a,s){var o=a.length|0,h=s.length|0;if(o===1&&h===1)return e(a[0],s[0]);var d=o+h,g=new Array(d),b=0,_=0,$=0,it=Math.abs,nt=a[_],tt=it(nt),at=s[$],ut=it(at),ft,ht;tt<ut?(ht=nt,_+=1,_<o&&(nt=a[_],tt=it(nt))):(ht=at,$+=1,$<h&&(at=s[$],ut=it(at))),_<o&&tt<ut||$>=h?(ft=nt,_+=1,_<o&&(nt=a[_],tt=it(nt))):(ft=at,$+=1,$<h&&(at=s[$],ut=it(at)));for(var dt=ft+ht,st=dt-ft,ct=ht-st,wt=ct,_t=dt,gt,yt,bt,vt,Ct;_<o&&$<h;)tt<ut?(ft=nt,_+=1,_<o&&(nt=a[_],tt=it(nt))):(ft=at,$+=1,$<h&&(at=s[$],ut=it(at))),ht=wt,dt=ft+ht,st=dt-ft,ct=ht-st,ct&&(g[b++]=ct),gt=_t+dt,yt=gt-_t,bt=gt-yt,vt=dt-yt,Ct=_t-bt,wt=Ct+vt,_t=gt;for(;_<o;)ft=nt,ht=wt,dt=ft+ht,st=dt-ft,ct=ht-st,ct&&(g[b++]=ct),gt=_t+dt,yt=gt-_t,bt=gt-yt,vt=dt-yt,Ct=_t-bt,wt=Ct+vt,_t=gt,_+=1,_<o&&(nt=a[_]);for(;$<h;)ft=at,ht=wt,dt=ft+ht,st=dt-ft,ct=ht-st,ct&&(g[b++]=ct),gt=_t+dt,yt=gt-_t,bt=gt-yt,vt=dt-yt,Ct=_t-bt,wt=Ct+vt,_t=gt,$+=1,$<h&&(at=s[$]);return wt&&(g[b++]=wt),_t&&(g[b++]=_t),b||(g[b++]=0),g.length=b,g}return robustSum}var twoSum,hasRequiredTwoSum;function requireTwoSum(){if(hasRequiredTwoSum)return twoSum;hasRequiredTwoSum=1,twoSum=e;function e(i,a,s){var o=i+a,h=o-i,d=o-h,g=a-h,b=i-d;return s?(s[0]=b+g,s[1]=o,s):[b+g,o]}return twoSum}var robustScale,hasRequiredRobustScale;function requireRobustScale(){if(hasRequiredRobustScale)return robustScale;hasRequiredRobustScale=1;var e=requireTwoProduct(),i=requireTwoSum();robustScale=a;function a(s,o){var h=s.length;if(h===1){var d=e(s[0],o);return d[0]?d:[d[1]]}var g=new Array(2*h),b=[.1,.1],_=[.1,.1],$=0;e(s[0],o,b),b[0]&&(g[$++]=b[0]);for(var it=1;it<h;++it){e(s[it],o,_);var nt=b[1];i(nt,_[0],b),b[0]&&(g[$++]=b[0]);var tt=_[1],at=b[1],ut=tt+at,ft=ut-tt,ht=at-ft;b[1]=ut,ht&&(g[$++]=ht)}return b[1]&&(g[$++]=b[1]),$===0&&(g[$++]=0),g.length=$,g}return robustScale}var robustDiff,hasRequiredRobustDiff;function requireRobustDiff(){if(hasRequiredRobustDiff)return robustDiff;hasRequiredRobustDiff=1,robustDiff=i;function e(a,s){var o=a+s,h=o-a,d=o-h,g=s-h,b=a-d,_=b+g;return _?[_,o]:[o]}function i(a,s){var o=a.length|0,h=s.length|0;if(o===1&&h===1)return e(a[0],-s[0]);var d=o+h,g=new Array(d),b=0,_=0,$=0,it=Math.abs,nt=a[_],tt=it(nt),at=-s[$],ut=it(at),ft,ht;tt<ut?(ht=nt,_+=1,_<o&&(nt=a[_],tt=it(nt))):(ht=at,$+=1,$<h&&(at=-s[$],ut=it(at))),_<o&&tt<ut||$>=h?(ft=nt,_+=1,_<o&&(nt=a[_],tt=it(nt))):(ft=at,$+=1,$<h&&(at=-s[$],ut=it(at)));for(var dt=ft+ht,st=dt-ft,ct=ht-st,wt=ct,_t=dt,gt,yt,bt,vt,Ct;_<o&&$<h;)tt<ut?(ft=nt,_+=1,_<o&&(nt=a[_],tt=it(nt))):(ft=at,$+=1,$<h&&(at=-s[$],ut=it(at))),ht=wt,dt=ft+ht,st=dt-ft,ct=ht-st,ct&&(g[b++]=ct),gt=_t+dt,yt=gt-_t,bt=gt-yt,vt=dt-yt,Ct=_t-bt,wt=Ct+vt,_t=gt;for(;_<o;)ft=nt,ht=wt,dt=ft+ht,st=dt-ft,ct=ht-st,ct&&(g[b++]=ct),gt=_t+dt,yt=gt-_t,bt=gt-yt,vt=dt-yt,Ct=_t-bt,wt=Ct+vt,_t=gt,_+=1,_<o&&(nt=a[_]);for(;$<h;)ft=at,ht=wt,dt=ft+ht,st=dt-ft,ct=ht-st,ct&&(g[b++]=ct),gt=_t+dt,yt=gt-_t,bt=gt-yt,vt=dt-yt,Ct=_t-bt,wt=Ct+vt,_t=gt,$+=1,$<h&&(at=-s[$]);return wt&&(g[b++]=wt),_t&&(g[b++]=_t),b||(g[b++]=0),g.length=b,g}return robustDiff}var hasRequiredOrientation;function requireOrientation(){return hasRequiredOrientation||(hasRequiredOrientation=1,function(e){var i=requireTwoProduct(),a=requireRobustSum(),s=requireRobustScale(),o=requireRobustDiff(),h=5,d=11102230246251565e-32,g=(3+16*d)*d,b=(7+56*d)*d;function _(st,ct,wt,_t){return function(gt,yt,bt){var vt=st(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),st(ct(gt[1],yt[0]),ct(-yt[1],gt[0]))),Ct=st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),Ht=_t(vt,Ct);return Ht[Ht.length-1]}}function $(st,ct,wt,_t){return function(gt,yt,bt,vt){var Ct=st(st(wt(st(ct(bt[1],vt[0]),ct(-vt[1],bt[0])),yt[2]),st(wt(st(ct(yt[1],vt[0]),ct(-vt[1],yt[0])),-bt[2]),wt(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),vt[2]))),st(wt(st(ct(yt[1],vt[0]),ct(-vt[1],yt[0])),gt[2]),st(wt(st(ct(gt[1],vt[0]),ct(-vt[1],gt[0])),-yt[2]),wt(st(ct(gt[1],yt[0]),ct(-yt[1],gt[0])),vt[2])))),Ht=st(st(wt(st(ct(bt[1],vt[0]),ct(-vt[1],bt[0])),gt[2]),st(wt(st(ct(gt[1],vt[0]),ct(-vt[1],gt[0])),-bt[2]),wt(st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),vt[2]))),st(wt(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),gt[2]),st(wt(st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),-yt[2]),wt(st(ct(gt[1],yt[0]),ct(-yt[1],gt[0])),bt[2])))),Ft=_t(Ct,Ht);return Ft[Ft.length-1]}}function it(st,ct,wt,_t){return function(gt,yt,bt,vt,Ct){var Ht=st(st(st(wt(st(wt(st(ct(vt[1],Ct[0]),ct(-Ct[1],vt[0])),bt[2]),st(wt(st(ct(bt[1],Ct[0]),ct(-Ct[1],bt[0])),-vt[2]),wt(st(ct(bt[1],vt[0]),ct(-vt[1],bt[0])),Ct[2]))),yt[3]),st(wt(st(wt(st(ct(vt[1],Ct[0]),ct(-Ct[1],vt[0])),yt[2]),st(wt(st(ct(yt[1],Ct[0]),ct(-Ct[1],yt[0])),-vt[2]),wt(st(ct(yt[1],vt[0]),ct(-vt[1],yt[0])),Ct[2]))),-bt[3]),wt(st(wt(st(ct(bt[1],Ct[0]),ct(-Ct[1],bt[0])),yt[2]),st(wt(st(ct(yt[1],Ct[0]),ct(-Ct[1],yt[0])),-bt[2]),wt(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),Ct[2]))),vt[3]))),st(wt(st(wt(st(ct(bt[1],vt[0]),ct(-vt[1],bt[0])),yt[2]),st(wt(st(ct(yt[1],vt[0]),ct(-vt[1],yt[0])),-bt[2]),wt(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),vt[2]))),-Ct[3]),st(wt(st(wt(st(ct(vt[1],Ct[0]),ct(-Ct[1],vt[0])),yt[2]),st(wt(st(ct(yt[1],Ct[0]),ct(-Ct[1],yt[0])),-vt[2]),wt(st(ct(yt[1],vt[0]),ct(-vt[1],yt[0])),Ct[2]))),gt[3]),wt(st(wt(st(ct(vt[1],Ct[0]),ct(-Ct[1],vt[0])),gt[2]),st(wt(st(ct(gt[1],Ct[0]),ct(-Ct[1],gt[0])),-vt[2]),wt(st(ct(gt[1],vt[0]),ct(-vt[1],gt[0])),Ct[2]))),-yt[3])))),st(st(wt(st(wt(st(ct(yt[1],Ct[0]),ct(-Ct[1],yt[0])),gt[2]),st(wt(st(ct(gt[1],Ct[0]),ct(-Ct[1],gt[0])),-yt[2]),wt(st(ct(gt[1],yt[0]),ct(-yt[1],gt[0])),Ct[2]))),vt[3]),st(wt(st(wt(st(ct(yt[1],vt[0]),ct(-vt[1],yt[0])),gt[2]),st(wt(st(ct(gt[1],vt[0]),ct(-vt[1],gt[0])),-yt[2]),wt(st(ct(gt[1],yt[0]),ct(-yt[1],gt[0])),vt[2]))),-Ct[3]),wt(st(wt(st(ct(bt[1],vt[0]),ct(-vt[1],bt[0])),yt[2]),st(wt(st(ct(yt[1],vt[0]),ct(-vt[1],yt[0])),-bt[2]),wt(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),vt[2]))),gt[3]))),st(wt(st(wt(st(ct(bt[1],vt[0]),ct(-vt[1],bt[0])),gt[2]),st(wt(st(ct(gt[1],vt[0]),ct(-vt[1],gt[0])),-bt[2]),wt(st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),vt[2]))),-yt[3]),st(wt(st(wt(st(ct(yt[1],vt[0]),ct(-vt[1],yt[0])),gt[2]),st(wt(st(ct(gt[1],vt[0]),ct(-vt[1],gt[0])),-yt[2]),wt(st(ct(gt[1],yt[0]),ct(-yt[1],gt[0])),vt[2]))),bt[3]),wt(st(wt(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),gt[2]),st(wt(st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),-yt[2]),wt(st(ct(gt[1],yt[0]),ct(-yt[1],gt[0])),bt[2]))),-vt[3]))))),Ft=st(st(st(wt(st(wt(st(ct(vt[1],Ct[0]),ct(-Ct[1],vt[0])),bt[2]),st(wt(st(ct(bt[1],Ct[0]),ct(-Ct[1],bt[0])),-vt[2]),wt(st(ct(bt[1],vt[0]),ct(-vt[1],bt[0])),Ct[2]))),gt[3]),wt(st(wt(st(ct(vt[1],Ct[0]),ct(-Ct[1],vt[0])),gt[2]),st(wt(st(ct(gt[1],Ct[0]),ct(-Ct[1],gt[0])),-vt[2]),wt(st(ct(gt[1],vt[0]),ct(-vt[1],gt[0])),Ct[2]))),-bt[3])),st(wt(st(wt(st(ct(bt[1],Ct[0]),ct(-Ct[1],bt[0])),gt[2]),st(wt(st(ct(gt[1],Ct[0]),ct(-Ct[1],gt[0])),-bt[2]),wt(st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),Ct[2]))),vt[3]),wt(st(wt(st(ct(bt[1],vt[0]),ct(-vt[1],bt[0])),gt[2]),st(wt(st(ct(gt[1],vt[0]),ct(-vt[1],gt[0])),-bt[2]),wt(st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),vt[2]))),-Ct[3]))),st(st(wt(st(wt(st(ct(bt[1],Ct[0]),ct(-Ct[1],bt[0])),yt[2]),st(wt(st(ct(yt[1],Ct[0]),ct(-Ct[1],yt[0])),-bt[2]),wt(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),Ct[2]))),gt[3]),wt(st(wt(st(ct(bt[1],Ct[0]),ct(-Ct[1],bt[0])),gt[2]),st(wt(st(ct(gt[1],Ct[0]),ct(-Ct[1],gt[0])),-bt[2]),wt(st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),Ct[2]))),-yt[3])),st(wt(st(wt(st(ct(yt[1],Ct[0]),ct(-Ct[1],yt[0])),gt[2]),st(wt(st(ct(gt[1],Ct[0]),ct(-Ct[1],gt[0])),-yt[2]),wt(st(ct(gt[1],yt[0]),ct(-yt[1],gt[0])),Ct[2]))),bt[3]),wt(st(wt(st(ct(yt[1],bt[0]),ct(-bt[1],yt[0])),gt[2]),st(wt(st(ct(gt[1],bt[0]),ct(-bt[1],gt[0])),-yt[2]),wt(st(ct(gt[1],yt[0]),ct(-yt[1],gt[0])),bt[2]))),-Ct[3])))),qt=_t(Ht,Ft);return qt[qt.length-1]}}function nt(st){var ct=st===3?_:st===4?$:it;return ct(a,i,s,o)}var tt=nt(3),at=nt(4),ut=[function(){return 0},function(){return 0},function(st,ct){return ct[0]-st[0]},function(st,ct,wt){var _t=(st[1]-wt[1])*(ct[0]-wt[0]),gt=(st[0]-wt[0])*(ct[1]-wt[1]),yt=_t-gt,bt;if(_t>0){if(gt<=0)return yt;bt=_t+gt}else if(_t<0){if(gt>=0)return yt;bt=-(_t+gt)}else return yt;var vt=g*bt;return yt>=vt||yt<=-vt?yt:tt(st,ct,wt)},function(st,ct,wt,_t){var gt=st[0]-_t[0],yt=ct[0]-_t[0],bt=wt[0]-_t[0],vt=st[1]-_t[1],Ct=ct[1]-_t[1],Ht=wt[1]-_t[1],Ft=st[2]-_t[2],qt=ct[2]-_t[2],zt=wt[2]-_t[2],Qt=yt*Ht,_e=bt*Ct,Gt=bt*vt,Jt=gt*Ht,or=gt*Ct,mr=yt*vt,hr=Ft*(Qt-_e)+qt*(Gt-Jt)+zt*(or-mr),Lr=(Math.abs(Qt)+Math.abs(_e))*Math.abs(Ft)+(Math.abs(Gt)+Math.abs(Jt))*Math.abs(qt)+(Math.abs(or)+Math.abs(mr))*Math.abs(zt),Er=b*Lr;return hr>Er||-hr>Er?hr:at(st,ct,wt,_t)}];function ft(st){var ct=ut[st.length];return ct||(ct=ut[st.length]=nt(st.length)),ct.apply(void 0,st)}function ht(st,ct,wt,_t,gt,yt,bt){return function(vt,Ct,Ht,Ft,qt){switch(arguments.length){case 0:case 1:return 0;case 2:return _t(vt,Ct);case 3:return gt(vt,Ct,Ht);case 4:return yt(vt,Ct,Ht,Ft);case 5:return bt(vt,Ct,Ht,Ft,qt)}for(var zt=new Array(arguments.length),Qt=0;Qt<arguments.length;++Qt)zt[Qt]=arguments[Qt];return st(zt)}}function dt(){for(;ut.length<=h;)ut.push(nt(ut.length));e.exports=ht.apply(void 0,[ft].concat(ut));for(var st=0;st<=h;++st)e.exports[st]=ut[st]}dt()}(orientation)),orientation.exports}var robustPnp,hasRequiredRobustPnp;function requireRobustPnp(){if(hasRequiredRobustPnp)return robustPnp;hasRequiredRobustPnp=1,robustPnp=i;var e=requireOrientation();function i(a,s){for(var o=s[0],h=s[1],d=a.length,g=1,b=d,_=0,$=d-1;_<b;$=_++){var it=a[_],nt=a[$],tt=it[1],at=nt[1];if(at<tt){if(at<h&&h<tt){var ut=e(it,nt,s);if(ut===0)return 0;g^=0<ut|0}else if(h===tt){var ft=a[(_+1)%d],ht=ft[1];if(tt<ht){var ut=e(it,nt,s);if(ut===0)return 0;g^=0<ut|0}}}else if(tt<at){if(tt<h&&h<at){var ut=e(it,nt,s);if(ut===0)return 0;g^=ut<0|0}else if(h===tt){var ft=a[(_+1)%d],ht=ft[1];if(ht<tt){var ut=e(it,nt,s);if(ut===0)return 0;g^=ut<0|0}}}else if(h===tt){var dt=Math.min(it[0],nt[0]),st=Math.max(it[0],nt[0]);if(_===0){for(;$>0;){var ct=($+d-1)%d,wt=a[ct];if(wt[1]!==h)break;var _t=wt[0];dt=Math.min(dt,_t),st=Math.max(st,_t),$=ct}if($===0)return dt<=o&&o<=st?0:1;b=$+1}for(var gt=a[($+d-1)%d][1];_+1<b;){var wt=a[_+1];if(wt[1]!==h)break;var _t=wt[0];dt=Math.min(dt,_t),st=Math.max(st,_t),_+=1}if(dt<=o&&o<=st)return 0;var yt=a[(_+1)%d][1];o<dt&&gt<h!=yt<h&&(g^=1)}}return 2*g-1}return robustPnp}var robustPnpExports=requireRobustPnp();const robustPointInPolygon=getDefaultExportFromCjs(robustPnpExports);function feretDiameters(e={}){const{originalPoints:i=monotoneChainConvexHull.call(this)}=e;if(i.length===0)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(i.length===1)return{min:1,max:1,minLine:[i[0],i[0]],maxLine:[i[0],i[0]],aspectRatio:1};const a=new Array(i.length);let s=1/0,o=0,h=[];for(let _=0;_<i.length;_++){let $=getAngle(i[_],i[(_+1)%i.length]);rotate(-$,i,a);let it=0,nt=[];for(let tt=0;tt<i.length;tt++){let at=Math.abs(a[_][1]-a[tt][1]);at>it&&(it=at,nt=[],nt.push([a[tt][0],a[_][1]],[a[tt][0],a[tt][1]]))}it<s&&(s=it,o=$,h=nt)}rotate(o,h,h);let d=0,g=[],b=0;for(let _=0;_<i.length-1;_++)for(let $=_+1;$<i.length;$++){let it=(i[_][0]-i[$][0])**2+(i[_][1]-i[$][1])**2;it>b&&(b=it,d=Math.sqrt(it),g=[i[_],i[$]])}return{min:s,minLine:h,max:d,maxLine:g,aspectRatio:s/d}}function getAngle(e,i){let a=difference(i,e),s=normalize(a),o=Math.acos(s[0]);return s[1]<0?-o:o}class Roi{constructor(i,a){this.map=i,this.id=a,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(i={}){const{scale:a=1,kind:s=""}=i;let o;switch(s){case"contour":o=this.contourMask;break;case"box":o=this.boxMask;break;case"filled":o=this.filledMask;break;case"center":o=this.centerMask;break;case"mbr":o=this.mbrFilledMask;break;case"hull":o=this.convexHullFilledMask;break;case"hullContour":o=this.convexHullMask;break;case"mbrContour":o=this.mbrMask;break;case"feret":o=this.feretMask;break;default:o=this.mask}return a<1&&(o=o.resize({factor:a}),o.parent=this.mask.parent,o.position[0]+=this.minX,o.position[1]+=this.minY),o}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let i=this.borderIDs,a=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let s=this.internalIDs;for(let o=0;o<i.length;o++)s.includes(i[o])||(this.computed.externalIDs.push(i[o]),this.computed.externalLengths.push(a[o]))}get externalIDs(){return this.computed.externalIDs?this.computed.externalIDs:(this._computExternalIDs(),this.computed.externalIDs)}get externalLengths(){return this.computed.externalLengths?this.computed.externalLengths:(this._computExternalIDs(),this.computed.externalLengths)}_computeBorderIDs(){let i=getBorders(this);this.computed.borderIDs=i.ids,this.computed.borderLengths=i.lengths}get borderIDs(){return this.computed.borderIDs?this.computed.borderIDs:(this._computeBorderIDs(),this.computed.borderIDs)}get borderLengths(){return this.computed.borderLengths?this.computed.borderLengths:(this._computeBorderIDs(),this.computed.borderLengths)}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=getBoxIDs(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=getInternalIDs(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=getBox(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=getExternal(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=getHolesInfo(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=getBorder(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let i=new Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let a=0;a<this.width;a++)for(let s=0;s<this.height;s++)this.map.data[a+this.minX+(s+this.minY)*this.map.width]===this.id&&(a>0&&a<this.width-1&&s>0&&s<this.height-1?(this.map.data[a-1+this.minX+(s+this.minY)*this.map.width]!==this.id||this.map.data[a+1+this.minX+(s+this.minY)*this.map.width]!==this.id||this.map.data[a+this.minX+(s-1+this.minY)*this.map.width]!==this.id||this.map.data[a+this.minX+(s+1+this.minY)*this.map.width]!==this.id)&&i.setBitXY(a,s):i.setBitXY(a,s));this.computed.contourMask=i}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let i=new Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let a=0;a<this.width;a++)i.setBitXY(a,0),i.setBitXY(a,this.height-1);for(let a=0;a<this.height;a++)i.setBitXY(0,a),i.setBitXY(this.width-1,a);this.computed.boxMask=i}return this.computed.boxMask}get mask(){if(!this.computed.mask){let i=new Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let a=0;a<this.width;a++)for(let s=0;s<this.height;s++)this.map.data[a+this.minX+(s+this.minY)*this.map.width]===this.id&&i.setBitXY(a,s);this.computed.mask=i}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let i=new Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let a=0;a<this.width;a++)for(let s=0;s<this.height;s++){let o=a+this.minX+(s+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[o])&&i.setBitXY(a,s)}this.computed.filledMask=i}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let i=new Shape({kind:"smallCross"}).getMask();i.parent=this.map.parent,i.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=i}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const i=[];for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++)this.map.data[s+this.minX+(o+this.minY)*this.map.width]===this.id&&(s>0&&s<this.width-1&&o>0&&o<this.height-1?(this.map.data[s-1+this.minX+(o+this.minY)*this.map.width]!==this.id||this.map.data[s+1+this.minX+(o+this.minY)*this.map.width]!==this.id||this.map.data[s+this.minX+(o-1+this.minY)*this.map.width]!==this.id||this.map.data[s+this.minX+(o+1+this.minY)*this.map.width]!==this.id)&&(i.push([s,o]),i.push([s+1,o]),i.push([s,o+1]),i.push([s+1,o+1])):(i.push([s,o]),i.push([s+1,o]),i.push([s,o+1]),i.push([s+1,o+1])));const a=monotoneChainConvexHull$1(i);this.computed.convexHull={polyline:a,surface:surface(a),perimeter:perimeter(a)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const i=this.convexHull,a=new Image(this.width+1,this.height+1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});a.paintPolyline(i.polyline,{closed:!0}),this.computed.convexHullMask=a}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const i=this.convexHull,a=new Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++)robustPointInPolygon(i.polyline,[s,o])!==1&&a.setBitXY(s,o);this.computed.convexHullFilledMask=a}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let i=minimalBoundingRectangle({originalPoints:this.convexHull.polyline});if(i.length===0)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:i};else{let a=i[0],s=i[1],o=i[2],h=Math.sqrt((a[0]-s[0])**2+(a[1]-s[1])**2),d=Math.sqrt((o[0]-s[0])**2+(o[1]-s[1])**2);this.computed.mbr={width:h,height:d,elongation:1-h/d,aspectRatio:h/d,surface:h*d,perimeter:(h+d)*2,rectangle:i}}}return this.computed.mbr}get filledSurface(){return this.surface+this.holesInfo.surface}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=feretDiameters({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=getPerimeterInfo(this)),this.computed.perimeterInfo}get perimeter(){let i=this.perimeterInfo,a=2-Math.sqrt(2);return i.one+i.two*2+i.three*3+i.four*4-a*(i.two+i.three*2+i.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const i=new Image(this.width+1,this.height+1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent});i.paintPolyline(this.feretDiameters.minLine),i.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=i}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let i=round(this.mbr.rectangle);if(i.length>0){const a=minMax(i),s=new Image(a[1][0]-a[0][0]+1,a[1][1]-a[0][1]+1,{kind:BINARY,position:[this.minX+a[0][0],this.minY+a[0][1]],parent:this.map.parent});i=moveToZeroZero(i),s.paintPolyline(i,{closed:!0}),this.computed.mbrMask=s}else this.computed.mbrMask=new Image(1,1,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const i=new Image(this.width,this.height,{kind:BINARY,position:[this.minX,this.minY],parent:this.map.parent}),a=this.mask.minimalBoundingRectangle();for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++)robustPointInPolygon(a,[s,o])!==1&&i.setBitXY(s,o);this.computed.mbrFilledMask=i}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let i=[];for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++){let o=(a+this.minY)*this.map.width+s+this.minX;this.map.data[o]===this.id&&i.push([s,a])}this.computed.points=i}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let i=0,a;const s=this.points;for(let o=0;o<s.length;o++)for(let h=o+1;h<s.length;h++){let d=Math.pow(s[o][0]-s[h][0],2)+Math.pow(s[o][1]-s[h][1],2);d>=i&&(i=d,a=[s[o],s[h]])}this.computed.maxLengthPoints=a}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let i=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=i}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let i=this.maxLengthPoints,a=-Math.atan2(i[0][1]-i[1][1],i[0][0]-i[1][0])*180/Math.PI;this.computed.angle=a}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,filledSurface:this.filledSurface,surface:this.surface,hullSurface:this.convexHull.surface,hullPerimeter:this.convexHull.perimeter,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}function getBorders(e){let i=e.map,a=i.data,s=new Set,o=new Map,h=new Set,d=[1,0,-1,0],g=[0,1,0,-1];for(let $=e.minX;$<=e.maxX;$++)for(let it=e.minY;it<=e.maxY;it++){let nt=$+it*i.width;if(a[nt]===e.id)for(let tt=0;tt<4;tt++){let at=$+d[tt],ut=it+g[tt];if(at>=0&&ut>=0&&at<i.width&&ut<i.height){let ft=at+ut*i.width;if(a[ft]!==e.id&&!h.has(ft)){h.add(ft),s.add(a[ft]);let ht=o.get(a[ft]);ht?o.set(a[ft],++ht):o.set(a[ft],1)}}}}let b=Array.from(s),_=b.map(function($){return o.get($)});return{ids:b,lengths:_}}function getBoxIDs(e){let i=new Set,a=e.map,s=a.data;for(let o of[0,e.height-1])for(let h=0;h<e.width;h++){let d=(o+e.minY)*a.width+h+e.minX;if(h-e.minX>0&&s[d]===e.id&&s[d-1]!==e.id){let g=s[d-1];i.add(g)}if(a.width-h-e.minX>1&&s[d]===e.id&&s[d+1]!==e.id){let g=s[d+1];i.add(g)}}for(let o of[0,e.width-1])for(let h=0;h<e.height;h++){let d=(h+e.minY)*a.width+o+e.minX;if(h-e.minY>0&&s[d]===e.id&&s[d-a.width]!==e.id){let g=s[d-a.width];i.add(g)}if(a.height-h-e.minY>1&&s[d]===e.id&&s[d+a.width]!==e.id){let g=s[d+a.width];i.add(g)}}return Array.from(i)}function getBox(e){let i=0,a=e.map,s=a.data,o=[0];e.height>1&&(o[1]=e.height-1);for(let d of o)for(let g=1;g<e.width-1;g++){let b=(d+e.minY)*a.width+g+e.minX;s[b]===e.id&&i++}let h=[0];e.width>1&&(h[1]=e.width-1);for(let d of h)for(let g=0;g<e.height;g++){let b=(g+e.minY)*a.width+d+e.minX;s[b]===e.id&&i++}return i}function getBorder(e){let i=0,a=e.map,s=a.data;for(let o=1;o<e.width-1;o++)for(let h=1;h<e.height-1;h++){let d=(h+e.minY)*a.width+o+e.minX;s[d]===e.id&&(s[d-1]!==e.id||s[d+1]!==e.id||s[d-a.width]!==e.id||s[d+a.width]!==e.id)&&i++}return i+e.box}function getPerimeterInfo(e){let i=e.map,a=i.data,s=0,o=0,h=0,d=0;for(let g=0;g<e.width;g++)for(let b=0;b<e.height;b++){let _=(b+e.minY)*i.width+g+e.minX;if(a[_]===e.id){let $=0;switch((g===0||e.externalIDs.includes(a[_-1]))&&$++,(g===e.width-1||e.externalIDs.includes(a[_+1]))&&$++,(b===0||e.externalIDs.includes(a[_-i.width]))&&$++,(b===e.height-1||e.externalIDs.includes(a[_+i.width]))&&$++,$){case 1:s++;break;case 2:o++;break;case 3:h++;break;case 4:d++;break}}}return{one:s,two:o,three:h,four:d}}function getExternal(e){let i=0,a=e.map,s=a.data;for(let o=1;o<e.width-1;o++)for(let h=1;h<e.height-1;h++){let d=(h+e.minY)*a.width+o+e.minX;s[d]===e.id&&(e.externalIDs.includes(s[d-1])||e.externalIDs.includes(s[d+1])||e.externalIDs.includes(s[d-a.width])||e.externalIDs.includes(s[d+a.width]))&&i++}return i+e.box}function getHolesInfo(e){let i=0,a=e.map.width,s=e.map.data;for(let o=1;o<e.width-1;o++)for(let h=1;h<e.height-1;h++){let d=(h+e.minY)*a+o+e.minX;e.internalIDs.includes(s[d])&&s[d]!==e.id&&i++}return{number:e.internalIDs.length-1,surface:i}}function getInternalIDs(e){let i=[e.id],a=e.map,s=a.data;if(e.height>2)for(let h=0;h<e.width;h++){let d=e.minY*a.width+h+e.minX;if(i.includes(s[d])){let g=s[d+a.width];!i.includes(g)&&!e.boxIDs.includes(g)&&i.push(g)}}let o=new Array(4);for(let h=1;h<e.width-1;h++)for(let d=1;d<e.height-1;d++){let g=(d+e.minY)*a.width+h+e.minX;if(i.includes(s[g])){o[0]=s[g-1],o[1]=s[g+1],o[2]=s[g-a.width],o[3]=s[g+a.width];for(let b=0;b<4;b++){let _=o[b];!i.includes(_)&&!e.boxIDs.includes(_)&&i.push(_)}}}return i}class RoiLayer{constructor(i,a){this.roiMap=i,this.options=a,this.roi=this.createRoi()}createRoi(){let i=this.roiMap.data,a={};this.roiMap.positive=0,this.roiMap.negative=0;for(let g=0;g<i.length;g++)i[g]&&!a[i[g]]&&(a[i[g]]=!0,i[g]>0?this.roiMap.positive++:this.roiMap.negative++);let s={};for(let g in a)s[g]=new Roi(this.roiMap,g*1);let o=this.roiMap.width,h=this.roiMap.height;for(let g=0;g<h;g++)for(let b=0;b<o;b++){let _=g*o+b;if(i[_]!==0){const $=i[_],it=s[$];b<it.minX&&(it.minX=b),b>it.maxX&&(it.maxX=b),g<it.minY&&(it.minY=g),g>it.maxY&&(it.maxY=g),it.meanX+=b,it.meanY+=g,it.surface++}}let d=[];for(let g in a)s[g].meanX/=s[g].surface,s[g].meanY/=s[g].surface,d.push(s[g]);return d}}function commonBorderLength(e){let i=e.data,a=[1,0,-1,0],s=[0,1,0,-1],o=e.minMax,h=-o.min,d=o.max+h,g=[];for(let _=0;_<=d;_++)g.push(Object.create(null));for(let _=0;_<e.width;_++)for(let $=0;$<e.height;$++){let it=_+$*e.width,nt=i[it];if(nt!==0){let tt=Object.create(null),at=!1;for(let ut=0;ut<4;ut++){let ft=_+a[ut],ht=$+s[ut];if(ft>=0&&ht>=0&&ft<e.width&&ht<e.height){let dt=i[ft+ht*e.width];nt!==dt&&(at=!0,dt!==0&&tt[dt]===void 0&&(tt[dt]=!0,g[dt+h][nt]?g[dt+h][nt]++:g[dt+h][nt]=1))}else at=!0}at&&(g[nt+h][nt]?g[nt+h][nt]++:g[nt+h][nt]=1)}}let b={};for(let _=0;_<g.length;_++)Object.keys(g[_]).length>0&&(b[_-h]=g[_]);return b}function mergeRoi(e={}){const{algorithm:i="commonBorderLength",minCommonBorderLength:a=5,maxCommonBorderLength:s=100,minCommonBorderRatio:o=.3,maxCommonBorderRatio:h=1}=e;let d=function(ft,ht,dt){return ft[dt]>=a&&ft[dt]<=s};typeof i=="function"&&(d=i),i.toLowerCase()==="commonborderratio"&&(d=function(ft,ht,dt){let st=Math.min(ft[dt]/ft[ht],1);return st>=o&&st<=h});const g=this,b=g.commonBorderLength;let _={},$={};for(let ft of Object.keys(b)){let ht=b[ft],dt=Object.keys(ht);for(let st of dt)if(st!==ft&&d(ht,ft,st)){let ct=st;$[st]&&(ct=$[st]);let wt=ft;if($[ft]&&(wt=$[ft]),Number(ct)!==wt){let _t=Math.min(ct,wt),gt=Math.max(ct,wt);if(_[_t]||(_[_t]={}),_[_t][gt]=!0,$[gt]=_t,_[gt]){for(let yt of Object.keys(_[gt]))_[_t][yt]=!0,$[yt]=_t;delete _[gt]}}}}let it=g.minMax,nt=-it.min,tt=it.max+nt,at=new Array(tt+1).fill(0);for(let ft of Object.keys($))at[Number(ft)+nt]=$[ft];let ut=g.data;for(let ft=0;ft<ut.length;ft++){let ht=ut[ft];if(ht!==0){let dt=at[ht+nt];dt!==0&&(ut[ft]=dt)}}return g.computed={},g}class RoiMap{constructor(i,a){this.parent=i,this.width=i.width,this.height=i.height,this.data=a,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let i=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(let s=0;s<this.data.length;s++)this.data[s]<i&&(i=this.data[s]),this.data[s]>a&&(a=this.data[s]);return{min:i,max:a}}get commonBorderLength(){return commonBorderLength(this)}mergeRoi(i={}){return mergeRoi.call(this,i)}mergeRois(i){const a=i[0],s=i.slice(1);for(let o=0;o<this.data.length;o++)s.includes(this.data[o])&&(this.data[o]=a)}rowsInfo(){let i=new Array(this.height),a=0;for(let s=0;s<this.data.length;s+=this.width){let o={row:a,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};i[a++]=o;let h={},d={},g=[],b=this.data[s],_=0;for(let $=s;$<s+this.width;$++){let it=this.data[$];b!==it&&(b=it,g.push(_),_=0),_++,it>0?(o.positivePixel++,h[it]||(h[it]=!0)):it<0?(o.negativePixel++,d[it]||(d[it]=!0)):o.zeroPixel++}g.push(_),o.medianChange=g.sort(($,it)=>$-it)[Math.floor(g.length/2)],o.positiveRoiIDs=Object.keys(h),o.negativeRoiIDs=Object.keys(d),o.positiveRoi=o.positiveRoiIDs.length,o.negativeRoi=o.negativeRoiIDs.length}return i}colsInfo(){let i=new Array(this.width),a=0;for(let s=0;s<this.width;s++){let o={col:a,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};i[a++]=o;let h={},d={},g=[],b=this.data[s],_=0;for(let $=s;$<s+this.data.length;$+=this.width){let it=this.data[$];b!==it&&(b=it,g.push(_),_=0),_++,it>0?(o.positivePixel++,h[it]||(h[it]=!0)):it<0?(o.negativePixel++,d[it]||(d[it]=!0)):o.zeroPixel++}g.push(_),o.medianChange=g.sort(($,it)=>$-it)[Math.floor(g.length/2)],o.positiveRoiIDs=Object.keys(h),o.negativeRoiIDs=Object.keys(d),o.positiveRoi=o.positiveRoiIDs.length,o.negativeRoi=o.negativeRoiIDs.length}return i}}function fromMask(e,i={}){const{allowCorners:a=!1}=i,s=65535;let o=new Int16Array(e.size),h=0,d=0,g=new Uint16Array(s+1),b=new Uint16Array(s+1);for(let $=0;$<e.width;$++)for(let it=0;it<e.height;it++)o[it*e.width+$]===0&&_($,it);function _($,it){let nt=0,tt=0,at=e.getBitXY($,it),ut=at?++h:--d;if(h>32767||d<-32768)throw new Error("Too many regions of interest");for(g[0]=$,b[0]=it;nt<=tt;){let ft=g[nt&s],ht=b[nt&s];if(o[ht*e.width+ft]=ut,ft>0&&o[ht*e.width+ft-1]===0&&e.getBitXY(ft-1,ht)===at&&(tt++,g[tt&s]=ft-1,b[tt&s]=ht,o[ht*e.width+ft-1]=-32768),ht>0&&o[(ht-1)*e.width+ft]===0&&e.getBitXY(ft,ht-1)===at&&(tt++,g[tt&s]=ft,b[tt&s]=ht-1,o[(ht-1)*e.width+ft]=-32768),ft<e.width-1&&o[ht*e.width+ft+1]===0&&e.getBitXY(ft+1,ht)===at&&(tt++,g[tt&s]=ft+1,b[tt&s]=ht,o[ht*e.width+ft+1]=-32768),ht<e.height-1&&o[(ht+1)*e.width+ft]===0&&e.getBitXY(ft,ht+1)===at&&(tt++,g[tt&s]=ft,b[tt&s]=ht+1,o[(ht+1)*e.width+ft]=-32768),a&&(ft>0&&ht>0&&o[(ht-1)*e.width+ft-1]===0&&e.getBitXY(ft-1,ht-1)===at&&(tt++,g[tt&s]=ft-1,b[tt&s]=ht-1,o[(ht-1)*e.width+ft-1]=-32768),ft<e.width-1&&ht>0&&o[(ht-1)*e.width+ft+1]===0&&e.getBitXY(ft+1,ht-1)===at&&(tt++,g[tt&s]=ft+1,b[tt&s]=ht-1,o[(ht-1)*e.width+ft+1]=-32768),ft>0&&ht<e.height-1&&o[(ht+1)*e.width+ft-1]===0&&e.getBitXY(ft-1,ht+1)===at&&(tt++,g[tt&s]=ft-1,b[tt&s]=ht+1,o[(ht+1)*e.width+ft-1]=-32768),ft<e.width-1&&ht<e.height-1&&o[(ht+1)*e.width+ft+1]===0&&e.getBitXY(ft+1,ht+1)===at&&(tt++,g[tt&s]=ft+1,b[tt&s]=ht+1,o[(ht+1)*e.width+ft+1]=-32768)),nt++,tt-nt>s)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new RoiMap(e,o)}var DisjointSet_1,hasRequiredDisjointSet;function requireDisjointSet(){if(hasRequiredDisjointSet)return DisjointSet_1;hasRequiredDisjointSet=1;class e{constructor(){this.nodes=new Map}add(s){var o=this.nodes.get(s);return o||(o=new i(s),this.nodes.set(s,o)),o}union(s,o){const h=this.find(s),d=this.find(o);h!==d&&(h.rank<d.rank?h.parent=d:h.rank>d.rank?d.parent=h:(d.parent=h,h.rank++))}find(s){for(var o=s;o.parent!==null;)o=o.parent;for(var h=s;h.parent!==null;){var d=h;h=h.parent,d.parent=o}return o}connected(s,o){return this.find(s)===this.find(o)}}DisjointSet_1=e;function i(a){this.value=a,this.parent=null,this.rank=0}return DisjointSet_1}var DisjointSetExports=requireDisjointSet();const DisjointSet=getDefaultExportFromCjs(DisjointSetExports),direction4X=[-1,0],direction4Y=[0,-1],neighbours4=[null,null],direction8X=[-1,-1,0,1],direction8Y=[0,-1,-1,-1],neighbours8=[null,null,null,null];function fromMaskConnectedComponentLabelingAlgorithm(e,i={}){const{allowCorners:a=!1}=i;let s=4;a&&(s=8);let o,h,d;if(s===8)o=direction8X,h=direction8Y,d=neighbours8;else if(s===4)o=direction4X,h=direction4Y,d=neighbours4;else throw new RangeError(`unsupported neighbours count: ${s}`);const g=e.size,b=e.width,_=e.height,$=new Array(g),it=new Uint32Array(g),nt=new DisjointSet;let tt=1;for(let at=0;at<_;at++)for(let ut=0;ut<b;ut++){const ft=ut+at*b;if(e.getBit(ft)){let ht=null;for(let dt=0;dt<d.length;dt++){const st=ut+o[dt],ct=at+h[dt];if(st>=0&&ct>=0&&st<b&&ct<_){const wt=st+ct*b;let _t=$[wt];_t?(d[dt]=_t,(!ht||d[dt].value<ht.value)&&(ht=d[dt])):d[dt]=null}}if(!ht)$[ft]=nt.add(tt++);else{$[ft]=ht;for(let dt=0;dt<d.length;dt++)d[dt]&&d[dt]!==ht&&nt.union(ht,d[dt])}}}for(let at=0;at<_;at++)for(let ut=0;ut<b;ut++){const ft=ut+at*b;e.getBit(ft)&&(it[ft]=nt.find($[ft]).value)}return new RoiMap(e,it)}function fromMaxima(e={}){let{allowCorner:i=!0,onlyTop:a=!1,invert:s=!1}=e,o=this;o.checkProcessable("fromMaxima",{components:[1]});const h=1,d=2;let g=0,b=0,_=new Int16Array(o.size),$=new Int8Array(o.size),it=new Float32Array(o.size),nt=1048575,tt=new Uint16Array(nt+1),at=new Uint16Array(nt+1),ut=0,ft=0,ht=new Uint16Array(nt+1),dt=new Uint16Array(nt+1),st=0,ct=0;for(wt(o);ut<ft;){let yt=tt[ut&nt],bt=at[ut&nt];gt(yt,bt,d),ut++}return new RoiMap(o,_);function wt({maxima:yt=!0}){for(let bt=1;bt<o.height-1;bt++)for(let vt=1;vt<o.width-1;vt++){let Ct=vt+bt*o.width;if($[Ct]===0){let Ht=yt?o.data[Ct]:-o.data[vt+bt*o.width];if(o.data[bt*o.width+vt-1]>Ht||o.data[bt*o.width+vt+1]>Ht||o.data[(bt-1)*o.width+vt]>Ht||o.data[(bt+1)*o.width+vt]>Ht||i&&(o.data[(bt-1)*o.width+vt-1]>Ht||o.data[(bt-1)*o.width+vt+1]>Ht||o.data[(bt+1)*o.width+vt-1]>Ht||o.data[(bt+1)*o.width+vt+1]>Ht))continue;_[Ct]=yt?++g:--b,_t(vt,bt)||(yt?--g:++b)}}}function _t(yt,bt){let vt=ft;st=0,ct=1,ht[0]=yt,dt[0]=bt;let Ct=!0;for(;st<ct;){let Ht=ht[st&nt],Ft=dt[st&nt];Ct&=gt(Ht,Ft,h),st++}if(!Ct){for(let Ht=0;Ht<ct;Ht++){let Ft=ht[Ht&nt],qt=dt[Ht&nt]*o.width+Ft;_[qt]=0}ft=vt}return Ct}function gt(yt,bt,vt){let Ct=_[bt*o.width+yt],Ht=o.data[bt*o.width+yt];for(let Ft=bt-1;Ft<=bt+1;Ft++)for(let qt=yt-1;qt<=yt+1;qt++){let zt=Ft*o.width+qt;if($[zt]===0)switch($[zt]=1,it[zt]=o.data[zt]-Ht,vt){case h:if(it[zt]===0){if(qt===0||Ft===0||qt===o.width-1||Ft===o.height-1)return!1;_[zt]=Ct,ht[ct&nt]=qt,dt[ct&nt]=Ft,ct++}else{if(it[zt]>0)return!1;a||(_[zt]=Ct,tt[ft&nt]=qt,at[ft&nt]=Ft,ft++)}break;case d:it[zt]<=0&&(_[zt]=Ct,tt[ft&nt]=qt,at[ft&nt]=Ft,ft++);break;default:throw new Error("unreachable")}}return!0}}function fromPoints(e,i={}){let a=new Shape(i),s=new Int16Array(this.size),o=0,h=a.getPoints();for(let d=0;d<e.length;d++){o++;let g=e[d][0],b=e[d][1];for(let _=0;_<h.length;_++){let $=h[_][0],it=h[_][1];g+$>=0&&b+it>=0&&g+$<this.width&&b+it<this.height&&(s[g+$+(b+it)*this.width]=o)}}return new RoiMap(this,s)}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var priorityQueue={exports:{}},hasRequiredPriorityQueue;function requirePriorityQueue(){return hasRequiredPriorityQueue||(hasRequiredPriorityQueue=1,function(e,i){(function(a){e.exports=a()})(function(){return function a(s,o,h){function d(_,$){if(!o[_]){if(!s[_]){var it=typeof commonjsRequire=="function"&&commonjsRequire;if(!$&&it)return it(_,!0);if(g)return g(_,!0);var nt=new Error("Cannot find module '"+_+"'");throw nt.code="MODULE_NOT_FOUND",nt}var tt=o[_]={exports:{}};s[_][0].call(tt.exports,function(at){var ut=s[_][1][at];return d(ut||at)},tt,tt.exports,a,s,o,h)}return o[_].exports}for(var g=typeof commonjsRequire=="function"&&commonjsRequire,b=0;b<h.length;b++)d(h[b]);return d}({1:[function(a,s,o){var h,d,g,b,_,$=function(nt,tt){for(var at in tt)it.call(tt,at)&&(nt[at]=tt[at]);function ut(){this.constructor=nt}return ut.prototype=tt.prototype,nt.prototype=new ut,nt.__super__=tt.prototype,nt},it={}.hasOwnProperty;h=a("./PriorityQueue/AbstractPriorityQueue"),d=a("./PriorityQueue/ArrayStrategy"),b=a("./PriorityQueue/BinaryHeapStrategy"),g=a("./PriorityQueue/BHeapStrategy"),_=function(nt){$(tt,nt);function tt(at){at||(at={}),at.strategy||(at.strategy=b),at.comparator||(at.comparator=function(ut,ft){return(ut||0)-(ft||0)}),tt.__super__.constructor.call(this,at)}return tt}(h),_.ArrayStrategy=d,_.BinaryHeapStrategy=b,_.BHeapStrategy=g,s.exports=_},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(a,s,o){s.exports=function(){function h(d){var g;if((d!=null?d.strategy:void 0)==null)throw"Must pass options.strategy, a strategy";if((d!=null?d.comparator:void 0)==null)throw"Must pass options.comparator, a comparator";this.priv=new d.strategy(d),this.length=(d!=null&&(g=d.initialValues)!=null?g.length:void 0)||0}return h.prototype.queue=function(d){this.length++,this.priv.queue(d)},h.prototype.dequeue=function(d){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},h.prototype.peek=function(d){if(!this.length)throw"Empty queue";return this.priv.peek()},h.prototype.clear=function(){return this.length=0,this.priv.clear()},h}()},{}],3:[function(a,s,o){var h;h=function(d,g,b){var _,$,it;for($=0,_=d.length;$<_;)it=$+_>>>1,b(d[it],g)>=0?$=it+1:_=it;return $},s.exports=function(){function d(g){var b;this.options=g,this.comparator=this.options.comparator,this.data=((b=this.options.initialValues)!=null?b.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return d.prototype.queue=function(g){var b;b=h(this.data,g,this.comparator),this.data.splice(b,0,g)},d.prototype.dequeue=function(){return this.data.pop()},d.prototype.peek=function(){return this.data[this.data.length-1]},d.prototype.clear=function(){this.data.length=0},d}()},{}],4:[function(a,s,o){s.exports=function(){function h(d){var g,b,_,$,it,nt,tt,at;for(this.comparator=(d!=null?d.comparator:void 0)||function(ut,ft){return ut-ft},this.pageSize=(d!=null?d.pageSize:void 0)||512,this.length=0,tt=0;1<<tt<this.pageSize;)tt+=1;if(1<<tt!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=tt,this._emptyMemoryPageTemplate=g=[],b=0,it=this.pageSize;0<=it?b<it:b>it;0<=it?++b:--b)g.push(null);if(this._memory=[],this._mask=this.pageSize-1,d.initialValues)for(nt=d.initialValues,_=0,$=nt.length;_<$;_++)at=nt[_],this.queue(at)}return h.prototype.queue=function(d){this.length+=1,this._write(this.length,d),this._bubbleUp(this.length,d)},h.prototype.dequeue=function(){var d,g;return d=this._read(1),g=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,g),this._bubbleDown(1,g)),d},h.prototype.peek=function(){return this._read(1)},h.prototype.clear=function(){this.length=0,this._memory.length=0},h.prototype._write=function(d,g){var b;for(b=d>>this._shift;b>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[b][d&this._mask]=g},h.prototype._read=function(d){return this._memory[d>>this._shift][d&this._mask]},h.prototype._bubbleUp=function(d,g){var b,_,$,it;for(b=this.comparator;d>1&&(_=d&this._mask,d<this.pageSize||_>3?$=d&~this._mask|_>>1:_<2?($=d-this.pageSize>>this._shift,$+=$&~(this._mask>>1),$|=this.pageSize>>1):$=d-2,it=this._read($),!(b(it,g)<0));)this._write($,g),this._write(d,it),d=$},h.prototype._bubbleDown=function(d,g){var b,_,$,it,nt;for(nt=this.comparator;d<this.length;)if(d>this._mask&&!(d&this._mask-1)?b=_=d+2:d&this.pageSize>>1?(b=(d&~this._mask)>>1,b|=d&this._mask>>1,b=b+1<<this._shift,_=b+1):(b=d+(d&this._mask),_=b+1),b!==_&&_<=this.length)if($=this._read(b),it=this._read(_),nt($,g)<0&&nt($,it)<=0)this._write(b,g),this._write(d,$),d=b;else if(nt(it,g)<0)this._write(_,g),this._write(d,it),d=_;else break;else if(b<=this.length)if($=this._read(b),nt($,g)<0)this._write(b,g),this._write(d,$),d=b;else break;else break},h}()},{}],5:[function(a,s,o){s.exports=function(){function h(d){var g;this.comparator=(d!=null?d.comparator:void 0)||function(b,_){return b-_},this.length=0,this.data=((g=d.initialValues)!=null?g.slice(0):void 0)||[],this._heapify()}return h.prototype._heapify=function(){var d,g,b;if(this.data.length>0)for(d=g=1,b=this.data.length;1<=b?g<b:g>b;d=1<=b?++g:--g)this._bubbleUp(d)},h.prototype.queue=function(d){this.data.push(d),this._bubbleUp(this.data.length-1)},h.prototype.dequeue=function(){var d,g;return g=this.data[0],d=this.data.pop(),this.data.length>0&&(this.data[0]=d,this._bubbleDown(0)),g},h.prototype.peek=function(){return this.data[0]},h.prototype.clear=function(){this.length=0,this.data.length=0},h.prototype._bubbleUp=function(d){for(var g,b;d>0&&(g=d-1>>>1,this.comparator(this.data[d],this.data[g])<0);)b=this.data[g],this.data[g]=this.data[d],this.data[d]=b,d=g},h.prototype._bubbleDown=function(d){var g,b,_,$,it;for(g=this.data.length-1;b=(d<<1)+1,$=b+1,_=d,b<=g&&this.comparator(this.data[b],this.data[_])<0&&(_=b),$<=g&&this.comparator(this.data[$],this.data[_])<0&&(_=$),_!==d;)it=this.data[_],this.data[_]=this.data[d],this.data[d]=it,d=_},h}()},{}]},{},[1])(1)})}(priorityQueue)),priorityQueue.exports}var priorityQueueExports=requirePriorityQueue();const PriorityQueue=getDefaultExportFromCjs(priorityQueueExports),dxs=[1,0,-1,0,1,1,-1,-1],dys=[0,1,0,-1,1,-1,1,-1];function fromWaterShed(e={}){let{points:i,mask:a,image:s,fillMaxValue:o=this.maxValue,invert:h=!1}=e,d=s||this;d.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),h=!h,i||(i=d.getLocalMaxima({invert:h,mask:a}));let g=h?0:1,b=new Int16Array(d.size),_=d.width,$=d.height,it=new PriorityQueue({comparator:(nt,tt)=>nt[2]-tt[2],strategy:PriorityQueue.BinaryHeapStrategy});for(let nt=0;nt<i.length;nt++){let tt=i[nt][0]+i[nt][1]*_;b[tt]=nt+1;let at=d.data[tt];(h&&at<=o||!h&&at>=o)&&it.queue([i[nt][0],i[nt][1],at])}for(;it.length>0;){let nt=it.dequeue(),tt=nt[0]+nt[1]*_;for(let at=0;at<4;at++){let ut=nt[0]+dxs[at],ft=nt[1]+dys[at];if(ut>=0&&ft>=0&&ut<_&&ft<$){let ht=ut+ft*_;if(!a||a.getBit(ht)===g){let dt=d.data[ht];(h&&dt<=o||!h&&dt>=o)&&b[ht]===0&&(b[ht]=b[tt],it.queue([nt[0]+dxs[at],nt[1]+dys[at],dt]))}}}}return new RoiMap(d,b)}class RoiManager{constructor(i,a={}){this._image=i,this._options=a,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(i={}){let a=Object.assign({},this._options,i),s=fromMaxima.call(this._image,i);this._layers[a.label]=new RoiLayer(s,a)}fromPoints(i,a={}){let s=Object.assign({},this._options,a),o=fromPoints.call(this._image,i,a);return this._layers[s.label]=new RoiLayer(o,s),this}putMap(i,a={}){let s=new RoiMap(this._image,i),o=Object.assign({},this._options,a);return this._layers[o.label]=new RoiLayer(s,o),this}fromWaterShed(i={}){let a=Object.assign({},this._options,i),s=fromWaterShed.call(this._image,i);this._layers[a.label]=new RoiLayer(s,a)}fromMask(i,a={}){let s=Object.assign({},this._options,a),o=fromMask.call(this._image,i,a);return this._layers[s.label]=new RoiLayer(o,s),this}fromMaskConnectedComponentLabelingAlgorithm(i,a={}){let s=Object.assign({},this._options,a),o=fromMaskConnectedComponentLabelingAlgorithm.call(this._image,i,a);return this._layers[s.label]=new RoiLayer(o,s),this}getMap(i={}){let a=Object.assign({},this._options,i);return this._assertLayerWithLabel(a.label),this._layers[a.label].roiMap}rowsInfo(i={}){return this.getMap(i).rowsInfo()}colsInfo(i={}){return this.getMap(i).rowsInfo()}getRoiIds(i={}){let a=this.getRois(i);if(a){let s=new Array(a.length);for(let o=0;o<a.length;o++)s[o]=a[o].id;return s}throw new Error("ROIs not found")}getRois(i={}){let{label:a=this._options.label,positive:s=!0,negative:o=!0,minSurface:h=0,maxSurface:d=Number.POSITIVE_INFINITY,minWidth:g=0,maxWidth:b=Number.POSITIVE_INFINITY,minHeight:_=0,maxHeight:$=Number.POSITIVE_INFINITY,minRatio:it=0,maxRatio:nt=Number.POSITIVE_INFINITY}=i;if(!this._layers[a])throw new Error(`this Roi layer (${a}) does not exist`);const tt=this._layers[a].roi,at=[];for(const ut of tt)(ut.id<0&&o||ut.id>0&&s)&&ut.surface>=h&&ut.surface<=d&&ut.width>=g&&ut.width<=b&&ut.height>=_&&ut.height<=$&&ut.ratio>=it&&ut.ratio<=nt&&at.push(ut);return at}getRoi(i,a={}){const{label:s=this._options.label}=a;if(!this._layers[s])throw new Error(`this Roi layer (${s}) does not exist`);const o=this._layers[s].roi.find(h=>h.id===i);if(!o)throw new Error(`found no Roi with id ${i}`);return o}getMasks(i={}){let a=this.getRois(i),s=new Array(a.length);for(let o=0;o<a.length;o++)s[o]=a[o].getMask(i);return s}getAnalysisMasks(i={}){const{analysisProperty:a}=i;let s=`${a}Mask`,o=this.getRois(i);return o.length===0||!o[0][s]?[]:o.map(h=>h[s])}getData(i={}){let a=Object.assign({},this._options,i);return this._assertLayerWithLabel(a.label),this._layers[a.label].roiMap.data}paint(i={}){let{labelProperty:a,analysisProperty:s}=i;this._painted||(this._painted=this._image.rgba8());let o=this.getMasks(i);if(a){const h=this.getRois(i);i.labels=h.map(_=>deepValue(_,a));const d=Math.max(...i.labels);let g=!1,b=!1;if(a.includes("surface")?g=!0:/(?:perimeter|min|max|external|width|height|length)/.test(a)&&(b=!0),isFinite(d)){let _="";if(i.unit!=="pixel"&&i.pixelSize&&(b||g)){_=g?`${i.unit}^2`:i.unit;let $=g?"m^2":"m",it=g?i.pixelSize**2:i.pixelSize;const nt=Qty.swiftConverter($,_);i.labels=i.labels.map(tt=>nt(it*tt))}d>50?i.labels=i.labels.map($=>Math.round($)+_):d>10?i.labels=i.labels.map($=>$.toFixed(1)+_):i.labels=i.labels.map($=>$.toFixed(2)+_)}i.labelsPosition=h.map(_=>[_.meanX,_.meanY])}if(this._painted.paintMasks(o,i),s){let h=this.getAnalysisMasks(i);this._painted.paintMasks(h,{color:i.analysisColor,alpha:i.analysisAlpha})}return this._painted}getMask(i={}){let a=new Image(this._image.width,this._image.height,{kind:"BINARY"}),s=this.getMasks(i);for(let o=0;o<s.length;o++){let h=s[o];for(let d=0;d<h.width;d++)for(let g=0;g<h.height;g++)h.getBitXY(d,g)&&a.setBitXY(d+h.position[0],g+h.position[1])}return a}resetPainted(i={}){const{image:a}=i;a?this._painted=this.image.rgba8():this._painted=this._image.rgba8()}mergeRoi(i={}){const a=this.getMap(i);return a.mergeRoi(i),this.putMap(a.data,i),this}mergeRois(i,a={}){if(!Array.isArray(i)||i.some(o=>!Number.isInteger(o)))throw new Error("Roi ids must be an array of integers");if(i.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(i).size!==i.length)throw new Error("Roi ids must be all different");i.forEach(o=>this.getRoi(o));const s=this.getMap(a);return s.mergeRois(i),this.putMap(s.data,a),this}findCorrespondingRoi(i,a={}){let s=this.getRois(a),o=[];for(let h=0;h<s.length;h++){let d=s[h],g=d.minX,b=d.minY,_=d.points,$=Math.sign(d.id),it=correspondingRoisInformation(g,b,_,i,$);o.push(it)}return o}_assertLayerWithLabel(i){if(!this._layers[i])throw new Error(`no layer with label ${i}`)}}function correspondingRoisInformation(e,i,a,s,o){let h={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let d=0;d<a.length;d++){let g=a[d],b=g[0],_=g[1],$=b+e+(_+i)*s.width,it=s.data[$];(it>0||it<0)&&(h.id.includes(it)?h.surface[h.id.indexOf(it)]+=1:(h.id.push(it),h.surface.push(1)))}for(let d=0;d<h.id.length;d++)Math.sign(h.id[d])===o?h.same+=h.surface[d]:h.opposite+=h.surface[d],h.roiSurfaceCovered[d]=h.surface[d]/a.length;return h.total=h.opposite+h.same,h}const objectToString=Object.prototype.toString;class Image{constructor(i,a,s,o){if(arguments.length===1?(o=i,{width:i,height:a,data:s}=o):s&&!s.length&&(o=s,{data:s}=o),i===void 0&&(i=1),a===void 0&&(a=1),o===void 0&&(o={}),typeof o!="object"||o===null)throw new TypeError("options must be an object");if(!Number.isInteger(i)||i<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(a)||a<=0)throw new RangeError("height must be a positive integer");const{kind:h=RGBA}=o;if(typeof h!="string")throw new TypeError("kind must be a string");const d=getKind(h),g=Object.assign({},o);for(const ut in d)g[ut]===void 0&&(g[ut]=d[ut]);verifyKindDefinition(g);const{components:b,bitDepth:_,colorModel:$}=g,it=g.alpha+0,nt=i*a,tt=b+it,at=_===32?Number.MAX_VALUE:2**_-1;if(s===void 0)s=createPixelArray(nt,b,it,tt,_,at);else{const ut=getTheoreticalPixelArraySize(nt,tt,_);if(s.length!==ut)throw new RangeError(`incorrect data size: ${s.length}. Should be ${ut}`)}this.width=i,this.height=a,this.data=s,this.size=nt,this.components=b,this.alpha=it,this.bitDepth=_,this.maxValue=at,this.colorModel=$,this.channels=tt,this.meta=o.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:o.parent||null}),this.position=o.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(i){return objectToString.call(i)==="[object IJSImage]"}static fromCanvas(i){const a=i.getContext("2d").getImageData(0,0,i.width,i.height);return new Image(a.width,a.height,a.data)}static createFrom(i,a){const s=getImageParameters(i);return Object.assign(s,{parent:i,position:[0,0]},a),new Image(s)}getRoiManager(i){return new RoiManager(this,i)}clone(){const i=this.data.slice();return new Image(this.width,this.height,i,this)}apply(i){for(let a=0;a<this.height;a++)for(let s=0;s<this.width;s++){let o=(a*this.width+s)*this.channels;i.call(this,o)}}}setValueMethods(Image);setBitMethods(Image);setExportMethods(Image);Image.prototype.checkProcessable=checkProcessable;Image.prototype.getRGBAData=getRGBAData;Image.load=load;Image.extendMethod=extendMethod;Image.extendProperty=extendProperty;extend$1(Image);var workerTemplate={},hasRequiredWorkerTemplate;function requireWorkerTemplate(){if(hasRequiredWorkerTemplate)return workerTemplate;hasRequiredWorkerTemplate=1;var e=function(){self.window=self;function a(){this._listeners={}}a.prototype.on=function(o,h){if(this._listeners[o])throw new RangeError("there is already a listener for "+o);if(typeof h!="function")throw new TypeError("callback argument must be a function");this._listeners[o]=h},a.prototype._send=function(o,h,d){d===void 0?d=[]:Array.isArray(d)||(d=[d]),self.postMessage({id:o,data:h},d)},a.prototype._trigger=function(o,h){if(!this._listeners[o])throw new Error("event "+o+" is not defined");this._listeners[o].apply(null,h)};var s=new a;self.onmessage=function(o){switch(o.data.action){case"exec":o.data.args.unshift(function(h,d){s._send(o.data.id,h,d)}),s._trigger(o.data.event,o.data.args);break;case"ping":s._send(o.data.id,"pong");break;default:throw new Error("unexpected action: "+o.data.action)}}},i=e.toString().split('"CODE";');return workerTemplate.newWorkerURL=function(a,s){var o=new Blob(["(",i[0],"importScripts.apply(self, "+JSON.stringify(s)+`);
`,"(",a,")();",i[1],")();"],{type:"application/javascript"});return URL.createObjectURL(o)},workerTemplate}var src,hasRequiredSrc;function requireSrc(){if(hasRequiredSrc)return src;hasRequiredSrc=1;var e=requireWorkerTemplate(),i=navigator.hardwareConcurrency||1;function a(s,o){if(typeof s!="string"&&typeof s!="function")throw new TypeError("func argument must be a function");if(o===void 0&&(o={}),typeof o!="object"||o===null)throw new TypeError("options argument must be an object");this._workerCode=s.toString(),o.maxWorkers===void 0||o.maxWorkers==="auto"?this._numWorkers=Math.min(i-1,1):o.maxWorkers>0?this._numWorkers=Math.min(o.maxWorkers,i):this._numWorkers=i,this._workers=new Map,this._timeout=o.timeout||0,this._terminateOnError=!!o.terminateOnError;var h=o.deps;typeof h=="string"&&(h=[h]),Array.isArray(h)||(h=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(h)}return a.prototype._init=function(s){for(var o=e.newWorkerURL(this._workerCode,s),h=0;h<this._numWorkers;h++){var d=new Worker(o);d.onmessage=this._onmessage.bind(this,d),d.onerror=this._onerror.bind(this,d),d.running=!1,d.id=h,this._workers.set(d,null)}URL.revokeObjectURL(o)},a.prototype._onerror=function(s,o){if(!this._terminated){this._working--,s.running=!1;var h=this._workers.get(s);h&&h[1](o.message),this._workers.set(s,null),this._terminateOnError?this.terminate():this._exec()}},a.prototype._onmessage=function(s,o){if(!this._terminated){this._working--,s.running=!1;var h=this._workers.get(s);h&&h[0](o.data.data),this._workers.set(s,null),this._exec()}},a.prototype._exec=function(){for(var s of this._workers.keys()){if(this._working===this._numWorkers||this._waiting.length===0)return;if(!s.running)for(var o=0;o<this._waiting.length;o++){var h=this._waiting[o];if(!(typeof h[4]=="number"&&h[4]!==s.id)){this._waiting.splice(o,1),s.postMessage({action:"exec",event:h[0],args:h[1]},h[2]),s.running=!0,s.time=Date.now(),this._workers.set(s,h[3]),this._working++;break}}}},a.prototype.terminate=function(){if(!this._terminated){for(var s of this._workers)s[0].terminate(),s[1]&&s[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},a.prototype.postAll=function(s,o){if(this._terminated)throw new Error("Cannot post (terminated)");var h=[];for(var d of this._workers.keys())h.push(this.post(s,o,[],d.id));return Promise.all(h)},a.prototype.post=function(s,o,h,d){o===void 0&&(o=[]),h===void 0&&(h=[]),Array.isArray(o)||(o=[o]),Array.isArray(h)||(h=[h]);var g=this;return new Promise(function(b,_){if(g._terminated)throw new Error("Cannot post (terminated)");g._waiting.push([s,o,h,[b,_],d]),g._exec()})},src=a,src}var srcExports=requireSrc();const WorkerManager=getDefaultExportFromCjs(srcExports),defaultOptions={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function run(e,i,a){i=Object.assign({},defaultOptions,i);const s=this.manager;return Array.isArray(e)?Promise.all(e.map(function(o){const h=runOnce(s,o,i);return typeof a=="function"&&h.then(a),h})):runOnce(s,e,i)}function runOnce(e,i,a){return e.post("data",[i,a]).then(function(s){for(let o in s)s[o]=new Image(s[o]);return s})}function work(){worker.on("data",function(e,i,a){i=new IJS(i);const s={},o=[],h=i.grey(),d=h.sobelFilter();tt("sobel",d);const g=d.level().mask({threshold:a.threshold});tt("mask",g);const b=d.getRoiManager();b.fromMask(g);const _=b.getMask(a.roi);tt("realMask",_);const $=h.getPixelsGrid({sampling:a.sampling,mask:_}),it=i.getBackground($.xyS,$.zS,a.regression);tt("background",it);const nt=i.subtract(it);s.result=nt,o.push(nt.data.buffer),e(s,o);function tt(at,ut){a.include.includes(at)&&(s[at]=ut,o.push(ut.data.buffer))}})}const background={run,work};function extend(e){e.extendMethod("background",background)}let Worker$1=class yn{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(this._url===null)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(i){if(typeof i!="string")throw new TypeError("worker URL must be a string");this._url=i,this._deps[0]=i}static extendMethod(i,a){let s,o,h={};function d(...g){return s||(this.checkUrl(),o=this.url,s=new WorkerManager(a.work,{deps:o}),h.manager=s),a.run.call(h,...g)}d.reset=function(){s&&(s.terminate(),s=new WorkerManager(a.work,{deps:o}),h.manager=s)},yn.prototype[i]=d}};extend(Worker$1);var lz4$1={},xxh32={},util={},hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,util.hashU32=function(e){return e=e|0,e=e+2127912214+(e<<12)|0,e=e^-949894596^e>>>19,e=e+374761393+(e<<5)|0,e=e+-744332180^e<<9,e=e+-42973499+(e<<3)|0,e^-1252372727^e>>>16|0},util.readU64=function(e,i){var a=0;return a|=e[i++]<<0,a|=e[i++]<<8,a|=e[i++]<<16,a|=e[i++]<<24,a|=e[i++]<<32,a|=e[i++]<<40,a|=e[i++]<<48,a|=e[i++]<<56,a},util.readU32=function(e,i){var a=0;return a|=e[i++]<<0,a|=e[i++]<<8,a|=e[i++]<<16,a|=e[i++]<<24,a},util.writeU32=function(e,i,a){e[i++]=a>>0&255,e[i++]=a>>8&255,e[i++]=a>>16&255,e[i++]=a>>24&255},util.imul=function(e,i){var a=e>>>16,s=e&65535,o=i>>>16,h=i&65535;return s*h+(a*h+s*o<<16)|0}),util}var hasRequiredXxh32;function requireXxh32(){if(hasRequiredXxh32)return xxh32;hasRequiredXxh32=1;var e=requireUtil(),i=2654435761,a=2246822519,s=3266489917,o=668265263,h=374761393;function d(at,ut){return at=at|0,ut=ut|0,at>>>(32-ut|0)|at<<ut|0}function g(at,ut,ft){return at=at|0,ut=ut|0,ft=ft|0,e.imul(at>>>(32-ut|0)|at<<ut,ft)|0}function b(at,ut){return at=at|0,ut=ut|0,at>>>ut^at|0}function _(at,ut,ft,ht,dt){return g(e.imul(ut,ft)+at,ht,dt)}function $(at,ut,ft){return g(at+e.imul(ut[ft],h),11,i)}function it(at,ut,ft){return _(at,e.readU32(ut,ft),s,17,o)}function nt(at,ut,ft){return[_(at[0],e.readU32(ut,ft+0),a,13,i),_(at[1],e.readU32(ut,ft+4),a,13,i),_(at[2],e.readU32(ut,ft+8),a,13,i),_(at[3],e.readU32(ut,ft+12),a,13,i)]}function tt(at,ut,ft,ht){var dt,st;if(st=ht,ht>=16){for(dt=[at+i+a,at+a,at,at-i];ht>=16;)dt=nt(dt,ut,ft),ft+=16,ht-=16;dt=d(dt[0],1)+d(dt[1],7)+d(dt[2],12)+d(dt[3],18)+st}else dt=at+h+ht>>>0;for(;ht>=4;)dt=it(dt,ut,ft),ft+=4,ht-=4;for(;ht>0;)dt=$(dt,ut,ft),ft++,ht--;return dt=b(e.imul(b(e.imul(b(dt,15),a),13),s),16),dt>>>0}return xxh32.hash=tt,xxh32}var hasRequiredLz4;function requireLz4(){return hasRequiredLz4||(hasRequiredLz4=1,function(e){var i=requireXxh32(),a=requireUtil(),s=4,o=13,h=5,d=6,g=65536,b=4,_=(1<<b)-1,$=4,it=(1<<$)-1,nt=Ct(5<<20),tt=bt(),at=407708164,ut=4,ft=8,ht=16,dt=64,st=192,ct=2147483648,wt=7,_t=4,gt=7,yt={4:65536,5:262144,6:1048576,7:4194304};function bt(){try{return new Uint32Array(g)}catch{for(var Ft=new Array(g),qt=0;qt<g;qt++)Ft[qt]=0;return Ft}}function vt(Ft){for(var qt=0;qt<g;qt++)tt[qt]=0}function Ct(Ft){try{return new Uint8Array(Ft)}catch{for(var qt=new Array(Ft),zt=0;zt<Ft;zt++)qt[zt]=0;return qt}}function Ht(Ft,qt,zt){if(typeof Ft.buffer!==void 0){if(Uint8Array.prototype.slice)return Ft.slice(qt,zt);var Qt=Ft.length;qt=qt|0,qt=qt<0?Math.max(Qt+qt,0):Math.min(qt,Qt),zt=zt===void 0?Qt:zt|0,zt=zt<0?Math.max(Qt+zt,0):Math.min(zt,Qt);for(var _e=new Uint8Array(zt-qt),Gt=qt,Jt=0;Gt<zt;)_e[Jt++]=Ft[Gt++];return _e}else return Ft.slice(qt,zt)}e.compressBound=function(Ft){return Ft+Ft/255+16|0},e.decompressBound=function(Ft){var qt=0;if(a.readU32(Ft,qt)!==at)throw new Error("invalid magic number");qt+=4;var zt=Ft[qt++];if((zt&st)!==dt)throw new Error("incompatible descriptor version "+(zt&st));var Qt=(zt&ht)!==0,_e=(zt&ft)!==0,Gt=Ft[qt++]>>_t&gt;if(yt[Gt]===void 0)throw new Error("invalid block size "+Gt);var Jt=yt[Gt];if(_e)return a.readU64(Ft,qt);qt++;for(var or=0;;){var mr=a.readU32(Ft,qt);if(qt+=4,mr&ct?(mr&=2147483647,or+=mr):or+=Jt,mr===0)return or;Qt&&(qt+=4),qt+=mr}},e.makeBuffer=Ct,e.decompressBlock=function(Ft,qt,zt,Qt,_e){var Gt,Jt,or,mr,hr;for(or=zt+Qt;zt<or;){var Lr=Ft[zt++],Er=Lr>>4;if(Er>0){if(Er===15)for(;Er+=Ft[zt],Ft[zt++]===255;);for(mr=zt+Er;zt<mr;)qt[_e++]=Ft[zt++]}if(zt>=or)break;if(Gt=Lr&15,Jt=Ft[zt++]|Ft[zt++]<<8,Gt===15)for(;Gt+=Ft[zt],Ft[zt++]===255;);for(Gt+=s,hr=_e-Jt,mr=hr+Gt;hr<mr;)qt[_e++]=qt[hr++]|0}return _e},e.compressBlock=function(Ft,qt,zt,Qt,_e){var Gt,Jt,or,mr,hr,Lr,Er,Kt,fr;if(Er=0,Kt=Qt+zt,Jt=zt,Qt>=o)for(var Rr=(1<<d)+3;zt+s<Kt-h;){var gr=a.readU32(Ft,zt),ir=a.hashU32(gr)>>>0;if(ir=(ir>>16^ir)>>>0&65535,Gt=_e[ir]-1,_e[ir]=zt+1,Gt<0||zt-Gt>>>16>0||a.readU32(Ft,Gt)!==gr){hr=Rr++>>d,zt+=hr;continue}for(Rr=(1<<d)+3,Lr=zt-Jt,mr=zt-Gt,zt+=s,Gt+=s,or=zt;zt<Kt-h&&Ft[zt]===Ft[Gt];)zt++,Gt++;or=zt-or;var Vr=or<_?or:_;if(Lr>=it){for(qt[Er++]=(it<<b)+Vr,fr=Lr-it;fr>=255;fr-=255)qt[Er++]=255;qt[Er++]=fr}else qt[Er++]=(Lr<<b)+Vr;for(var Ur=0;Ur<Lr;Ur++)qt[Er++]=Ft[Jt+Ur];if(qt[Er++]=mr,qt[Er++]=mr>>8,or>=_){for(fr=or-_;fr>=255;fr-=255)qt[Er++]=255;qt[Er++]=fr}Jt=zt}if(Jt===0)return 0;if(Lr=Kt-Jt,Lr>=it){for(qt[Er++]=it<<b,fr=Lr-it;fr>=255;fr-=255)qt[Er++]=255;qt[Er++]=fr}else qt[Er++]=Lr<<b;for(zt=Jt;zt<Kt;)qt[Er++]=Ft[zt++];return Er},e.decompressFrame=function(Ft,qt){var zt,Qt,_e,Gt,Jt=0,or=0;if(a.readU32(Ft,Jt)!==at)throw new Error("invalid magic number");if(Jt+=4,Gt=Ft[Jt++],(Gt&st)!==dt)throw new Error("incompatible descriptor version");zt=(Gt&ht)!==0,Qt=(Gt&ut)!==0,_e=(Gt&ft)!==0;var mr=Ft[Jt++]>>_t&gt;if(yt[mr]===void 0)throw new Error("invalid block size");for(_e&&(Jt+=8),Jt++;;){var hr;if(hr=a.readU32(Ft,Jt),Jt+=4,hr===0)break;if(zt&&(Jt+=4),(hr&ct)!==0){hr&=2147483647;for(var Lr=0;Lr<hr;Lr++)qt[or++]=Ft[Jt++]}else or=e.decompressBlock(Ft,qt,Jt,hr,or),Jt+=hr}return Qt&&(Jt+=4),or},e.compressFrame=function(Ft,qt){var zt=0;a.writeU32(qt,zt,at),zt+=4,qt[zt++]=dt,qt[zt++]=wt<<_t,qt[zt]=i.hash(0,qt,4,zt-4)>>8,zt++;var Qt=yt[wt],_e=Ft.length,Gt=0;for(vt();_e>0;){var Jt=0,or=_e>Qt?Qt:_e;if(Jt=e.compressBlock(Ft,nt,Gt,or,tt),Jt>or||Jt===0){a.writeU32(qt,zt,2147483648|or),zt+=4;for(var mr=Gt+or;Gt<mr;)qt[zt++]=Ft[Gt++];_e-=or}else{a.writeU32(qt,zt,Jt),zt+=4;for(var hr=0;hr<Jt;)qt[zt++]=nt[hr++];Gt+=or,_e-=or}}return a.writeU32(qt,zt,0),zt+=4,zt},e.decompress=function(Ft,qt){var zt,Qt;return qt===void 0&&(qt=e.decompressBound(Ft)),zt=e.makeBuffer(qt),Qt=e.decompressFrame(Ft,zt),Qt!==qt&&(zt=Ht(zt,0,Qt)),zt},e.compress=function(Ft,qt){var zt,Qt;return qt===void 0&&(qt=e.compressBound(Ft.length)),zt=e.makeBuffer(qt),Qt=e.compressFrame(Ft,zt),Qt!==qt&&(zt=Ht(zt,0,Qt)),zt}}(lz4$1)),lz4$1}requireLz4();var __defProp=Object.defineProperty,__defNormalProp=(e,i,a)=>i in e?__defProp(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,__export=(e,i)=>{for(var a in i)__defProp(e,a,{get:i[a],enumerable:!0})},__publicField=(e,i,a)=>(__defNormalProp(e,typeof i!="symbol"?i+"":i,a),a),constants_exports={};__export(constants_exports,{bt709:()=>bt709_exports});var bt709_exports={};__export(bt709_exports,{Y:()=>Y,x:()=>x,y:()=>y});var Y=(e=>(e[e.RED=.2126]="RED",e[e.GREEN=.7152]="GREEN",e[e.BLUE=.0722]="BLUE",e[e.WHITE=1]="WHITE",e))(Y||{}),x=(e=>(e[e.RED=.64]="RED",e[e.GREEN=.3]="GREEN",e[e.BLUE=.15]="BLUE",e[e.WHITE=.3127]="WHITE",e))(x||{}),y=(e=>(e[e.RED=.33]="RED",e[e.GREEN=.6]="GREEN",e[e.BLUE=.06]="BLUE",e[e.WHITE=.329]="WHITE",e))(y||{}),conversion_exports={};__export(conversion_exports,{lab2rgb:()=>lab2rgb,lab2xyz:()=>lab2xyz,rgb2hsl:()=>rgb2hsl,rgb2lab:()=>rgb2lab,rgb2xyz:()=>rgb2xyz,xyz2lab:()=>xyz2lab,xyz2rgb:()=>xyz2rgb});function correctGamma(e){return e>.04045?((e+.055)/1.055)**2.4:e/12.92}function rgb2xyz(e,i,a){return e=correctGamma(e/255),i=correctGamma(i/255),a=correctGamma(a/255),{x:e*.4124+i*.3576+a*.1805,y:e*.2126+i*.7152+a*.0722,z:e*.0193+i*.1192+a*.9505}}var arithmetic_exports={};__export(arithmetic_exports,{degrees2radians:()=>degrees2radians,inRange0to255:()=>inRange0to255,inRange0to255Rounded:()=>inRange0to255Rounded,intInRange:()=>intInRange,max3:()=>max3,min3:()=>min3,stableSort:()=>stableSort});function degrees2radians(e){return e*(Math.PI/180)}function max3(e,i,a){let s=e;return s<i&&(s=i),s<a&&(s=a),s}function min3(e,i,a){let s=e;return s>i&&(s=i),s>a&&(s=a),s}function intInRange(e,i,a){return e>a&&(e=a),e<i&&(e=i),e|0}function inRange0to255Rounded(e){return e=Math.round(e),e>255?e=255:e<0&&(e=0),e}function inRange0to255(e){return e>255?e=255:e<0&&(e=0),e}function stableSort(e,i){const a=typeof e[0];let s;if(a==="number"||a==="string"){const o=Object.create(null);for(let h=0,d=e.length;h<d;h++){const g=e[h];o[g]||o[g]===0||(o[g]=h)}s=e.sort((h,d)=>i(h,d)||o[h]-o[d])}else{const o=e.slice(0);s=e.sort((h,d)=>i(h,d)||o.indexOf(h)-o.indexOf(d))}return s}function rgb2hsl(e,i,a){const s=min3(e,i,a),o=max3(e,i,a),h=o-s,d=(s+o)/510;let g=0;d>0&&d<1&&(g=h/(d<.5?o+s:510-o-s));let b=0;return h>0&&(o===e?b=(i-a)/h:o===i?b=2+(a-e)/h:b=4+(e-i)/h,b*=60,b<0&&(b+=360)),{h:b,s:g,l:d}}var refX=.95047,refY=1,refZ=1.08883;function pivot(e){return e>.008856?e**(1/3):7.787*e+16/116}function xyz2lab(e,i,a){if(e=pivot(e/refX),i=pivot(i/refY),a=pivot(a/refZ),116*i-16<0)throw new Error("xxx");return{L:Math.max(0,116*i-16),a:500*(e-i),b:200*(i-a)}}function rgb2lab(e,i,a){const s=rgb2xyz(e,i,a);return xyz2lab(s.x,s.y,s.z)}var refX2=.95047,refY2=1,refZ2=1.08883;function pivot2(e){return e>.206893034?e**3:(e-16/116)/7.787}function lab2xyz(e,i,a){const s=(e+16)/116,o=i/500+s,h=s-a/200;return{x:refX2*pivot2(o),y:refY2*pivot2(s),z:refZ2*pivot2(h)}}function correctGamma2(e){return e>.0031308?1.055*e**(1/2.4)-.055:12.92*e}function xyz2rgb(e,i,a){const s=correctGamma2(e*3.2406+i*-1.5372+a*-.4986),o=correctGamma2(e*-.9689+i*1.8758+a*.0415),h=correctGamma2(e*.0557+i*-.204+a*1.057);return{r:inRange0to255Rounded(s*255),g:inRange0to255Rounded(o*255),b:inRange0to255Rounded(h*255)}}function lab2rgb(e,i,a){const s=lab2xyz(e,i,a);return xyz2rgb(s.x,s.y,s.z)}var distance_exports={};__export(distance_exports,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator,AbstractEuclidean:()=>AbstractEuclidean,AbstractManhattan:()=>AbstractManhattan,CIE94GraphicArts:()=>CIE94GraphicArts,CIE94Textiles:()=>CIE94Textiles,CIEDE2000:()=>CIEDE2000,CMetric:()=>CMetric,Euclidean:()=>Euclidean,EuclideanBT709:()=>EuclideanBT709,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha,Manhattan:()=>Manhattan,ManhattanBT709:()=>ManhattanBT709,ManhattanNommyde:()=>ManhattanNommyde,PNGQuant:()=>PNGQuant});var AbstractDistanceCalculator=class{constructor(){__publicField(this,"_maxDistance"),__publicField(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(e,i,a,s){this._whitePoint={r:e>0?255/e:0,g:i>0?255/i:0,b:a>0?255/a:0,a:s>0?255/s:0},this._maxDistance=this.calculateRaw(e,i,a,s,0,0,0,0)}calculateNormalized(e,i){return this.calculateRaw(e.r,e.g,e.b,e.a,i.r,i.g,i.b,i.a)/this._maxDistance}},AbstractCIE94=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,d,g){const b=rgb2lab(inRange0to255(e*this._whitePoint.r),inRange0to255(i*this._whitePoint.g),inRange0to255(a*this._whitePoint.b)),_=rgb2lab(inRange0to255(o*this._whitePoint.r),inRange0to255(h*this._whitePoint.g),inRange0to255(d*this._whitePoint.b)),$=b.L-_.L,it=b.a-_.a,nt=b.b-_.b,tt=Math.sqrt(b.a*b.a+b.b*b.b),at=Math.sqrt(_.a*_.a+_.b*_.b),ut=tt-at;let ft=it*it+nt*nt-ut*ut;ft=ft<0?0:Math.sqrt(ft);const ht=(g-s)*this._whitePoint.a*this._kA;return Math.sqrt(($/this._Kl)**2+(ut/(1+this._K1*tt))**2+(ft/(1+this._K2*tt))**2+ht**2)}},CIE94Textiles=class extends AbstractCIE94{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=.25*50/255}},CIE94GraphicArts=class extends AbstractCIE94{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=.25*100/255}},_CIEDE2000=class extends AbstractDistanceCalculator{_setDefaults(){}static _calculatehp(e,i){const a=Math.atan2(e,i);return a>=0?a:a+_CIEDE2000._deg360InRad}static _calculateRT(e,i){const a=i**7,s=2*Math.sqrt(a/(a+_CIEDE2000._pow25to7)),o=_CIEDE2000._deg30InRad*Math.exp(-(((e-_CIEDE2000._deg275InRad)/_CIEDE2000._deg25InRad)**2));return-Math.sin(2*o)*s}static _calculateT(e){return 1-.17*Math.cos(e-_CIEDE2000._deg30InRad)+.24*Math.cos(e*2)+.32*Math.cos(e*3+_CIEDE2000._deg6InRad)-.2*Math.cos(e*4-_CIEDE2000._deg63InRad)}static _calculate_ahp(e,i,a,s){const o=a+s;return e===0?o:i<=_CIEDE2000._deg180InRad?o/2:o<_CIEDE2000._deg360InRad?(o+_CIEDE2000._deg360InRad)/2:(o-_CIEDE2000._deg360InRad)/2}static _calculate_dHp(e,i,a,s){let o;return e===0?o=0:i<=_CIEDE2000._deg180InRad?o=a-s:a<=s?o=a-s+_CIEDE2000._deg360InRad:o=a-s-_CIEDE2000._deg360InRad,2*Math.sqrt(e)*Math.sin(o/2)}calculateRaw(e,i,a,s,o,h,d,g){const b=rgb2lab(inRange0to255(e*this._whitePoint.r),inRange0to255(i*this._whitePoint.g),inRange0to255(a*this._whitePoint.b)),_=rgb2lab(inRange0to255(o*this._whitePoint.r),inRange0to255(h*this._whitePoint.g),inRange0to255(d*this._whitePoint.b)),$=(g-s)*this._whitePoint.a*_CIEDE2000._kA,it=this.calculateRawInLab(b,_);return Math.sqrt(it+$*$)}calculateRawInLab(e,i){const a=e.L,s=e.a,o=e.b,h=i.L,d=i.a,g=i.b,b=Math.sqrt(s*s+o*o),_=Math.sqrt(d*d+g*g),$=((b+_)/2)**7,it=.5*(1-Math.sqrt($/($+_CIEDE2000._pow25to7))),nt=(1+it)*s,tt=(1+it)*d,at=Math.sqrt(nt*nt+o*o),ut=Math.sqrt(tt*tt+g*g),ft=at*ut,ht=_CIEDE2000._calculatehp(o,nt),dt=_CIEDE2000._calculatehp(g,tt),st=Math.abs(ht-dt),ct=h-a,wt=ut-at,_t=_CIEDE2000._calculate_dHp(ft,st,dt,ht),gt=_CIEDE2000._calculate_ahp(ft,st,ht,dt),yt=_CIEDE2000._calculateT(gt),bt=(at+ut)/2,vt=((a+h)/2-50)**2,Ct=1+.015*vt/Math.sqrt(20+vt),Ht=1+.045*bt,Ft=1+.015*yt*bt,qt=_CIEDE2000._calculateRT(gt,bt),zt=ct/Ct,Qt=wt/Ht,_e=_t/Ft;return zt**2+Qt**2+_e**2+qt*Qt*_e}},CIEDE2000=_CIEDE2000;__publicField(CIEDE2000,"_kA",.25*100/255);__publicField(CIEDE2000,"_pow25to7",25**7);__publicField(CIEDE2000,"_deg360InRad",degrees2radians(360));__publicField(CIEDE2000,"_deg180InRad",degrees2radians(180));__publicField(CIEDE2000,"_deg30InRad",degrees2radians(30));__publicField(CIEDE2000,"_deg6InRad",degrees2radians(6));__publicField(CIEDE2000,"_deg63InRad",degrees2radians(63));__publicField(CIEDE2000,"_deg275InRad",degrees2radians(275));__publicField(CIEDE2000,"_deg25InRad",degrees2radians(25));var CMetric=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,d,g){const b=(e+o)/2*this._whitePoint.r,_=(e-o)*this._whitePoint.r,$=(i-h)*this._whitePoint.g,it=(a-d)*this._whitePoint.b,nt=((512+b)*_*_>>8)+4*$*$+((767-b)*it*it>>8),tt=(g-s)*this._whitePoint.a;return Math.sqrt(nt+tt*tt)}_setDefaults(){}},AbstractEuclidean=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,d,g){const b=o-e,_=h-i,$=d-a,it=g-s;return Math.sqrt(this._kR*b*b+this._kG*_*_+this._kB*$*$+this._kA*it*it)}},Euclidean=class extends AbstractEuclidean{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,d,g){let b=o-e,_=h-i,$=d-a,it=g-s;return b<0&&(b=0-b),_<0&&(_=0-_),$<0&&($=0-$),it<0&&(it=0-it),this._kR*b+this._kG*_+this._kB*$+this._kA*it}},Manhattan=class extends AbstractManhattan{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde=class extends AbstractManhattan{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709=class extends AbstractManhattan{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant=class extends AbstractDistanceCalculator{calculateRaw(e,i,a,s,o,h,d,g){const b=(g-s)*this._whitePoint.a;return this._colordifferenceCh(e*this._whitePoint.r,o*this._whitePoint.r,b)+this._colordifferenceCh(i*this._whitePoint.g,h*this._whitePoint.g,b)+this._colordifferenceCh(a*this._whitePoint.b,d*this._whitePoint.b,b)}_colordifferenceCh(e,i,a){const s=e-i,o=s+a;return s*s+o*o}_setDefaults(){}},palette_exports={};__export(palette_exports,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer,ColorHistogram:()=>ColorHistogram,NeuQuant:()=>NeuQuant,NeuQuantFloat:()=>NeuQuantFloat,RGBQuant:()=>RGBQuant,WuColorCube:()=>WuColorCube,WuQuant:()=>WuQuant});var AbstractPaletteQuantizer=class{quantizeSync(){for(const e of this.quantize())if(e.palette)return e.palette;throw new Error("unreachable")}},Point=class{constructor(){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),__publicField(this,"uint32"),__publicField(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(e){const i=new Point;return i.r=e[0]|0,i.g=e[1]|0,i.b=e[2]|0,i.a=e[3]|0,i._loadUINT32(),i._loadQuadruplet(),i}static createByRGBA(e,i,a,s){const o=new Point;return o.r=e|0,o.g=i|0,o.b=a|0,o.a=s|0,o._loadUINT32(),o._loadQuadruplet(),o}static createByUint32(e){const i=new Point;return i.uint32=e>>>0,i._loadRGBA(),i._loadQuadruplet(),i}from(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this.uint32=e.uint32,this.rgba[0]=e.r,this.rgba[1]=e.g,this.rgba[2]=e.b,this.rgba[3]=e.a}getLuminosity(e){let i=this.r,a=this.g,s=this.b;return e&&(i=Math.min(255,255-this.a+this.a*i/255),a=Math.min(255,255-this.a+this.a*a/255),s=Math.min(255,255-this.a+this.a*s/255)),i*.2126+a*.7152+s*.0722}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=this.uint32&255,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer=class{constructor(){__publicField(this,"_pointArray"),__publicField(this,"_width"),__publicField(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(e){this._width=e}setHeight(e){this._height=e}getPointArray(){return this._pointArray}clone(){const e=new PointContainer;e._width=this._width,e._height=this._height;for(let i=0,a=this._pointArray.length;i<a;i++)e._pointArray[i]=Point.createByUint32(this._pointArray[i].uint32|0);return e}toUint32Array(){const e=this._pointArray.length,i=new Uint32Array(e);for(let a=0;a<e;a++)i[a]=this._pointArray[a].uint32;return i}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(e){const i=e.naturalWidth,a=e.naturalHeight,s=document.createElement("canvas");return s.width=i,s.height=a,s.getContext("2d").drawImage(e,0,0,i,a,0,0,i,a),PointContainer.fromHTMLCanvasElement(s)}static fromHTMLCanvasElement(e){const i=e.width,a=e.height,s=e.getContext("2d").getImageData(0,0,i,a);return PointContainer.fromImageData(s)}static fromImageData(e){const i=e.width,a=e.height;return PointContainer.fromUint8Array(e.data,i,a)}static fromUint8Array(e,i,a){switch(Object.prototype.toString.call(e)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:e=new Uint8Array(e)}const s=new Uint32Array(e.buffer);return PointContainer.fromUint32Array(s,i,a)}static fromUint32Array(e,i,a){const s=new PointContainer;s._width=i,s._height=a;for(let o=0,h=e.length;o<h;o++)s._pointArray[o]=Point.createByUint32(e[o]|0);return s}static fromBuffer(e,i,a){const s=new Uint32Array(e.buffer,e.byteOffset,e.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer.fromUint32Array(s,i,a)}},hueGroups=10;function hueGroup(e,i){const a=360/i,s=a/2;for(let o=1,h=a-s;o<i;o++,h+=a)if(e>=h&&e<h+a)return o;return 0}var Palette=class{constructor(){__publicField(this,"_pointContainer"),__publicField(this,"_pointArray",[]),__publicField(this,"_i32idx",{}),this._pointContainer=new PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(e){this._pointArray.push(e),this._pointContainer.setWidth(this._pointArray.length)}has(e){for(let i=this._pointArray.length-1;i>=0;i--)if(e.uint32===this._pointArray[i].uint32)return!0;return!1}getNearestColor(e,i){return this._pointArray[this._getNearestIndex(e,i)|0]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(e){return typeof this._i32idx[e]=="number"?this._i32idx[e]:-1}_getNearestIndex(e,i){let a=this._nearestPointFromCache(""+i.uint32);if(a>=0)return a;let s=Number.MAX_VALUE;a=0;for(let o=0,h=this._pointArray.length;o<h;o++){const d=this._pointArray[o],g=e.calculateRaw(i.r,i.g,i.b,i.a,d.r,d.g,d.b,d.a);g<s&&(s=g,a=o)}return this._i32idx[i.uint32]=a,a}sort(){this._i32idx={},this._pointArray.sort((e,i)=>{const a=rgb2hsl(e.r,e.g,e.b),s=rgb2hsl(i.r,i.g,i.b),o=e.r===e.g&&e.g===e.b?0:1+hueGroup(a.h,hueGroups),h=(i.r===i.g&&i.g===i.b?0:1+hueGroup(s.h,hueGroups))-o;if(h)return-h;const d=e.getLuminosity(!0),g=i.getLuminosity(!0);if(g-d!==0)return g-d;const b=(s.s*100|0)-(a.s*100|0);return b?-b:0})}},utils_exports={};__export(utils_exports,{HueStatistics:()=>HueStatistics,Palette:()=>Palette,Point:()=>Point,PointContainer:()=>PointContainer,ProgressTracker:()=>ProgressTracker,arithmetic:()=>arithmetic_exports});var HueGroup=class{constructor(){__publicField(this,"num",0),__publicField(this,"cols",[])}},HueStatistics=class{constructor(e,i){__publicField(this,"_numGroups"),__publicField(this,"_minCols"),__publicField(this,"_stats"),__publicField(this,"_groupsFull"),this._numGroups=e,this._minCols=i,this._stats=[];for(let a=0;a<=e;a++)this._stats[a]=new HueGroup;this._groupsFull=0}check(e){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const i=e&255,a=e>>>8&255,s=e>>>16&255,o=i===a&&a===s?0:1+hueGroup(rgb2hsl(i,a,s).h,this._numGroups),h=this._stats[o],d=this._minCols;h.num++,!(h.num>d)&&(h.num===d&&this._groupsFull++,h.num<=d&&this._stats[o].cols.push(e))}injectIntoDictionary(e){for(let i=0;i<=this._numGroups;i++)this._stats[i].num<=this._minCols&&this._stats[i].cols.forEach(a=>{e[a]?e[a]++:e[a]=1})}injectIntoArray(e){for(let i=0;i<=this._numGroups;i++)this._stats[i].num<=this._minCols&&this._stats[i].cols.forEach(a=>{e.indexOf(a)===-1&&e.push(a)})}},_ProgressTracker=class{constructor(e,i){__publicField(this,"progress"),__publicField(this,"_step"),__publicField(this,"_range"),__publicField(this,"_last"),__publicField(this,"_progressRange"),this._range=e,this._progressRange=i,this._step=Math.max(1,this._range/(_ProgressTracker.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(e){return e-this._last>=this._step?(this._last=e,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0):!1}},ProgressTracker=_ProgressTracker;__publicField(ProgressTracker,"steps",100);var networkBiasShift=3,Neuron=class{constructor(e){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=e}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift,this.g>>networkBiasShift,this.b>>networkBiasShift,this.a>>networkBiasShift)}subtract(e,i,a,s){this.r-=e|0,this.g-=i|0,this.b-=a|0,this.a-=s|0}},_NeuQuant=class extends AbstractPaletteQuantizer{constructor(e,i=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=e,this._pointArray=[],this._sampleFactor=1,this._networkSize=i,this._distance.setWhitePoint(255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift)}sample(e){this._pointArray=this._pointArray.concat(e.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let e=0;e<this._networkSize;e++)this._network[e]=new Neuron((e<<networkBiasShift+8)/this._networkSize|0),this._freq[e]=_NeuQuant._initialBias/this._networkSize|0,this._bias[e]=0}*_learn(){let e=this._sampleFactor;const i=this._pointArray.length;i<_NeuQuant._minpicturebytes&&(e=1);const a=30+(e-1)/3|0,s=i/e|0;let o=s/_NeuQuant._nCycles|0,h=_NeuQuant._initAlpha,d=(this._networkSize>>3)*_NeuQuant._radiusBias,g=d>>_NeuQuant._radiusBiasShift;g<=1&&(g=0);for(let $=0;$<g;$++)this._radPower[$]=h*((g*g-$*$)*_NeuQuant._radBias/(g*g))>>>0;let b;i<_NeuQuant._minpicturebytes?b=1:i%_NeuQuant._prime1!==0?b=_NeuQuant._prime1:i%_NeuQuant._prime2!==0?b=_NeuQuant._prime2:i%_NeuQuant._prime3!==0?b=_NeuQuant._prime3:b=_NeuQuant._prime4;const _=new ProgressTracker(s,99);for(let $=0,it=0;$<s;){_.shouldNotify($)&&(yield{progress:_.progress});const nt=this._pointArray[it],tt=nt.b<<networkBiasShift,at=nt.g<<networkBiasShift,ut=nt.r<<networkBiasShift,ft=nt.a<<networkBiasShift,ht=this._contest(tt,at,ut,ft);if(this._alterSingle(h,ht,tt,at,ut,ft),g!==0&&this._alterNeighbour(g,ht,tt,at,ut,ft),it+=b,it>=i&&(it-=i),$++,o===0&&(o=1),$%o===0){h-=h/a|0,d-=d/_NeuQuant._radiusDecrease|0,g=d>>_NeuQuant._radiusBiasShift,g<=1&&(g=0);for(let dt=0;dt<g;dt++)this._radPower[dt]=h*((g*g-dt*dt)*_NeuQuant._radBias/(g*g))>>>0}}}_buildPalette(){const e=new Palette;return this._network.forEach(i=>{e.add(i.toPoint())}),e.sort(),e}_alterNeighbour(e,i,a,s,o,h){let d=i-e;d<-1&&(d=-1);let g=i+e;g>this._networkSize&&(g=this._networkSize);let b=i+1,_=i-1,$=1;for(;b<g||_>d;){const it=this._radPower[$++]/_NeuQuant._alphaRadBias;if(b<g){const nt=this._network[b++];nt.subtract(it*(nt.r-o),it*(nt.g-s),it*(nt.b-a),it*(nt.a-h))}if(_>d){const nt=this._network[_--];nt.subtract(it*(nt.r-o),it*(nt.g-s),it*(nt.b-a),it*(nt.a-h))}}}_alterSingle(e,i,a,s,o,h){e/=_NeuQuant._initAlpha;const d=this._network[i];d.subtract(e*(d.r-o),e*(d.g-s),e*(d.b-a),e*(d.a-h))}_contest(e,i,a,s){const o=1020<<networkBiasShift;let h=2147483647,d=h,g=-1,b=g;for(let _=0;_<this._networkSize;_++){const $=this._network[_],it=this._distance.calculateNormalized($,{r:a,g:i,b:e,a:s})*o|0;it<h&&(h=it,g=_);const nt=it-(this._bias[_]>>_NeuQuant._initialBiasShift-networkBiasShift);nt<d&&(d=nt,b=_);const tt=this._freq[_]>>_NeuQuant._betaShift;this._freq[_]-=tt,this._bias[_]+=tt<<_NeuQuant._gammaShift}return this._freq[g]+=_NeuQuant._beta,this._bias[g]-=_NeuQuant._betaGamma,b}},NeuQuant=_NeuQuant;__publicField(NeuQuant,"_prime1",499);__publicField(NeuQuant,"_prime2",491);__publicField(NeuQuant,"_prime3",487);__publicField(NeuQuant,"_prime4",503);__publicField(NeuQuant,"_minpicturebytes",_NeuQuant._prime4);__publicField(NeuQuant,"_nCycles",100);__publicField(NeuQuant,"_initialBiasShift",16);__publicField(NeuQuant,"_initialBias",1<<_NeuQuant._initialBiasShift);__publicField(NeuQuant,"_gammaShift",10);__publicField(NeuQuant,"_betaShift",10);__publicField(NeuQuant,"_beta",_NeuQuant._initialBias>>_NeuQuant._betaShift);__publicField(NeuQuant,"_betaGamma",_NeuQuant._initialBias<<_NeuQuant._gammaShift-_NeuQuant._betaShift);__publicField(NeuQuant,"_radiusBiasShift",6);__publicField(NeuQuant,"_radiusBias",1<<_NeuQuant._radiusBiasShift);__publicField(NeuQuant,"_radiusDecrease",30);__publicField(NeuQuant,"_alphaBiasShift",10);__publicField(NeuQuant,"_initAlpha",1<<_NeuQuant._alphaBiasShift);__publicField(NeuQuant,"_radBiasShift",8);__publicField(NeuQuant,"_radBias",1<<_NeuQuant._radBiasShift);__publicField(NeuQuant,"_alphaRadBiasShift",_NeuQuant._alphaBiasShift+_NeuQuant._radBiasShift);__publicField(NeuQuant,"_alphaRadBias",1<<_NeuQuant._alphaRadBiasShift);var networkBiasShift2=3,NeuronFloat=class{constructor(e){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=e}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift2,this.g>>networkBiasShift2,this.b>>networkBiasShift2,this.a>>networkBiasShift2)}subtract(e,i,a,s){this.r-=e,this.g-=i,this.b-=a,this.a-=s}},_NeuQuantFloat=class extends AbstractPaletteQuantizer{constructor(e,i=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=e,this._pointArray=[],this._sampleFactor=1,this._networkSize=i,this._distance.setWhitePoint(255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2)}sample(e){this._pointArray=this._pointArray.concat(e.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let e=0;e<this._networkSize;e++)this._network[e]=new NeuronFloat((e<<networkBiasShift2+8)/this._networkSize),this._freq[e]=_NeuQuantFloat._initialBias/this._networkSize,this._bias[e]=0}*_learn(){let e=this._sampleFactor;const i=this._pointArray.length;i<_NeuQuantFloat._minpicturebytes&&(e=1);const a=30+(e-1)/3,s=i/e;let o=s/_NeuQuantFloat._nCycles|0,h=_NeuQuantFloat._initAlpha,d=(this._networkSize>>3)*_NeuQuantFloat._radiusBias,g=d>>_NeuQuantFloat._radiusBiasShift;g<=1&&(g=0);for(let $=0;$<g;$++)this._radPower[$]=h*((g*g-$*$)*_NeuQuantFloat._radBias/(g*g));let b;i<_NeuQuantFloat._minpicturebytes?b=1:i%_NeuQuantFloat._prime1!==0?b=_NeuQuantFloat._prime1:i%_NeuQuantFloat._prime2!==0?b=_NeuQuantFloat._prime2:i%_NeuQuantFloat._prime3!==0?b=_NeuQuantFloat._prime3:b=_NeuQuantFloat._prime4;const _=new ProgressTracker(s,99);for(let $=0,it=0;$<s;){_.shouldNotify($)&&(yield{progress:_.progress});const nt=this._pointArray[it],tt=nt.b<<networkBiasShift2,at=nt.g<<networkBiasShift2,ut=nt.r<<networkBiasShift2,ft=nt.a<<networkBiasShift2,ht=this._contest(tt,at,ut,ft);if(this._alterSingle(h,ht,tt,at,ut,ft),g!==0&&this._alterNeighbour(g,ht,tt,at,ut,ft),it+=b,it>=i&&(it-=i),$++,o===0&&(o=1),$%o===0){h-=h/a,d-=d/_NeuQuantFloat._radiusDecrease,g=d>>_NeuQuantFloat._radiusBiasShift,g<=1&&(g=0);for(let dt=0;dt<g;dt++)this._radPower[dt]=h*((g*g-dt*dt)*_NeuQuantFloat._radBias/(g*g))}}}_buildPalette(){const e=new Palette;return this._network.forEach(i=>{e.add(i.toPoint())}),e.sort(),e}_alterNeighbour(e,i,a,s,o,h){let d=i-e;d<-1&&(d=-1);let g=i+e;g>this._networkSize&&(g=this._networkSize);let b=i+1,_=i-1,$=1;for(;b<g||_>d;){const it=this._radPower[$++]/_NeuQuantFloat._alphaRadBias;if(b<g){const nt=this._network[b++];nt.subtract(it*(nt.r-o),it*(nt.g-s),it*(nt.b-a),it*(nt.a-h))}if(_>d){const nt=this._network[_--];nt.subtract(it*(nt.r-o),it*(nt.g-s),it*(nt.b-a),it*(nt.a-h))}}}_alterSingle(e,i,a,s,o,h){e/=_NeuQuantFloat._initAlpha;const d=this._network[i];d.subtract(e*(d.r-o),e*(d.g-s),e*(d.b-a),e*(d.a-h))}_contest(e,i,a,s){const o=1020<<networkBiasShift2;let h=2147483647,d=h,g=-1,b=g;for(let _=0;_<this._networkSize;_++){const $=this._network[_],it=this._distance.calculateNormalized($,{r:a,g:i,b:e,a:s})*o;it<h&&(h=it,g=_);const nt=it-(this._bias[_]>>_NeuQuantFloat._initialBiasShift-networkBiasShift2);nt<d&&(d=nt,b=_);const tt=this._freq[_]>>_NeuQuantFloat._betaShift;this._freq[_]-=tt,this._bias[_]+=tt<<_NeuQuantFloat._gammaShift}return this._freq[g]+=_NeuQuantFloat._beta,this._bias[g]-=_NeuQuantFloat._betaGamma,b}},NeuQuantFloat=_NeuQuantFloat;__publicField(NeuQuantFloat,"_prime1",499);__publicField(NeuQuantFloat,"_prime2",491);__publicField(NeuQuantFloat,"_prime3",487);__publicField(NeuQuantFloat,"_prime4",503);__publicField(NeuQuantFloat,"_minpicturebytes",_NeuQuantFloat._prime4);__publicField(NeuQuantFloat,"_nCycles",100);__publicField(NeuQuantFloat,"_initialBiasShift",16);__publicField(NeuQuantFloat,"_initialBias",1<<_NeuQuantFloat._initialBiasShift);__publicField(NeuQuantFloat,"_gammaShift",10);__publicField(NeuQuantFloat,"_betaShift",10);__publicField(NeuQuantFloat,"_beta",_NeuQuantFloat._initialBias>>_NeuQuantFloat._betaShift);__publicField(NeuQuantFloat,"_betaGamma",_NeuQuantFloat._initialBias<<_NeuQuantFloat._gammaShift-_NeuQuantFloat._betaShift);__publicField(NeuQuantFloat,"_radiusBiasShift",6);__publicField(NeuQuantFloat,"_radiusBias",1<<_NeuQuantFloat._radiusBiasShift);__publicField(NeuQuantFloat,"_radiusDecrease",30);__publicField(NeuQuantFloat,"_alphaBiasShift",10);__publicField(NeuQuantFloat,"_initAlpha",1<<_NeuQuantFloat._alphaBiasShift);__publicField(NeuQuantFloat,"_radBiasShift",8);__publicField(NeuQuantFloat,"_radBias",1<<_NeuQuantFloat._radBiasShift);__publicField(NeuQuantFloat,"_alphaRadBiasShift",_NeuQuantFloat._alphaBiasShift+_NeuQuantFloat._radBiasShift);__publicField(NeuQuantFloat,"_alphaRadBias",1<<_NeuQuantFloat._alphaRadBiasShift);var _ColorHistogram=class{constructor(e,i){__publicField(this,"_method"),__publicField(this,"_hueStats"),__publicField(this,"_histogram"),__publicField(this,"_initColors"),__publicField(this,"_minHueCols"),this._method=e,this._minHueCols=i<<2,this._initColors=i<<2,this._hueStats=new HueStatistics(_ColorHistogram._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(e){switch(this._method){case 1:this._colorStats1D(e);break;case 2:this._colorStats2D(e);break}}getImportanceSortedColorsIDXI32(){const e=stableSort(Object.keys(this._histogram),(a,s)=>this._histogram[s]-this._histogram[a]);if(e.length===0)return[];let i;switch(this._method){case 1:const a=Math.min(e.length,this._initColors),s=e[a-1],o=this._histogram[s];i=e.slice(0,a);let h=a;const d=e.length;for(;h<d&&this._histogram[e[h]]===o;)i.push(e[h++]);this._hueStats.injectIntoArray(i);break;case 2:i=e;break;default:throw new Error("Incorrect method")}return i.map(a=>+a)}_colorStats1D(e){const i=this._histogram,a=e.getPointArray(),s=a.length;for(let o=0;o<s;o++){const h=a[o].uint32;this._hueStats.check(h),h in i?i[h]++:i[h]=1}}_colorStats2D(e){const i=e.getWidth(),a=e.getHeight(),s=e.getPointArray(),o=_ColorHistogram._boxSize[0],h=_ColorHistogram._boxSize[1],d=o*h,g=this._makeBoxes(i,a,o,h),b=this._histogram;g.forEach(_=>{let $=Math.round(_.w*_.h/d)*_ColorHistogram._boxPixels;$<2&&($=2);const it={};this._iterateBox(_,i,nt=>{const tt=s[nt].uint32;this._hueStats.check(tt),tt in b?b[tt]++:tt in it?++it[tt]>=$&&(b[tt]=it[tt]):it[tt]=1})}),this._hueStats.injectIntoDictionary(b)}_iterateBox(e,i,a){const s=e,o=s.y*i+s.x,h=(s.y+s.h-1)*i+(s.x+s.w-1),d=i-s.w+1;let g=0,b=o;do a.call(this,b),b+=++g%s.w===0?d:1;while(b<=h)}_makeBoxes(e,i,a,s){const o=e%a,h=i%s,d=e-o,g=i-h,b=[];for(let _=0;_<i;_+=s)for(let $=0;$<e;$+=a)b.push({x:$,y:_,w:$===d?o:a,h:_===g?h:s});return b}},ColorHistogram=_ColorHistogram;__publicField(ColorHistogram,"_boxSize",[64,64]);__publicField(ColorHistogram,"_boxPixels",2);__publicField(ColorHistogram,"_hueGroups",10);var RemovedColor=class{constructor(e,i,a){__publicField(this,"index"),__publicField(this,"color"),__publicField(this,"distance"),this.index=e,this.color=i,this.distance=a}},RGBQuant=class extends AbstractPaletteQuantizer{constructor(e,i=256,a=2){super(),__publicField(this,"_colors"),__publicField(this,"_initialDistance"),__publicField(this,"_distanceIncrement"),__publicField(this,"_histogram"),__publicField(this,"_distance"),this._distance=e,this._colors=i,this._histogram=new ColorHistogram(a,i),this._initialDistance=.01,this._distanceIncrement=.005}sample(e){this._histogram.sample(e)}*quantize(){const e=this._histogram.getImportanceSortedColorsIDXI32();if(e.length===0)throw new Error("No colors in image");yield*this._buildPalette(e)}*_buildPalette(e){const i=new Palette,a=i.getPointContainer().getPointArray(),s=new Array(e.length);for(let $=0;$<e.length;$++)a.push(Point.createByUint32(e[$])),s[$]=1;const o=a.length,h=[];let d=o,g=this._initialDistance;const b=new ProgressTracker(d-this._colors,99);for(;d>this._colors;){h.length=0;for(let $=0;$<o;$++){if(b.shouldNotify(o-d)&&(yield{progress:b.progress}),s[$]===0)continue;const it=a[$];for(let nt=$+1;nt<o;nt++){if(s[nt]===0)continue;const tt=a[nt],at=this._distance.calculateNormalized(it,tt);at<g&&(h.push(new RemovedColor(nt,tt,at)),s[nt]=0,d--)}}g+=d>this._colors*3?this._initialDistance:this._distanceIncrement}if(d<this._colors){stableSort(h,(it,nt)=>nt.distance-it.distance);let $=0;for(;d<this._colors&&$<h.length;){const it=h[$];s[it.index]=1,d++,$++}}let _=a.length;for(let $=_-1;$>=0;$--)s[$]===0&&($!==_-1&&(a[$]=a[_-1]),--_);a.length=_,i.sort(),yield{palette:i,progress:100}}};function createArray1D(e){const i=[];for(let a=0;a<e;a++)i[a]=0;return i}function createArray4D(e,i,a,s){const o=new Array(e);for(let h=0;h<e;h++){o[h]=new Array(i);for(let d=0;d<i;d++){o[h][d]=new Array(a);for(let g=0;g<a;g++){o[h][d][g]=new Array(s);for(let b=0;b<s;b++)o[h][d][g][b]=0}}}return o}function createArray3D(e,i,a){const s=new Array(e);for(let o=0;o<e;o++){s[o]=new Array(i);for(let h=0;h<i;h++){s[o][h]=new Array(a);for(let d=0;d<a;d++)s[o][h][d]=0}}return s}function fillArray3D(e,i,a,s,o){for(let h=0;h<i;h++){e[h]=[];for(let d=0;d<a;d++){e[h][d]=[];for(let g=0;g<s;g++)e[h][d][g]=o}}}function fillArray1D(e,i,a){for(let s=0;s<i;s++)e[s]=a}var WuColorCube=class{constructor(){__publicField(this,"redMinimum"),__publicField(this,"redMaximum"),__publicField(this,"greenMinimum"),__publicField(this,"greenMaximum"),__publicField(this,"blueMinimum"),__publicField(this,"blueMaximum"),__publicField(this,"volume"),__publicField(this,"alphaMinimum"),__publicField(this,"alphaMaximum")}},_WuQuant=class extends AbstractPaletteQuantizer{constructor(e,i=256,a=5){super(),__publicField(this,"_reds"),__publicField(this,"_greens"),__publicField(this,"_blues"),__publicField(this,"_alphas"),__publicField(this,"_sums"),__publicField(this,"_weights"),__publicField(this,"_momentsRed"),__publicField(this,"_momentsGreen"),__publicField(this,"_momentsBlue"),__publicField(this,"_momentsAlpha"),__publicField(this,"_moments"),__publicField(this,"_table"),__publicField(this,"_pixels"),__publicField(this,"_cubes"),__publicField(this,"_colors"),__publicField(this,"_significantBitsPerChannel"),__publicField(this,"_maxSideIndex"),__publicField(this,"_alphaMaxSideIndex"),__publicField(this,"_sideSize"),__publicField(this,"_alphaSideSize"),__publicField(this,"_distance"),this._distance=e,this._setQuality(a),this._initialize(i)}sample(e){const i=e.getPointArray();for(let a=0,s=i.length;a<s;a++)this._addColor(i[a]);this._pixels=this._pixels.concat(i)}*quantize(){yield*this._preparePalette();const e=new Palette;for(let i=0;i<this._colors;i++)if(this._sums[i]>0){const a=this._sums[i],s=this._reds[i]/a,o=this._greens[i]/a,h=this._blues[i]/a,d=this._alphas[i]/a,g=Point.createByRGBA(s|0,o|0,h|0,d|0);e.add(g)}e.sort(),yield{palette:e,progress:100}}*_preparePalette(){yield*this._calculateMoments();let e=0;const i=createArray1D(this._colors);for(let d=1;d<this._colors;++d){this._cut(this._cubes[e],this._cubes[d])?(i[e]=this._cubes[e].volume>1?this._calculateVariance(this._cubes[e]):0,i[d]=this._cubes[d].volume>1?this._calculateVariance(this._cubes[d]):0):(i[e]=0,d--),e=0;let g=i[0];for(let b=1;b<=d;++b)i[b]>g&&(g=i[b],e=b);if(g<=0){this._colors=d+1;break}}const a=[],s=[],o=[],h=[];for(let d=0;d<this._colors;++d){const g=_WuQuant._volume(this._cubes[d],this._weights);g>0?(a[d]=_WuQuant._volume(this._cubes[d],this._momentsRed)/g|0,s[d]=_WuQuant._volume(this._cubes[d],this._momentsGreen)/g|0,o[d]=_WuQuant._volume(this._cubes[d],this._momentsBlue)/g|0,h[d]=_WuQuant._volume(this._cubes[d],this._momentsAlpha)/g|0):(a[d]=0,s[d]=0,o[d]=0,h[d]=0)}this._reds=createArray1D(this._colors+1),this._greens=createArray1D(this._colors+1),this._blues=createArray1D(this._colors+1),this._alphas=createArray1D(this._colors+1),this._sums=createArray1D(this._colors+1);for(let d=0,g=this._pixels.length;d<g;d++){const b=this._pixels[d];let _=-1,$=Number.MAX_VALUE;for(let it=0;it<this._colors;it++){const nt=a[it],tt=s[it],at=o[it],ut=h[it],ft=this._distance.calculateRaw(nt,tt,at,ut,b.r,b.g,b.b,b.a);ft<$&&($=ft,_=it)}this._reds[_]+=b.r,this._greens[_]+=b.g,this._blues[_]+=b.b,this._alphas[_]+=b.a,this._sums[_]++}}_addColor(e){const i=8-this._significantBitsPerChannel,a=(e.r>>i)+1,s=(e.g>>i)+1,o=(e.b>>i)+1,h=(e.a>>i)+1;this._weights[h][a][s][o]++,this._momentsRed[h][a][s][o]+=e.r,this._momentsGreen[h][a][s][o]+=e.g,this._momentsBlue[h][a][s][o]+=e.b,this._momentsAlpha[h][a][s][o]+=e.a,this._moments[h][a][s][o]+=this._table[e.r]+this._table[e.g]+this._table[e.b]+this._table[e.a]}*_calculateMoments(){const e=[],i=[],a=[],s=[],o=[],h=[],d=createArray3D(this._sideSize,this._sideSize,this._sideSize),g=createArray3D(this._sideSize,this._sideSize,this._sideSize),b=createArray3D(this._sideSize,this._sideSize,this._sideSize),_=createArray3D(this._sideSize,this._sideSize,this._sideSize),$=createArray3D(this._sideSize,this._sideSize,this._sideSize),it=createArray3D(this._sideSize,this._sideSize,this._sideSize);let nt=0;const tt=new ProgressTracker(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let at=1;at<=this._alphaMaxSideIndex;++at){fillArray3D(d,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(g,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(b,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(_,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D($,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(it,this._sideSize,this._sideSize,this._sideSize,0);for(let ut=1;ut<=this._maxSideIndex;++ut,++nt){tt.shouldNotify(nt)&&(yield{progress:tt.progress}),fillArray1D(e,this._sideSize,0),fillArray1D(i,this._sideSize,0),fillArray1D(a,this._sideSize,0),fillArray1D(s,this._sideSize,0),fillArray1D(o,this._sideSize,0),fillArray1D(h,this._sideSize,0);for(let ft=1;ft<=this._maxSideIndex;++ft){let ht=0,dt=0,st=0,ct=0,wt=0,_t=0;for(let gt=1;gt<=this._maxSideIndex;++gt)ht+=this._weights[at][ut][ft][gt],dt+=this._momentsRed[at][ut][ft][gt],st+=this._momentsGreen[at][ut][ft][gt],ct+=this._momentsBlue[at][ut][ft][gt],wt+=this._momentsAlpha[at][ut][ft][gt],_t+=this._moments[at][ut][ft][gt],e[gt]+=ht,i[gt]+=dt,a[gt]+=st,s[gt]+=ct,o[gt]+=wt,h[gt]+=_t,d[ut][ft][gt]=d[ut-1][ft][gt]+e[gt],g[ut][ft][gt]=g[ut-1][ft][gt]+i[gt],b[ut][ft][gt]=b[ut-1][ft][gt]+a[gt],_[ut][ft][gt]=_[ut-1][ft][gt]+s[gt],$[ut][ft][gt]=$[ut-1][ft][gt]+o[gt],it[ut][ft][gt]=it[ut-1][ft][gt]+h[gt],this._weights[at][ut][ft][gt]=this._weights[at-1][ut][ft][gt]+d[ut][ft][gt],this._momentsRed[at][ut][ft][gt]=this._momentsRed[at-1][ut][ft][gt]+g[ut][ft][gt],this._momentsGreen[at][ut][ft][gt]=this._momentsGreen[at-1][ut][ft][gt]+b[ut][ft][gt],this._momentsBlue[at][ut][ft][gt]=this._momentsBlue[at-1][ut][ft][gt]+_[ut][ft][gt],this._momentsAlpha[at][ut][ft][gt]=this._momentsAlpha[at-1][ut][ft][gt]+$[ut][ft][gt],this._moments[at][ut][ft][gt]=this._moments[at-1][ut][ft][gt]+it[ut][ft][gt]}}}}static _volumeFloat(e,i){return i[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMaximum]-i[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMaximum]-i[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMaximum]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]-i[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMaximum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(i[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMinimum]-i[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]-i[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+i[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]-i[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]+i[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]-i[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum])}static _volume(e,i){return _WuQuant._volumeFloat(e,i)|0}static _top(e,i,a,s){let o;switch(i){case _WuQuant._alpha:o=s[a][e.redMaximum][e.greenMaximum][e.blueMaximum]-s[a][e.redMaximum][e.greenMinimum][e.blueMaximum]-s[a][e.redMinimum][e.greenMaximum][e.blueMaximum]+s[a][e.redMinimum][e.greenMinimum][e.blueMaximum]-(s[a][e.redMaximum][e.greenMaximum][e.blueMinimum]-s[a][e.redMaximum][e.greenMinimum][e.blueMinimum]-s[a][e.redMinimum][e.greenMaximum][e.blueMinimum]+s[a][e.redMinimum][e.greenMinimum][e.blueMinimum]);break;case _WuQuant._red:o=s[e.alphaMaximum][a][e.greenMaximum][e.blueMaximum]-s[e.alphaMaximum][a][e.greenMinimum][e.blueMaximum]-s[e.alphaMinimum][a][e.greenMaximum][e.blueMaximum]+s[e.alphaMinimum][a][e.greenMinimum][e.blueMaximum]-(s[e.alphaMaximum][a][e.greenMaximum][e.blueMinimum]-s[e.alphaMaximum][a][e.greenMinimum][e.blueMinimum]-s[e.alphaMinimum][a][e.greenMaximum][e.blueMinimum]+s[e.alphaMinimum][a][e.greenMinimum][e.blueMinimum]);break;case _WuQuant._green:o=s[e.alphaMaximum][e.redMaximum][a][e.blueMaximum]-s[e.alphaMaximum][e.redMinimum][a][e.blueMaximum]-s[e.alphaMinimum][e.redMaximum][a][e.blueMaximum]+s[e.alphaMinimum][e.redMinimum][a][e.blueMaximum]-(s[e.alphaMaximum][e.redMaximum][a][e.blueMinimum]-s[e.alphaMaximum][e.redMinimum][a][e.blueMinimum]-s[e.alphaMinimum][e.redMaximum][a][e.blueMinimum]+s[e.alphaMinimum][e.redMinimum][a][e.blueMinimum]);break;case _WuQuant._blue:o=s[e.alphaMaximum][e.redMaximum][e.greenMaximum][a]-s[e.alphaMaximum][e.redMaximum][e.greenMinimum][a]-s[e.alphaMaximum][e.redMinimum][e.greenMaximum][a]+s[e.alphaMaximum][e.redMinimum][e.greenMinimum][a]-(s[e.alphaMinimum][e.redMaximum][e.greenMaximum][a]-s[e.alphaMinimum][e.redMaximum][e.greenMinimum][a]-s[e.alphaMinimum][e.redMinimum][e.greenMaximum][a]+s[e.alphaMinimum][e.redMinimum][e.greenMinimum][a]);break;default:throw new Error("impossible")}return o|0}static _bottom(e,i,a){switch(i){case _WuQuant._alpha:return-a[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMaximum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-a[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _WuQuant._red:return-a[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMaximum]+a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-a[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]+a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _WuQuant._green:return-a[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMaximum]+a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-a[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case _WuQuant._blue:return-a[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMinimum]+a[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+a[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]-a[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]-(-a[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]+a[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]+a[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-a[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);default:return 0}}_calculateVariance(e){const i=_WuQuant._volume(e,this._momentsRed),a=_WuQuant._volume(e,this._momentsGreen),s=_WuQuant._volume(e,this._momentsBlue),o=_WuQuant._volume(e,this._momentsAlpha),h=_WuQuant._volumeFloat(e,this._moments),d=_WuQuant._volume(e,this._weights),g=i*i+a*a+s*s+o*o;return h-g/d}_maximize(e,i,a,s,o,h,d,g,b){const _=_WuQuant._bottom(e,i,this._momentsRed)|0,$=_WuQuant._bottom(e,i,this._momentsGreen)|0,it=_WuQuant._bottom(e,i,this._momentsBlue)|0,nt=_WuQuant._bottom(e,i,this._momentsAlpha)|0,tt=_WuQuant._bottom(e,i,this._weights)|0;let at=0,ut=-1;for(let ft=a;ft<s;++ft){let ht=_+_WuQuant._top(e,i,ft,this._momentsRed),dt=$+_WuQuant._top(e,i,ft,this._momentsGreen),st=it+_WuQuant._top(e,i,ft,this._momentsBlue),ct=nt+_WuQuant._top(e,i,ft,this._momentsAlpha),wt=tt+_WuQuant._top(e,i,ft,this._weights);if(wt!==0){let _t=ht*ht+dt*dt+st*st+ct*ct,gt=_t/wt;ht=o-ht,dt=h-dt,st=d-st,ct=g-ct,wt=b-wt,wt!==0&&(_t=ht*ht+dt*dt+st*st+ct*ct,gt+=_t/wt,gt>at&&(at=gt,ut=ft))}}return{max:at,position:ut}}_cut(e,i){let a;const s=_WuQuant._volume(e,this._momentsRed),o=_WuQuant._volume(e,this._momentsGreen),h=_WuQuant._volume(e,this._momentsBlue),d=_WuQuant._volume(e,this._momentsAlpha),g=_WuQuant._volume(e,this._weights),b=this._maximize(e,_WuQuant._red,e.redMinimum+1,e.redMaximum,s,o,h,d,g),_=this._maximize(e,_WuQuant._green,e.greenMinimum+1,e.greenMaximum,s,o,h,d,g),$=this._maximize(e,_WuQuant._blue,e.blueMinimum+1,e.blueMaximum,s,o,h,d,g),it=this._maximize(e,_WuQuant._alpha,e.alphaMinimum+1,e.alphaMaximum,s,o,h,d,g);if(it.max>=b.max&&it.max>=_.max&&it.max>=$.max){if(a=_WuQuant._alpha,it.position<0)return!1}else b.max>=it.max&&b.max>=_.max&&b.max>=$.max?a=_WuQuant._red:_.max>=it.max&&_.max>=b.max&&_.max>=$.max?a=_WuQuant._green:a=_WuQuant._blue;switch(i.redMaximum=e.redMaximum,i.greenMaximum=e.greenMaximum,i.blueMaximum=e.blueMaximum,i.alphaMaximum=e.alphaMaximum,a){case _WuQuant._red:i.redMinimum=e.redMaximum=b.position,i.greenMinimum=e.greenMinimum,i.blueMinimum=e.blueMinimum,i.alphaMinimum=e.alphaMinimum;break;case _WuQuant._green:i.greenMinimum=e.greenMaximum=_.position,i.redMinimum=e.redMinimum,i.blueMinimum=e.blueMinimum,i.alphaMinimum=e.alphaMinimum;break;case _WuQuant._blue:i.blueMinimum=e.blueMaximum=$.position,i.redMinimum=e.redMinimum,i.greenMinimum=e.greenMinimum,i.alphaMinimum=e.alphaMinimum;break;case _WuQuant._alpha:i.alphaMinimum=e.alphaMaximum=it.position,i.blueMinimum=e.blueMinimum,i.redMinimum=e.redMinimum,i.greenMinimum=e.greenMinimum;break}return e.volume=(e.redMaximum-e.redMinimum)*(e.greenMaximum-e.greenMinimum)*(e.blueMaximum-e.blueMinimum)*(e.alphaMaximum-e.alphaMinimum),i.volume=(i.redMaximum-i.redMinimum)*(i.greenMaximum-i.greenMinimum)*(i.blueMaximum-i.blueMinimum)*(i.alphaMaximum-i.alphaMinimum),!0}_initialize(e){this._colors=e,this._cubes=[];for(let i=0;i<e;i++)this._cubes[i]=new WuColorCube;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let i=0;i<256;++i)this._table[i]=i*i;this._pixels=[]}_setQuality(e=5){this._significantBitsPerChannel=e,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant=_WuQuant;__publicField(WuQuant,"_alpha",3);__publicField(WuQuant,"_red",2);__publicField(WuQuant,"_green",1);__publicField(WuQuant,"_blue",0);var image_exports={};__export(image_exports,{AbstractImageQuantizer:()=>AbstractImageQuantizer,ErrorDiffusionArray:()=>ErrorDiffusionArray,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma,NearestColor:()=>NearestColor});var AbstractImageQuantizer=class{quantizeSync(e,i){for(const a of this.quantize(e,i))if(a.pointContainer)return a.pointContainer;throw new Error("unreachable")}},NearestColor=class extends AbstractImageQuantizer{constructor(e){super(),__publicField(this,"_distance"),this._distance=e}*quantize(e,i){const a=e.getPointArray(),s=e.getWidth(),o=e.getHeight(),h=new ProgressTracker(o,99);for(let d=0;d<o;d++){h.shouldNotify(d)&&(yield{progress:h.progress});for(let g=0,b=d*s;g<s;g++,b++){const _=a[b];_.from(i.getNearestColor(this._distance,_))}}yield{pointContainer:e,progress:100}}},ErrorDiffusionArrayKernel=(e=>(e[e.FloydSteinberg=0]="FloydSteinberg",e[e.FalseFloydSteinberg=1]="FalseFloydSteinberg",e[e.Stucki=2]="Stucki",e[e.Atkinson=3]="Atkinson",e[e.Jarvis=4]="Jarvis",e[e.Burkes=5]="Burkes",e[e.Sierra=6]="Sierra",e[e.TwoSierra=7]="TwoSierra",e[e.SierraLite=8]="SierraLite",e))(ErrorDiffusionArrayKernel||{}),ErrorDiffusionArray=class extends AbstractImageQuantizer{constructor(e,i,a=!0,s=0,o=!1){super(),__publicField(this,"_minColorDistance"),__publicField(this,"_serpentine"),__publicField(this,"_kernel"),__publicField(this,"_calculateErrorLikeGIMP"),__publicField(this,"_distance"),this._setKernel(i),this._distance=e,this._minColorDistance=s,this._serpentine=a,this._calculateErrorLikeGIMP=o}*quantize(e,i){const a=e.getPointArray(),s=new Point,o=e.getWidth(),h=e.getHeight(),d=[];let g=1,b=1;for(const $ of this._kernel){const it=$[2]+1;b<it&&(b=it)}for(let $=0;$<b;$++)this._fillErrorLine(d[$]=[],o);const _=new ProgressTracker(h,99);for(let $=0;$<h;$++){_.shouldNotify($)&&(yield{progress:_.progress}),this._serpentine&&(g*=-1);const it=$*o,nt=g===1?0:o-1,tt=g===1?o:-1;this._fillErrorLine(d[0],o),d.push(d.shift());const at=d[0];for(let ut=nt,ft=it+nt;ut!==tt;ut+=g,ft+=g){const ht=a[ft],dt=at[ut];s.from(ht);const st=Point.createByRGBA(inRange0to255Rounded(ht.r+dt[0]),inRange0to255Rounded(ht.g+dt[1]),inRange0to255Rounded(ht.b+dt[2]),inRange0to255Rounded(ht.a+dt[3])),ct=i.getNearestColor(this._distance,st);if(ht.from(ct),this._minColorDistance&&this._distance.calculateNormalized(s,ct)<this._minColorDistance)continue;let wt,_t,gt,yt;this._calculateErrorLikeGIMP?(wt=st.r-ct.r,_t=st.g-ct.g,gt=st.b-ct.b,yt=st.a-ct.a):(wt=s.r-ct.r,_t=s.g-ct.g,gt=s.b-ct.b,yt=s.a-ct.a);const bt=g===1?0:this._kernel.length-1,vt=g===1?this._kernel.length:-1;for(let Ct=bt;Ct!==vt;Ct+=g){const Ht=this._kernel[Ct][1]*g,Ft=this._kernel[Ct][2];if(Ht+ut>=0&&Ht+ut<o&&Ft+$>=0&&Ft+$<h){const qt=this._kernel[Ct][0],zt=d[Ft][Ht+ut];zt[0]+=wt*qt,zt[1]+=_t*qt,zt[2]+=gt*qt,zt[3]+=yt*qt}}}}yield{pointContainer:e,progress:100}}_fillErrorLine(e,i){e.length>i&&(e.length=i);const a=e.length;for(let s=0;s<a;s++){const o=e[s];o[0]=o[1]=o[2]=o[3]=0}for(let s=a;s<i;s++)e[s]=[0,0,0,0]}_setKernel(e){switch(e){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[8/32,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[8/32,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[4/16,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[2/4,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${e}`)}}};function*hilbertCurve(e,i,a){const s=Math.max(e,i),o=Math.floor(Math.log(s)/Math.log(2)+1),h=new ProgressTracker(e*i,99),d={width:e,height:i,level:o,callback:a,tracker:h,index:0,x:0,y:0};yield*walkHilbert(d,1),visit(d,0)}function*walkHilbert(e,i){if(!(e.level<1)){switch(e.tracker.shouldNotify(e.index)&&(yield{progress:e.tracker.progress}),e.level--,i){case 2:yield*walkHilbert(e,1),visit(e,3),yield*walkHilbert(e,2),visit(e,4),yield*walkHilbert(e,2),visit(e,2),yield*walkHilbert(e,4);break;case 3:yield*walkHilbert(e,4),visit(e,2),yield*walkHilbert(e,3),visit(e,1),yield*walkHilbert(e,3),visit(e,3),yield*walkHilbert(e,1);break;case 1:yield*walkHilbert(e,2),visit(e,4),yield*walkHilbert(e,1),visit(e,3),yield*walkHilbert(e,1),visit(e,1),yield*walkHilbert(e,3);break;case 4:yield*walkHilbert(e,3),visit(e,1),yield*walkHilbert(e,4),visit(e,2),yield*walkHilbert(e,4),visit(e,4),yield*walkHilbert(e,2);break}e.level++}}function visit(e,i){switch(e.x>=0&&e.x<e.width&&e.y>=0&&e.y<e.height&&(e.callback(e.x,e.y),e.index++),i){case 2:e.x--;break;case 3:e.x++;break;case 1:e.y--;break;case 4:e.y++;break}}var ErrorDiffusionRiemersma=class extends AbstractImageQuantizer{constructor(e,i=16,a=1){super(),__publicField(this,"_distance"),__publicField(this,"_weights"),__publicField(this,"_errorQueueSize"),this._distance=e,this._errorQueueSize=i,this._weights=ErrorDiffusionRiemersma._createWeights(a,i)}*quantize(e,i){const a=e.getPointArray(),s=e.getWidth(),o=e.getHeight(),h=[];let d=0;for(let g=0;g<this._errorQueueSize;g++)h[g]={r:0,g:0,b:0,a:0};yield*hilbertCurve(s,o,(g,b)=>{const _=a[g+b*s];let{r:$,g:it,b:nt,a:tt}=_;for(let ht=0;ht<this._errorQueueSize;ht++){const dt=this._weights[ht],st=h[(ht+d)%this._errorQueueSize];$+=st.r*dt,it+=st.g*dt,nt+=st.b*dt,tt+=st.a*dt}const at=Point.createByRGBA(inRange0to255Rounded($),inRange0to255Rounded(it),inRange0to255Rounded(nt),inRange0to255Rounded(tt)),ut=i.getNearestColor(this._distance,at);d=(d+1)%this._errorQueueSize;const ft=(d+this._errorQueueSize-1)%this._errorQueueSize;h[ft].r=_.r-ut.r,h[ft].g=_.g-ut.g,h[ft].b=_.b-ut.b,h[ft].a=_.a-ut.a,_.from(ut)}),yield{pointContainer:e,progress:100}}static _createWeights(e,i){const a=[],s=Math.exp(Math.log(i)/(i-1));for(let o=0,h=1;o<i;o++)a[o]=(h+.5|0)/i*e,h*=s;return a}},quality_exports={};__export(quality_exports,{ssim:()=>ssim});var K1=.01,K2=.03;function ssim(e,i){if(e.getHeight()!==i.getHeight()||e.getWidth()!==i.getWidth())throw new Error("Images have different sizes!");const a=255,s=(K1*a)**2,o=(K2*a)**2;let h=0,d=0;return iterate(e,i,(g,b,_,$)=>{let it=0,nt=0,tt=0;for(let dt=0;dt<g.length;dt++)nt+=(g[dt]-_)**2,tt+=(b[dt]-$)**2,it+=(g[dt]-_)*(b[dt]-$);const at=g.length-1;nt/=at,tt/=at,it/=at;const ut=(2*_*$+s)*(2*it+o),ft=(_**2+$**2+s)*(nt+tt+o),ht=ut/ft;d+=ht,h++}),d/h}function iterate(e,i,a){const s=e.getWidth(),o=e.getHeight();for(let h=0;h<o;h+=8)for(let d=0;d<s;d+=8){const g=Math.min(8,s-d),b=Math.min(8,o-h),_=calculateLumaValuesForWindow(e,d,h,g,b),$=calculateLumaValuesForWindow(i,d,h,g,b),it=calculateAverageLuma(_),nt=calculateAverageLuma($);a(_,$,it,nt)}}function calculateLumaValuesForWindow(e,i,a,s,o){const h=e.getPointArray(),d=[];let g=0;for(let b=a;b<a+o;b++){const _=b*e.getWidth();for(let $=i;$<i+s;$++){const it=h[_+$];d[g]=it.r*.2126+it.g*.7152+it.b*.0722,g++}}return d}function calculateAverageLuma(e){let i=0;for(const a of e)i+=a;return i/e.length}typeof setImmediate=="function"?setImmediate:typeof process<"u"&&(process==null||process.nextTick);/**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cie94.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ciede2000.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cmetric.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * common.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * constants.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ditherErrorDiffusionArray.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * euclidean.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * helper.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * hueStatistics.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2rgb.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2xyz.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * manhattanNeuQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * nearestColor.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * palette.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pngQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * point.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pointContainer.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2hsl.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2lab.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2xyz.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * wuQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2lab.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2rgb.ts - part of Image Quantization Library
 *//**
 * @preserve
 * MIT License
 *
 * Copyright 2015-2018 Igor Bezkrovnyi
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * riemersma.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * colorHistogram.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * neuquant.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgbquant.ts - part of Image Quantization Library
 */var common={},hasRequiredCommon;function requireCommon(){return hasRequiredCommon||(hasRequiredCommon=1,function(e){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function a(h,d){return Object.prototype.hasOwnProperty.call(h,d)}e.assign=function(h){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var g=d.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var b in g)a(g,b)&&(h[b]=g[b])}}return h},e.shrinkBuf=function(h,d){return h.length===d?h:h.subarray?h.subarray(0,d):(h.length=d,h)};var s={arraySet:function(h,d,g,b,_){if(d.subarray&&h.subarray){h.set(d.subarray(g,g+b),_);return}for(var $=0;$<b;$++)h[_+$]=d[g+$]},flattenChunks:function(h){var d,g,b,_,$,it;for(b=0,d=0,g=h.length;d<g;d++)b+=h[d].length;for(it=new Uint8Array(b),_=0,d=0,g=h.length;d<g;d++)$=h[d],it.set($,_),_+=$.length;return it}},o={arraySet:function(h,d,g,b,_){for(var $=0;$<b;$++)h[_+$]=d[g+$]},flattenChunks:function(h){return[].concat.apply([],h)}};e.setTyped=function(h){h?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,s)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,o))},e.setTyped(i)}(common)),common}var deflate$1={},deflate={},trees={},hasRequiredTrees;function requireTrees(){if(hasRequiredTrees)return trees;hasRequiredTrees=1;var e=requireCommon(),i=4,a=0,s=1,o=2;function h(At){for(var ur=At.length;--ur>=0;)At[ur]=0}var d=0,g=1,b=2,_=3,$=258,it=29,nt=256,tt=nt+1+it,at=30,ut=19,ft=2*tt+1,ht=15,dt=16,st=7,ct=256,wt=16,_t=17,gt=18,yt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],bt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ct=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ht=512,Ft=new Array((tt+2)*2);h(Ft);var qt=new Array(at*2);h(qt);var zt=new Array(Ht);h(zt);var Qt=new Array($-_+1);h(Qt);var _e=new Array(it);h(_e);var Gt=new Array(at);h(Gt);function Jt(At,ur,cr,yr,jt){this.static_tree=At,this.extra_bits=ur,this.extra_base=cr,this.elems=yr,this.max_length=jt,this.has_stree=At&&At.length}var or,mr,hr;function Lr(At,ur){this.dyn_tree=At,this.max_code=0,this.stat_desc=ur}function Er(At){return At<256?zt[At]:zt[256+(At>>>7)]}function Kt(At,ur){At.pending_buf[At.pending++]=ur&255,At.pending_buf[At.pending++]=ur>>>8&255}function fr(At,ur,cr){At.bi_valid>dt-cr?(At.bi_buf|=ur<<At.bi_valid&65535,Kt(At,At.bi_buf),At.bi_buf=ur>>dt-At.bi_valid,At.bi_valid+=cr-dt):(At.bi_buf|=ur<<At.bi_valid&65535,At.bi_valid+=cr)}function Rr(At,ur,cr){fr(At,cr[ur*2],cr[ur*2+1])}function gr(At,ur){var cr=0;do cr|=At&1,At>>>=1,cr<<=1;while(--ur>0);return cr>>>1}function ir(At){At.bi_valid===16?(Kt(At,At.bi_buf),At.bi_buf=0,At.bi_valid=0):At.bi_valid>=8&&(At.pending_buf[At.pending++]=At.bi_buf&255,At.bi_buf>>=8,At.bi_valid-=8)}function Vr(At,ur){var cr=ur.dyn_tree,yr=ur.max_code,jt=ur.stat_desc.static_tree,lr=ur.stat_desc.has_stree,xt=ur.stat_desc.extra_bits,pr=ur.stat_desc.extra_base,Yr=ur.stat_desc.max_length,mt,er,sr,Mt,Ut,tr,zr=0;for(Mt=0;Mt<=ht;Mt++)At.bl_count[Mt]=0;for(cr[At.heap[At.heap_max]*2+1]=0,mt=At.heap_max+1;mt<ft;mt++)er=At.heap[mt],Mt=cr[cr[er*2+1]*2+1]+1,Mt>Yr&&(Mt=Yr,zr++),cr[er*2+1]=Mt,!(er>yr)&&(At.bl_count[Mt]++,Ut=0,er>=pr&&(Ut=xt[er-pr]),tr=cr[er*2],At.opt_len+=tr*(Mt+Ut),lr&&(At.static_len+=tr*(jt[er*2+1]+Ut)));if(zr!==0){do{for(Mt=Yr-1;At.bl_count[Mt]===0;)Mt--;At.bl_count[Mt]--,At.bl_count[Mt+1]+=2,At.bl_count[Yr]--,zr-=2}while(zr>0);for(Mt=Yr;Mt!==0;Mt--)for(er=At.bl_count[Mt];er!==0;)sr=At.heap[--mt],!(sr>yr)&&(cr[sr*2+1]!==Mt&&(At.opt_len+=(Mt-cr[sr*2+1])*cr[sr*2],cr[sr*2+1]=Mt),er--)}}function Ur(At,ur,cr){var yr=new Array(ht+1),jt=0,lr,xt;for(lr=1;lr<=ht;lr++)yr[lr]=jt=jt+cr[lr-1]<<1;for(xt=0;xt<=ur;xt++){var pr=At[xt*2+1];pr!==0&&(At[xt*2]=gr(yr[pr]++,pr))}}function Fr(){var At,ur,cr,yr,jt,lr=new Array(ht+1);for(cr=0,yr=0;yr<it-1;yr++)for(_e[yr]=cr,At=0;At<1<<yt[yr];At++)Qt[cr++]=yr;for(Qt[cr-1]=yr,jt=0,yr=0;yr<16;yr++)for(Gt[yr]=jt,At=0;At<1<<bt[yr];At++)zt[jt++]=yr;for(jt>>=7;yr<at;yr++)for(Gt[yr]=jt<<7,At=0;At<1<<bt[yr]-7;At++)zt[256+jt++]=yr;for(ur=0;ur<=ht;ur++)lr[ur]=0;for(At=0;At<=143;)Ft[At*2+1]=8,At++,lr[8]++;for(;At<=255;)Ft[At*2+1]=9,At++,lr[9]++;for(;At<=279;)Ft[At*2+1]=7,At++,lr[7]++;for(;At<=287;)Ft[At*2+1]=8,At++,lr[8]++;for(Ur(Ft,tt+1,lr),At=0;At<at;At++)qt[At*2+1]=5,qt[At*2]=gr(At,5);or=new Jt(Ft,yt,nt+1,tt,ht),mr=new Jt(qt,bt,0,at,ht),hr=new Jt(new Array(0),vt,0,ut,st)}function Sr(At){var ur;for(ur=0;ur<tt;ur++)At.dyn_ltree[ur*2]=0;for(ur=0;ur<at;ur++)At.dyn_dtree[ur*2]=0;for(ur=0;ur<ut;ur++)At.bl_tree[ur*2]=0;At.dyn_ltree[ct*2]=1,At.opt_len=At.static_len=0,At.last_lit=At.matches=0}function vr(At){At.bi_valid>8?Kt(At,At.bi_buf):At.bi_valid>0&&(At.pending_buf[At.pending++]=At.bi_buf),At.bi_buf=0,At.bi_valid=0}function Qr(At,ur,cr,yr){vr(At),Kt(At,cr),Kt(At,~cr),e.arraySet(At.pending_buf,At.window,ur,cr,At.pending),At.pending+=cr}function Or(At,ur,cr,yr){var jt=ur*2,lr=cr*2;return At[jt]<At[lr]||At[jt]===At[lr]&&yr[ur]<=yr[cr]}function Cr(At,ur,cr){for(var yr=At.heap[cr],jt=cr<<1;jt<=At.heap_len&&(jt<At.heap_len&&Or(ur,At.heap[jt+1],At.heap[jt],At.depth)&&jt++,!Or(ur,yr,At.heap[jt],At.depth));)At.heap[cr]=At.heap[jt],cr=jt,jt<<=1;At.heap[cr]=yr}function Hr(At,ur,cr){var yr,jt,lr=0,xt,pr;if(At.last_lit!==0)do yr=At.pending_buf[At.d_buf+lr*2]<<8|At.pending_buf[At.d_buf+lr*2+1],jt=At.pending_buf[At.l_buf+lr],lr++,yr===0?Rr(At,jt,ur):(xt=Qt[jt],Rr(At,xt+nt+1,ur),pr=yt[xt],pr!==0&&(jt-=_e[xt],fr(At,jt,pr)),yr--,xt=Er(yr),Rr(At,xt,cr),pr=bt[xt],pr!==0&&(yr-=Gt[xt],fr(At,yr,pr)));while(lr<At.last_lit);Rr(At,ct,ur)}function nr(At,ur){var cr=ur.dyn_tree,yr=ur.stat_desc.static_tree,jt=ur.stat_desc.has_stree,lr=ur.stat_desc.elems,xt,pr,Yr=-1,mt;for(At.heap_len=0,At.heap_max=ft,xt=0;xt<lr;xt++)cr[xt*2]!==0?(At.heap[++At.heap_len]=Yr=xt,At.depth[xt]=0):cr[xt*2+1]=0;for(;At.heap_len<2;)mt=At.heap[++At.heap_len]=Yr<2?++Yr:0,cr[mt*2]=1,At.depth[mt]=0,At.opt_len--,jt&&(At.static_len-=yr[mt*2+1]);for(ur.max_code=Yr,xt=At.heap_len>>1;xt>=1;xt--)Cr(At,cr,xt);mt=lr;do xt=At.heap[1],At.heap[1]=At.heap[At.heap_len--],Cr(At,cr,1),pr=At.heap[1],At.heap[--At.heap_max]=xt,At.heap[--At.heap_max]=pr,cr[mt*2]=cr[xt*2]+cr[pr*2],At.depth[mt]=(At.depth[xt]>=At.depth[pr]?At.depth[xt]:At.depth[pr])+1,cr[xt*2+1]=cr[pr*2+1]=mt,At.heap[1]=mt++,Cr(At,cr,1);while(At.heap_len>=2);At.heap[--At.heap_max]=At.heap[1],Vr(At,ur),Ur(cr,Yr,At.bl_count)}function Dr(At,ur,cr){var yr,jt=-1,lr,xt=ur[0*2+1],pr=0,Yr=7,mt=4;for(xt===0&&(Yr=138,mt=3),ur[(cr+1)*2+1]=65535,yr=0;yr<=cr;yr++)lr=xt,xt=ur[(yr+1)*2+1],!(++pr<Yr&&lr===xt)&&(pr<mt?At.bl_tree[lr*2]+=pr:lr!==0?(lr!==jt&&At.bl_tree[lr*2]++,At.bl_tree[wt*2]++):pr<=10?At.bl_tree[_t*2]++:At.bl_tree[gt*2]++,pr=0,jt=lr,xt===0?(Yr=138,mt=3):lr===xt?(Yr=6,mt=3):(Yr=7,mt=4))}function qr(At,ur,cr){var yr,jt=-1,lr,xt=ur[0*2+1],pr=0,Yr=7,mt=4;for(xt===0&&(Yr=138,mt=3),yr=0;yr<=cr;yr++)if(lr=xt,xt=ur[(yr+1)*2+1],!(++pr<Yr&&lr===xt)){if(pr<mt)do Rr(At,lr,At.bl_tree);while(--pr!==0);else lr!==0?(lr!==jt&&(Rr(At,lr,At.bl_tree),pr--),Rr(At,wt,At.bl_tree),fr(At,pr-3,2)):pr<=10?(Rr(At,_t,At.bl_tree),fr(At,pr-3,3)):(Rr(At,gt,At.bl_tree),fr(At,pr-11,7));pr=0,jt=lr,xt===0?(Yr=138,mt=3):lr===xt?(Yr=6,mt=3):(Yr=7,mt=4)}}function Nr(At){var ur;for(Dr(At,At.dyn_ltree,At.l_desc.max_code),Dr(At,At.dyn_dtree,At.d_desc.max_code),nr(At,At.bl_desc),ur=ut-1;ur>=3&&At.bl_tree[Ct[ur]*2+1]===0;ur--);return At.opt_len+=3*(ur+1)+5+5+4,ur}function _r(At,ur,cr,yr){var jt;for(fr(At,ur-257,5),fr(At,cr-1,5),fr(At,yr-4,4),jt=0;jt<yr;jt++)fr(At,At.bl_tree[Ct[jt]*2+1],3);qr(At,At.dyn_ltree,ur-1),qr(At,At.dyn_dtree,cr-1)}function jr(At){var ur=4093624447,cr;for(cr=0;cr<=31;cr++,ur>>>=1)if(ur&1&&At.dyn_ltree[cr*2]!==0)return a;if(At.dyn_ltree[9*2]!==0||At.dyn_ltree[10*2]!==0||At.dyn_ltree[13*2]!==0)return s;for(cr=32;cr<nt;cr++)if(At.dyn_ltree[cr*2]!==0)return s;return a}var Ar=!1;function $r(At){Ar||(Fr(),Ar=!0),At.l_desc=new Lr(At.dyn_ltree,or),At.d_desc=new Lr(At.dyn_dtree,mr),At.bl_desc=new Lr(At.bl_tree,hr),At.bi_buf=0,At.bi_valid=0,Sr(At)}function Tr(At,ur,cr,yr){fr(At,(d<<1)+(yr?1:0),3),Qr(At,ur,cr)}function Gr(At){fr(At,g<<1,3),Rr(At,ct,Ft),ir(At)}function xr(At,ur,cr,yr){var jt,lr,xt=0;At.level>0?(At.strm.data_type===o&&(At.strm.data_type=jr(At)),nr(At,At.l_desc),nr(At,At.d_desc),xt=Nr(At),jt=At.opt_len+3+7>>>3,lr=At.static_len+3+7>>>3,lr<=jt&&(jt=lr)):jt=lr=cr+5,cr+4<=jt&&ur!==-1?Tr(At,ur,cr,yr):At.strategy===i||lr===jt?(fr(At,(g<<1)+(yr?1:0),3),Hr(At,Ft,qt)):(fr(At,(b<<1)+(yr?1:0),3),_r(At,At.l_desc.max_code+1,At.d_desc.max_code+1,xt+1),Hr(At,At.dyn_ltree,At.dyn_dtree)),Sr(At),yr&&vr(At)}function Br(At,ur,cr){return At.pending_buf[At.d_buf+At.last_lit*2]=ur>>>8&255,At.pending_buf[At.d_buf+At.last_lit*2+1]=ur&255,At.pending_buf[At.l_buf+At.last_lit]=cr&255,At.last_lit++,ur===0?At.dyn_ltree[cr*2]++:(At.matches++,ur--,At.dyn_ltree[(Qt[cr]+nt+1)*2]++,At.dyn_dtree[Er(ur)*2]++),At.last_lit===At.lit_bufsize-1}return trees._tr_init=$r,trees._tr_stored_block=Tr,trees._tr_flush_block=xr,trees._tr_tally=Br,trees._tr_align=Gr,trees}var adler32_1,hasRequiredAdler32;function requireAdler32(){if(hasRequiredAdler32)return adler32_1;hasRequiredAdler32=1;function e(i,a,s,o){for(var h=i&65535|0,d=i>>>16&65535|0,g=0;s!==0;){g=s>2e3?2e3:s,s-=g;do h=h+a[o++]|0,d=d+h|0;while(--g);h%=65521,d%=65521}return h|d<<16|0}return adler32_1=e,adler32_1}var crc32_1,hasRequiredCrc32;function requireCrc32(){if(hasRequiredCrc32)return crc32_1;hasRequiredCrc32=1;function e(){for(var s,o=[],h=0;h<256;h++){s=h;for(var d=0;d<8;d++)s=s&1?3988292384^s>>>1:s>>>1;o[h]=s}return o}var i=e();function a(s,o,h,d){var g=i,b=d+h;s^=-1;for(var _=d;_<b;_++)s=s>>>8^g[(s^o[_])&255];return s^-1}return crc32_1=a,crc32_1}var messages,hasRequiredMessages;function requireMessages(){return hasRequiredMessages||(hasRequiredMessages=1,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),messages}var hasRequiredDeflate$1;function requireDeflate$1(){if(hasRequiredDeflate$1)return deflate;hasRequiredDeflate$1=1;var e=requireCommon(),i=requireTrees(),a=requireAdler32(),s=requireCrc32(),o=requireMessages(),h=0,d=1,g=3,b=4,_=5,$=0,it=1,nt=-2,tt=-3,at=-5,ut=-1,ft=1,ht=2,dt=3,st=4,ct=0,wt=2,_t=8,gt=9,yt=15,bt=8,vt=29,Ct=256,Ht=Ct+1+vt,Ft=30,qt=19,zt=2*Ht+1,Qt=15,_e=3,Gt=258,Jt=Gt+_e+1,or=32,mr=42,hr=69,Lr=73,Er=91,Kt=103,fr=113,Rr=666,gr=1,ir=2,Vr=3,Ur=4,Fr=3;function Sr(mt,er){return mt.msg=o[er],er}function vr(mt){return(mt<<1)-(mt>4?9:0)}function Qr(mt){for(var er=mt.length;--er>=0;)mt[er]=0}function Or(mt){var er=mt.state,sr=er.pending;sr>mt.avail_out&&(sr=mt.avail_out),sr!==0&&(e.arraySet(mt.output,er.pending_buf,er.pending_out,sr,mt.next_out),mt.next_out+=sr,er.pending_out+=sr,mt.total_out+=sr,mt.avail_out-=sr,er.pending-=sr,er.pending===0&&(er.pending_out=0))}function Cr(mt,er){i._tr_flush_block(mt,mt.block_start>=0?mt.block_start:-1,mt.strstart-mt.block_start,er),mt.block_start=mt.strstart,Or(mt.strm)}function Hr(mt,er){mt.pending_buf[mt.pending++]=er}function nr(mt,er){mt.pending_buf[mt.pending++]=er>>>8&255,mt.pending_buf[mt.pending++]=er&255}function Dr(mt,er,sr,Mt){var Ut=mt.avail_in;return Ut>Mt&&(Ut=Mt),Ut===0?0:(mt.avail_in-=Ut,e.arraySet(er,mt.input,mt.next_in,Ut,sr),mt.state.wrap===1?mt.adler=a(mt.adler,er,Ut,sr):mt.state.wrap===2&&(mt.adler=s(mt.adler,er,Ut,sr)),mt.next_in+=Ut,mt.total_in+=Ut,Ut)}function qr(mt,er){var sr=mt.max_chain_length,Mt=mt.strstart,Ut,tr,zr=mt.prev_length,lt=mt.nice_match,et=mt.strstart>mt.w_size-Jt?mt.strstart-(mt.w_size-Jt):0,j=mt.window,rt=mt.w_mask,ot=mt.prev,pt=mt.strstart+Gt,kt=j[Mt+zr-1],Et=j[Mt+zr];mt.prev_length>=mt.good_match&&(sr>>=2),lt>mt.lookahead&&(lt=mt.lookahead);do if(Ut=er,!(j[Ut+zr]!==Et||j[Ut+zr-1]!==kt||j[Ut]!==j[Mt]||j[++Ut]!==j[Mt+1])){Mt+=2,Ut++;do;while(j[++Mt]===j[++Ut]&&j[++Mt]===j[++Ut]&&j[++Mt]===j[++Ut]&&j[++Mt]===j[++Ut]&&j[++Mt]===j[++Ut]&&j[++Mt]===j[++Ut]&&j[++Mt]===j[++Ut]&&j[++Mt]===j[++Ut]&&Mt<pt);if(tr=Gt-(pt-Mt),Mt=pt-Gt,tr>zr){if(mt.match_start=er,zr=tr,tr>=lt)break;kt=j[Mt+zr-1],Et=j[Mt+zr]}}while((er=ot[er&rt])>et&&--sr!==0);return zr<=mt.lookahead?zr:mt.lookahead}function Nr(mt){var er=mt.w_size,sr,Mt,Ut,tr,zr;do{if(tr=mt.window_size-mt.lookahead-mt.strstart,mt.strstart>=er+(er-Jt)){e.arraySet(mt.window,mt.window,er,er,0),mt.match_start-=er,mt.strstart-=er,mt.block_start-=er,Mt=mt.hash_size,sr=Mt;do Ut=mt.head[--sr],mt.head[sr]=Ut>=er?Ut-er:0;while(--Mt);Mt=er,sr=Mt;do Ut=mt.prev[--sr],mt.prev[sr]=Ut>=er?Ut-er:0;while(--Mt);tr+=er}if(mt.strm.avail_in===0)break;if(Mt=Dr(mt.strm,mt.window,mt.strstart+mt.lookahead,tr),mt.lookahead+=Mt,mt.lookahead+mt.insert>=_e)for(zr=mt.strstart-mt.insert,mt.ins_h=mt.window[zr],mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[zr+1])&mt.hash_mask;mt.insert&&(mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[zr+_e-1])&mt.hash_mask,mt.prev[zr&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=zr,zr++,mt.insert--,!(mt.lookahead+mt.insert<_e)););}while(mt.lookahead<Jt&&mt.strm.avail_in!==0)}function _r(mt,er){var sr=65535;for(sr>mt.pending_buf_size-5&&(sr=mt.pending_buf_size-5);;){if(mt.lookahead<=1){if(Nr(mt),mt.lookahead===0&&er===h)return gr;if(mt.lookahead===0)break}mt.strstart+=mt.lookahead,mt.lookahead=0;var Mt=mt.block_start+sr;if((mt.strstart===0||mt.strstart>=Mt)&&(mt.lookahead=mt.strstart-Mt,mt.strstart=Mt,Cr(mt,!1),mt.strm.avail_out===0)||mt.strstart-mt.block_start>=mt.w_size-Jt&&(Cr(mt,!1),mt.strm.avail_out===0))return gr}return mt.insert=0,er===b?(Cr(mt,!0),mt.strm.avail_out===0?Vr:Ur):(mt.strstart>mt.block_start&&(Cr(mt,!1),mt.strm.avail_out),gr)}function jr(mt,er){for(var sr,Mt;;){if(mt.lookahead<Jt){if(Nr(mt),mt.lookahead<Jt&&er===h)return gr;if(mt.lookahead===0)break}if(sr=0,mt.lookahead>=_e&&(mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+_e-1])&mt.hash_mask,sr=mt.prev[mt.strstart&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=mt.strstart),sr!==0&&mt.strstart-sr<=mt.w_size-Jt&&(mt.match_length=qr(mt,sr)),mt.match_length>=_e)if(Mt=i._tr_tally(mt,mt.strstart-mt.match_start,mt.match_length-_e),mt.lookahead-=mt.match_length,mt.match_length<=mt.max_lazy_match&&mt.lookahead>=_e){mt.match_length--;do mt.strstart++,mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+_e-1])&mt.hash_mask,sr=mt.prev[mt.strstart&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=mt.strstart;while(--mt.match_length!==0);mt.strstart++}else mt.strstart+=mt.match_length,mt.match_length=0,mt.ins_h=mt.window[mt.strstart],mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+1])&mt.hash_mask;else Mt=i._tr_tally(mt,0,mt.window[mt.strstart]),mt.lookahead--,mt.strstart++;if(Mt&&(Cr(mt,!1),mt.strm.avail_out===0))return gr}return mt.insert=mt.strstart<_e-1?mt.strstart:_e-1,er===b?(Cr(mt,!0),mt.strm.avail_out===0?Vr:Ur):mt.last_lit&&(Cr(mt,!1),mt.strm.avail_out===0)?gr:ir}function Ar(mt,er){for(var sr,Mt,Ut;;){if(mt.lookahead<Jt){if(Nr(mt),mt.lookahead<Jt&&er===h)return gr;if(mt.lookahead===0)break}if(sr=0,mt.lookahead>=_e&&(mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+_e-1])&mt.hash_mask,sr=mt.prev[mt.strstart&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=mt.strstart),mt.prev_length=mt.match_length,mt.prev_match=mt.match_start,mt.match_length=_e-1,sr!==0&&mt.prev_length<mt.max_lazy_match&&mt.strstart-sr<=mt.w_size-Jt&&(mt.match_length=qr(mt,sr),mt.match_length<=5&&(mt.strategy===ft||mt.match_length===_e&&mt.strstart-mt.match_start>4096)&&(mt.match_length=_e-1)),mt.prev_length>=_e&&mt.match_length<=mt.prev_length){Ut=mt.strstart+mt.lookahead-_e,Mt=i._tr_tally(mt,mt.strstart-1-mt.prev_match,mt.prev_length-_e),mt.lookahead-=mt.prev_length-1,mt.prev_length-=2;do++mt.strstart<=Ut&&(mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+_e-1])&mt.hash_mask,sr=mt.prev[mt.strstart&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=mt.strstart);while(--mt.prev_length!==0);if(mt.match_available=0,mt.match_length=_e-1,mt.strstart++,Mt&&(Cr(mt,!1),mt.strm.avail_out===0))return gr}else if(mt.match_available){if(Mt=i._tr_tally(mt,0,mt.window[mt.strstart-1]),Mt&&Cr(mt,!1),mt.strstart++,mt.lookahead--,mt.strm.avail_out===0)return gr}else mt.match_available=1,mt.strstart++,mt.lookahead--}return mt.match_available&&(Mt=i._tr_tally(mt,0,mt.window[mt.strstart-1]),mt.match_available=0),mt.insert=mt.strstart<_e-1?mt.strstart:_e-1,er===b?(Cr(mt,!0),mt.strm.avail_out===0?Vr:Ur):mt.last_lit&&(Cr(mt,!1),mt.strm.avail_out===0)?gr:ir}function $r(mt,er){for(var sr,Mt,Ut,tr,zr=mt.window;;){if(mt.lookahead<=Gt){if(Nr(mt),mt.lookahead<=Gt&&er===h)return gr;if(mt.lookahead===0)break}if(mt.match_length=0,mt.lookahead>=_e&&mt.strstart>0&&(Ut=mt.strstart-1,Mt=zr[Ut],Mt===zr[++Ut]&&Mt===zr[++Ut]&&Mt===zr[++Ut])){tr=mt.strstart+Gt;do;while(Mt===zr[++Ut]&&Mt===zr[++Ut]&&Mt===zr[++Ut]&&Mt===zr[++Ut]&&Mt===zr[++Ut]&&Mt===zr[++Ut]&&Mt===zr[++Ut]&&Mt===zr[++Ut]&&Ut<tr);mt.match_length=Gt-(tr-Ut),mt.match_length>mt.lookahead&&(mt.match_length=mt.lookahead)}if(mt.match_length>=_e?(sr=i._tr_tally(mt,1,mt.match_length-_e),mt.lookahead-=mt.match_length,mt.strstart+=mt.match_length,mt.match_length=0):(sr=i._tr_tally(mt,0,mt.window[mt.strstart]),mt.lookahead--,mt.strstart++),sr&&(Cr(mt,!1),mt.strm.avail_out===0))return gr}return mt.insert=0,er===b?(Cr(mt,!0),mt.strm.avail_out===0?Vr:Ur):mt.last_lit&&(Cr(mt,!1),mt.strm.avail_out===0)?gr:ir}function Tr(mt,er){for(var sr;;){if(mt.lookahead===0&&(Nr(mt),mt.lookahead===0)){if(er===h)return gr;break}if(mt.match_length=0,sr=i._tr_tally(mt,0,mt.window[mt.strstart]),mt.lookahead--,mt.strstart++,sr&&(Cr(mt,!1),mt.strm.avail_out===0))return gr}return mt.insert=0,er===b?(Cr(mt,!0),mt.strm.avail_out===0?Vr:Ur):mt.last_lit&&(Cr(mt,!1),mt.strm.avail_out===0)?gr:ir}function Gr(mt,er,sr,Mt,Ut){this.good_length=mt,this.max_lazy=er,this.nice_length=sr,this.max_chain=Mt,this.func=Ut}var xr;xr=[new Gr(0,0,0,0,_r),new Gr(4,4,8,4,jr),new Gr(4,5,16,8,jr),new Gr(4,6,32,32,jr),new Gr(4,4,16,16,Ar),new Gr(8,16,32,32,Ar),new Gr(8,16,128,128,Ar),new Gr(8,32,128,256,Ar),new Gr(32,128,258,1024,Ar),new Gr(32,258,258,4096,Ar)];function Br(mt){mt.window_size=2*mt.w_size,Qr(mt.head),mt.max_lazy_match=xr[mt.level].max_lazy,mt.good_match=xr[mt.level].good_length,mt.nice_match=xr[mt.level].nice_length,mt.max_chain_length=xr[mt.level].max_chain,mt.strstart=0,mt.block_start=0,mt.lookahead=0,mt.insert=0,mt.match_length=mt.prev_length=_e-1,mt.match_available=0,mt.ins_h=0}function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_t,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(zt*2),this.dyn_dtree=new e.Buf16((2*Ft+1)*2),this.bl_tree=new e.Buf16((2*qt+1)*2),Qr(this.dyn_ltree),Qr(this.dyn_dtree),Qr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(Qt+1),this.heap=new e.Buf16(2*Ht+1),Qr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*Ht+1),Qr(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ur(mt){var er;return!mt||!mt.state?Sr(mt,nt):(mt.total_in=mt.total_out=0,mt.data_type=wt,er=mt.state,er.pending=0,er.pending_out=0,er.wrap<0&&(er.wrap=-er.wrap),er.status=er.wrap?mr:fr,mt.adler=er.wrap===2?0:1,er.last_flush=h,i._tr_init(er),$)}function cr(mt){var er=ur(mt);return er===$&&Br(mt.state),er}function yr(mt,er){return!mt||!mt.state||mt.state.wrap!==2?nt:(mt.state.gzhead=er,$)}function jt(mt,er,sr,Mt,Ut,tr){if(!mt)return nt;var zr=1;if(er===ut&&(er=6),Mt<0?(zr=0,Mt=-Mt):Mt>15&&(zr=2,Mt-=16),Ut<1||Ut>gt||sr!==_t||Mt<8||Mt>15||er<0||er>9||tr<0||tr>st)return Sr(mt,nt);Mt===8&&(Mt=9);var lt=new At;return mt.state=lt,lt.strm=mt,lt.wrap=zr,lt.gzhead=null,lt.w_bits=Mt,lt.w_size=1<<lt.w_bits,lt.w_mask=lt.w_size-1,lt.hash_bits=Ut+7,lt.hash_size=1<<lt.hash_bits,lt.hash_mask=lt.hash_size-1,lt.hash_shift=~~((lt.hash_bits+_e-1)/_e),lt.window=new e.Buf8(lt.w_size*2),lt.head=new e.Buf16(lt.hash_size),lt.prev=new e.Buf16(lt.w_size),lt.lit_bufsize=1<<Ut+6,lt.pending_buf_size=lt.lit_bufsize*4,lt.pending_buf=new e.Buf8(lt.pending_buf_size),lt.d_buf=1*lt.lit_bufsize,lt.l_buf=3*lt.lit_bufsize,lt.level=er,lt.strategy=tr,lt.method=sr,cr(mt)}function lr(mt,er){return jt(mt,er,_t,yt,bt,ct)}function xt(mt,er){var sr,Mt,Ut,tr;if(!mt||!mt.state||er>_||er<0)return mt?Sr(mt,nt):nt;if(Mt=mt.state,!mt.output||!mt.input&&mt.avail_in!==0||Mt.status===Rr&&er!==b)return Sr(mt,mt.avail_out===0?at:nt);if(Mt.strm=mt,sr=Mt.last_flush,Mt.last_flush=er,Mt.status===mr)if(Mt.wrap===2)mt.adler=0,Hr(Mt,31),Hr(Mt,139),Hr(Mt,8),Mt.gzhead?(Hr(Mt,(Mt.gzhead.text?1:0)+(Mt.gzhead.hcrc?2:0)+(Mt.gzhead.extra?4:0)+(Mt.gzhead.name?8:0)+(Mt.gzhead.comment?16:0)),Hr(Mt,Mt.gzhead.time&255),Hr(Mt,Mt.gzhead.time>>8&255),Hr(Mt,Mt.gzhead.time>>16&255),Hr(Mt,Mt.gzhead.time>>24&255),Hr(Mt,Mt.level===9?2:Mt.strategy>=ht||Mt.level<2?4:0),Hr(Mt,Mt.gzhead.os&255),Mt.gzhead.extra&&Mt.gzhead.extra.length&&(Hr(Mt,Mt.gzhead.extra.length&255),Hr(Mt,Mt.gzhead.extra.length>>8&255)),Mt.gzhead.hcrc&&(mt.adler=s(mt.adler,Mt.pending_buf,Mt.pending,0)),Mt.gzindex=0,Mt.status=hr):(Hr(Mt,0),Hr(Mt,0),Hr(Mt,0),Hr(Mt,0),Hr(Mt,0),Hr(Mt,Mt.level===9?2:Mt.strategy>=ht||Mt.level<2?4:0),Hr(Mt,Fr),Mt.status=fr);else{var zr=_t+(Mt.w_bits-8<<4)<<8,lt=-1;Mt.strategy>=ht||Mt.level<2?lt=0:Mt.level<6?lt=1:Mt.level===6?lt=2:lt=3,zr|=lt<<6,Mt.strstart!==0&&(zr|=or),zr+=31-zr%31,Mt.status=fr,nr(Mt,zr),Mt.strstart!==0&&(nr(Mt,mt.adler>>>16),nr(Mt,mt.adler&65535)),mt.adler=1}if(Mt.status===hr)if(Mt.gzhead.extra){for(Ut=Mt.pending;Mt.gzindex<(Mt.gzhead.extra.length&65535)&&!(Mt.pending===Mt.pending_buf_size&&(Mt.gzhead.hcrc&&Mt.pending>Ut&&(mt.adler=s(mt.adler,Mt.pending_buf,Mt.pending-Ut,Ut)),Or(mt),Ut=Mt.pending,Mt.pending===Mt.pending_buf_size));)Hr(Mt,Mt.gzhead.extra[Mt.gzindex]&255),Mt.gzindex++;Mt.gzhead.hcrc&&Mt.pending>Ut&&(mt.adler=s(mt.adler,Mt.pending_buf,Mt.pending-Ut,Ut)),Mt.gzindex===Mt.gzhead.extra.length&&(Mt.gzindex=0,Mt.status=Lr)}else Mt.status=Lr;if(Mt.status===Lr)if(Mt.gzhead.name){Ut=Mt.pending;do{if(Mt.pending===Mt.pending_buf_size&&(Mt.gzhead.hcrc&&Mt.pending>Ut&&(mt.adler=s(mt.adler,Mt.pending_buf,Mt.pending-Ut,Ut)),Or(mt),Ut=Mt.pending,Mt.pending===Mt.pending_buf_size)){tr=1;break}Mt.gzindex<Mt.gzhead.name.length?tr=Mt.gzhead.name.charCodeAt(Mt.gzindex++)&255:tr=0,Hr(Mt,tr)}while(tr!==0);Mt.gzhead.hcrc&&Mt.pending>Ut&&(mt.adler=s(mt.adler,Mt.pending_buf,Mt.pending-Ut,Ut)),tr===0&&(Mt.gzindex=0,Mt.status=Er)}else Mt.status=Er;if(Mt.status===Er)if(Mt.gzhead.comment){Ut=Mt.pending;do{if(Mt.pending===Mt.pending_buf_size&&(Mt.gzhead.hcrc&&Mt.pending>Ut&&(mt.adler=s(mt.adler,Mt.pending_buf,Mt.pending-Ut,Ut)),Or(mt),Ut=Mt.pending,Mt.pending===Mt.pending_buf_size)){tr=1;break}Mt.gzindex<Mt.gzhead.comment.length?tr=Mt.gzhead.comment.charCodeAt(Mt.gzindex++)&255:tr=0,Hr(Mt,tr)}while(tr!==0);Mt.gzhead.hcrc&&Mt.pending>Ut&&(mt.adler=s(mt.adler,Mt.pending_buf,Mt.pending-Ut,Ut)),tr===0&&(Mt.status=Kt)}else Mt.status=Kt;if(Mt.status===Kt&&(Mt.gzhead.hcrc?(Mt.pending+2>Mt.pending_buf_size&&Or(mt),Mt.pending+2<=Mt.pending_buf_size&&(Hr(Mt,mt.adler&255),Hr(Mt,mt.adler>>8&255),mt.adler=0,Mt.status=fr)):Mt.status=fr),Mt.pending!==0){if(Or(mt),mt.avail_out===0)return Mt.last_flush=-1,$}else if(mt.avail_in===0&&vr(er)<=vr(sr)&&er!==b)return Sr(mt,at);if(Mt.status===Rr&&mt.avail_in!==0)return Sr(mt,at);if(mt.avail_in!==0||Mt.lookahead!==0||er!==h&&Mt.status!==Rr){var et=Mt.strategy===ht?Tr(Mt,er):Mt.strategy===dt?$r(Mt,er):xr[Mt.level].func(Mt,er);if((et===Vr||et===Ur)&&(Mt.status=Rr),et===gr||et===Vr)return mt.avail_out===0&&(Mt.last_flush=-1),$;if(et===ir&&(er===d?i._tr_align(Mt):er!==_&&(i._tr_stored_block(Mt,0,0,!1),er===g&&(Qr(Mt.head),Mt.lookahead===0&&(Mt.strstart=0,Mt.block_start=0,Mt.insert=0))),Or(mt),mt.avail_out===0))return Mt.last_flush=-1,$}return er!==b?$:Mt.wrap<=0?it:(Mt.wrap===2?(Hr(Mt,mt.adler&255),Hr(Mt,mt.adler>>8&255),Hr(Mt,mt.adler>>16&255),Hr(Mt,mt.adler>>24&255),Hr(Mt,mt.total_in&255),Hr(Mt,mt.total_in>>8&255),Hr(Mt,mt.total_in>>16&255),Hr(Mt,mt.total_in>>24&255)):(nr(Mt,mt.adler>>>16),nr(Mt,mt.adler&65535)),Or(mt),Mt.wrap>0&&(Mt.wrap=-Mt.wrap),Mt.pending!==0?$:it)}function pr(mt){var er;return!mt||!mt.state?nt:(er=mt.state.status,er!==mr&&er!==hr&&er!==Lr&&er!==Er&&er!==Kt&&er!==fr&&er!==Rr?Sr(mt,nt):(mt.state=null,er===fr?Sr(mt,tt):$))}function Yr(mt,er){var sr=er.length,Mt,Ut,tr,zr,lt,et,j,rt;if(!mt||!mt.state||(Mt=mt.state,zr=Mt.wrap,zr===2||zr===1&&Mt.status!==mr||Mt.lookahead))return nt;for(zr===1&&(mt.adler=a(mt.adler,er,sr,0)),Mt.wrap=0,sr>=Mt.w_size&&(zr===0&&(Qr(Mt.head),Mt.strstart=0,Mt.block_start=0,Mt.insert=0),rt=new e.Buf8(Mt.w_size),e.arraySet(rt,er,sr-Mt.w_size,Mt.w_size,0),er=rt,sr=Mt.w_size),lt=mt.avail_in,et=mt.next_in,j=mt.input,mt.avail_in=sr,mt.next_in=0,mt.input=er,Nr(Mt);Mt.lookahead>=_e;){Ut=Mt.strstart,tr=Mt.lookahead-(_e-1);do Mt.ins_h=(Mt.ins_h<<Mt.hash_shift^Mt.window[Ut+_e-1])&Mt.hash_mask,Mt.prev[Ut&Mt.w_mask]=Mt.head[Mt.ins_h],Mt.head[Mt.ins_h]=Ut,Ut++;while(--tr);Mt.strstart=Ut,Mt.lookahead=_e-1,Nr(Mt)}return Mt.strstart+=Mt.lookahead,Mt.block_start=Mt.strstart,Mt.insert=Mt.lookahead,Mt.lookahead=0,Mt.match_length=Mt.prev_length=_e-1,Mt.match_available=0,mt.next_in=et,mt.input=j,mt.avail_in=lt,Mt.wrap=zr,$}return deflate.deflateInit=lr,deflate.deflateInit2=jt,deflate.deflateReset=cr,deflate.deflateResetKeep=ur,deflate.deflateSetHeader=yr,deflate.deflate=xt,deflate.deflateEnd=pr,deflate.deflateSetDictionary=Yr,deflate.deflateInfo="pako deflate (from Nodeca project)",deflate}var strings={},hasRequiredStrings;function requireStrings(){if(hasRequiredStrings)return strings;hasRequiredStrings=1;var e=requireCommon(),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var s=new e.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;s[254]=s[254]=1,strings.string2buf=function(d){var g,b,_,$,it,nt=d.length,tt=0;for($=0;$<nt;$++)b=d.charCodeAt($),(b&64512)===55296&&$+1<nt&&(_=d.charCodeAt($+1),(_&64512)===56320&&(b=65536+(b-55296<<10)+(_-56320),$++)),tt+=b<128?1:b<2048?2:b<65536?3:4;for(g=new e.Buf8(tt),it=0,$=0;it<tt;$++)b=d.charCodeAt($),(b&64512)===55296&&$+1<nt&&(_=d.charCodeAt($+1),(_&64512)===56320&&(b=65536+(b-55296<<10)+(_-56320),$++)),b<128?g[it++]=b:b<2048?(g[it++]=192|b>>>6,g[it++]=128|b&63):b<65536?(g[it++]=224|b>>>12,g[it++]=128|b>>>6&63,g[it++]=128|b&63):(g[it++]=240|b>>>18,g[it++]=128|b>>>12&63,g[it++]=128|b>>>6&63,g[it++]=128|b&63);return g};function h(d,g){if(g<65534&&(d.subarray&&a||!d.subarray&&i))return String.fromCharCode.apply(null,e.shrinkBuf(d,g));for(var b="",_=0;_<g;_++)b+=String.fromCharCode(d[_]);return b}return strings.buf2binstring=function(d){return h(d,d.length)},strings.binstring2buf=function(d){for(var g=new e.Buf8(d.length),b=0,_=g.length;b<_;b++)g[b]=d.charCodeAt(b);return g},strings.buf2string=function(d,g){var b,_,$,it,nt=g||d.length,tt=new Array(nt*2);for(_=0,b=0;b<nt;){if($=d[b++],$<128){tt[_++]=$;continue}if(it=s[$],it>4){tt[_++]=65533,b+=it-1;continue}for($&=it===2?31:it===3?15:7;it>1&&b<nt;)$=$<<6|d[b++]&63,it--;if(it>1){tt[_++]=65533;continue}$<65536?tt[_++]=$:($-=65536,tt[_++]=55296|$>>10&1023,tt[_++]=56320|$&1023)}return h(tt,_)},strings.utf8border=function(d,g){var b;for(g=g||d.length,g>d.length&&(g=d.length),b=g-1;b>=0&&(d[b]&192)===128;)b--;return b<0||b===0?g:b+s[d[b]]>g?b:g},strings}var zstream,hasRequiredZstream;function requireZstream(){if(hasRequiredZstream)return zstream;hasRequiredZstream=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return zstream=e,zstream}var hasRequiredDeflate;function requireDeflate(){if(hasRequiredDeflate)return deflate$1;hasRequiredDeflate=1;var e=requireDeflate$1(),i=requireCommon(),a=requireStrings(),s=requireMessages(),o=requireZstream(),h=Object.prototype.toString,d=0,g=4,b=0,_=1,$=2,it=-1,nt=0,tt=8;function at(dt){if(!(this instanceof at))return new at(dt);this.options=i.assign({level:it,method:tt,chunkSize:16384,windowBits:15,memLevel:8,strategy:nt,to:""},dt||{});var st=this.options;st.raw&&st.windowBits>0?st.windowBits=-st.windowBits:st.gzip&&st.windowBits>0&&st.windowBits<16&&(st.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var ct=e.deflateInit2(this.strm,st.level,st.method,st.windowBits,st.memLevel,st.strategy);if(ct!==b)throw new Error(s[ct]);if(st.header&&e.deflateSetHeader(this.strm,st.header),st.dictionary){var wt;if(typeof st.dictionary=="string"?wt=a.string2buf(st.dictionary):h.call(st.dictionary)==="[object ArrayBuffer]"?wt=new Uint8Array(st.dictionary):wt=st.dictionary,ct=e.deflateSetDictionary(this.strm,wt),ct!==b)throw new Error(s[ct]);this._dict_set=!0}}at.prototype.push=function(dt,st){var ct=this.strm,wt=this.options.chunkSize,_t,gt;if(this.ended)return!1;gt=st===~~st?st:st===!0?g:d,typeof dt=="string"?ct.input=a.string2buf(dt):h.call(dt)==="[object ArrayBuffer]"?ct.input=new Uint8Array(dt):ct.input=dt,ct.next_in=0,ct.avail_in=ct.input.length;do{if(ct.avail_out===0&&(ct.output=new i.Buf8(wt),ct.next_out=0,ct.avail_out=wt),_t=e.deflate(ct,gt),_t!==_&&_t!==b)return this.onEnd(_t),this.ended=!0,!1;(ct.avail_out===0||ct.avail_in===0&&(gt===g||gt===$))&&(this.options.to==="string"?this.onData(a.buf2binstring(i.shrinkBuf(ct.output,ct.next_out))):this.onData(i.shrinkBuf(ct.output,ct.next_out)))}while((ct.avail_in>0||ct.avail_out===0)&&_t!==_);return gt===g?(_t=e.deflateEnd(this.strm),this.onEnd(_t),this.ended=!0,_t===b):(gt===$&&(this.onEnd(b),ct.avail_out=0),!0)},at.prototype.onData=function(dt){this.chunks.push(dt)},at.prototype.onEnd=function(dt){dt===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=dt,this.msg=this.strm.msg};function ut(dt,st){var ct=new at(st);if(ct.push(dt,!0),ct.err)throw ct.msg||s[ct.err];return ct.result}function ft(dt,st){return st=st||{},st.raw=!0,ut(dt,st)}function ht(dt,st){return st=st||{},st.gzip=!0,ut(dt,st)}return deflate$1.Deflate=at,deflate$1.deflate=ut,deflate$1.deflateRaw=ft,deflate$1.gzip=ht,deflate$1}var inflate$1={},inflate={},inffast,hasRequiredInffast;function requireInffast(){if(hasRequiredInffast)return inffast;hasRequiredInffast=1;var e=30,i=12;return inffast=function(a,s){var o,h,d,g,b,_,$,it,nt,tt,at,ut,ft,ht,dt,st,ct,wt,_t,gt,yt,bt,vt,Ct,Ht;o=a.state,h=a.next_in,Ct=a.input,d=h+(a.avail_in-5),g=a.next_out,Ht=a.output,b=g-(s-a.avail_out),_=g+(a.avail_out-257),$=o.dmax,it=o.wsize,nt=o.whave,tt=o.wnext,at=o.window,ut=o.hold,ft=o.bits,ht=o.lencode,dt=o.distcode,st=(1<<o.lenbits)-1,ct=(1<<o.distbits)-1;t:do{ft<15&&(ut+=Ct[h++]<<ft,ft+=8,ut+=Ct[h++]<<ft,ft+=8),wt=ht[ut&st];e:for(;;){if(_t=wt>>>24,ut>>>=_t,ft-=_t,_t=wt>>>16&255,_t===0)Ht[g++]=wt&65535;else if(_t&16){gt=wt&65535,_t&=15,_t&&(ft<_t&&(ut+=Ct[h++]<<ft,ft+=8),gt+=ut&(1<<_t)-1,ut>>>=_t,ft-=_t),ft<15&&(ut+=Ct[h++]<<ft,ft+=8,ut+=Ct[h++]<<ft,ft+=8),wt=dt[ut&ct];r:for(;;){if(_t=wt>>>24,ut>>>=_t,ft-=_t,_t=wt>>>16&255,_t&16){if(yt=wt&65535,_t&=15,ft<_t&&(ut+=Ct[h++]<<ft,ft+=8,ft<_t&&(ut+=Ct[h++]<<ft,ft+=8)),yt+=ut&(1<<_t)-1,yt>$){a.msg="invalid distance too far back",o.mode=e;break t}if(ut>>>=_t,ft-=_t,_t=g-b,yt>_t){if(_t=yt-_t,_t>nt&&o.sane){a.msg="invalid distance too far back",o.mode=e;break t}if(bt=0,vt=at,tt===0){if(bt+=it-_t,_t<gt){gt-=_t;do Ht[g++]=at[bt++];while(--_t);bt=g-yt,vt=Ht}}else if(tt<_t){if(bt+=it+tt-_t,_t-=tt,_t<gt){gt-=_t;do Ht[g++]=at[bt++];while(--_t);if(bt=0,tt<gt){_t=tt,gt-=_t;do Ht[g++]=at[bt++];while(--_t);bt=g-yt,vt=Ht}}}else if(bt+=tt-_t,_t<gt){gt-=_t;do Ht[g++]=at[bt++];while(--_t);bt=g-yt,vt=Ht}for(;gt>2;)Ht[g++]=vt[bt++],Ht[g++]=vt[bt++],Ht[g++]=vt[bt++],gt-=3;gt&&(Ht[g++]=vt[bt++],gt>1&&(Ht[g++]=vt[bt++]))}else{bt=g-yt;do Ht[g++]=Ht[bt++],Ht[g++]=Ht[bt++],Ht[g++]=Ht[bt++],gt-=3;while(gt>2);gt&&(Ht[g++]=Ht[bt++],gt>1&&(Ht[g++]=Ht[bt++]))}}else if(_t&64){a.msg="invalid distance code",o.mode=e;break t}else{wt=dt[(wt&65535)+(ut&(1<<_t)-1)];continue r}break}}else if(_t&64)if(_t&32){o.mode=i;break t}else{a.msg="invalid literal/length code",o.mode=e;break t}else{wt=ht[(wt&65535)+(ut&(1<<_t)-1)];continue e}break}}while(h<d&&g<_);gt=ft>>3,h-=gt,ft-=gt<<3,ut&=(1<<ft)-1,a.next_in=h,a.next_out=g,a.avail_in=h<d?5+(d-h):5-(h-d),a.avail_out=g<_?257+(_-g):257-(g-_),o.hold=ut,o.bits=ft},inffast}var inftrees,hasRequiredInftrees;function requireInftrees(){if(hasRequiredInftrees)return inftrees;hasRequiredInftrees=1;var e=requireCommon(),i=15,a=852,s=592,o=0,h=1,d=2,g=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],b=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],_=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],$=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return inftrees=function(it,nt,tt,at,ut,ft,ht,dt){var st=dt.bits,ct=0,wt=0,_t=0,gt=0,yt=0,bt=0,vt=0,Ct=0,Ht=0,Ft=0,qt,zt,Qt,_e,Gt,Jt=null,or=0,mr,hr=new e.Buf16(i+1),Lr=new e.Buf16(i+1),Er=null,Kt=0,fr,Rr,gr;for(ct=0;ct<=i;ct++)hr[ct]=0;for(wt=0;wt<at;wt++)hr[nt[tt+wt]]++;for(yt=st,gt=i;gt>=1&&hr[gt]===0;gt--);if(yt>gt&&(yt=gt),gt===0)return ut[ft++]=1<<24|64<<16|0,ut[ft++]=1<<24|64<<16|0,dt.bits=1,0;for(_t=1;_t<gt&&hr[_t]===0;_t++);for(yt<_t&&(yt=_t),Ct=1,ct=1;ct<=i;ct++)if(Ct<<=1,Ct-=hr[ct],Ct<0)return-1;if(Ct>0&&(it===o||gt!==1))return-1;for(Lr[1]=0,ct=1;ct<i;ct++)Lr[ct+1]=Lr[ct]+hr[ct];for(wt=0;wt<at;wt++)nt[tt+wt]!==0&&(ht[Lr[nt[tt+wt]]++]=wt);if(it===o?(Jt=Er=ht,mr=19):it===h?(Jt=g,or-=257,Er=b,Kt-=257,mr=256):(Jt=_,Er=$,mr=-1),Ft=0,wt=0,ct=_t,Gt=ft,bt=yt,vt=0,Qt=-1,Ht=1<<yt,_e=Ht-1,it===h&&Ht>a||it===d&&Ht>s)return 1;for(;;){fr=ct-vt,ht[wt]<mr?(Rr=0,gr=ht[wt]):ht[wt]>mr?(Rr=Er[Kt+ht[wt]],gr=Jt[or+ht[wt]]):(Rr=96,gr=0),qt=1<<ct-vt,zt=1<<bt,_t=zt;do zt-=qt,ut[Gt+(Ft>>vt)+zt]=fr<<24|Rr<<16|gr|0;while(zt!==0);for(qt=1<<ct-1;Ft&qt;)qt>>=1;if(qt!==0?(Ft&=qt-1,Ft+=qt):Ft=0,wt++,--hr[ct]===0){if(ct===gt)break;ct=nt[tt+ht[wt]]}if(ct>yt&&(Ft&_e)!==Qt){for(vt===0&&(vt=yt),Gt+=_t,bt=ct-vt,Ct=1<<bt;bt+vt<gt&&(Ct-=hr[bt+vt],!(Ct<=0));)bt++,Ct<<=1;if(Ht+=1<<bt,it===h&&Ht>a||it===d&&Ht>s)return 1;Qt=Ft&_e,ut[Qt]=yt<<24|bt<<16|Gt-ft|0}}return Ft!==0&&(ut[Gt+Ft]=ct-vt<<24|64<<16|0),dt.bits=yt,0},inftrees}var hasRequiredInflate$1;function requireInflate$1(){if(hasRequiredInflate$1)return inflate;hasRequiredInflate$1=1;var e=requireCommon(),i=requireAdler32(),a=requireCrc32(),s=requireInffast(),o=requireInftrees(),h=0,d=1,g=2,b=4,_=5,$=6,it=0,nt=1,tt=2,at=-2,ut=-3,ft=-4,ht=-5,dt=8,st=1,ct=2,wt=3,_t=4,gt=5,yt=6,bt=7,vt=8,Ct=9,Ht=10,Ft=11,qt=12,zt=13,Qt=14,_e=15,Gt=16,Jt=17,or=18,mr=19,hr=20,Lr=21,Er=22,Kt=23,fr=24,Rr=25,gr=26,ir=27,Vr=28,Ur=29,Fr=30,Sr=31,vr=32,Qr=852,Or=592,Cr=15,Hr=Cr;function nr(jt){return(jt>>>24&255)+(jt>>>8&65280)+((jt&65280)<<8)+((jt&255)<<24)}function Dr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function qr(jt){var lr;return!jt||!jt.state?at:(lr=jt.state,jt.total_in=jt.total_out=lr.total=0,jt.msg="",lr.wrap&&(jt.adler=lr.wrap&1),lr.mode=st,lr.last=0,lr.havedict=0,lr.dmax=32768,lr.head=null,lr.hold=0,lr.bits=0,lr.lencode=lr.lendyn=new e.Buf32(Qr),lr.distcode=lr.distdyn=new e.Buf32(Or),lr.sane=1,lr.back=-1,it)}function Nr(jt){var lr;return!jt||!jt.state?at:(lr=jt.state,lr.wsize=0,lr.whave=0,lr.wnext=0,qr(jt))}function _r(jt,lr){var xt,pr;return!jt||!jt.state||(pr=jt.state,lr<0?(xt=0,lr=-lr):(xt=(lr>>4)+1,lr<48&&(lr&=15)),lr&&(lr<8||lr>15))?at:(pr.window!==null&&pr.wbits!==lr&&(pr.window=null),pr.wrap=xt,pr.wbits=lr,Nr(jt))}function jr(jt,lr){var xt,pr;return jt?(pr=new Dr,jt.state=pr,pr.window=null,xt=_r(jt,lr),xt!==it&&(jt.state=null),xt):at}function Ar(jt){return jr(jt,Hr)}var $r=!0,Tr,Gr;function xr(jt){if($r){var lr;for(Tr=new e.Buf32(512),Gr=new e.Buf32(32),lr=0;lr<144;)jt.lens[lr++]=8;for(;lr<256;)jt.lens[lr++]=9;for(;lr<280;)jt.lens[lr++]=7;for(;lr<288;)jt.lens[lr++]=8;for(o(d,jt.lens,0,288,Tr,0,jt.work,{bits:9}),lr=0;lr<32;)jt.lens[lr++]=5;o(g,jt.lens,0,32,Gr,0,jt.work,{bits:5}),$r=!1}jt.lencode=Tr,jt.lenbits=9,jt.distcode=Gr,jt.distbits=5}function Br(jt,lr,xt,pr){var Yr,mt=jt.state;return mt.window===null&&(mt.wsize=1<<mt.wbits,mt.wnext=0,mt.whave=0,mt.window=new e.Buf8(mt.wsize)),pr>=mt.wsize?(e.arraySet(mt.window,lr,xt-mt.wsize,mt.wsize,0),mt.wnext=0,mt.whave=mt.wsize):(Yr=mt.wsize-mt.wnext,Yr>pr&&(Yr=pr),e.arraySet(mt.window,lr,xt-pr,Yr,mt.wnext),pr-=Yr,pr?(e.arraySet(mt.window,lr,xt-pr,pr,0),mt.wnext=pr,mt.whave=mt.wsize):(mt.wnext+=Yr,mt.wnext===mt.wsize&&(mt.wnext=0),mt.whave<mt.wsize&&(mt.whave+=Yr))),0}function At(jt,lr){var xt,pr,Yr,mt,er,sr,Mt,Ut,tr,zr,lt,et,j,rt,ot=0,pt,kt,Et,Pt,Nt,Xt,Lt,rr,dr=new e.Buf8(4),Wt,ar,Mr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!jt||!jt.state||!jt.output||!jt.input&&jt.avail_in!==0)return at;xt=jt.state,xt.mode===qt&&(xt.mode=zt),er=jt.next_out,Yr=jt.output,Mt=jt.avail_out,mt=jt.next_in,pr=jt.input,sr=jt.avail_in,Ut=xt.hold,tr=xt.bits,zr=sr,lt=Mt,rr=it;t:for(;;)switch(xt.mode){case st:if(xt.wrap===0){xt.mode=zt;break}for(;tr<16;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(xt.wrap&2&&Ut===35615){xt.check=0,dr[0]=Ut&255,dr[1]=Ut>>>8&255,xt.check=a(xt.check,dr,2,0),Ut=0,tr=0,xt.mode=ct;break}if(xt.flags=0,xt.head&&(xt.head.done=!1),!(xt.wrap&1)||(((Ut&255)<<8)+(Ut>>8))%31){jt.msg="incorrect header check",xt.mode=Fr;break}if((Ut&15)!==dt){jt.msg="unknown compression method",xt.mode=Fr;break}if(Ut>>>=4,tr-=4,Lt=(Ut&15)+8,xt.wbits===0)xt.wbits=Lt;else if(Lt>xt.wbits){jt.msg="invalid window size",xt.mode=Fr;break}xt.dmax=1<<Lt,jt.adler=xt.check=1,xt.mode=Ut&512?Ht:qt,Ut=0,tr=0;break;case ct:for(;tr<16;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(xt.flags=Ut,(xt.flags&255)!==dt){jt.msg="unknown compression method",xt.mode=Fr;break}if(xt.flags&57344){jt.msg="unknown header flags set",xt.mode=Fr;break}xt.head&&(xt.head.text=Ut>>8&1),xt.flags&512&&(dr[0]=Ut&255,dr[1]=Ut>>>8&255,xt.check=a(xt.check,dr,2,0)),Ut=0,tr=0,xt.mode=wt;case wt:for(;tr<32;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}xt.head&&(xt.head.time=Ut),xt.flags&512&&(dr[0]=Ut&255,dr[1]=Ut>>>8&255,dr[2]=Ut>>>16&255,dr[3]=Ut>>>24&255,xt.check=a(xt.check,dr,4,0)),Ut=0,tr=0,xt.mode=_t;case _t:for(;tr<16;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}xt.head&&(xt.head.xflags=Ut&255,xt.head.os=Ut>>8),xt.flags&512&&(dr[0]=Ut&255,dr[1]=Ut>>>8&255,xt.check=a(xt.check,dr,2,0)),Ut=0,tr=0,xt.mode=gt;case gt:if(xt.flags&1024){for(;tr<16;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}xt.length=Ut,xt.head&&(xt.head.extra_len=Ut),xt.flags&512&&(dr[0]=Ut&255,dr[1]=Ut>>>8&255,xt.check=a(xt.check,dr,2,0)),Ut=0,tr=0}else xt.head&&(xt.head.extra=null);xt.mode=yt;case yt:if(xt.flags&1024&&(et=xt.length,et>sr&&(et=sr),et&&(xt.head&&(Lt=xt.head.extra_len-xt.length,xt.head.extra||(xt.head.extra=new Array(xt.head.extra_len)),e.arraySet(xt.head.extra,pr,mt,et,Lt)),xt.flags&512&&(xt.check=a(xt.check,pr,et,mt)),sr-=et,mt+=et,xt.length-=et),xt.length))break t;xt.length=0,xt.mode=bt;case bt:if(xt.flags&2048){if(sr===0)break t;et=0;do Lt=pr[mt+et++],xt.head&&Lt&&xt.length<65536&&(xt.head.name+=String.fromCharCode(Lt));while(Lt&&et<sr);if(xt.flags&512&&(xt.check=a(xt.check,pr,et,mt)),sr-=et,mt+=et,Lt)break t}else xt.head&&(xt.head.name=null);xt.length=0,xt.mode=vt;case vt:if(xt.flags&4096){if(sr===0)break t;et=0;do Lt=pr[mt+et++],xt.head&&Lt&&xt.length<65536&&(xt.head.comment+=String.fromCharCode(Lt));while(Lt&&et<sr);if(xt.flags&512&&(xt.check=a(xt.check,pr,et,mt)),sr-=et,mt+=et,Lt)break t}else xt.head&&(xt.head.comment=null);xt.mode=Ct;case Ct:if(xt.flags&512){for(;tr<16;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(Ut!==(xt.check&65535)){jt.msg="header crc mismatch",xt.mode=Fr;break}Ut=0,tr=0}xt.head&&(xt.head.hcrc=xt.flags>>9&1,xt.head.done=!0),jt.adler=xt.check=0,xt.mode=qt;break;case Ht:for(;tr<32;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}jt.adler=xt.check=nr(Ut),Ut=0,tr=0,xt.mode=Ft;case Ft:if(xt.havedict===0)return jt.next_out=er,jt.avail_out=Mt,jt.next_in=mt,jt.avail_in=sr,xt.hold=Ut,xt.bits=tr,tt;jt.adler=xt.check=1,xt.mode=qt;case qt:if(lr===_||lr===$)break t;case zt:if(xt.last){Ut>>>=tr&7,tr-=tr&7,xt.mode=ir;break}for(;tr<3;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}switch(xt.last=Ut&1,Ut>>>=1,tr-=1,Ut&3){case 0:xt.mode=Qt;break;case 1:if(xr(xt),xt.mode=hr,lr===$){Ut>>>=2,tr-=2;break t}break;case 2:xt.mode=Jt;break;case 3:jt.msg="invalid block type",xt.mode=Fr}Ut>>>=2,tr-=2;break;case Qt:for(Ut>>>=tr&7,tr-=tr&7;tr<32;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if((Ut&65535)!==(Ut>>>16^65535)){jt.msg="invalid stored block lengths",xt.mode=Fr;break}if(xt.length=Ut&65535,Ut=0,tr=0,xt.mode=_e,lr===$)break t;case _e:xt.mode=Gt;case Gt:if(et=xt.length,et){if(et>sr&&(et=sr),et>Mt&&(et=Mt),et===0)break t;e.arraySet(Yr,pr,mt,et,er),sr-=et,mt+=et,Mt-=et,er+=et,xt.length-=et;break}xt.mode=qt;break;case Jt:for(;tr<14;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(xt.nlen=(Ut&31)+257,Ut>>>=5,tr-=5,xt.ndist=(Ut&31)+1,Ut>>>=5,tr-=5,xt.ncode=(Ut&15)+4,Ut>>>=4,tr-=4,xt.nlen>286||xt.ndist>30){jt.msg="too many length or distance symbols",xt.mode=Fr;break}xt.have=0,xt.mode=or;case or:for(;xt.have<xt.ncode;){for(;tr<3;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}xt.lens[Mr[xt.have++]]=Ut&7,Ut>>>=3,tr-=3}for(;xt.have<19;)xt.lens[Mr[xt.have++]]=0;if(xt.lencode=xt.lendyn,xt.lenbits=7,Wt={bits:xt.lenbits},rr=o(h,xt.lens,0,19,xt.lencode,0,xt.work,Wt),xt.lenbits=Wt.bits,rr){jt.msg="invalid code lengths set",xt.mode=Fr;break}xt.have=0,xt.mode=mr;case mr:for(;xt.have<xt.nlen+xt.ndist;){for(;ot=xt.lencode[Ut&(1<<xt.lenbits)-1],pt=ot>>>24,kt=ot>>>16&255,Et=ot&65535,!(pt<=tr);){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(Et<16)Ut>>>=pt,tr-=pt,xt.lens[xt.have++]=Et;else{if(Et===16){for(ar=pt+2;tr<ar;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(Ut>>>=pt,tr-=pt,xt.have===0){jt.msg="invalid bit length repeat",xt.mode=Fr;break}Lt=xt.lens[xt.have-1],et=3+(Ut&3),Ut>>>=2,tr-=2}else if(Et===17){for(ar=pt+3;tr<ar;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}Ut>>>=pt,tr-=pt,Lt=0,et=3+(Ut&7),Ut>>>=3,tr-=3}else{for(ar=pt+7;tr<ar;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}Ut>>>=pt,tr-=pt,Lt=0,et=11+(Ut&127),Ut>>>=7,tr-=7}if(xt.have+et>xt.nlen+xt.ndist){jt.msg="invalid bit length repeat",xt.mode=Fr;break}for(;et--;)xt.lens[xt.have++]=Lt}}if(xt.mode===Fr)break;if(xt.lens[256]===0){jt.msg="invalid code -- missing end-of-block",xt.mode=Fr;break}if(xt.lenbits=9,Wt={bits:xt.lenbits},rr=o(d,xt.lens,0,xt.nlen,xt.lencode,0,xt.work,Wt),xt.lenbits=Wt.bits,rr){jt.msg="invalid literal/lengths set",xt.mode=Fr;break}if(xt.distbits=6,xt.distcode=xt.distdyn,Wt={bits:xt.distbits},rr=o(g,xt.lens,xt.nlen,xt.ndist,xt.distcode,0,xt.work,Wt),xt.distbits=Wt.bits,rr){jt.msg="invalid distances set",xt.mode=Fr;break}if(xt.mode=hr,lr===$)break t;case hr:xt.mode=Lr;case Lr:if(sr>=6&&Mt>=258){jt.next_out=er,jt.avail_out=Mt,jt.next_in=mt,jt.avail_in=sr,xt.hold=Ut,xt.bits=tr,s(jt,lt),er=jt.next_out,Yr=jt.output,Mt=jt.avail_out,mt=jt.next_in,pr=jt.input,sr=jt.avail_in,Ut=xt.hold,tr=xt.bits,xt.mode===qt&&(xt.back=-1);break}for(xt.back=0;ot=xt.lencode[Ut&(1<<xt.lenbits)-1],pt=ot>>>24,kt=ot>>>16&255,Et=ot&65535,!(pt<=tr);){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(kt&&!(kt&240)){for(Pt=pt,Nt=kt,Xt=Et;ot=xt.lencode[Xt+((Ut&(1<<Pt+Nt)-1)>>Pt)],pt=ot>>>24,kt=ot>>>16&255,Et=ot&65535,!(Pt+pt<=tr);){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}Ut>>>=Pt,tr-=Pt,xt.back+=Pt}if(Ut>>>=pt,tr-=pt,xt.back+=pt,xt.length=Et,kt===0){xt.mode=gr;break}if(kt&32){xt.back=-1,xt.mode=qt;break}if(kt&64){jt.msg="invalid literal/length code",xt.mode=Fr;break}xt.extra=kt&15,xt.mode=Er;case Er:if(xt.extra){for(ar=xt.extra;tr<ar;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}xt.length+=Ut&(1<<xt.extra)-1,Ut>>>=xt.extra,tr-=xt.extra,xt.back+=xt.extra}xt.was=xt.length,xt.mode=Kt;case Kt:for(;ot=xt.distcode[Ut&(1<<xt.distbits)-1],pt=ot>>>24,kt=ot>>>16&255,Et=ot&65535,!(pt<=tr);){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(!(kt&240)){for(Pt=pt,Nt=kt,Xt=Et;ot=xt.distcode[Xt+((Ut&(1<<Pt+Nt)-1)>>Pt)],pt=ot>>>24,kt=ot>>>16&255,Et=ot&65535,!(Pt+pt<=tr);){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}Ut>>>=Pt,tr-=Pt,xt.back+=Pt}if(Ut>>>=pt,tr-=pt,xt.back+=pt,kt&64){jt.msg="invalid distance code",xt.mode=Fr;break}xt.offset=Et,xt.extra=kt&15,xt.mode=fr;case fr:if(xt.extra){for(ar=xt.extra;tr<ar;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}xt.offset+=Ut&(1<<xt.extra)-1,Ut>>>=xt.extra,tr-=xt.extra,xt.back+=xt.extra}if(xt.offset>xt.dmax){jt.msg="invalid distance too far back",xt.mode=Fr;break}xt.mode=Rr;case Rr:if(Mt===0)break t;if(et=lt-Mt,xt.offset>et){if(et=xt.offset-et,et>xt.whave&&xt.sane){jt.msg="invalid distance too far back",xt.mode=Fr;break}et>xt.wnext?(et-=xt.wnext,j=xt.wsize-et):j=xt.wnext-et,et>xt.length&&(et=xt.length),rt=xt.window}else rt=Yr,j=er-xt.offset,et=xt.length;et>Mt&&(et=Mt),Mt-=et,xt.length-=et;do Yr[er++]=rt[j++];while(--et);xt.length===0&&(xt.mode=Lr);break;case gr:if(Mt===0)break t;Yr[er++]=xt.length,Mt--,xt.mode=Lr;break;case ir:if(xt.wrap){for(;tr<32;){if(sr===0)break t;sr--,Ut|=pr[mt++]<<tr,tr+=8}if(lt-=Mt,jt.total_out+=lt,xt.total+=lt,lt&&(jt.adler=xt.check=xt.flags?a(xt.check,Yr,lt,er-lt):i(xt.check,Yr,lt,er-lt)),lt=Mt,(xt.flags?Ut:nr(Ut))!==xt.check){jt.msg="incorrect data check",xt.mode=Fr;break}Ut=0,tr=0}xt.mode=Vr;case Vr:if(xt.wrap&&xt.flags){for(;tr<32;){if(sr===0)break t;sr--,Ut+=pr[mt++]<<tr,tr+=8}if(Ut!==(xt.total&4294967295)){jt.msg="incorrect length check",xt.mode=Fr;break}Ut=0,tr=0}xt.mode=Ur;case Ur:rr=nt;break t;case Fr:rr=ut;break t;case Sr:return ft;case vr:default:return at}return jt.next_out=er,jt.avail_out=Mt,jt.next_in=mt,jt.avail_in=sr,xt.hold=Ut,xt.bits=tr,(xt.wsize||lt!==jt.avail_out&&xt.mode<Fr&&(xt.mode<ir||lr!==b))&&Br(jt,jt.output,jt.next_out,lt-jt.avail_out),zr-=jt.avail_in,lt-=jt.avail_out,jt.total_in+=zr,jt.total_out+=lt,xt.total+=lt,xt.wrap&&lt&&(jt.adler=xt.check=xt.flags?a(xt.check,Yr,lt,jt.next_out-lt):i(xt.check,Yr,lt,jt.next_out-lt)),jt.data_type=xt.bits+(xt.last?64:0)+(xt.mode===qt?128:0)+(xt.mode===hr||xt.mode===_e?256:0),(zr===0&&lt===0||lr===b)&&rr===it&&(rr=ht),rr}function ur(jt){if(!jt||!jt.state)return at;var lr=jt.state;return lr.window&&(lr.window=null),jt.state=null,it}function cr(jt,lr){var xt;return!jt||!jt.state||(xt=jt.state,(xt.wrap&2)===0)?at:(xt.head=lr,lr.done=!1,it)}function yr(jt,lr){var xt=lr.length,pr,Yr,mt;return!jt||!jt.state||(pr=jt.state,pr.wrap!==0&&pr.mode!==Ft)?at:pr.mode===Ft&&(Yr=1,Yr=i(Yr,lr,xt,0),Yr!==pr.check)?ut:(mt=Br(jt,lr,xt,xt),mt?(pr.mode=Sr,ft):(pr.havedict=1,it))}return inflate.inflateReset=Nr,inflate.inflateReset2=_r,inflate.inflateResetKeep=qr,inflate.inflateInit=Ar,inflate.inflateInit2=jr,inflate.inflate=At,inflate.inflateEnd=ur,inflate.inflateGetHeader=cr,inflate.inflateSetDictionary=yr,inflate.inflateInfo="pako inflate (from Nodeca project)",inflate}var constants,hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),constants}var gzheader,hasRequiredGzheader;function requireGzheader(){if(hasRequiredGzheader)return gzheader;hasRequiredGzheader=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return gzheader=e,gzheader}var hasRequiredInflate;function requireInflate(){if(hasRequiredInflate)return inflate$1;hasRequiredInflate=1;var e=requireInflate$1(),i=requireCommon(),a=requireStrings(),s=requireConstants(),o=requireMessages(),h=requireZstream(),d=requireGzheader(),g=Object.prototype.toString;function b(it){if(!(this instanceof b))return new b(it);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},it||{});var nt=this.options;nt.raw&&nt.windowBits>=0&&nt.windowBits<16&&(nt.windowBits=-nt.windowBits,nt.windowBits===0&&(nt.windowBits=-15)),nt.windowBits>=0&&nt.windowBits<16&&!(it&&it.windowBits)&&(nt.windowBits+=32),nt.windowBits>15&&nt.windowBits<48&&!(nt.windowBits&15)&&(nt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var tt=e.inflateInit2(this.strm,nt.windowBits);if(tt!==s.Z_OK)throw new Error(o[tt]);if(this.header=new d,e.inflateGetHeader(this.strm,this.header),nt.dictionary&&(typeof nt.dictionary=="string"?nt.dictionary=a.string2buf(nt.dictionary):g.call(nt.dictionary)==="[object ArrayBuffer]"&&(nt.dictionary=new Uint8Array(nt.dictionary)),nt.raw&&(tt=e.inflateSetDictionary(this.strm,nt.dictionary),tt!==s.Z_OK)))throw new Error(o[tt])}b.prototype.push=function(it,nt){var tt=this.strm,at=this.options.chunkSize,ut=this.options.dictionary,ft,ht,dt,st,ct,wt=!1;if(this.ended)return!1;ht=nt===~~nt?nt:nt===!0?s.Z_FINISH:s.Z_NO_FLUSH,typeof it=="string"?tt.input=a.binstring2buf(it):g.call(it)==="[object ArrayBuffer]"?tt.input=new Uint8Array(it):tt.input=it,tt.next_in=0,tt.avail_in=tt.input.length;do{if(tt.avail_out===0&&(tt.output=new i.Buf8(at),tt.next_out=0,tt.avail_out=at),ft=e.inflate(tt,s.Z_NO_FLUSH),ft===s.Z_NEED_DICT&&ut&&(ft=e.inflateSetDictionary(this.strm,ut)),ft===s.Z_BUF_ERROR&&wt===!0&&(ft=s.Z_OK,wt=!1),ft!==s.Z_STREAM_END&&ft!==s.Z_OK)return this.onEnd(ft),this.ended=!0,!1;tt.next_out&&(tt.avail_out===0||ft===s.Z_STREAM_END||tt.avail_in===0&&(ht===s.Z_FINISH||ht===s.Z_SYNC_FLUSH))&&(this.options.to==="string"?(dt=a.utf8border(tt.output,tt.next_out),st=tt.next_out-dt,ct=a.buf2string(tt.output,dt),tt.next_out=st,tt.avail_out=at-st,st&&i.arraySet(tt.output,tt.output,dt,st,0),this.onData(ct)):this.onData(i.shrinkBuf(tt.output,tt.next_out))),tt.avail_in===0&&tt.avail_out===0&&(wt=!0)}while((tt.avail_in>0||tt.avail_out===0)&&ft!==s.Z_STREAM_END);return ft===s.Z_STREAM_END&&(ht=s.Z_FINISH),ht===s.Z_FINISH?(ft=e.inflateEnd(this.strm),this.onEnd(ft),this.ended=!0,ft===s.Z_OK):(ht===s.Z_SYNC_FLUSH&&(this.onEnd(s.Z_OK),tt.avail_out=0),!0)},b.prototype.onData=function(it){this.chunks.push(it)},b.prototype.onEnd=function(it){it===s.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=it,this.msg=this.strm.msg};function _(it,nt){var tt=new b(nt);if(tt.push(it,!0),tt.err)throw tt.msg||o[tt.err];return tt.result}function $(it,nt){return nt=nt||{},nt.raw=!0,_(it,nt)}return inflate$1.Inflate=b,inflate$1.inflate=_,inflate$1.inflateRaw=$,inflate$1.ungzip=_,inflate$1}var pako_1,hasRequiredPako;function requirePako(){if(hasRequiredPako)return pako_1;hasRequiredPako=1;var e=requireCommon().assign,i=requireDeflate(),a=requireInflate(),s=requireConstants(),o={};return e(o,i,a,s),pako_1=o,pako_1}var pakoExports=requirePako();const pako=getDefaultExportFromCjs(pakoExports);var UPNG={};UPNG.toRGBA8=function(e){var i=e.width,a=e.height;if(e.tabs.acTL==null)return[UPNG.toRGBA8.decodeImage(e.data,i,a,e).buffer];var s=[];e.frames[0].data==null&&(e.frames[0].data=e.data);for(var o=i*a*4,h=new Uint8Array(o),d=new Uint8Array(o),g=new Uint8Array(o),b=0;b<e.frames.length;b++){var _=e.frames[b],$=_.rect.x,it=_.rect.y,nt=_.rect.width,tt=_.rect.height,at=UPNG.toRGBA8.decodeImage(_.data,nt,tt,e);if(b!=0)for(var ut=0;ut<o;ut++)g[ut]=h[ut];if(_.blend==0?UPNG._copyTile(at,nt,tt,h,i,a,$,it,0):_.blend==1&&UPNG._copyTile(at,nt,tt,h,i,a,$,it,1),s.push(h.buffer.slice(0)),_.dispose!=0){if(_.dispose==1)UPNG._copyTile(d,nt,tt,h,i,a,$,it,0);else if(_.dispose==2)for(var ut=0;ut<o;ut++)h[ut]=g[ut]}}return s};UPNG.toRGBA8.decodeImage=function(e,i,a,s){var o=i*a,h=UPNG.decode._getBPP(s),d=Math.ceil(i*h/8),g=new Uint8Array(o*4),b=new Uint32Array(g.buffer),_=s.ctype,$=s.depth,it=UPNG._bin.readUshort;if(_==6){var nt=o<<2;if($==8)for(var tt=0;tt<nt;tt+=4)g[tt]=e[tt],g[tt+1]=e[tt+1],g[tt+2]=e[tt+2],g[tt+3]=e[tt+3];if($==16)for(var tt=0;tt<nt;tt++)g[tt]=e[tt<<1]}else if(_==2){var at=s.tabs.tRNS;if(at==null){if($==8)for(var tt=0;tt<o;tt++){var ut=tt*3;b[tt]=255<<24|e[ut+2]<<16|e[ut+1]<<8|e[ut]}if($==16)for(var tt=0;tt<o;tt++){var ut=tt*6;b[tt]=255<<24|e[ut+4]<<16|e[ut+2]<<8|e[ut]}}else{var ft=at[0],ht=at[1],dt=at[2];if($==8)for(var tt=0;tt<o;tt++){var st=tt<<2,ut=tt*3;b[tt]=255<<24|e[ut+2]<<16|e[ut+1]<<8|e[ut],e[ut]==ft&&e[ut+1]==ht&&e[ut+2]==dt&&(g[st+3]=0)}if($==16)for(var tt=0;tt<o;tt++){var st=tt<<2,ut=tt*6;b[tt]=255<<24|e[ut+4]<<16|e[ut+2]<<8|e[ut],it(e,ut)==ft&&it(e,ut+2)==ht&&it(e,ut+4)==dt&&(g[st+3]=0)}}}else if(_==3){var ct=s.tabs.PLTE,wt=s.tabs.tRNS,_t=wt?wt.length:0;if($==1)for(var gt=0;gt<a;gt++)for(var yt=gt*d,bt=gt*i,tt=0;tt<i;tt++){var st=bt+tt<<2,vt=e[yt+(tt>>3)]>>7-((tt&7)<<0)&1,Ct=3*vt;g[st]=ct[Ct],g[st+1]=ct[Ct+1],g[st+2]=ct[Ct+2],g[st+3]=vt<_t?wt[vt]:255}if($==2)for(var gt=0;gt<a;gt++)for(var yt=gt*d,bt=gt*i,tt=0;tt<i;tt++){var st=bt+tt<<2,vt=e[yt+(tt>>2)]>>6-((tt&3)<<1)&3,Ct=3*vt;g[st]=ct[Ct],g[st+1]=ct[Ct+1],g[st+2]=ct[Ct+2],g[st+3]=vt<_t?wt[vt]:255}if($==4)for(var gt=0;gt<a;gt++)for(var yt=gt*d,bt=gt*i,tt=0;tt<i;tt++){var st=bt+tt<<2,vt=e[yt+(tt>>1)]>>4-((tt&1)<<2)&15,Ct=3*vt;g[st]=ct[Ct],g[st+1]=ct[Ct+1],g[st+2]=ct[Ct+2],g[st+3]=vt<_t?wt[vt]:255}if($==8)for(var tt=0;tt<o;tt++){var st=tt<<2,vt=e[tt],Ct=3*vt;g[st]=ct[Ct],g[st+1]=ct[Ct+1],g[st+2]=ct[Ct+2],g[st+3]=vt<_t?wt[vt]:255}}else if(_==4){if($==8)for(var tt=0;tt<o;tt++){var st=tt<<2,Ht=tt<<1,Ft=e[Ht];g[st]=Ft,g[st+1]=Ft,g[st+2]=Ft,g[st+3]=e[Ht+1]}if($==16)for(var tt=0;tt<o;tt++){var st=tt<<2,Ht=tt<<2,Ft=e[Ht];g[st]=Ft,g[st+1]=Ft,g[st+2]=Ft,g[st+3]=e[Ht+2]}}else if(_==0)for(var ft=s.tabs.tRNS?s.tabs.tRNS:-1,gt=0;gt<a;gt++){var qt=gt*d,zt=gt*i;if($==1)for(var Qt=0;Qt<i;Qt++){var Ft=255*(e[qt+(Qt>>>3)]>>>7-(Qt&7)&1),_e=Ft==ft*255?0:255;b[zt+Qt]=_e<<24|Ft<<16|Ft<<8|Ft}else if($==2)for(var Qt=0;Qt<i;Qt++){var Ft=85*(e[qt+(Qt>>>2)]>>>6-((Qt&3)<<1)&3),_e=Ft==ft*85?0:255;b[zt+Qt]=_e<<24|Ft<<16|Ft<<8|Ft}else if($==4)for(var Qt=0;Qt<i;Qt++){var Ft=17*(e[qt+(Qt>>>1)]>>>4-((Qt&1)<<2)&15),_e=Ft==ft*17?0:255;b[zt+Qt]=_e<<24|Ft<<16|Ft<<8|Ft}else if($==8)for(var Qt=0;Qt<i;Qt++){var Ft=e[qt+Qt],_e=Ft==ft?0:255;b[zt+Qt]=_e<<24|Ft<<16|Ft<<8|Ft}else if($==16)for(var Qt=0;Qt<i;Qt++){var Ft=e[qt+(Qt<<1)],_e=it(e,qt+(Qt<<tt))==ft?0:255;b[zt+Qt]=_e<<24|Ft<<16|Ft<<8|Ft}}return g};UPNG.decode=function(e){for(var i=new Uint8Array(e),a=8,s=UPNG._bin,o=s.readUshort,h=s.readUint,d={tabs:{},frames:[]},g=new Uint8Array(i.length),b=0,_,$=0,it=[137,80,78,71,13,10,26,10],nt=0;nt<8;nt++)if(i[nt]!=it[nt])throw"The input is not a PNG file!";for(;a<i.length;){var tt=s.readUint(i,a);a+=4;var at=s.readASCII(i,a,4);if(a+=4,at=="IHDR")UPNG.decode._IHDR(i,a,d);else if(at=="IDAT"){for(var nt=0;nt<tt;nt++)g[b+nt]=i[a+nt];b+=tt}else if(at=="acTL")d.tabs[at]={num_frames:h(i,a),num_plays:h(i,a+4)},_=new Uint8Array(i.length);else if(at=="fcTL"){if($!=0){var ut=d.frames[d.frames.length-1];ut.data=UPNG.decode._decompress(d,_.slice(0,$),ut.rect.width,ut.rect.height),$=0}var ft={x:h(i,a+12),y:h(i,a+16),width:h(i,a+4),height:h(i,a+8)},ht=o(i,a+22);ht=o(i,a+20)/(ht==0?100:ht);var dt={rect:ft,delay:Math.round(ht*1e3),dispose:i[a+24],blend:i[a+25]};d.frames.push(dt)}else if(at=="fdAT"){for(var nt=0;nt<tt-4;nt++)_[$+nt]=i[a+nt+4];$+=tt-4}else if(at=="pHYs")d.tabs[at]=[s.readUint(i,a),s.readUint(i,a+4),i[a+8]];else if(at=="cHRM"){d.tabs[at]=[];for(var nt=0;nt<8;nt++)d.tabs[at].push(s.readUint(i,a+nt*4))}else if(at=="tEXt"){d.tabs[at]==null&&(d.tabs[at]={});var st=s.nextZero(i,a),ct=s.readASCII(i,a,st-a),wt=s.readASCII(i,st+1,a+tt-st-1);d.tabs[at][ct]=wt}else if(at=="iTXt"){d.tabs[at]==null&&(d.tabs[at]={});var st=0,_t=a;st=s.nextZero(i,_t);var ct=s.readASCII(i,_t,st-_t);_t=st+1,i[_t],i[_t+1],_t+=2,st=s.nextZero(i,_t),s.readASCII(i,_t,st-_t),_t=st+1,st=s.nextZero(i,_t),s.readUTF8(i,_t,st-_t),_t=st+1;var wt=s.readUTF8(i,_t,tt-(_t-a));d.tabs[at][ct]=wt}else if(at=="PLTE")d.tabs[at]=s.readBytes(i,a,tt);else if(at=="hIST"){var gt=d.tabs.PLTE.length/3;d.tabs[at]=[];for(var nt=0;nt<gt;nt++)d.tabs[at].push(o(i,a+nt*2))}else if(at=="tRNS")d.ctype==3?d.tabs[at]=s.readBytes(i,a,tt):d.ctype==0?d.tabs[at]=o(i,a):d.ctype==2&&(d.tabs[at]=[o(i,a),o(i,a+2),o(i,a+4)]);else if(at=="gAMA")d.tabs[at]=s.readUint(i,a)/1e5;else if(at=="sRGB")d.tabs[at]=i[a];else if(at=="bKGD")d.ctype==0||d.ctype==4?d.tabs[at]=[o(i,a)]:d.ctype==2||d.ctype==6?d.tabs[at]=[o(i,a),o(i,a+2),o(i,a+4)]:d.ctype==3&&(d.tabs[at]=i[a]);else if(at=="IEND")break;a+=tt,s.readUint(i,a),a+=4}if($!=0){var ut=d.frames[d.frames.length-1];ut.data=UPNG.decode._decompress(d,_.slice(0,$),ut.rect.width,ut.rect.height),$=0}return d.data=UPNG.decode._decompress(d,g,d.width,d.height),delete d.compress,delete d.interlace,delete d.filter,d};UPNG.decode._decompress=function(e,i,a,s){var o=UPNG.decode._getBPP(e),h=Math.ceil(a*o/8),d=new Uint8Array((h+1+e.interlace)*s);return i=UPNG.decode._inflate(i,d),e.interlace==0?i=UPNG.decode._filterZero(i,e,0,a,s):e.interlace==1&&(i=UPNG.decode._readInterlace(i,e)),i};UPNG.decode._inflate=function(e,i){var a=UPNG.inflateRaw(new Uint8Array(e.buffer,2,e.length-6),i);return a};UPNG.inflateRaw=function(){var e={};return e.H={},e.H.N=function(i,a){var s=Uint8Array,o=0,h=0,d=0,g=0,b=0,_=0,$=0,it=0,nt=0,tt,at;if(i[0]==3&&i[1]==0)return a||new s(0);var ut=e.H,ft=ut.b,ht=ut.e,dt=ut.R,st=ut.n,ct=ut.A,wt=ut.Z,_t=ut.m,gt=a==null;for(gt&&(a=new s(i.length>>>2<<3));o==0;){if(o=ft(i,nt,1),h=ft(i,nt+1,2),nt+=3,h==0){nt&7&&(nt+=8-(nt&7));var yt=(nt>>>3)+4,bt=i[yt-4]|i[yt-3]<<8;gt&&(a=e.H.W(a,it+bt)),a.set(new s(i.buffer,i.byteOffset+yt,bt),it),nt=yt+bt<<3,it+=bt;continue}if(gt&&(a=e.H.W(a,it+(1<<17))),h==1&&(tt=_t.J,at=_t.h,_=511,$=31),h==2){d=ht(i,nt,5)+257,g=ht(i,nt+5,5)+1,b=ht(i,nt+10,4)+4,nt+=14;for(var vt=1,Ct=0;Ct<38;Ct+=2)_t.Q[Ct]=0,_t.Q[Ct+1]=0;for(var Ct=0;Ct<b;Ct++){var Ht=ht(i,nt+Ct*3,3);_t.Q[(_t.X[Ct]<<1)+1]=Ht,Ht>vt&&(vt=Ht)}nt+=3*b,st(_t.Q,vt),ct(_t.Q,vt,_t.u),tt=_t.w,at=_t.d,nt=dt(_t.u,(1<<vt)-1,d+g,i,nt,_t.v);var Ft=ut.V(_t.v,0,d,_t.C);_=(1<<Ft)-1;var qt=ut.V(_t.v,d,g,_t.D);$=(1<<qt)-1,st(_t.C,Ft),ct(_t.C,Ft,tt),st(_t.D,qt),ct(_t.D,qt,at)}for(;;){var zt=tt[wt(i,nt)&_];nt+=zt&15;var Qt=zt>>>4;if(!(Qt>>>8))a[it++]=Qt;else{if(Qt==256)break;var _e=it+Qt-254;if(Qt>264){var Gt=_t.q[Qt-257];_e=it+(Gt>>>3)+ht(i,nt,Gt&7),nt+=Gt&7}var Jt=at[wt(i,nt)&$];nt+=Jt&15;var or=Jt>>>4,mr=_t.c[or],hr=(mr>>>4)+ft(i,nt,mr&15);for(nt+=mr&15;it<_e;)a[it]=a[it++-hr],a[it]=a[it++-hr],a[it]=a[it++-hr],a[it]=a[it++-hr];it=_e}}}return a.length==it?a:a.slice(0,it)},e.H.W=function(i,a){var s=i.length;if(a<=s)return i;var o=new Uint8Array(s<<1);return o.set(i,0),o},e.H.R=function(i,a,s,o,h,d){for(var g=e.H.e,b=e.H.Z,_=0;_<s;){var $=i[b(o,h)&a];h+=$&15;var it=$>>>4;if(it<=15)d[_]=it,_++;else{var nt=0,tt=0;it==16?(tt=3+g(o,h,2),h+=2,nt=d[_-1]):it==17?(tt=3+g(o,h,3),h+=3):it==18&&(tt=11+g(o,h,7),h+=7);for(var at=_+tt;_<at;)d[_]=nt,_++}}return h},e.H.V=function(i,a,s,o){for(var h=0,d=0,g=o.length>>>1;d<s;){var b=i[d+a];o[d<<1]=0,o[(d<<1)+1]=b,b>h&&(h=b),d++}for(;d<g;)o[d<<1]=0,o[(d<<1)+1]=0,d++;return h},e.H.n=function(i,a){for(var s=e.H.m,o=i.length,h,d,g,$,b,_=s.j,$=0;$<=a;$++)_[$]=0;for($=1;$<o;$+=2)_[i[$]]++;var it=s.K;for(h=0,_[0]=0,d=1;d<=a;d++)h=h+_[d-1]<<1,it[d]=h;for(g=0;g<o;g+=2)b=i[g+1],b!=0&&(i[g]=it[b],it[b]++)},e.H.A=function(i,a,s){for(var o=i.length,h=e.H.m,d=h.r,g=0;g<o;g+=2)if(i[g+1]!=0)for(var b=g>>1,_=i[g+1],$=b<<4|_,it=a-_,nt=i[g]<<it,tt=nt+(1<<it);nt!=tt;){var at=d[nt]>>>15-a;s[at]=$,nt++}},e.H.l=function(i,a){for(var s=e.H.m.r,o=15-a,h=0;h<i.length;h+=2){var d=i[h]<<a-i[h+1];i[h]=s[d]>>>o}},e.H.M=function(i,a,s){s=s<<(a&7);var o=a>>>3;i[o]|=s,i[o+1]|=s>>>8},e.H.I=function(i,a,s){s=s<<(a&7);var o=a>>>3;i[o]|=s,i[o+1]|=s>>>8,i[o+2]|=s>>>16},e.H.e=function(i,a,s){return(i[a>>>3]|i[(a>>>3)+1]<<8)>>>(a&7)&(1<<s)-1},e.H.b=function(i,a,s){return(i[a>>>3]|i[(a>>>3)+1]<<8|i[(a>>>3)+2]<<16)>>>(a&7)&(1<<s)-1},e.H.Z=function(i,a){return(i[a>>>3]|i[(a>>>3)+1]<<8|i[(a>>>3)+2]<<16)>>>(a&7)},e.H.i=function(i,a){return(i[a>>>3]|i[(a>>>3)+1]<<8|i[(a>>>3)+2]<<16|i[(a>>>3)+3]<<24)>>>(a&7)},e.H.m=function(){var i=Uint16Array,a=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new a(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new a(286),Y:new a(30),a:new a(19),t:new a(15e3),k:new i(65536),g:new i(32768)}}(),function(){for(var i=e.H.m,a=32768,s=0;s<a;s++){var o=s;o=(o&2863311530)>>>1|(o&1431655765)<<1,o=(o&3435973836)>>>2|(o&858993459)<<2,o=(o&4042322160)>>>4|(o&252645135)<<4,o=(o&4278255360)>>>8|(o&16711935)<<8,i.r[s]=(o>>>16|o<<16)>>>17}function h(d,g,b){for(;g--!=0;)d.push(0,b)}for(var s=0;s<32;s++)i.q[s]=i.S[s]<<3|i.T[s],i.c[s]=i.p[s]<<4|i.z[s];h(i._,144,8),h(i._,112,9),h(i._,24,7),h(i._,8,8),e.H.n(i._,9),e.H.A(i._,9,i.J),e.H.l(i._,9),h(i.$,32,5),e.H.n(i.$,5),e.H.A(i.$,5,i.h),e.H.l(i.$,5),h(i.Q,19,0),h(i.C,286,0),h(i.D,30,0),h(i.v,320,0)}(),e.H.N}();UPNG.decode._readInterlace=function(e,i){for(var a=i.width,s=i.height,o=UPNG.decode._getBPP(i),h=o>>3,d=Math.ceil(a*o/8),g=new Uint8Array(s*d),b=0,_=[0,0,4,0,2,0,1],$=[0,4,0,2,0,1,0],it=[8,8,8,4,4,2,2],nt=[8,8,4,4,2,2,1],tt=0;tt<7;){for(var at=it[tt],ut=nt[tt],ft=0,ht=0,dt=_[tt];dt<s;)dt+=at,ht++;for(var st=$[tt];st<a;)st+=ut,ft++;var ct=Math.ceil(ft*o/8);UPNG.decode._filterZero(e,i,b,ft,ht);for(var wt=0,_t=_[tt];_t<s;){for(var gt=$[tt],yt=b+wt*ct<<3;gt<a;){if(o==1){var bt=e[yt>>3];bt=bt>>7-(yt&7)&1,g[_t*d+(gt>>3)]|=bt<<7-((gt&7)<<0)}if(o==2){var bt=e[yt>>3];bt=bt>>6-(yt&7)&3,g[_t*d+(gt>>2)]|=bt<<6-((gt&3)<<1)}if(o==4){var bt=e[yt>>3];bt=bt>>4-(yt&7)&15,g[_t*d+(gt>>1)]|=bt<<4-((gt&1)<<2)}if(o>=8)for(var vt=_t*d+gt*h,Ct=0;Ct<h;Ct++)g[vt+Ct]=e[(yt>>3)+Ct];yt+=o,gt+=ut}wt++,_t+=at}ft*ht!=0&&(b+=ht*(1+ct)),tt=tt+1}return g};UPNG.decode._getBPP=function(e){var i=[1,null,3,1,2,null,4][e.ctype];return i*e.depth};UPNG.decode._filterZero=function(e,i,a,s,o){var h=UPNG.decode._getBPP(i),d=Math.ceil(s*h/8),g=UPNG.decode._paeth;h=Math.ceil(h/8);var b=0,_=1,$=e[a],it=0;if($>1&&(e[a]=[0,0,1][$-2]),$==3)for(it=h;it<d;it++)e[it+1]=e[it+1]+(e[it+1-h]>>>1)&255;for(var nt=0;nt<o;nt++)if(b=a+nt*d,_=b+nt+1,$=e[_-1],it=0,$==0)for(;it<d;it++)e[b+it]=e[_+it];else if($==1){for(;it<h;it++)e[b+it]=e[_+it];for(;it<d;it++)e[b+it]=e[_+it]+e[b+it-h]}else if($==2)for(;it<d;it++)e[b+it]=e[_+it]+e[b+it-d];else if($==3){for(;it<h;it++)e[b+it]=e[_+it]+(e[b+it-d]>>>1);for(;it<d;it++)e[b+it]=e[_+it]+(e[b+it-d]+e[b+it-h]>>>1)}else{for(;it<h;it++)e[b+it]=e[_+it]+g(0,e[b+it-d],0);for(;it<d;it++)e[b+it]=e[_+it]+g(e[b+it-h],e[b+it-d],e[b+it-h-d])}return e};UPNG.decode._paeth=function(e,i,a){var s=e+i-a,o=s-e,h=s-i,d=s-a;return o*o<=h*h&&o*o<=d*d?e:h*h<=d*d?i:a};UPNG.decode._IHDR=function(e,i,a){var s=UPNG._bin;a.width=s.readUint(e,i),i+=4,a.height=s.readUint(e,i),i+=4,a.depth=e[i],i++,a.ctype=e[i],i++,a.compress=e[i],i++,a.filter=e[i],i++,a.interlace=e[i],i++};UPNG._bin={nextZero:function(e,i){for(;e[i]!=0;)i++;return i},readUshort:function(e,i){return e[i]<<8|e[i+1]},writeUshort:function(e,i,a){e[i]=a>>8&255,e[i+1]=a&255},readUint:function(e,i){return e[i]*(256*256*256)+(e[i+1]<<16|e[i+2]<<8|e[i+3])},writeUint:function(e,i,a){e[i]=a>>24&255,e[i+1]=a>>16&255,e[i+2]=a>>8&255,e[i+3]=a&255},readASCII:function(e,i,a){for(var s="",o=0;o<a;o++)s+=String.fromCharCode(e[i+o]);return s},writeASCII:function(e,i,a){for(var s=0;s<a.length;s++)e[i+s]=a.charCodeAt(s)},readBytes:function(e,i,a){for(var s=[],o=0;o<a;o++)s.push(e[i+o]);return s},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,i,a){for(var s="",o,h=0;h<a;h++)s+="%"+UPNG._bin.pad(e[i+h].toString(16));try{o=decodeURIComponent(s)}catch{return UPNG._bin.readASCII(e,i,a)}return o}};UPNG._copyTile=function(e,i,a,s,o,h,d,g,b){for(var _=Math.min(i,o),$=Math.min(a,h),it=0,nt=0,tt=0;tt<$;tt++)for(var at=0;at<_;at++)if(d>=0&&g>=0?(it=tt*i+at<<2,nt=(g+tt)*o+d+at<<2):(it=(-g+tt)*i-d+at<<2,nt=tt*o+at<<2),b==0)s[nt]=e[it],s[nt+1]=e[it+1],s[nt+2]=e[it+2],s[nt+3]=e[it+3];else if(b==1){var ut=e[it+3]*.00392156862745098,ft=e[it]*ut,ht=e[it+1]*ut,dt=e[it+2]*ut,st=s[nt+3]*(1/255),ct=s[nt]*st,wt=s[nt+1]*st,_t=s[nt+2]*st,gt=1-ut,yt=ut+st*gt,bt=yt==0?0:1/yt;s[nt+3]=255*yt,s[nt+0]=(ft+ct*gt)*bt,s[nt+1]=(ht+wt*gt)*bt,s[nt+2]=(dt+_t*gt)*bt}else if(b==2){var ut=e[it+3],ft=e[it],ht=e[it+1],dt=e[it+2],st=s[nt+3],ct=s[nt],wt=s[nt+1],_t=s[nt+2];ut==st&&ft==ct&&ht==wt&&dt==_t?(s[nt]=0,s[nt+1]=0,s[nt+2]=0,s[nt+3]=0):(s[nt]=ft,s[nt+1]=ht,s[nt+2]=dt,s[nt+3]=ut)}else if(b==3){var ut=e[it+3],ft=e[it],ht=e[it+1],dt=e[it+2],st=s[nt+3],ct=s[nt],wt=s[nt+1],_t=s[nt+2];if(ut==st&&ft==ct&&ht==wt&&dt==_t)continue;if(ut<220&&st>20)return!1}return!0};UPNG.encode=function(e,i,a,s,o,h,d){s==null&&(s=0),d==null&&(d=!1);var g=UPNG.encode.compress(e,i,a,s,[!1,!1,!1,0,d]);return UPNG.encode.compressPNG(g,-1),UPNG.encode._main(g,i,a,o,h)};UPNG.encodeLL=function(e,i,a,s,o,h,d,g){for(var b={ctype:0+(s==1?0:2)+(o==0?0:4),depth:h,frames:[]},_=(s+o)*h,$=_*i,it=0;it<e.length;it++)b.frames.push({rect:{x:0,y:0,width:i,height:a},img:new Uint8Array(e[it]),blend:0,dispose:1,bpp:Math.ceil(_/8),bpl:Math.ceil($/8)});UPNG.encode.compressPNG(b,0,!0);var nt=UPNG.encode._main(b,i,a,d,g);return nt};UPNG.encode._main=function(e,i,a,s,o){o==null&&(o={});var h=UPNG.crc.crc,d=UPNG._bin.writeUint,g=UPNG._bin.writeUshort,b=UPNG._bin.writeASCII,_=8,$=e.frames.length>1,it=!1,nt=33+($?20:0);if(o.sRGB!=null&&(nt+=13),o.pHYs!=null&&(nt+=21),e.ctype==3){for(var tt=e.plte.length,at=0;at<tt;at++)e.plte[at]>>>24!=255&&(it=!0);nt+=8+tt*3+4+(it?8+tt*1+4:0)}for(var ut=0;ut<e.frames.length;ut++){var ft=e.frames[ut];$&&(nt+=38),nt+=ft.cimg.length+12,ut!=0&&(nt+=4)}nt+=12;for(var ht=new Uint8Array(nt),dt=[137,80,78,71,13,10,26,10],at=0;at<8;at++)ht[at]=dt[at];if(d(ht,_,13),_+=4,b(ht,_,"IHDR"),_+=4,d(ht,_,i),_+=4,d(ht,_,a),_+=4,ht[_]=e.depth,_++,ht[_]=e.ctype,_++,ht[_]=0,_++,ht[_]=0,_++,ht[_]=0,_++,d(ht,_,h(ht,_-17,17)),_+=4,o.sRGB!=null&&(d(ht,_,1),_+=4,b(ht,_,"sRGB"),_+=4,ht[_]=o.sRGB,_++,d(ht,_,h(ht,_-5,5)),_+=4),o.pHYs!=null&&(d(ht,_,9),_+=4,b(ht,_,"pHYs"),_+=4,d(ht,_,o.pHYs[0]),_+=4,d(ht,_,o.pHYs[1]),_+=4,ht[_]=o.pHYs[2],_++,d(ht,_,h(ht,_-13,13)),_+=4),$&&(d(ht,_,8),_+=4,b(ht,_,"acTL"),_+=4,d(ht,_,e.frames.length),_+=4,d(ht,_,o.loop!=null?o.loop:0),_+=4,d(ht,_,h(ht,_-12,12)),_+=4),e.ctype==3){var tt=e.plte.length;d(ht,_,tt*3),_+=4,b(ht,_,"PLTE"),_+=4;for(var at=0;at<tt;at++){var st=at*3,ct=e.plte[at],wt=ct&255,_t=ct>>>8&255,gt=ct>>>16&255;ht[_+st+0]=wt,ht[_+st+1]=_t,ht[_+st+2]=gt}if(_+=tt*3,d(ht,_,h(ht,_-tt*3-4,tt*3+4)),_+=4,it){d(ht,_,tt),_+=4,b(ht,_,"tRNS"),_+=4;for(var at=0;at<tt;at++)ht[_+at]=e.plte[at]>>>24&255;_+=tt,d(ht,_,h(ht,_-tt-4,tt+4)),_+=4}}for(var yt=0,ut=0;ut<e.frames.length;ut++){var ft=e.frames[ut];$&&(d(ht,_,26),_+=4,b(ht,_,"fcTL"),_+=4,d(ht,_,yt++),_+=4,d(ht,_,ft.rect.width),_+=4,d(ht,_,ft.rect.height),_+=4,d(ht,_,ft.rect.x),_+=4,d(ht,_,ft.rect.y),_+=4,g(ht,_,s[ut]),_+=2,g(ht,_,1e3),_+=2,ht[_]=ft.dispose,_++,ht[_]=ft.blend,_++,d(ht,_,h(ht,_-30,30)),_+=4);var bt=ft.cimg,tt=bt.length;d(ht,_,tt+(ut==0?0:4)),_+=4;var vt=_;b(ht,_,ut==0?"IDAT":"fdAT"),_+=4,ut!=0&&(d(ht,_,yt++),_+=4),ht.set(bt,_),_+=tt,d(ht,_,h(ht,vt,_-vt)),_+=4}return d(ht,_,0),_+=4,b(ht,_,"IEND"),_+=4,d(ht,_,h(ht,_-4,4)),_+=4,ht.buffer};UPNG.encode.compressPNG=function(e,i,a){for(var s=0;s<e.frames.length;s++){var o=e.frames[s];o.rect.width;var h=o.rect.height,d=new Uint8Array(h*o.bpl+h);o.cimg=UPNG.encode._filterZero(o.img,h,o.bpp,o.bpl,d,i,a)}};UPNG.encode.compress=function(e,i,a,s,o){for(var h=o[0],d=o[1],g=o[2],b=o[3],_=o[4],$=6,it=8,nt=255,tt=0;tt<e.length;tt++)for(var at=new Uint8Array(e[tt]),ut=at.length,ft=0;ft<ut;ft+=4)nt&=at[ft+3];var ht=nt!=255,dt=UPNG.encode.framize(e,i,a,h,d,g),st={},ct=[],wt=[];if(s!=0){for(var _t=[],ft=0;ft<dt.length;ft++)_t.push(dt[ft].img.buffer);for(var gt=UPNG.encode.concatRGBA(_t),yt=UPNG.quantize(gt,s),bt=0,vt=new Uint8Array(yt.abuf),ft=0;ft<dt.length;ft++){var Ct=dt[ft].img,Ht=Ct.length;wt.push(new Uint8Array(yt.inds.buffer,bt>>2,Ht>>2));for(var tt=0;tt<Ht;tt+=4)Ct[tt]=vt[bt+tt],Ct[tt+1]=vt[bt+tt+1],Ct[tt+2]=vt[bt+tt+2],Ct[tt+3]=vt[bt+tt+3];bt+=Ht}for(var ft=0;ft<yt.plte.length;ft++)ct.push(yt.plte[ft].est.rgba)}else for(var tt=0;tt<dt.length;tt++){var Ft=dt[tt],qt=new Uint32Array(Ft.img.buffer),zt=Ft.rect.width,ut=qt.length,Qt=new Uint8Array(ut);wt.push(Qt);for(var ft=0;ft<ut;ft++){var _e=qt[ft];if(ft!=0&&_e==qt[ft-1])Qt[ft]=Qt[ft-1];else if(ft>zt&&_e==qt[ft-zt])Qt[ft]=Qt[ft-zt];else{var Gt=st[_e];if(Gt==null&&(st[_e]=Gt=ct.length,ct.push(_e),ct.length>=300))break;Qt[ft]=Gt}}}var Jt=ct.length;Jt<=256&&_==!1&&(Jt<=2?it=1:Jt<=4?it=2:Jt<=16?it=4:it=8,it=Math.max(it,b));for(var tt=0;tt<dt.length;tt++){var Ft=dt[tt];Ft.rect.x,Ft.rect.y;var zt=Ft.rect.width,or=Ft.rect.height,mr=Ft.img;new Uint32Array(mr.buffer);var hr=4*zt,Lr=4;if(Jt<=256&&_==!1){hr=Math.ceil(it*zt/8);for(var Er=new Uint8Array(hr*or),Kt=wt[tt],fr=0;fr<or;fr++){var ft=fr*hr,Rr=fr*zt;if(it==8)for(var gr=0;gr<zt;gr++)Er[ft+gr]=Kt[Rr+gr];else if(it==4)for(var gr=0;gr<zt;gr++)Er[ft+(gr>>1)]|=Kt[Rr+gr]<<4-(gr&1)*4;else if(it==2)for(var gr=0;gr<zt;gr++)Er[ft+(gr>>2)]|=Kt[Rr+gr]<<6-(gr&3)*2;else if(it==1)for(var gr=0;gr<zt;gr++)Er[ft+(gr>>3)]|=Kt[Rr+gr]<<7-(gr&7)*1}mr=Er,$=3,Lr=1}else if(ht==!1&&dt.length==1){for(var Er=new Uint8Array(zt*or*3),ir=zt*or,ft=0;ft<ir;ft++){var Ct=ft*3,Vr=ft*4;Er[Ct]=mr[Vr],Er[Ct+1]=mr[Vr+1],Er[Ct+2]=mr[Vr+2]}mr=Er,$=2,Lr=3,hr=3*zt}Ft.img=mr,Ft.bpl=hr,Ft.bpp=Lr}return{ctype:$,depth:it,plte:ct,frames:dt}};UPNG.encode.framize=function(e,i,a,s,o,h){for(var d=[],g=0;g<e.length;g++){var b=new Uint8Array(e[g]),_=new Uint32Array(b.buffer),$,it=0,nt=0,tt=i,at=a,ut=s?1:0;if(g!=0){for(var ft=h||s||g==1||d[g-2].dispose!=0?1:2,ht=0,dt=1e9,st=0;st<ft;st++){for(var Ft=new Uint8Array(e[g-1-st]),ct=new Uint32Array(e[g-1-st]),wt=i,_t=a,gt=-1,yt=-1,bt=0;bt<a;bt++)for(var vt=0;vt<i;vt++){var Ct=bt*i+vt;_[Ct]!=ct[Ct]&&(vt<wt&&(wt=vt),vt>gt&&(gt=vt),bt<_t&&(_t=bt),bt>yt&&(yt=bt))}gt==-1&&(wt=_t=gt=yt=0),o&&((wt&1)==1&&wt--,(_t&1)==1&&_t--);var Ht=(gt-wt+1)*(yt-_t+1);Ht<dt&&(dt=Ht,ht=st,it=wt,nt=_t,tt=gt-wt+1,at=yt-_t+1)}var Ft=new Uint8Array(e[g-1-ht]);ht==1&&(d[g-1].dispose=2),$=new Uint8Array(tt*at*4),UPNG._copyTile(Ft,i,a,$,tt,at,-it,-nt,0),ut=UPNG._copyTile(b,i,a,$,tt,at,-it,-nt,3)?1:0,ut==1?UPNG.encode._prepareDiff(b,i,a,$,{x:it,y:nt,width:tt,height:at}):UPNG._copyTile(b,i,a,$,tt,at,-it,-nt,0)}else $=b.slice(0);d.push({rect:{x:it,y:nt,width:tt,height:at},img:$,blend:ut,dispose:0})}if(s)for(var g=0;g<d.length;g++){var qt=d[g];if(qt.blend!=1){var zt=qt.rect,Qt=d[g-1].rect,_e=Math.min(zt.x,Qt.x),Gt=Math.min(zt.y,Qt.y),Jt=Math.max(zt.x+zt.width,Qt.x+Qt.width),or=Math.max(zt.y+zt.height,Qt.y+Qt.height),mr={x:_e,y:Gt,width:Jt-_e,height:or-Gt};d[g-1].dispose=1,g-1!=0&&UPNG.encode._updateFrame(e,i,a,d,g-1,mr,o),UPNG.encode._updateFrame(e,i,a,d,g,mr,o)}}var hr=0;if(e.length!=1)for(var Ct=0;Ct<d.length;Ct++){var qt=d[Ct];hr+=qt.rect.width*qt.rect.height}return d};UPNG.encode._updateFrame=function(e,i,a,s,o,h,d){for(var g=Uint8Array,b=Uint32Array,_=new g(e[o-1]),$=new b(e[o-1]),it=o+1<e.length?new g(e[o+1]):null,nt=new g(e[o]),tt=new b(nt.buffer),at=i,ut=a,ft=-1,ht=-1,dt=0;dt<h.height;dt++)for(var st=0;st<h.width;st++){var ct=h.x+st,wt=h.y+dt,_t=wt*i+ct,gt=tt[_t];gt==0||s[o-1].dispose==0&&$[_t]==gt&&(it==null||it[_t*4+3]!=0)||(ct<at&&(at=ct),ct>ft&&(ft=ct),wt<ut&&(ut=wt),wt>ht&&(ht=wt))}ft==-1&&(at=ut=ft=ht=0),d&&((at&1)==1&&at--,(ut&1)==1&&ut--),h={x:at,y:ut,width:ft-at+1,height:ht-ut+1};var yt=s[o];yt.rect=h,yt.blend=1,yt.img=new Uint8Array(h.width*h.height*4),s[o-1].dispose==0?(UPNG._copyTile(_,i,a,yt.img,h.width,h.height,-h.x,-h.y,0),UPNG.encode._prepareDiff(nt,i,a,yt.img,h)):UPNG._copyTile(nt,i,a,yt.img,h.width,h.height,-h.x,-h.y,0)};UPNG.encode._prepareDiff=function(e,i,a,s,o){UPNG._copyTile(e,i,a,s,o.width,o.height,-o.x,-o.y,2)};UPNG.encode._filterZero=function(e,i,a,s,o,h,d){var g=[],b=[0,1,2,3,4];h!=-1?b=[h]:(i*s>5e5||a==1)&&(b=[0]);var _;d&&(_={level:0});for(var $=d&&UZIP!=null?UZIP:pako,it=0;it<b.length;it++){for(var nt=0;nt<i;nt++)UPNG.encode._filterLine(o,e,nt,s,a,b[it]);g.push($.deflate(o,_))}for(var tt,at=1e9,it=0;it<g.length;it++)g[it].length<at&&(tt=it,at=g[it].length);return g[tt]};UPNG.encode._filterLine=function(e,i,a,s,o,h){var d=a*s,g=d+a,b=UPNG.decode._paeth;if(e[g]=h,g++,h==0)if(s<500)for(var _=0;_<s;_++)e[g+_]=i[d+_];else e.set(new Uint8Array(i.buffer,d,s),g);else if(h==1){for(var _=0;_<o;_++)e[g+_]=i[d+_];for(var _=o;_<s;_++)e[g+_]=i[d+_]-i[d+_-o]+256&255}else if(a==0){for(var _=0;_<o;_++)e[g+_]=i[d+_];if(h==2)for(var _=o;_<s;_++)e[g+_]=i[d+_];if(h==3)for(var _=o;_<s;_++)e[g+_]=i[d+_]-(i[d+_-o]>>1)+256&255;if(h==4)for(var _=o;_<s;_++)e[g+_]=i[d+_]-b(i[d+_-o],0,0)+256&255}else{if(h==2)for(var _=0;_<s;_++)e[g+_]=i[d+_]+256-i[d+_-s]&255;if(h==3){for(var _=0;_<o;_++)e[g+_]=i[d+_]+256-(i[d+_-s]>>1)&255;for(var _=o;_<s;_++)e[g+_]=i[d+_]+256-(i[d+_-s]+i[d+_-o]>>1)&255}if(h==4){for(var _=0;_<o;_++)e[g+_]=i[d+_]+256-b(0,i[d+_-s],0)&255;for(var _=o;_<s;_++)e[g+_]=i[d+_]+256-b(i[d+_-o],i[d+_-s],i[d+_-o-s])&255}}};UPNG.crc={table:function(){for(var e=new Uint32Array(256),i=0;i<256;i++){for(var a=i,s=0;s<8;s++)a&1?a=3988292384^a>>>1:a=a>>>1;e[i]=a}return e}(),update:function(e,i,a,s){for(var o=0;o<s;o++)e=UPNG.crc.table[(e^i[a+o])&255]^e>>>8;return e},crc:function(e,i,a){return UPNG.crc.update(4294967295,e,i,a)^4294967295}};UPNG.quantize=function(e,i){var a=new Uint8Array(e),s=a.slice(0),o=new Uint32Array(s.buffer),h=UPNG.quantize.getKDtree(s,i),d=h[0],g=h[1];UPNG.quantize.planeDst;for(var b=a,_=o,$=b.length,it=new Uint8Array(a.length>>2),nt=0;nt<$;nt+=4){var tt=b[nt]*.00392156862745098,at=b[nt+1]*(1/255),ut=b[nt+2]*(1/255),ft=b[nt+3]*(1/255),ht=UPNG.quantize.getNearest(d,tt,at,ut,ft);it[nt>>2]=ht.ind,_[nt>>2]=ht.est.rgba}return{abuf:s.buffer,inds:it,plte:g}};UPNG.quantize.getKDtree=function(e,i,a){a==null&&(a=1e-4);var s=new Uint32Array(e.buffer),o={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};o.bst=UPNG.quantize.stats(e,o.i0,o.i1),o.est=UPNG.quantize.estats(o.bst);for(var h=[o];h.length<i;){for(var d=0,g=0,b=0;b<h.length;b++)h[b].est.L>d&&(d=h[b].est.L,g=b);if(d<a)break;var _=h[g],$=UPNG.quantize.splitPixels(e,s,_.i0,_.i1,_.est.e,_.est.eMq255),it=_.i0>=$||_.i1<=$;if(it){_.est.L=0;continue}var nt={i0:_.i0,i1:$,bst:null,est:null,tdst:0,left:null,right:null};nt.bst=UPNG.quantize.stats(e,nt.i0,nt.i1),nt.est=UPNG.quantize.estats(nt.bst);var tt={i0:$,i1:_.i1,bst:null,est:null,tdst:0,left:null,right:null};tt.bst={R:[],m:[],N:_.bst.N-nt.bst.N};for(var b=0;b<16;b++)tt.bst.R[b]=_.bst.R[b]-nt.bst.R[b];for(var b=0;b<4;b++)tt.bst.m[b]=_.bst.m[b]-nt.bst.m[b];tt.est=UPNG.quantize.estats(tt.bst),_.left=nt,_.right=tt,h[g]=nt,h.push(tt)}h.sort(function(at,ut){return ut.bst.N-at.bst.N});for(var b=0;b<h.length;b++)h[b].ind=b;return[o,h]};UPNG.quantize.getNearest=function(e,i,a,s,o){if(e.left==null)return e.tdst=UPNG.quantize.dist(e.est.q,i,a,s,o),e;var h=UPNG.quantize.planeDst(e.est,i,a,s,o),d=e.left,g=e.right;h>0&&(d=e.right,g=e.left);var b=UPNG.quantize.getNearest(d,i,a,s,o);if(b.tdst<=h*h)return b;var _=UPNG.quantize.getNearest(g,i,a,s,o);return _.tdst<b.tdst?_:b};UPNG.quantize.planeDst=function(e,i,a,s,o){var h=e.e;return h[0]*i+h[1]*a+h[2]*s+h[3]*o-e.eMq};UPNG.quantize.dist=function(e,i,a,s,o){var h=i-e[0],d=a-e[1],g=s-e[2],b=o-e[3];return h*h+d*d+g*g+b*b};UPNG.quantize.splitPixels=function(e,i,a,s,o,h){var d=UPNG.quantize.vecDot;for(s-=4;a<s;){for(;d(e,a,o)<=h;)a+=4;for(;d(e,s,o)>h;)s-=4;if(a>=s)break;var g=i[a>>2];i[a>>2]=i[s>>2],i[s>>2]=g,a+=4,s-=4}for(;d(e,a,o)>h;)a-=4;return a+4};UPNG.quantize.vecDot=function(e,i,a){return e[i]*a[0]+e[i+1]*a[1]+e[i+2]*a[2]+e[i+3]*a[3]};UPNG.quantize.stats=function(e,i,a){for(var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=[0,0,0,0],h=a-i>>2,d=i;d<a;d+=4){var g=e[d]*.00392156862745098,b=e[d+1]*(1/255),_=e[d+2]*(1/255),$=e[d+3]*(1/255);o[0]+=g,o[1]+=b,o[2]+=_,o[3]+=$,s[0]+=g*g,s[1]+=g*b,s[2]+=g*_,s[3]+=g*$,s[5]+=b*b,s[6]+=b*_,s[7]+=b*$,s[10]+=_*_,s[11]+=_*$,s[15]+=$*$}return s[4]=s[1],s[8]=s[2],s[9]=s[6],s[12]=s[3],s[13]=s[7],s[14]=s[11],{R:s,m:o,N:h}};UPNG.quantize.estats=function(e){var i=e.R,a=e.m,s=e.N,o=a[0],h=a[1],d=a[2],g=a[3],b=s==0?0:1/s,_=[i[0]-o*o*b,i[1]-o*h*b,i[2]-o*d*b,i[3]-o*g*b,i[4]-h*o*b,i[5]-h*h*b,i[6]-h*d*b,i[7]-h*g*b,i[8]-d*o*b,i[9]-d*h*b,i[10]-d*d*b,i[11]-d*g*b,i[12]-g*o*b,i[13]-g*h*b,i[14]-g*d*b,i[15]-g*g*b],$=_,it=UPNG.M4,nt=[.5,.5,.5,.5],tt=0,at=0;if(s!=0)for(var ut=0;ut<10&&(nt=it.multVec($,nt),at=Math.sqrt(it.dot(nt,nt)),nt=it.sml(1/at,nt),!(Math.abs(at-tt)<1e-9));ut++)tt=at;var ft=[o*b,h*b,d*b,g*b],ht=it.dot(it.sml(255,ft),nt);return{Cov:_,q:ft,e:nt,L:tt,eMq255:ht,eMq:it.dot(nt,ft),rgba:(Math.round(255*ft[3])<<24|Math.round(255*ft[2])<<16|Math.round(255*ft[1])<<8|Math.round(255*ft[0])<<0)>>>0}};UPNG.M4={multVec:function(e,i){return[e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3],e[4]*i[0]+e[5]*i[1]+e[6]*i[2]+e[7]*i[3],e[8]*i[0]+e[9]*i[1]+e[10]*i[2]+e[11]*i[3],e[12]*i[0]+e[13]*i[1]+e[14]*i[2]+e[15]*i[3]]},dot:function(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3]},sml:function(e,i){return[e*i[0],e*i[1],e*i[2],e*i[3]]}};UPNG.encode.concatRGBA=function(e){for(var i=0,a=0;a<e.length;a++)i+=e[a].byteLength;for(var s=new Uint8Array(i),o=0,a=0;a<e.length;a++){for(var h=new Uint8Array(e[a]),d=h.length,g=0;g<d;g+=4){var b=h[g],_=h[g+1],$=h[g+2],it=h[g+3];it==0&&(b=_=$=0),s[o+g]=b,s[o+g+1]=_,s[o+g+2]=$,s[o+g+3]=it}o+=d}return s.buffer};const Rt=class gn{constructor(i={}){$e(this,"nonFinalChunkFlag"),$e(this,"finalChunkFlag"),$e(this,"upright"),$e(this,"isRaw"),$e(this,"quality"),$e(this,"resolution"),$e(this,"queue"),$e(this,"_imageDataChunks"),this.nonFinalChunkFlag=i.nonFinalChunkFlag??7,this.finalChunkFlag=i.finalChunkFlag??8,this.upright=i.upright??!0,this.isRaw=i.isRaw??!1,this.quality=i.quality??null,this.resolution=i.resolution??null,this.queue=null,this._imageDataChunks=[]}static hasJpegHeader(i,a){return`${i}_${a}`in gn._jpegHeaderMap}concatenateImageData(){let i=0;for(const o of this._imageDataChunks)i+=o.length;const a=new Uint8Array(i);let s=0;for(const o of this._imageDataChunks)a.set(o,s),s+=o.length;return a}handleData(i){if(!this.queue){console.warn("RxPhoto: Received data but queue not initialized - call attach() first");return}const a=i[0],s=i.slice(1);this._imageDataChunks.push(s),a===this.finalChunkFlag&&this._processCompleteImage().catch(o=>{console.error("RxPhoto: Error processing complete image:",o),this._imageDataChunks=[]})}async _processCompleteImage(){if(!this.queue)return;let i;const a=this.concatenateImageData();if(this._imageDataChunks=[],this.isRaw){if(!this.quality||!this.resolution)throw new Error("RxPhoto: Quality and resolution must be set for raw images if no header is cached.");const s=`${this.quality}_${this.resolution}`,o=gn._jpegHeaderMap[s];if(!o)throw new Error(`RxPhoto: No JPEG header found for quality ${this.quality} and resolution ${this.resolution} - request full JPEG first to cache header.`);const h=new Uint8Array(o.length+a.length);h.set(o,0),h.set(a,o.length),i=h}else if(i=a,this.quality&&this.resolution){const s=`${this.quality}_${this.resolution}`;if(!gn._jpegHeaderMap[s]){const o=i.slice(0,623);gn._jpegHeaderMap[s]=o}}this.upright?(console.log("Rotating image 90 degrees counter-clockwise"),this.queue.put(await this.rotateJpeg90CounterClockwise(i))):this.queue.put(i)}async attach(i){return this.isRaw&&(!this.quality||!this.resolution)&&console.warn("RxPhoto: Handling raw images without quality/resolution specified. Header must be pre-cached or will fail."),this.queue=new AsyncQueue,this._imageDataChunks=[],i.registerDataResponseHandler(this,[this.nonFinalChunkFlag,this.finalChunkFlag],this.handleData.bind(this)),this.queue}detach(i){i.unregisterDataResponseHandler(this),this.queue&&this.queue.clear(),this.queue=null,this._imageDataChunks=[]}async rotateJpeg90CounterClockwise(i){const a=jpeg.decode(i,{useTArray:!0});if(!a||!a.data||!a.width||!a.height)throw new Error("Failed to decode JPEG image.");const s=document.createElement("canvas");s.width=a.height,s.height=a.width;const o=s.getContext("2d");if(!o)throw new Error("Failed to get canvas 2D context.");const h=document.createElement("canvas");h.width=a.width,h.height=a.height;const d=h.getContext("2d");if(!d)throw new Error("Failed to get temporary canvas 2D context.");d.putImageData(new ImageData(new Uint8ClampedArray(a.data.buffer),a.width,a.height),0,0),o.clearRect(0,0,s.width,s.height),o.translate(0,s.height),o.rotate(-90*Math.PI/180),o.drawImage(h,0,0);const g=await(await new Promise((b,_)=>{s.toBlob($=>{$?b($):_(new Error("Failed to convert canvas to JPEG blob."))},"image/jpeg")})).arrayBuffer();return new Uint8Array(g)}};$e(Rt,"_jpegHeaderMap",{});const plainTextFrameApp=`local data       = require('data.min')
local plain_text = require('plain_text.min')

-- Phone to Frame msg code
TEXT_MSG = 0x0a
data.parsers[TEXT_MSG] = plain_text.parse_plain_text

-- Layout constants
local CHAR_PER_LINE  = 25
local LINES_PER_PAGE = 5
local LINE_HEIGHT    = 60

-- State
local wrapped_lines = {}
local page_index    = 1

local function wrap_text(str)
  local out = {}
  local len = #str
  local i = 1
  while i <= len do
    table.insert(out, str:sub(i, math.min(i + CHAR_PER_LINE - 1, len)))
    i = i + CHAR_PER_LINE
  end
  return out
end

local function clear_display()
  frame.display.text(" ", 1, 1)
  frame.display.show()
  frame.sleep(0.04)
end

local function render_page()
  clear_display()
  for offset = 0, LINES_PER_PAGE - 1 do
    local idx = page_index + offset
    local line = wrapped_lines[idx]
    if not line then break end
    frame.display.text(line, 1, offset * LINE_HEIGHT + 1)
  end
  frame.display.show()
end

local function on_tap()
  page_index = page_index + LINES_PER_PAGE
  if page_index > #wrapped_lines then
    page_index = 1
  end
  render_page()
end

-- register tap callback once
frame.imu.tap_callback(on_tap)

function app_loop()
  clear_display()
  print('Frame scroll app in esecuzione')
  while true do
    local ok, err = pcall(function()
      local ready = data.process_raw_items()
      if ready > 0 and data.app_data[TEXT_MSG] then
        local txt = data.app_data[TEXT_MSG].string or ""
        wrapped_lines = wrap_text(txt)
        page_index = 1
        render_page()
        data.app_data[TEXT_MSG] = nil
      end
    end)
    if not ok then
      print('Errore in app_loop:', err)
      clear_display()
    end
    frame.sleep(0.1)
  end
end

app_loop()
`,GEMINI_API_KEY="AIzaSyCUspjopyRDqf8iR-ftL7UsPyaYfAt1p_M";async function fetchGemini(e){const i="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key="+GEMINI_API_KEY,a=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}]})});if(!a.ok)throw new Error("Errore chiamando Gemini: "+a.status);const s=await a.json();try{return s.candidates[0].content.parts[0].text}catch{return JSON.stringify(s)}}function App(){const[e,i]=reactExports.useState(null),[a,s]=reactExports.useState(""),[o,h]=reactExports.useState(""),[d,g]=reactExports.useState("Pronto!"),[b,_]=reactExports.useState([]),$=tt=>{_(at=>[...at,tt])},it=async()=>{g("Connessione in corso…"),$("▶ handleConnect start");try{$("• new FrameMsg()");const tt=new FrameMsg;$("• connecting…"),await tt.connect(),$("✔ connected"),g("Frame connesso, carico librerie…"),$("• uploadStdLuaLibs"),await tt.uploadStdLuaLibs([StdLua.DataMin,StdLua.PlainTextMin]),$("✔ libs loaded"),g("Lib caricate, invio app Lua…"),$("• uploadFrameApp"),await tt.uploadFrameApp(plainTextFrameApp),$("✔ Lua uploaded"),g("App Lua inviata, avvio…"),$("• startFrameApp"),await tt.startFrameApp(),$("✔ app running"),i(tt),g("Occhiali connessi e Lua caricata!")}catch(tt){const at=(tt==null?void 0:tt.message)||String(tt);$("✖ ERRORE: "+at),g("Errore: "+at)}},nt=async()=>{g("Richiesta a Gemini…"),$("▶ handleSend start");try{const tt=await fetchGemini(a);if(h(tt),$("✔ Gemini response: "+tt.slice(0,30)+"…"),e){g("Invio a Frame…"),$("• sendMessage");const at=new TxPlainText(tt);await e.sendMessage(10,at.pack()),$("✔ sent to Frame"),g("Risposta mostrata sugli occhiali!")}else g("Frame non connesso — risposta solo schermo")}catch(tt){const at=(tt==null?void 0:tt.message)||String(tt);$("✖ ERRORE send: "+at),g("Errore: "+at)}};return jsxRuntimeExports.jsxs("div",{style:{maxWidth:600,margin:"auto",padding:24},children:[jsxRuntimeExports.jsx("h1",{children:"Gemini → Frame"}),jsxRuntimeExports.jsx("button",{onClick:it,children:"Connetti a Frame & Carica Lua"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("textarea",{rows:3,style:{width:"100%",marginTop:12},value:a,onChange:tt=>s(tt.target.value),placeholder:"Scrivi qui il prompt per Gemini..."}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("button",{onClick:nt,style:{marginTop:12},children:"Invia Prompt a Gemini & Frame"}),jsxRuntimeExports.jsxs("div",{style:{marginTop:12,minHeight:24},children:[jsxRuntimeExports.jsx("b",{children:"Stato:"})," ",d]}),jsxRuntimeExports.jsx("pre",{style:{marginTop:8,padding:8,background:"#f0f0f0",maxHeight:120,overflowY:"auto",fontSize:"0.8em"},children:b.join(`
`)}),jsxRuntimeExports.jsxs("div",{style:{marginTop:24,fontSize:"0.9em",color:"#333"},children:[jsxRuntimeExports.jsx("b",{children:"Risposta Gemini:"}),jsxRuntimeExports.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:o})]})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
